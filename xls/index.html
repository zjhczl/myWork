
  
  
 
  
  
 


<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>XlsxWriter Documentation</title>
    <link rel="stylesheet" href="_static/basic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/_static/css/badge_only.css" />
    <link rel="stylesheet" href="_static/bootstrap-3.0.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html#document-index">XlsxWriter</a>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a href="index.html#document-index"
     class="dropdown-toggle"
     data-toggle="dropdown">Contents <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-contents">Contents</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-introduction">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-getting_started">Getting Started with XlsxWriter</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tutorial01">Tutorial 1: Create a simple XLSX file</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tutorial02">Tutorial 2: Adding formatting to the XLSX File</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tutorial03">Tutorial 3: Writing different types of data to the XLSX File</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-workbook">The Workbook Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-worksheet">The Worksheet Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-page_setup">The Worksheet Class (Page Setup)</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-format">The Format Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-chart">The Chart Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-chartsheet">The Chartsheet Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-exceptions">The Exceptions Class</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_cell_notation">Working with Cell Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_data">Working with and Writing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_formulas">Working with Formulas</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_dates_and_time">Working with Dates and Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_colors">Working with Colors</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_charts">Working with Charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_object_positioning">Working with Object Positioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_autofilters">Working with Autofilters</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_data_validation">Working with Data Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_conditional_formats">Working with Conditional Formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_tables">Working with Worksheet Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_textboxes">Working with Textboxes</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_sparklines">Working with Sparklines</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_cell_comments">Working with Cell Comments</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_outlines">Working with Outlines and Grouping</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_memory">Working with Memory and Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_macros">Working with VBA Macros</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_pandas">Working with Python Pandas and XlsxWriter</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-examples">Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-chart_examples">Chart Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-pandas_examples">Pandas with XlsxWriter Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-alternatives">Alternative modules for handling Excel files</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-third_party">Libraries that use or enhance XlsxWriter</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-bugs">Known Issues and Bugs</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#reporting-bugs">Reporting Bugs</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-faq">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-changes">Changes in XlsxWriter</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-author">Author</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-license">License</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-contents">Contents</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-introduction">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-getting_started">Getting Started with XlsxWriter</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tutorial01">Tutorial 1: Create a simple XLSX file</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tutorial02">Tutorial 2: Adding formatting to the XLSX File</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tutorial03">Tutorial 3: Writing different types of data to the XLSX File</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-workbook">The Workbook Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-worksheet">The Worksheet Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-page_setup">The Worksheet Class (Page Setup)</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-format">The Format Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-chart">The Chart Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-chartsheet">The Chartsheet Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-exceptions">The Exceptions Class</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_cell_notation">Working with Cell Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_data">Working with and Writing Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_formulas">Working with Formulas</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_dates_and_time">Working with Dates and Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_colors">Working with Colors</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_charts">Working with Charts</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_object_positioning">Working with Object Positioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_autofilters">Working with Autofilters</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_data_validation">Working with Data Validation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_conditional_formats">Working with Conditional Formatting</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_tables">Working with Worksheet Tables</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_textboxes">Working with Textboxes</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_sparklines">Working with Sparklines</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_cell_comments">Working with Cell Comments</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_outlines">Working with Outlines and Grouping</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_memory">Working with Memory and Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_macros">Working with VBA Macros</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-working_with_pandas">Working with Python Pandas and XlsxWriter</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-examples">Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-chart_examples">Chart Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-pandas_examples">Pandas with XlsxWriter Examples</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-alternatives">Alternative modules for handling Excel files</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-third_party">Libraries that use or enhance XlsxWriter</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-bugs">Known Issues and Bugs</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#reporting-bugs">Reporting Bugs</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-faq">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-changes">Changes in XlsxWriter</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-author">Author</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-license">License</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="creating-excel-files-with-python-and-xlsxwriter">
<h1>Creating Excel files with Python and XlsxWriter</h1>
<p>XlsxWriter is a Python module for creating Excel XLSX files.</p>
<img alt="_images/demo.png" src="_images/demo.png" />
<p>(<a class="reference internal" href="index.html#ex-demo"><span class="std std-ref">Sample code to create the above spreadsheet</span></a>.)</p>
<p><strong>XlsxWriter</strong></p>
<p>XlsxWriter is a Python module that can be used to write text, numbers, formulas
and hyperlinks to multiple worksheets in an Excel 2007+ XLSX file. It supports
features such as formatting and many more, including:</p>
<ul class="simple">
<li>100% compatible Excel XLSX files.</li>
<li>Full formatting.</li>
<li>Merged cells.</li>
<li>Defined names.</li>
<li>Charts.</li>
<li>Autofilters.</li>
<li>Data validation and drop down lists.</li>
<li>Conditional formatting.</li>
<li>Worksheet PNG/JPEG/BMP/WMF/EMF images.</li>
<li>Rich multi-format strings.</li>
<li>Cell comments.</li>
<li>Textboxes.</li>
<li>Integration with Pandas.</li>
<li>Memory optimization mode for writing large files.</li>
</ul>
<p>It supports Python 2.7, 3.4+ and PyPy and uses standard libraries only.</p>
<p>This document explains how to use the XlsxWriter module. See the following
sections for more information, or jump straight to the <a class="reference internal" href="index.html#intro"><span class="std std-ref">Introduction</span></a>.</p>
<div class="toctree-wrapper compound">
<span id="document-contents"></span><div class="section" id="contents">
<h2>Contents</h2>
<div class="toctree-wrapper compound">
<span id="document-introduction"></span><div class="section" id="introduction">
<span id="intro"></span><h3>Introduction</h3>
<p><strong>XlsxWriter</strong> is a Python module for writing files in the Excel 2007+ XLSX
file format.</p>
<p>It can be used to write text, numbers, and formulas to multiple worksheets and
it supports features such as formatting, images, charts, page setup,
autofilters, conditional formatting and many others.</p>
<p>XlsxWriter has some advantages and disadvantages over the
<a class="reference internal" href="index.html#alternatives"><span class="std std-ref">alternative Python modules</span></a> for writing Excel files.</p>
<ul>
<li><p class="first">Advantages:</p>
<blockquote>
<div><ul class="simple">
<li>It supports more Excel features than any of the alternative modules.</li>
<li>It has a high degree of fidelity with files produced by Excel. In most
cases the files produced are 100% equivalent to files produced by Excel.</li>
<li>It has extensive documentation, example files and tests.</li>
<li>It is fast and can be configured to use very little memory even for very
large output files.</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Disadvantages:</p>
<blockquote>
<div><ul class="simple">
<li>It cannot read or modify existing Excel XLSX files.</li>
</ul>
</div></blockquote>
</li>
</ul>
<p>XlsxWriter is licensed under a BSD <a class="reference internal" href="index.html#license"><span class="std std-ref">License</span></a> and the source code is
available on <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter">GitHub</a>.</p>
<p>To try out the module see the next section on <a class="reference internal" href="index.html#getting-started"><span class="std std-ref">Getting Started with XlsxWriter</span></a>.</p>
</div>
<span id="document-getting_started"></span><div class="section" id="getting-started-with-xlsxwriter">
<span id="getting-started"></span><h3>Getting Started with XlsxWriter</h3>
<p>Here are some easy instructions to get you up and running with the XlsxWriter
module.</p>
<div class="section" id="installing-xlsxwriter">
<h4>Installing XlsxWriter</h4>
<p>The first step is to install the XlsxWriter module. There are several ways to
do this.</p>
<div class="section" id="using-pip">
<h5>Using PIP</h5>
<p>The <a class="reference external" href="https://pip.pypa.io/en/latest/">pip</a>  installer is
the preferred method for installing Python modules from
<a class="reference external" href="https://pypi.org/">PyPI</a>, the Python Package Index:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install XlsxWriter

# Or to a non system dir:
$ pip install --user XlsxWriter
</pre></div>
</div>
</div>
<div class="section" id="installing-from-a-tarball">
<h5>Installing from a tarball</h5>
<p>If you download a tarball of the latest version of XlsxWriter you can install
it as follows (change the version number to suit):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ tar -zxvf XlsxWriter-1.2.3.tar.gz

$ cd XlsxWriter-1.2.3
$ python setup.py install
</pre></div>
</div>
<p>A tarball of the latest code can be downloaded from GitHub as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ curl -O -L http://github.com/jmcnamara/XlsxWriter/archive/master.tar.gz

$ tar zxvf master.tar.gz
$ cd XlsxWriter-master/
$ python setup.py install
</pre></div>
</div>
</div>
<div class="section" id="cloning-from-github">
<h5>Cloning from GitHub</h5>
<p>The XlsxWriter source code and bug tracker is in the
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter">XlsxWriter repository</a> on GitHub.
You can clone the repository and install from it as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/jmcnamara/XlsxWriter.git

$ cd XlsxWriter
$ python setup.py install
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-a-sample-program">
<h4>Running a sample program</h4>
<p>If the installation went correctly you can create a small sample program like
the following to verify that the module works correctly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;hello.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello world&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Save this to a file called <code class="docutils literal notranslate"><span class="pre">hello.py</span></code> and run it as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python hello.py
</pre></div>
</div>
<p>This will output a file called <code class="docutils literal notranslate"><span class="pre">hello.xlsx</span></code> which should look something like
the following:</p>
<img alt="_images/hello01.png" src="_images/hello01.png" />
<p>If you downloaded a tarball or cloned the repo, as shown above, you should also
have a directory called
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/tree/master/examples">examples</a>
with some sample applications that demonstrate different features of
XlsxWriter.</p>
</div>
<div class="section" id="documentation">
<h4>Documentation</h4>
<p>The latest version of this document is hosted on
<a class="reference external" href="https://xlsxwriter.readthedocs.io">Read The Docs</a>. It is also
available as a
<a class="reference external" href="https://raw.githubusercontent.com/jmcnamara/XlsxWriter/master/docs/XlsxWriter.pdf">PDF</a>.</p>
<p>Once you are happy that the module is installed and operational you can have a
look at the rest of the XlsxWriter documentation. <a class="reference internal" href="index.html#tutorial1"><span class="std std-ref">Tutorial 1: Create a simple XLSX file</span></a> is a good
place to start.</p>
</div>
</div>
<span id="document-tutorial01"></span><div class="section" id="tutorial-1-create-a-simple-xlsx-file">
<span id="tutorial1"></span><h3>Tutorial 1: Create a simple XLSX file</h3>
<p>Let’s start by creating a simple spreadsheet using Python and the XlsxWriter
module.</p>
<p>Say that we have some data on monthly outgoings that we want to convert into an
Excel XLSX file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">expenses</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Rent&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Gas&#39;</span><span class="p">,</span>   <span class="mi">100</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Food&#39;</span><span class="p">,</span>  <span class="mi">300</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Gym&#39;</span><span class="p">,</span>    <span class="mi">50</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<p>To do that we can start with a small program like the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="c1"># Create a workbook and add a worksheet.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;Expenses01.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Some data we want to write to the worksheet.</span>
<span class="n">expenses</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Rent&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Gas&#39;</span><span class="p">,</span>   <span class="mi">100</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Food&#39;</span><span class="p">,</span>  <span class="mi">300</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Gym&#39;</span><span class="p">,</span>    <span class="mi">50</span><span class="p">],</span>
<span class="p">)</span>

<span class="c1"># Start from the first cell. Rows and columns are zero indexed.</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Iterate over the data and write it out row by row.</span>
<span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">cost</span> <span class="ow">in</span> <span class="p">(</span><span class="n">expenses</span><span class="p">):</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span>     <span class="n">item</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cost</span><span class="p">)</span>
    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Write a total using a formula.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Total&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;=SUM(B1:B4)&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>If we run this program we should get a spreadsheet that looks like this:</p>
<img alt="_images/tutorial01.png" src="_images/tutorial01.png" />
<p>This is a simple example but the steps involved are representative of all
programs that use XlsxWriter, so let’s break it down into separate parts.</p>
<p>The first step is to import the module:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>
</pre></div>
</div>
<p>The next step is to create a new workbook object using the <code class="docutils literal notranslate"><span class="pre">Workbook()</span></code>
constructor.</p>
<p><a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> takes one, non-optional, argument which is the filename that
we want to create:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;Expenses01.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">XlsxWriter can only create <em>new files</em>. It cannot read or modify existing
files.</p>
</div>
<p>The workbook object is then used to add a new worksheet via the
<a class="reference internal" href="index.html#add_worksheet" title="add_worksheet"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_worksheet()</span></code></a> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
</pre></div>
</div>
<p>By default worksheet names in the spreadsheet will be <cite>Sheet1</cite>, <cite>Sheet2</cite> etc.,
but we can also specify a name:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>        <span class="c1"># Defaults to Sheet1.</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>  <span class="c1"># Data.</span>
<span class="n">worksheet3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>        <span class="c1"># Defaults to Sheet3.</span>
</pre></div>
</div>
<p>We can then use the worksheet object to write data via the <a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a>
method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">some_data</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Throughout XlsxWriter, <em>rows</em> and <em>columns</em> are zero indexed. The
first cell in a worksheet, <code class="docutils literal notranslate"><span class="pre">A1</span></code>, is <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code>.</p>
</div>
<p>So in our example we iterate over our data and write it out as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Iterate over the data and write it out row by row.</span>
<span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">cost</span> <span class="ow">in</span> <span class="p">(</span><span class="n">expenses</span><span class="p">):</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span>     <span class="n">item</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cost</span><span class="p">)</span>
    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>We then add a formula to calculate the total of the items in the second column:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;=SUM(B1:B4)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, we close the Excel file via the <a class="reference internal" href="index.html#close" title="close"><code class="xref py py-func docutils literal notranslate"><span class="pre">close()</span></code></a> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>And that’s it. We now have a file that can be read by Excel and other
spreadsheet applications.</p>
<p>In the next sections we will see how we can use the XlsxWriter module to add
formatting and other Excel features.</p>
</div>
<span id="document-tutorial02"></span><div class="section" id="tutorial-2-adding-formatting-to-the-xlsx-file">
<span id="tutorial2"></span><h3>Tutorial 2: Adding formatting to the XLSX File</h3>
<p>In the previous section we created a simple spreadsheet using Python and the
XlsxWriter module.</p>
<p>This converted the required data into an Excel file but it looked a little
bare. In order to make the information clearer we would like to add some
simple formatting, like this:</p>
<img alt="_images/tutorial02.png" src="_images/tutorial02.png" />
<p>The differences here are that we have added <strong>Item</strong> and <strong>Cost</strong> column
headers in a bold font, we have formatted the currency in the second column
and we have made the <strong>Total</strong> string bold.</p>
<p>To do this we can extend our program as follows:</p>
<p>(The significant changes are shown with a red line.)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="kn">import</span> <span class="nn">xlsxwriter</span>

 <span class="c1"># Create a workbook and add a worksheet.</span>
 <span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;Expenses02.xlsx&#39;</span><span class="p">)</span>
 <span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="hll"> <span class="c1"># Add a bold format to use to highlight cells.</span>
</span><span class="hll"> <span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>
</span><span class="hll">
</span><span class="hll"> <span class="c1"># Add a number format for cells with money.</span>
</span><span class="hll"> <span class="n">money</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;$#,##0&#39;</span><span class="p">})</span>
</span><span class="hll">
</span><span class="hll"> <span class="c1"># Write some data headers.</span>
</span><span class="hll"> <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Item&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
</span><span class="hll"> <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;Cost&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
</span>
 <span class="c1"># Some data we want to write to the worksheet.</span>
 <span class="n">expenses</span> <span class="o">=</span> <span class="p">(</span>
     <span class="p">[</span><span class="s1">&#39;Rent&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
     <span class="p">[</span><span class="s1">&#39;Gas&#39;</span><span class="p">,</span>   <span class="mi">100</span><span class="p">],</span>
     <span class="p">[</span><span class="s1">&#39;Food&#39;</span><span class="p">,</span>  <span class="mi">300</span><span class="p">],</span>
     <span class="p">[</span><span class="s1">&#39;Gym&#39;</span><span class="p">,</span>    <span class="mi">50</span><span class="p">],</span>
 <span class="p">)</span>

 <span class="c1"># Start from the first cell below the headers.</span>
 <span class="n">row</span> <span class="o">=</span> <span class="mi">1</span>
 <span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>

 <span class="c1"># Iterate over the data and write it out row by row.</span>
 <span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">cost</span> <span class="ow">in</span> <span class="p">(</span><span class="n">expenses</span><span class="p">):</span>
     <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span>     <span class="n">item</span><span class="p">)</span>
<span class="hll">     <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">money</span><span class="p">)</span>
</span>     <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

 <span class="c1"># Write a total using a formula.</span>
<span class="hll"> <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Total&#39;</span><span class="p">,</span>       <span class="n">bold</span><span class="p">)</span>
</span><span class="hll"> <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;=SUM(B2:B5)&#39;</span><span class="p">,</span> <span class="n">money</span><span class="p">)</span>
</span>
 <span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>The main difference between this and the previous program is that we have added
two <a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a> objects that we can use to format cells in the
spreadsheet.</p>
<p>Format objects represent all of the formatting properties that can be applied
to a cell in Excel such as fonts, number formatting, colors and borders. This
is explained in more detail in <a class="reference internal" href="index.html#format"><span class="std std-ref">The Format Class</span></a> section.</p>
<p>For now we will avoid getting into the details and just use a limited amount of
the format functionality to add some simple formatting:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add a bold format to use to highlight cells.</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>

<span class="c1"># Add a number format for cells with money.</span>
<span class="n">money</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;$#,##0&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>We can then pass these formats as an optional third parameter to the
<a class="reference internal" href="index.html#worksheet"><span class="std std-ref">worksheet.</span></a><a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method to format the data in the
cell:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="p">[</span><span class="n">format</span><span class="p">])</span>
</pre></div>
</div>
<p>Like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Total&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
</pre></div>
</div>
<p>Which leads us to another new feature in this program. To add the headers in
the first row of the worksheet we used <a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Item&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;Cost&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
</pre></div>
</div>
<p>So, instead of <code class="docutils literal notranslate"><span class="pre">(row,</span> <span class="pre">col)</span></code> we used the Excel <code class="docutils literal notranslate"><span class="pre">'A1'</span></code>  style notation. See
<a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details but don’t be too concerned about it for
now. It is just a little syntactic sugar to help with laying out worksheets.</p>
<p>In the next section we will look at handling more data types.</p>
</div>
<span id="document-tutorial03"></span><div class="section" id="tutorial-3-writing-different-types-of-data-to-the-xlsx-file">
<span id="tutorial3"></span><h3>Tutorial 3: Writing different types of data to the XLSX File</h3>
<p>In the previous section we created a simple spreadsheet with formatting using
Python and the XlsxWriter module.</p>
<p>This time let’s extend the data we want to write to include some dates:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">expenses</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Rent&#39;</span><span class="p">,</span> <span class="s1">&#39;2013-01-13&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Gas&#39;</span><span class="p">,</span>  <span class="s1">&#39;2013-01-14&#39;</span><span class="p">,</span>  <span class="mi">100</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Food&#39;</span><span class="p">,</span> <span class="s1">&#39;2013-01-16&#39;</span><span class="p">,</span>  <span class="mi">300</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Gym&#39;</span><span class="p">,</span>  <span class="s1">&#39;2013-01-20&#39;</span><span class="p">,</span>   <span class="mi">50</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The corresponding spreadsheet will look like this:</p>
<img alt="_images/tutorial03.png" src="_images/tutorial03.png" />
<p>The differences here are that we have added a Date column with formatting and
made that column a little wider to accommodate the dates.</p>
<p>To do this we can extend our program as follows:</p>
<p>(The significant changes are shown with a red line.)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"> <span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
</span> <span class="kn">import</span> <span class="nn">xlsxwriter</span>

 <span class="c1"># Create a workbook and add a worksheet.</span>
 <span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;Expenses03.xlsx&#39;</span><span class="p">)</span>
 <span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

 <span class="c1"># Add a bold format to use to highlight cells.</span>
 <span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

 <span class="c1"># Add a number format for cells with money.</span>
 <span class="n">money_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;$#,##0&#39;</span><span class="p">})</span>

 <span class="c1"># Add an Excel date format.</span>
<span class="hll"> <span class="n">date_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;mmmm d yyyy&#39;</span><span class="p">})</span>
</span>
 <span class="c1"># Adjust the column width.</span>
<span class="hll"> <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</span>
 <span class="c1"># Write some data headers.</span>
 <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Item&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
 <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
 <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;Cost&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

 <span class="c1"># Some data we want to write to the worksheet.</span>
 <span class="n">expenses</span> <span class="o">=</span> <span class="p">(</span>
<span class="hll">     <span class="p">[</span><span class="s1">&#39;Rent&#39;</span><span class="p">,</span> <span class="s1">&#39;2013-01-13&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span>
</span><span class="hll">     <span class="p">[</span><span class="s1">&#39;Gas&#39;</span><span class="p">,</span>  <span class="s1">&#39;2013-01-14&#39;</span><span class="p">,</span>  <span class="mi">100</span><span class="p">],</span>
</span><span class="hll">     <span class="p">[</span><span class="s1">&#39;Food&#39;</span><span class="p">,</span> <span class="s1">&#39;2013-01-16&#39;</span><span class="p">,</span>  <span class="mi">300</span><span class="p">],</span>
</span><span class="hll">     <span class="p">[</span><span class="s1">&#39;Gym&#39;</span><span class="p">,</span>  <span class="s1">&#39;2013-01-20&#39;</span><span class="p">,</span>   <span class="mi">50</span><span class="p">],</span>
</span> <span class="p">)</span>

 <span class="c1"># Start from the first cell below the headers.</span>
 <span class="n">row</span> <span class="o">=</span> <span class="mi">1</span>
 <span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>

 <span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">date_str</span><span class="p">,</span> <span class="n">cost</span> <span class="ow">in</span> <span class="p">(</span><span class="n">expenses</span><span class="p">):</span>
     <span class="c1"># Convert the date string into a datetime object.</span>
<span class="hll">     <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date_str</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span class="hll">
</span><span class="hll">     <span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span>  <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span>     <span class="n">item</span>              <span class="p">)</span>
</span><span class="hll">     <span class="n">worksheet</span><span class="o">.</span><span class="n">write_datetime</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date_format</span> <span class="p">)</span>
</span><span class="hll">     <span class="n">worksheet</span><span class="o">.</span><span class="n">write_number</span>  <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">money_format</span><span class="p">)</span>
</span>     <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

 <span class="c1"># Write a total using a formula.</span>
 <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Total&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
 <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;=SUM(C2:C5)&#39;</span><span class="p">,</span> <span class="n">money_format</span><span class="p">)</span>

 <span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>The main difference between this and the previous program is that we have added
a new <a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a> object for dates and we have additional handling
for data types.</p>
<p>Excel treats different types of input data, such as strings and numbers,
differently although it generally does it transparently to the user.
XlsxWriter tries to emulate this in the
<a class="reference internal" href="index.html#worksheet"><span class="std std-ref">worksheet.</span></a><a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method by mapping Python data
types to types that Excel supports.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">write()</span></code> method acts as a general alias for several more specific
methods:</p>
<ul class="simple">
<li><a class="reference internal" href="index.html#write_string" title="write_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_string()</span></code></a></li>
<li><a class="reference internal" href="index.html#write_number" title="write_number"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_number()</span></code></a></li>
<li><a class="reference internal" href="index.html#write_blank" title="write_blank"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_blank()</span></code></a></li>
<li><a class="reference internal" href="index.html#write_formula" title="write_formula"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_formula()</span></code></a></li>
<li><a class="reference internal" href="index.html#write_datetime" title="write_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_datetime()</span></code></a></li>
<li><a class="reference internal" href="index.html#write_boolean" title="write_boolean"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_boolean()</span></code></a></li>
<li><a class="reference internal" href="index.html#write_url" title="write_url"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_url()</span></code></a></li>
</ul>
<p>In this version of our program we have used some of these explicit <code class="docutils literal notranslate"><span class="pre">write_</span></code>
methods for different types of data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span>  <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span>     <span class="n">item</span>              <span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_datetime</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date_format</span> <span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_number</span>  <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">cost</span><span class="p">,</span> <span class="n">money_format</span><span class="p">)</span>
</pre></div>
</div>
<p>This is mainly to show that if you need more control over the type of data you
write to a worksheet you can use the appropriate method. In this simplified
example the <a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method would actually have worked just as well.</p>
<p>The handling of dates is also new to our program.</p>
<p>Dates and times in Excel are floating point numbers that have a number format
applied to display them in the correct format. If the date and time are Python
<a class="reference external" href="https://docs.python.org/3/library/datetime.html#module-datetime" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">datetime</span></code></a> objects XlsxWriter makes the required number conversion
automatically. However, we also need to add the number format to ensure that
Excel displays it as as date:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="o">...</span>

<span class="n">date_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;mmmm d yyyy&#39;</span><span class="p">})</span>
<span class="o">...</span>

<span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">date_str</span><span class="p">,</span> <span class="n">cost</span> <span class="ow">in</span> <span class="p">(</span><span class="n">expenses</span><span class="p">):</span>
    <span class="c1"># Convert the date string into a datetime object.</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date_str</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="o">...</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write_datetime</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date_format</span> <span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Date handling is explained in more detail in <a class="reference internal" href="index.html#working-with-dates-and-time"><span class="std std-ref">Working with Dates and Time</span></a>.</p>
<p>The last addition to our program is the <a class="reference internal" href="index.html#set_column" title="set_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_column()</span></code></a> method to adjust the
width of column ‘B’ so that the dates are more clearly visible:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adjust the column width.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:B&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<p>That completes the tutorial section.</p>
<p>In the next sections we will look at the API in more detail starting with
<a class="reference internal" href="index.html#workbook"><span class="std std-ref">The Workbook Class</span></a>.</p>
</div>
<span id="document-workbook"></span><div class="section" id="the-workbook-class">
<span id="workbook"></span><h3>The Workbook Class</h3>
<p>The Workbook class is the main class exposed by the XlsxWriter module and it is
the only class that you will need to instantiate directly.</p>
<p>The Workbook class represents the entire spreadsheet as you see it in Excel and
internally it represents the Excel file as it is written on disk.</p>
<div class="section" id="constructor">
<h4>Constructor</h4>
<dl class="function">
<dt id="Workbook">
<code class="descname">Workbook</code><span class="sig-paren">(</span><em>filename</em><span class="optional">[</span>, <em>options</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Create a new XlsxWriter Workbook object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>string</em>) – The name of the new Excel file to create.</li>
<li><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Optional workbook parameters. See below.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">A Workbook object.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">Workbook()</span></code> constructor is used to create a new Excel workbook with a
given filename:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span>  <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;filename.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Hello Excel&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/workbook01.png" src="_images/workbook01.png" />
<p>The constructor options are:</p>
<ul>
<li><p class="first"><strong>constant_memory</strong>: Reduces the amount of data stored in memory so that
large files can be written efficiently:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;constant_memory&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>Note, in this mode a row of data is written and then discarded when a cell
in a new row is added via one of the worksheet <code class="docutils literal notranslate"><span class="pre">write_()</span></code> methods.
Therefore, once this mode is active, data should be written in sequential
row order. For this reason the <a class="reference internal" href="index.html#add_table" title="add_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_table()</span></code></a> and <a class="reference internal" href="index.html#merge_range" title="merge_range"><code class="xref py py-func docutils literal notranslate"><span class="pre">merge_range()</span></code></a>
Worksheet methods don’t work in this mode.</p>
<p>See <a class="reference internal" href="index.html#memory-perf"><span class="std std-ref">Working with Memory and Performance</span></a> for more details.</p>
</li>
<li><p class="first"><strong>tmpdir</strong>: <code class="docutils literal notranslate"><span class="pre">XlsxWriter</span></code> stores workbook data in temporary files prior
to assembling the final XLSX file. The temporary files are created in the
system’s temp directory. If the default temporary directory isn’t accessible
to your application, or doesn’t contain enough space, you can specify an
alternative location using the <code class="docutils literal notranslate"><span class="pre">tmpdir</span></code> option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;tmpdir&#39;</span><span class="p">:</span> <span class="s1">&#39;/home/user/tmp&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The temporary directory must exist and will not be created.</p>
</li>
<li><p class="first"><strong>in_memory</strong>: To avoid the use of temporary files in the assembly of the
final XLSX file, for example on servers that don’t allow temp files, set the
<code class="docutils literal notranslate"><span class="pre">in_memory</span></code> constructor option to <code class="docutils literal notranslate"><span class="pre">True</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;in_memory&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>This option overrides the <code class="docutils literal notranslate"><span class="pre">constant_memory</span></code> option.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This option used to be the recommended way of deploying XlsxWriter on
Google APP Engine since it didn’t support a <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> directory. However,
the Python 3 Runtime Environment in Google App Engine now supports a
<a class="reference external" href="https://cloud.google.com/appengine/docs/standard/python3/runtime#filesystem">filesystem with read/write access to /tmp</a>
which means this option isn’t required. The <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> dir isn’t supported
in the Python 2 Runtime Environment so this option is still required
there.</p>
</div>
</li>
<li><p class="first"><strong>strings_to_numbers</strong>: Enable the
<a class="reference internal" href="index.html#worksheet"><span class="std std-ref">worksheet.</span></a><a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method to convert strings to
numbers, where possible, using <code class="xref py py-func docutils literal notranslate"><span class="pre">float()</span></code> in order to avoid an Excel
warning about “Numbers Stored as Text”. The default is <code class="docutils literal notranslate"><span class="pre">False</span></code>. To enable
this option use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;strings_to_numbers&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>strings_to_formulas</strong>: Enable the
<a class="reference internal" href="index.html#worksheet"><span class="std std-ref">worksheet.</span></a><a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method to convert strings to
formulas. The default is <code class="docutils literal notranslate"><span class="pre">True</span></code>. To disable this option use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;strings_to_formulas&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>strings_to_urls</strong>: Enable the <a class="reference internal" href="index.html#worksheet"><span class="std std-ref">worksheet.</span></a><a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a>
method to convert strings to urls. The default is <code class="docutils literal notranslate"><span class="pre">True</span></code>. To disable this
option use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;strings_to_urls&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>max_url_length</strong>: Set the maximum length for hyperlinks in worksheets. The
default is 2079 and the minimum is 255. Versions of Excel prior to Excel
2015 limited hyperlink links and anchor/locations to 255 characters
each. Versions after that support urls up to 2079 characters. XlsxWriter
versions &gt;= 1.2.3 support the new longer limit by default. However, a lower
or user defined limit can be set via the <code class="docutils literal notranslate"><span class="pre">max_url_length</span></code> option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;max_url_length&#39;</span><span class="p">:</span> <span class="mi">255</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>nan_inf_to_errors</strong>: Enable the
<a class="reference internal" href="index.html#worksheet"><span class="std std-ref">worksheet.</span></a><a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> and <a class="reference internal" href="index.html#write_number" title="write_number"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_number()</span></code></a>
methods to convert <code class="docutils literal notranslate"><span class="pre">nan</span></code>, <code class="docutils literal notranslate"><span class="pre">inf</span></code> and <code class="docutils literal notranslate"><span class="pre">-inf</span></code> to Excel errors. Excel
doesn’t handle NAN/INF as numbers so as a workaround they are mapped to
formulas that yield the error codes <code class="docutils literal notranslate"><span class="pre">#NUM!</span></code> and <code class="docutils literal notranslate"><span class="pre">#DIV/0!</span></code>.  The default
is <code class="docutils literal notranslate"><span class="pre">False</span></code>. To enable this option use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;nan_inf_to_errors&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>default_date_format</strong>: This option is used to specify a default date
format string for use with the
<a class="reference internal" href="index.html#worksheet"><span class="std std-ref">worksheet.</span></a><a class="reference internal" href="index.html#write_datetime" title="write_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_datetime()</span></code></a> method when an
explicit format isn’t given. See <a class="reference internal" href="index.html#working-with-dates-and-time"><span class="std std-ref">Working with Dates and Time</span></a> for more
details:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;default_date_format&#39;</span><span class="p">:</span> <span class="s1">&#39;dd/mm/yy&#39;</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><strong>remove_timezone</strong>: Excel doesn’t support timezones in datetimes/times so
there isn’t any fail-safe way that XlsxWriter can map a Python timezone aware
datetime into an Excel datetime in functions such as
<a class="reference internal" href="index.html#write_datetime" title="write_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_datetime()</span></code></a>. As such the user should convert and remove the
timezones in some way that makes sense according to their
requirements. Alternatively the <code class="docutils literal notranslate"><span class="pre">remove_timezone</span></code> option can be used to
strip the timezone from datetime values. The default is <code class="docutils literal notranslate"><span class="pre">False</span></code>. To enable
this option use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;remove_timezone&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="index.html#timezone-handling"><span class="std std-ref">Timezone Handling in XlsxWriter</span></a>.</p>
</li>
<li><p class="first"><strong>date_1904</strong>: Excel for Windows uses a default epoch of 1900 and Excel for
Mac uses an epoch of 1904. However, Excel on either platform will convert
automatically between one system and the other. XlsxWriter stores dates in
the 1900 format by default. If you wish to change this you can use the
<code class="docutils literal notranslate"><span class="pre">date_1904</span></code> workbook option. This option is mainly for enhanced
compatibility with Excel and in general isn’t required very often:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;date_1904&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</li>
</ul>
<p>When specifying a filename it is recommended that you use an <code class="docutils literal notranslate"><span class="pre">.xlsx</span></code>
extension or Excel will generate a warning when opening the file.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Workbook()</span></code> method also works using the <code class="docutils literal notranslate"><span class="pre">with</span></code> context manager. In
which case it doesn’t need an explicit <cite>close()</cite> statement:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;hello_world.xlsx&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">workbook</span><span class="p">:</span>
    <span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello world&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>It is possible to write files to in-memory strings using BytesIO as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">io</span> <span class="k">import</span> <span class="n">BytesIO</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="n">xlsx_data</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
</pre></div>
</div>
<p>To avoid the use of any temporary files and keep the entire file in-memory use
the <code class="docutils literal notranslate"><span class="pre">in_memory</span></code> constructor option shown above.</p>
<p>See also <a class="reference internal" href="index.html#ex-http-server"><span class="std std-ref">Example: Simple HTTP Server (Python 2)</span></a> and <a class="reference internal" href="index.html#ex-http-server3"><span class="std std-ref">Example: Simple HTTP Server (Python 3)</span></a>.</p>
</div>
<div class="section" id="workbook-add-worksheet">
<h4>workbook.add_worksheet()</h4>
<dl class="function">
<dt id="add_worksheet">
<code class="descname">add_worksheet</code><span class="sig-paren">(</span><span class="optional">[</span><em>name</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Add a new worksheet to a workbook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> (<em>string</em>) – Optional worksheet name, defaults to Sheet1, etc.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first">A <a class="reference internal" href="index.html#worksheet"><span class="std std-ref">worksheet</span></a> object.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="index.html#DuplicateWorksheetName" title="DuplicateWorksheetName"><strong>DuplicateWorksheetName</strong></a> – if a duplicate worksheet name is used.</li>
<li><a class="reference internal" href="index.html#InvalidWorksheetName" title="InvalidWorksheetName"><strong>InvalidWorksheetName</strong></a> – if an invalid worksheet name is used.</li>
<li><strong>ReservedWorksheetName</strong> – if a reserved worksheet name is used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">add_worksheet()</span></code> method adds a new worksheet to a workbook.</p>
<p>At least one worksheet should be added to a new workbook. The
<a class="reference internal" href="index.html#worksheet"><span class="std std-ref">Worksheet</span></a> object is used to write data and configure a
worksheet in the workbook.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter is optional. If it is not specified, or blank, the
default Excel convention will be followed, i.e. Sheet1, Sheet2, etc.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>           <span class="c1"># Sheet1</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Foglio2&#39;</span><span class="p">)</span>  <span class="c1"># Foglio2</span>
<span class="n">worksheet3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>     <span class="c1"># Data</span>
<span class="n">worksheet4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>           <span class="c1"># Sheet4</span>
</pre></div>
</div>
<img alt="_images/workbook02.png" src="_images/workbook02.png" />
<p>The worksheet name must be a valid Excel worksheet name:</p>
<ul class="simple">
<li>It must be less than 32 characters. This error will raise a
<a class="reference internal" href="index.html#InvalidWorksheetName" title="InvalidWorksheetName"><code class="xref py py-exc docutils literal notranslate"><span class="pre">InvalidWorksheetName</span></code></a> exception.</li>
<li>It cannot contain any of the characters: <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span> <span class="pre">:</span> <span class="pre">*</span> <span class="pre">?</span> <span class="pre">/</span> <span class="pre">\</span></code>. This error will
raise a <a class="reference internal" href="index.html#InvalidWorksheetName" title="InvalidWorksheetName"><code class="xref py py-exc docutils literal notranslate"><span class="pre">InvalidWorksheetName</span></code></a> exception.</li>
<li>It cannot begin or end with an apostrophe. This error will raise a
<a class="reference internal" href="index.html#InvalidWorksheetName" title="InvalidWorksheetName"><code class="xref py py-exc docutils literal notranslate"><span class="pre">InvalidWorksheetName</span></code></a> exception.</li>
<li>You cannot use the same, case insensitive, <code class="docutils literal notranslate"><span class="pre">name</span></code> for more than one
worksheet. This error will raise a <a class="reference internal" href="index.html#DuplicateWorksheetName" title="DuplicateWorksheetName"><code class="xref py py-exc docutils literal notranslate"><span class="pre">DuplicateWorksheetName</span></code></a> exception.</li>
<li>You should not use the Excel reserved name “History”, or case insensitive
variants as this is restricted in English, and other, versions of Excel.</li>
</ul>
<p>The rules for worksheet names in Excel are explained in the Microsoft Office
documentation on how to <a class="reference external" href="https://support.office.com/en-ie/article/rename-a-worksheet-3f1f7148-ee83-404d-8ef0-9ff99fbad1f9">Rename a worksheet</a>.</p>
</div>
<div class="section" id="workbook-add-format">
<h4>workbook.add_format()</h4>
<dl class="function">
<dt id="add_format">
<code class="descname">add_format</code><span class="sig-paren">(</span><span class="optional">[</span><em>properties</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Create a new Format object to formats cells in worksheets.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>properties</strong> (<em>dictionary</em>) – An optional dictionary of format properties.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">A <a class="reference internal" href="index.html#format"><span class="std std-ref">format</span></a> object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">add_format()</span></code> method can be used to create new <a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>
objects which are used to apply formatting to a cell. You can either define
the properties at creation time via a dictionary of property values or later
via method calls:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">format1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">(</span><span class="n">props</span><span class="p">)</span>  <span class="c1"># Set properties at creation.</span>
<span class="n">format2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>       <span class="c1"># Set properties later.</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="index.html#format"><span class="std std-ref">The Format Class</span></a> section for more details about Format properties and how
to set them.</p>
</div>
<div class="section" id="workbook-add-chart">
<h4>workbook.add_chart()</h4>
<dl class="function">
<dt id="add_chart">
<code class="descname">add_chart</code><span class="sig-paren">(</span><em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Create a chart object that can be added to a worksheet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<em>dictionary</em>) – An dictionary of chart type options.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">A <a class="reference internal" href="index.html#chart-class"><span class="std std-ref">Chart</span></a> object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>This method is use to create a new chart object that can be inserted into a
worksheet via the <a class="reference internal" href="index.html#insert_chart" title="insert_chart"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_chart()</span></code></a> Worksheet method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The properties that can be set are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span>    <span class="p">(</span><span class="n">required</span><span class="p">)</span>
<span class="n">subtype</span> <span class="p">(</span><span class="n">optional</span><span class="p">)</span>
</pre></div>
</div>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">type</span></code></p>
<p>This is a required parameter. It defines the type of chart that will be
created:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The available types are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">area</span>
<span class="n">bar</span>
<span class="n">column</span>
<span class="n">doughnut</span>
<span class="n">line</span>
<span class="n">pie</span>
<span class="n">radar</span>
<span class="n">scatter</span>
<span class="n">stock</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">subtype</span></code></p>
<p>Used to define a chart subtype where available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;stacked&#39;</span><span class="p">})</span>
</pre></div>
</div>
</li>
</ul>
<p>See the <a class="reference internal" href="index.html#chart-class"><span class="std std-ref">The Chart Class</span></a> for a list of available chart subtypes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A chart can only be inserted into a worksheet once. If several similar
charts are required then each one must be created separately with
<code class="docutils literal notranslate"><span class="pre">add_chart()</span></code>.</p>
</div>
<p>See also <a class="reference internal" href="index.html#working-with-charts"><span class="std std-ref">Working with Charts</span></a> and <a class="reference internal" href="index.html#chart-examples"><span class="std std-ref">Chart Examples</span></a>.</p>
</div>
<div class="section" id="workbook-add-chartsheet">
<h4>workbook.add_chartsheet()</h4>
<dl class="function">
<dt id="add_chartsheet">
<code class="descname">add_chartsheet</code><span class="sig-paren">(</span><span class="optional">[</span><em>sheetname</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Add a new add_chartsheet to a workbook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>sheetname</strong> (<em>string</em>) – Optional chartsheet name, defaults to Chart1, etc.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">A <a class="reference internal" href="index.html#chartsheet"><span class="std std-ref">chartsheet</span></a> object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">add_chartsheet()</span></code> method adds a new chartsheet to a workbook.</p>
<img alt="_images/chartsheet.png" src="_images/chartsheet.png" />
<p>See <a class="reference internal" href="index.html#chartsheet"><span class="std std-ref">The Chartsheet Class</span></a> for details.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">sheetname</span></code> parameter is optional. If it is not specified the default
Excel convention will be followed, i.e. Chart1, Chart2, etc.</p>
<p>The chartsheet name must be a valid Excel worksheet name. See
<a class="reference internal" href="#add_worksheet" title="add_worksheet"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_worksheet()</span></code></a> for the limitation on Excel worksheet names.</p>
</div>
<div class="section" id="workbook-close">
<h4>workbook.close()</h4>
<dl class="function">
<dt id="close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Close the Workbook object and write the XLSX file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference internal" href="index.html#FileCreateError" title="FileCreateError"><strong>FileCreateError</strong></a> – if there is a file or permissions error during writing.</li>
<li><a class="reference internal" href="index.html#DuplicateTableName" title="DuplicateTableName"><strong>DuplicateTableName</strong></a> – if a duplicate worksheet table name was added.</li>
<li><a class="reference internal" href="index.html#EmptyChartSeries" title="EmptyChartSeries"><strong>EmptyChartSeries</strong></a> – if a chart is added without a data series.</li>
<li><a class="reference internal" href="index.html#UndefinedImageSize" title="UndefinedImageSize"><strong>UndefinedImageSize</strong></a> – if an image doesn’t contain height/width data.</li>
<li><a class="reference internal" href="index.html#UnsupportedImageFormat" title="UnsupportedImageFormat"><strong>UnsupportedImageFormat</strong></a> – if an image type isn’t supported.</li>
<li><a class="reference internal" href="index.html#FileSizeError" title="FileSizeError"><strong>FileSizeError</strong></a> – if the filesize would require ZIP64 extensions.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The workbook <code class="docutils literal notranslate"><span class="pre">close()</span></code> method writes all data to the xlsx file and closes
it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>This is a required method call to close and write the xlsxwriter file, unless
you are using the <code class="docutils literal notranslate"><span class="pre">with</span></code> context manager, see below.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Workbook</span></code> object also works using the <code class="docutils literal notranslate"><span class="pre">with</span></code> context manager. In
which case it doesn’t need an explicit <code class="docutils literal notranslate"><span class="pre">close()</span></code> statement:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">With</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;hello_world.xlsx&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">workbook</span><span class="p">:</span>
    <span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello world&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The workbook will close automatically when exiting the scope of the <code class="docutils literal notranslate"><span class="pre">with</span></code>
statement.</p>
<p>The most common exception during <code class="docutils literal notranslate"><span class="pre">close()</span></code> is <code class="docutils literal notranslate"><span class="pre">FileCreateError</span></code> which is
generally caused by a write permission error.  On Windows this usually occurs
if the file being created is already open in Excel. This exception can be
caught in a <code class="docutils literal notranslate"><span class="pre">try</span></code> block where you can instruct the user to close the open
file before overwriting it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">FileCreateError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># For Python 3 use input() instead of raw_input().</span>
        <span class="n">decision</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s2">&quot;Exception caught in workbook.close(): </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Please close the file if it is open in Excel.</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Try to write file again? [Y/n]: &quot;</span> <span class="o">%</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">decision</span> <span class="o">!=</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
            <span class="k">continue</span>

    <span class="k">break</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="index.html#ex-check-close"><span class="std std-ref">Example: Catch exception on closing</span></a>.</p>
</div>
<div class="section" id="workbook-set-size">
<h4>workbook.set_size()</h4>
<dl class="function">
<dt id="set_size">
<code class="descname">set_size</code><span class="sig-paren">(</span><em>width</em>, <em>height</em><span class="sig-paren">)</span></dt>
<dd><p>Set the size of a workbook window.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Width of the window in pixels.</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Height of the window in pixels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_size()</span></code> method can be used to set the size of a workbook window:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span><span class="o">.</span><span class="n">set_size</span><span class="p">(</span><span class="mi">1200</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>
</pre></div>
</div>
<p>The Excel window size was used in Excel 2007 to define the width and height of
a workbook window within the Multiple Document Interface (MDI). In later
versions of Excel for Windows this interface was dropped. This method is
currently only useful when setting the window size in Excel for Mac 2011. The
units are pixels and the default size is 1073 x 644.</p>
<p>Note, this doesn’t equate exactly to the Excel for Mac pixel size since it is
based on the original Excel 2007 for Windows sizing. Some trial and error may
be required to get an exact size.</p>
</div>
<div class="section" id="workbook-tab-ratio">
<h4>workbook.tab_ratio()</h4>
<dl class="function">
<dt id="set_tab_ratio">
<code class="descname">set_tab_ratio</code><span class="sig-paren">(</span><em>tab_ratio</em><span class="sig-paren">)</span></dt>
<dd><p>Set the ratio between the worksheet tabs and the horizontal slider.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tab_ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The tab ratio between 0 and 100.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_tab_ratio()</span></code> method can be used to set the ratio between worksheet
tabs and the horizontal slider at the bottom of a workbook. This can be
increased to give more room to the tabs or reduced to increase the size of the
horizontal slider:</p>
<img alt="_images/tab_ratio.png" src="_images/tab_ratio.png" />
<p>The default value in Excel is 60. It can be changed as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span><span class="o">.</span><span class="n">set_tab_ratio</span><span class="p">(</span><span class="mi">75</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="workbook-set-properties">
<h4>workbook.set_properties()</h4>
<dl class="function">
<dt id="set_properties">
<code class="descname">set_properties</code><span class="sig-paren">(</span><em>properties</em><span class="sig-paren">)</span></dt>
<dd><p>Set the document properties such as Title, Author etc.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>properties</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Dictionary of document properties.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_properties()</span></code> method can be used to set the document properties of the
Excel file created by <code class="docutils literal notranslate"><span class="pre">XlsxWriter</span></code>. These properties are visible when you
use the <code class="docutils literal notranslate"><span class="pre">Office</span> <span class="pre">Button</span> <span class="pre">-&gt;</span> <span class="pre">Prepare</span> <span class="pre">-&gt;</span> <span class="pre">Properties</span></code> option in Excel and are
also available to external applications that read or index windows files.</p>
<p>The properties that can be set are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">title</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">subject</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">author</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">manager</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">company</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">category</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">keywords</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">comments</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">status</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">hyperlink_base</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">create</span></code> - the file creation date as a <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.date" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.date</span></code></a> object.</li>
</ul>
<p>The properties are all optional and should be passed in dictionary format as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span><span class="o">.</span><span class="n">set_properties</span><span class="p">({</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span>    <span class="s1">&#39;This is an example spreadsheet&#39;</span><span class="p">,</span>
    <span class="s1">&#39;subject&#39;</span><span class="p">:</span>  <span class="s1">&#39;With document properties&#39;</span><span class="p">,</span>
    <span class="s1">&#39;author&#39;</span><span class="p">:</span>   <span class="s1">&#39;John McNamara&#39;</span><span class="p">,</span>
    <span class="s1">&#39;manager&#39;</span><span class="p">:</span>  <span class="s1">&#39;Dr. Heinz Doofenshmirtz&#39;</span><span class="p">,</span>
    <span class="s1">&#39;company&#39;</span><span class="p">:</span>  <span class="s1">&#39;of Wolves&#39;</span><span class="p">,</span>
    <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="s1">&#39;Example spreadsheets&#39;</span><span class="p">,</span>
    <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample, Example, Properties&#39;</span><span class="p">,</span>
    <span class="s1">&#39;created&#39;</span><span class="p">:</span>  <span class="n">datetime</span><span class="o">.</span><span class="n">date</span><span class="p">(</span><span class="mi">2018</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;Created with Python and XlsxWriter&#39;</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/doc_properties.png" src="_images/doc_properties.png" />
<p>See also <a class="reference internal" href="index.html#ex-doc-properties"><span class="std std-ref">Example: Setting Document Properties</span></a>.</p>
</div>
<div class="section" id="workbook-set-custom-property">
<h4>workbook.set_custom_property()</h4>
<dl class="function">
<dt id="set_custom_property">
<code class="descname">set_custom_property</code><span class="sig-paren">(</span><em>name</em>, <em>value</em><span class="optional">[</span>, <em>property_type</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Set a custom document property.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>string</em>) – The name of the custom property.</li>
<li><strong>value</strong> – The value of the custom property (various types).</li>
<li><strong>property_type</strong> (<em>string</em>) – The type of the property. Optional.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_custom_property()</span></code> method can be used to set one or more custom
document properties not covered by the standard properties in the
<code class="docutils literal notranslate"><span class="pre">set_properties()</span></code> method above.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;2016-12-12&#39;</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">set_custom_property</span><span class="p">(</span><span class="s1">&#39;Checked by&#39;</span><span class="p">,</span>       <span class="s1">&#39;Eve&#39;</span><span class="p">)</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">set_custom_property</span><span class="p">(</span><span class="s1">&#39;Date completed&#39;</span><span class="p">,</span>   <span class="n">date</span><span class="p">)</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">set_custom_property</span><span class="p">(</span><span class="s1">&#39;Document number&#39;</span><span class="p">,</span>  <span class="mi">12345</span><span class="p">)</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">set_custom_property</span><span class="p">(</span><span class="s1">&#39;Reference number&#39;</span><span class="p">,</span> <span class="mf">1.2345</span><span class="p">)</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">set_custom_property</span><span class="p">(</span><span class="s1">&#39;Has review&#39;</span><span class="p">,</span>       <span class="kc">True</span><span class="p">)</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">set_custom_property</span><span class="p">(</span><span class="s1">&#39;Signed off&#39;</span><span class="p">,</span>       <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/custom_properties.png" src="_images/custom_properties.png" />
<p>Date parameters should be <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a> objects.</p>
<p>The optional <code class="docutils literal notranslate"><span class="pre">property_type</span></code> parameter can be used to set an explicit type
for the custom property, just like in Excel. The available types are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">text</span>
<span class="n">date</span>
<span class="n">number</span>
<span class="nb">bool</span>
</pre></div>
</div>
<p>However, in almost all cases the type will be inferred correctly from the
Python type, like in the example above.</p>
<p>Note: the <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code> parameters are limited to 255 characters by
Excel.</p>
</div>
<div class="section" id="workbook-define-name">
<h4>workbook.define_name()</h4>
<dl class="function">
<dt id="define_name">
<code class="descname">define_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Create a defined name in the workbook to use as a variable.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>name</strong> (<em>string</em>) – The defined name.</li>
<li><strong>formula</strong> (<em>string</em>) – The cell or range that the defined name refers to.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>This method is used to defined a name that can be used to represent a value, a
single cell or a range of cells in a workbook. These are sometimes referred to
as a “Named Range”.</p>
<p>Defined names are generally used to simplify or clarify formulas by using
descriptive variable names:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span><span class="o">.</span><span class="n">define_name</span><span class="p">(</span><span class="s1">&#39;Exchange_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;=0.96&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;=B2*Exchange_rate&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/defined_name.png" src="_images/defined_name.png" />
<p>As in Excel a name defined like this is “global” to the workbook and can be
referred to from any worksheet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Global workbook name.</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">define_name</span><span class="p">(</span><span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;=Sheet1!$G$1:$H$10&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>It is also possible to define a local/worksheet name by prefixing it with the
sheet name using the syntax <code class="docutils literal notranslate"><span class="pre">'sheetname!definedname'</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Local worksheet name.</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">define_name</span><span class="p">(</span><span class="s1">&#39;Sheet2!Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;=Sheet2!$G$1:$G$10&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If the sheet name contains spaces or special characters you must follow the
Excel convention and enclose it in single quotes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span><span class="o">.</span><span class="n">define_name</span><span class="p">(</span><span class="s2">&quot;&#39;New Data&#39;!Sales&quot;</span><span class="p">,</span> <span class="s1">&#39;=Sheet2!$G$1:$G$10&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The rules for names in Excel are explained in the Microsoft Office
documentation on how to <a class="reference external" href="http://office.microsoft.com/en-001/excel-help/define-and-use-names-in-formulas-HA010147120.aspx">Define and use names in formulas</a>.</p>
<p>See also <a class="reference internal" href="index.html#ex-defined-name"><span class="std std-ref">Example: Defined names/Named ranges</span></a>.</p>
</div>
<div class="section" id="workbook-add-vba-project">
<h4>workbook.add_vba_project()</h4>
<dl class="function">
<dt id="add_vba_project">
<code class="descname">add_vba_project</code><span class="sig-paren">(</span><em>vba_project</em><span class="optional">[</span>, <em>is_stream</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Add a vbaProject binary to the Excel workbook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>vba_project</strong> – The vbaProject binary file name.</li>
<li><strong>is_stream</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – The vba_project is an in memory byte stream.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">add_vba_project()</span></code> method can be used to add macros or functions to a
workbook using a binary VBA project file that has been extracted from an
existing Excel xlsm file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span><span class="o">.</span><span class="n">add_vba_project</span><span class="p">(</span><span class="s1">&#39;./vbaProject.bin&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Only one <code class="docutils literal notranslate"><span class="pre">vbaProject.bin</span></code> file can be added per workbook.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">is_stream</span></code> parameter is used to indicate that <code class="docutils literal notranslate"><span class="pre">vba_project</span></code> refers to
a BytesIO byte stream rather than a physical file. This can be used when
working with the workbook <code class="docutils literal notranslate"><span class="pre">in_memory</span></code> mode.</p>
<p>See <a class="reference internal" href="index.html#macros"><span class="std std-ref">Working with VBA Macros</span></a> for more details.</p>
</div>
<div class="section" id="workbook-set-vba-name">
<h4>workbook.set_vba_name()</h4>
<dl class="function">
<dt id="set_vba_name">
<code class="descname">set_vba_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span></dt>
<dd><p>Set the VBA name for the workbook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>string</em>) – The VBA name for the workbook.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_vba_name()</span></code> method can be used to set the VBA codename for the
workbook. This is sometimes required when a vbaProject macro included via
<code class="docutils literal notranslate"><span class="pre">add_vba_project()</span></code> refers to the workbook. The default Excel VBA name of
<code class="docutils literal notranslate"><span class="pre">ThisWorkbook</span></code> is used if a user defined name isn’t specified.</p>
<p>See <a class="reference internal" href="index.html#macros"><span class="std std-ref">Working with VBA Macros</span></a> for more details.</p>
</div>
<div class="section" id="workbook-worksheets">
<h4>workbook.worksheets()</h4>
<dl class="function">
<dt id="worksheets">
<code class="descname">worksheets</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Return a list of the worksheet objects in the workbook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">A list of <a class="reference internal" href="index.html#worksheet"><span class="std std-ref">worksheet</span></a> objects.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">worksheets()</span></code> method returns a list of the worksheets in a workbook.
This is useful if you want to repeat an operation on each worksheet in a
workbook:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">worksheet</span> <span class="ow">in</span> <span class="n">workbook</span><span class="o">.</span><span class="n">worksheets</span><span class="p">():</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="workbook-get-worksheet-by-name">
<h4>workbook.get_worksheet_by_name()</h4>
<dl class="function">
<dt id="get_worksheet_by_name">
<code class="descname">get_worksheet_by_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span></dt>
<dd><p>Return a worksheet object in the workbook using the sheetname.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>string</em>) – Name of worksheet that you wish to retrieve.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">A <a class="reference internal" href="index.html#worksheet"><span class="std std-ref">worksheet</span></a> object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">get_worksheet_by_name()</span></code> method returns the worksheet or chartsheet
object with the the given <code class="docutils literal notranslate"><span class="pre">name</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code> if it isn’t found:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">get_worksheet_by_name</span><span class="p">(</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="workbook-get-default-url-format">
<h4>workbook.get_default_url_format()</h4>
<dl class="function">
<dt id="get_default_url_format">
<code class="descname">get_default_url_format</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Return a format object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">A <a class="reference internal" href="index.html#format"><span class="std std-ref">format</span></a> object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">get_default_url_format()</span></code> method gets a copy of the default url format
used when a user defined format isn’t specified with <a class="reference internal" href="index.html#write_url" title="write_url"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_url()</span></code></a>. The
format is the hyperlink style defined by Excel for the default theme:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">url_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">get_default_url_format</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="workbook-set-calc-mode">
<h4>workbook.set_calc_mode()</h4>
<dl class="function">
<dt id="set_calc_mode">
<code class="descname">set_calc_mode</code><span class="sig-paren">(</span><em>mode</em><span class="sig-paren">)</span></dt>
<dd><p>Set the Excel calculation mode for the workbook.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mode</strong> (<em>string</em>) – The calculation mode string</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Set the calculation mode for formulas in the workbook. This is mainly of use
for workbooks with slow formulas where you want to allow the user to calculate
them manually.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">mode</span></code> parameter can be:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">auto</span></code>: The default. Excel will re-calculate formulas when a formula or a
value affecting the formula changes.</li>
<li><code class="docutils literal notranslate"><span class="pre">manual</span></code>: Only re-calculate formulas when the user requires it. Generally
by pressing F9.</li>
<li><code class="docutils literal notranslate"><span class="pre">auto_except_tables</span></code>: Excel will automatically re-calculate formulas
except for tables.</li>
</ul>
</div>
<div class="section" id="workbook-use-zip64">
<h4>workbook.use_zip64()</h4>
<dl class="function">
<dt id="use_zip64">
<code class="descname">use_zip64</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Allow ZIP64 extensions when writing the xlsx file zip container.</p>
</dd></dl>

<p>Use ZIP64 extensions when writing the xlsx file zip container to allow files
greater than 4 GB.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When using the <code class="docutils literal notranslate"><span class="pre">use_zip64()</span></code> option the zip file created by the Python
standard library <code class="docutils literal notranslate"><span class="pre">zipfile.py</span></code> may cause Excel to issue a warning about
repairing the file. This warning is annoying but harmless. The “repaired”
file will contain all of the data written by XlsxWriter, only the zip
container will be changed.</p>
</div>
</div>
</div>
<span id="document-worksheet"></span><div class="section" id="the-worksheet-class">
<span id="worksheet"></span><h3>The Worksheet Class</h3>
<p>The worksheet class represents an Excel worksheet. It handles operations such
as writing data to cells or formatting worksheet layout.</p>
<p>A worksheet object isn’t instantiated directly. Instead a new worksheet is
created by calling the <a class="reference internal" href="index.html#add_worksheet" title="add_worksheet"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_worksheet()</span></code></a> method from a <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a>
object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span>   <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;filename.xlsx&#39;</span><span class="p">)</span>

<span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/worksheet00.png" src="_images/worksheet00.png" />
<p>XlsxWriter supports Excels worksheet limits of 1,048,576 rows by 16,384
columns.</p>
<div class="section" id="worksheet-write">
<h4>worksheet.write()</h4>
<dl class="function">
<dt id="write">
<code class="descname">write</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>*args</em><span class="sig-paren">)</span></dt>
<dd><p>Write generic data to a worksheet cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> – The cell row (zero indexed).</li>
<li><strong>col</strong> – The cell column (zero indexed).</li>
<li><strong>*args</strong> – The additional args that are passed to the sub methods
such as number, string and cell_format.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Other values from the called write methods.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Excel makes a distinction between data types such as strings, numbers, blanks,
formulas and hyperlinks. To simplify the process of writing data to an
XlsxWriter file the <code class="docutils literal notranslate"><span class="pre">write()</span></code> method acts as a general alias for several
more specific methods:</p>
<ul class="simple">
<li><a class="reference internal" href="#write_string" title="write_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_string()</span></code></a></li>
<li><a class="reference internal" href="#write_number" title="write_number"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_number()</span></code></a></li>
<li><a class="reference internal" href="#write_blank" title="write_blank"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_blank()</span></code></a></li>
<li><a class="reference internal" href="#write_formula" title="write_formula"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_formula()</span></code></a></li>
<li><a class="reference internal" href="#write_datetime" title="write_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_datetime()</span></code></a></li>
<li><a class="reference internal" href="#write_boolean" title="write_boolean"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_boolean()</span></code></a></li>
<li><a class="reference internal" href="#write_url" title="write_url"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_url()</span></code></a></li>
</ul>
<p>The rules for handling data in <code class="docutils literal notranslate"><span class="pre">write()</span></code> are as follows:</p>
<ul class="simple">
<li>Data types <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">long</span></code>, <a class="reference external" href="https://docs.python.org/3/library/decimal.html#decimal.Decimal" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">decimal.Decimal</span></code></a> and
<a class="reference external" href="https://docs.python.org/3/library/fractions.html#fractions.Fraction" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">fractions.Fraction</span></code></a>  are written using <a class="reference internal" href="#write_number" title="write_number"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_number()</span></code></a>.</li>
<li>Data types <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.date" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.date</span></code></a>
<a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.time" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.time</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.timedelta</span></code></a> are written using
<a class="reference internal" href="#write_datetime" title="write_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_datetime()</span></code></a> .</li>
<li><code class="docutils literal notranslate"><span class="pre">None</span></code> and empty strings <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> are written using <a class="reference internal" href="#write_blank" title="write_blank"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_blank()</span></code></a>.</li>
<li>Data type <code class="docutils literal notranslate"><span class="pre">bool</span></code> is written using <a class="reference internal" href="#write_boolean" title="write_boolean"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_boolean()</span></code></a>.</li>
</ul>
<p>Strings are then handled as follows:</p>
<ul class="simple">
<li>Strings that start with <code class="docutils literal notranslate"><span class="pre">&quot;=&quot;</span></code> are take to match a formula and are written
using <a class="reference internal" href="#write_formula" title="write_formula"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_formula()</span></code></a>. This can be overridden, see below.</li>
<li>Strings that match supported URL types are written using
<a class="reference internal" href="#write_url" title="write_url"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_url()</span></code></a>. This can be overridden, see below.</li>
<li>When the <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> constructor <code class="docutils literal notranslate"><span class="pre">strings_to_numbers</span></code> option is
<code class="docutils literal notranslate"><span class="pre">True</span></code> strings that convert to numbers using <code class="xref py py-func docutils literal notranslate"><span class="pre">float()</span></code> are written
using <a class="reference internal" href="#write_number" title="write_number"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_number()</span></code></a> in order to avoid Excel warnings about “Numbers
Stored as Text”. See the note below.</li>
<li>Strings that don’t match any of the above criteria are written using
<a class="reference internal" href="#write_string" title="write_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_string()</span></code></a>.</li>
</ul>
<p>If none of the above types are matched the value is evaluated with <code class="docutils literal notranslate"><span class="pre">float()</span></code>
to see if it corresponds to a user defined float type. If it does then it is
written using <a class="reference internal" href="#write_number" title="write_number"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_number()</span></code></a>.</p>
<p>Finally, if none of these rules are matched then a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code> exception is
raised. However, it is also possible to handle additional, user defined, data
types using the <a class="reference internal" href="#add_write_handler" title="add_write_handler"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_write_handler()</span></code></a> method explained below and in
<a class="reference internal" href="index.html#writing-user-types"><span class="std std-ref">Writing user defined types</span></a>.</p>
<p>Here are some examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>          <span class="c1"># write_string()</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;World&#39;</span><span class="p">)</span>          <span class="c1"># write_string()</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>                <span class="c1"># write_number()</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">3.00001</span><span class="p">)</span>          <span class="c1"># write_number()</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;=SIN(PI()/4)&#39;</span><span class="p">)</span>   <span class="c1"># write_formula()</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>               <span class="c1"># write_blank()</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>             <span class="c1"># write_blank()</span>
</pre></div>
</div>
<p>This creates a worksheet like the following:</p>
<img alt="_images/worksheet01.png" src="_images/worksheet01.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> constructor option takes three optional arguments
that can be used to override string handling in the <code class="docutils literal notranslate"><span class="pre">write()</span></code> function.
These options are shown below with their default values:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;strings_to_numbers&#39;</span><span class="p">:</span>  <span class="kc">False</span><span class="p">,</span>
                               <span class="s1">&#39;strings_to_formulas&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                               <span class="s1">&#39;strings_to_urls&#39;</span><span class="p">:</span>     <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">write()</span></code> method supports two forms of notation to designate the position
of cells: <strong>Row-column</strong> notation and <strong>A1</strong> notation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># These are equivalent.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">cell_format</span></code> parameter in the sub <code class="docutils literal notranslate"><span class="pre">write</span></code> methods is used to apply
formatting to the cell. This parameter is optional but when present it should
be a valid <a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;italic&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>  <span class="c1"># Cell is bold and italic.</span>
</pre></div>
</div>
</div>
<div class="section" id="worksheet-add-write-handler">
<h4>worksheet.add_write_handler()</h4>
<dl class="function">
<dt id="add_write_handler">
<code class="descname">add_write_handler</code><span class="sig-paren">(</span><em>user_type</em>, <em>user_function</em><span class="sig-paren">)</span></dt>
<dd><p>Add a callback function to the <code class="docutils literal notranslate"><span class="pre">write()</span></code> method to handle user define
types.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>user_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.8)"><em>type</em></a>) – The user <code class="docutils literal notranslate"><span class="pre">type()</span></code> to match on.</li>
<li><strong>user_function</strong> (<em>types.FunctionType</em>) – The user defined function to write the type data.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>As explained above, the <a class="reference internal" href="#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method maps basic Python types to
corresponding Excel types. If you want to write an unsupported type then you
can either avoid <code class="docutils literal notranslate"><span class="pre">write()</span></code> and map the user type in your code to one of the
more specific write methods or you can extend it using the
<code class="docutils literal notranslate"><span class="pre">add_write_handler()</span></code> method.</p>
<p>For example, say you wanted to automatically write <a class="reference external" href="https://docs.python.org/3/library/uuid.html#module-uuid" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">uuid</span></code></a> values as
strings using <code class="docutils literal notranslate"><span class="pre">write()</span></code> you would start by creating a function that takes the
uuid, converts it to a string and then writes it using <a class="reference internal" href="#write_string" title="write_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_string()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">write_uuid</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">string_uuid</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">string_uuid</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>
</pre></div>
</div>
<p>You could then add a handler that matches the <code class="docutils literal notranslate"><span class="pre">uuid</span></code> type and calls your
user defined function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#                           match,     action()</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_write_handler</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="n">write_uuid</span><span class="p">)</span>
</pre></div>
</div>
<p>Then you can use <code class="docutils literal notranslate"><span class="pre">write()</span></code> without further modification:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_uuid</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid3</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">NAMESPACE_DNS</span><span class="p">,</span> <span class="s1">&#39;python.org&#39;</span><span class="p">)</span>

<span class="c1"># Write the UUID. This would raise a TypeError without the handler.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">my_uuid</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/user_types4.png" src="_images/user_types4.png" />
<p>Multiple callback functions can be added using <code class="docutils literal notranslate"><span class="pre">add_write_handler()</span></code> but
only one callback action is allowed per type. However, it is valid to use the
same callback function for different types:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_write_handler</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span>   <span class="n">test_number_range</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_write_handler</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">test_number_range</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#writing-user-types"><span class="std std-ref">Writing user defined types</span></a> for more details on how this feature works and
how to write callback functions, and also the following examples:</p>
<ul class="simple">
<li><a class="reference internal" href="index.html#ex-user-type1"><span class="std std-ref">Example: Writing User Defined Types (1)</span></a></li>
<li><a class="reference internal" href="index.html#ex-user-type2"><span class="std std-ref">Example: Writing User Defined Types (2)</span></a></li>
<li><a class="reference internal" href="index.html#ex-user-type3"><span class="std std-ref">Example: Writing User Defined types (3)</span></a></li>
</ul>
</div>
<div class="section" id="worksheet-write-string">
<h4>worksheet.write_string()</h4>
<dl class="function">
<dt id="write_string">
<code class="descname">write_string</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>string</em><span class="optional">[</span>, <em>cell_format</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Write a string to a worksheet cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>string</strong> (<em>string</em>) – String to write to cell.</li>
<li><strong>cell_format</strong> (<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>) – Optional Format object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-2: String truncated to 32k characters.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">write_string()</span></code> method writes a string to the cell specified by <code class="docutils literal notranslate"><span class="pre">row</span></code>
and <code class="docutils literal notranslate"><span class="pre">column</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Your text here&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;or here&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Both row-column and A1 style notation are supported, as shown above. See
<a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">cell_format</span></code> parameter is used to apply formatting to the cell. This
parameter is optional but when present is should be a valid
<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a> object.</p>
<p>Unicode strings are supported in UTF-8 encoding. This generally requires that
your source file in also UTF-8 encoded:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># _*_ coding: utf-8</span>
<span class="c1"># Python 2 example.</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;Some UTF-8 text&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/worksheet02.png" src="_images/worksheet02.png" />
<p>See <a class="reference internal" href="index.html#ex-unicode-python2"><span class="std std-ref">Example: Simple Unicode with Python 2</span></a> and <a class="reference internal" href="index.html#ex-unicode-python3"><span class="std std-ref">Example: Simple Unicode with Python 3</span></a> for more complete
examples.</p>
<p>Alternatively, you can read data from an encoded file, convert it to UTF-8
during reading and then write the data to an Excel file. See
<a class="reference internal" href="index.html#ex-unicode-polish-utf8"><span class="std std-ref">Example: Unicode - Polish in UTF-8</span></a> and <a class="reference internal" href="index.html#ex-unicode-shift-jis"><span class="std std-ref">Example: Unicode - Shift JIS</span></a>.</p>
<p>The maximum string size supported by Excel is 32,767 characters. Strings longer
than this will be truncated by <code class="docutils literal notranslate"><span class="pre">write_string()</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Even though Excel allows strings of 32,767 characters it can only
<strong>display</strong> 1000 in a cell. However, all 32,767 characters are displayed in the
formula bar.</p>
</div>
</div>
<div class="section" id="worksheet-write-number">
<h4>worksheet.write_number()</h4>
<dl class="function">
<dt id="write_number">
<code class="descname">write_number</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>number</em><span class="optional">[</span>, <em>cell_format</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Write a number to a worksheet cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>number</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Number to write to cell.</li>
<li><strong>cell_format</strong> (<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>) – Optional Format object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">write_number()</span></code> method writes numeric types to the cell specified by
<code class="docutils literal notranslate"><span class="pre">row</span></code> and <code class="docutils literal notranslate"><span class="pre">column</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_number</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">123456</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_number</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="mf">2.3451</span><span class="p">)</span>
</pre></div>
</div>
<p>Both row-column and A1 style notation are supported, as shown above. See
<a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>The numeric types supported are <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">long</span></code>,
<a class="reference external" href="https://docs.python.org/3/library/decimal.html#decimal.Decimal" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">decimal.Decimal</span></code></a> and <a class="reference external" href="https://docs.python.org/3/library/fractions.html#fractions.Fraction" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">fractions.Fraction</span></code></a> or anything that can
be converted via <code class="docutils literal notranslate"><span class="pre">float()</span></code>.</p>
<p>When written to an Excel file numbers are converted to IEEE-754 64-bit
double-precision floating point. This means that, in most cases, the maximum
number of digits that can be stored in Excel without losing precision is 15.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">NAN and INF are not supported and will raise a TypeError exception.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">cell_format</span></code> parameter is used to apply formatting to the cell. This
parameter is optional but when present is should be a valid
<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a> object.</p>
</div>
<div class="section" id="worksheet-write-formula">
<h4>worksheet.write_formula()</h4>
<dl class="function">
<dt id="write_formula">
<code class="descname">write_formula</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>formula</em><span class="optional">[</span>, <em>cell_format</em><span class="optional">[</span>, <em>value</em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Write a formula to a worksheet cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>formula</strong> (<em>string</em>) – Formula to write to cell.</li>
<li><strong>cell_format</strong> (<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>) – Optional Format object.</li>
<li><strong>value</strong> – Optional result. The value if the formula was calculated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">write_formula()</span></code> method writes a formula or function to the cell
specified by <code class="docutils literal notranslate"><span class="pre">row</span></code> and <code class="docutils literal notranslate"><span class="pre">column</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;=B3 + B4&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;=SIN(PI()/4)&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;=SUM(B1:B5)&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="s1">&#39;=IF(A3&gt;1,&quot;Yes&quot;, &quot;No&quot;)&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="s1">&#39;=AVERAGE(1, 2, 3, 4)&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A6&#39;</span><span class="p">,</span> <span class="s1">&#39;=DATEVALUE(&quot;1-Jan-2013&quot;)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Both row-column and A1 style notation are supported, as shown above. See
<a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>Array formulas are also supported:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="s1">&#39;{=SUM(A1:B1*A2:B2)}&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See also the <code class="docutils literal notranslate"><span class="pre">write_array_formula()</span></code> method below.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">cell_format</span></code> parameter is used to apply formatting to the cell. This
parameter is optional but when present is should be a valid
<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a> object.</p>
<p>If required, it is also possible to specify the calculated result of the
formula using the optional <code class="docutils literal notranslate"><span class="pre">value</span></code> parameter. This is occasionally
necessary when working with non-Excel applications that don’t calculate the
result of the formula:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;=2+2&#39;</span><span class="p">,</span> <span class="n">num_format</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#formula-result"><span class="std std-ref">Formula Results</span></a> for more details.</p>
<p>Excel stores formulas in US style formatting regardless of the Locale or
Language of the Excel version:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUM(1, 2, 3)&#39;</span><span class="p">)</span>    <span class="c1"># OK</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;=SOMME(1, 2, 3)&#39;</span><span class="p">)</span>  <span class="c1"># French. Error on load.</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#formula-syntax"><span class="std std-ref">Non US Excel functions and syntax</span></a> for a full explanation.</p>
<p>Excel 2010 and 2013 added functions which weren’t defined in the original file
specification. These functions are referred to as <em>future</em> functions. Examples
of these functions are <code class="docutils literal notranslate"><span class="pre">ACOT</span></code>, <code class="docutils literal notranslate"><span class="pre">CHISQ.DIST.RT</span></code> , <code class="docutils literal notranslate"><span class="pre">CONFIDENCE.NORM</span></code>,
<code class="docutils literal notranslate"><span class="pre">STDEV.P</span></code>, <code class="docutils literal notranslate"><span class="pre">STDEV.S</span></code> and <code class="docutils literal notranslate"><span class="pre">WORKDAY.INTL</span></code>. In XlsxWriter these require a
prefix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;=_xlfn.STDEV.S(B1:B10)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#formula-future"><span class="std std-ref">Formulas added in Excel 2010 and later</span></a> for a detailed explanation and full list of
functions that are affected.</p>
</div>
<div class="section" id="worksheet-write-array-formula">
<h4>worksheet.write_array_formula()</h4>
<dl class="function">
<dt id="write_array_formula">
<code class="descname">write_array_formula</code><span class="sig-paren">(</span><em>first_row</em>, <em>first_col</em>, <em>last_row</em>, <em>last_col</em>, <em>formula</em><span class="optional">[</span>, <em>cell_format</em><span class="optional">[</span>, <em>value</em><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Write an array formula to a worksheet cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>first_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first row of the range. (All zero indexed.)</li>
<li><strong>first_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first column of the range.</li>
<li><strong>last_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last row of the range.</li>
<li><strong>last_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last col of the range.</li>
<li><strong>formula</strong> (<em>string</em>) – Array formula to write to cell.</li>
<li><strong>cell_format</strong> (<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>) – Optional Format object.</li>
<li><strong>value</strong> – Optional result. The value if the formula was calculated.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">write_array_formula()</span></code> method writes an array formula to a cell range. In
Excel an array formula is a formula that performs a calculation on a set of
values. It can return a single value or a range of values.</p>
<p>An array formula is indicated by a pair of braces around the formula:
<code class="docutils literal notranslate"><span class="pre">{=SUM(A1:B1*A2:B2)}</span></code>.</p>
<p>For array formulas that return a range of values you must specify the range
that the return values will be written to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_array_formula</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;{=TREND(C1:C3,B1:B3)}&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_array_formula</span><span class="p">(</span><span class="s1">&#39;A1:A3&#39;</span><span class="p">,</span>    <span class="s1">&#39;{=TREND(C1:C3,B1:B3)}&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Both row-column and A1 style notation are supported, as shown above. See
<a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>If the array formula returns a single value then the <code class="docutils literal notranslate"><span class="pre">first_</span></code> and <code class="docutils literal notranslate"><span class="pre">last_</span></code>
parameters should be the same:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_array_formula</span><span class="p">(</span><span class="s1">&#39;A1:A1&#39;</span><span class="p">,</span> <span class="s1">&#39;{=SUM(B1:C1*B2:C2)}&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>It this case however it is easier to just use the <code class="docutils literal notranslate"><span class="pre">write_formula()</span></code> or
<code class="docutils literal notranslate"><span class="pre">write()</span></code> methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Same as above but more concise.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;{=SUM(B1:C1*B2:C2)}&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;{=SUM(B1:C1*B2:C2)}&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">cell_format</span></code> parameter is used to apply formatting to the cell. This
parameter is optional but when present is should be a valid
<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a> object.</p>
<p>If required, it is also possible to specify the calculated result of the
formula (see discussion of formulas and the <code class="docutils literal notranslate"><span class="pre">value</span></code> parameter for the
<code class="docutils literal notranslate"><span class="pre">write_formula()</span></code> method above). However, using this parameter only writes a
single value to the upper left cell in the result array. See
<a class="reference internal" href="index.html#formula-result"><span class="std std-ref">Formula Results</span></a> for more details.</p>
<p>See also <a class="reference internal" href="index.html#ex-array-formula"><span class="std std-ref">Example: Array formulas</span></a>.</p>
</div>
<div class="section" id="worksheet-write-blank">
<h4>worksheet.write_blank()</h4>
<dl class="function">
<dt id="write_blank">
<code class="descname">write_blank</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>blank</em><span class="optional">[</span>, <em>cell_format</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Write a blank worksheet cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>blank</strong> – None or empty string. The value is ignored.</li>
<li><strong>cell_format</strong> (<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>) – Optional Format object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Write a blank cell specified by <code class="docutils literal notranslate"><span class="pre">row</span></code> and <code class="docutils literal notranslate"><span class="pre">column</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_blank</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_blank</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
</pre></div>
</div>
<p>Both row-column and A1 style notation are supported, as shown above. See
<a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>This method is used to add formatting to a cell which doesn’t contain a string
or number value.</p>
<p>Excel differentiates between an “Empty” cell and a “Blank” cell. An “Empty”
cell is a cell which doesn’t contain data or formatting whilst a “Blank” cell
doesn’t contain data but does contain formatting. Excel stores “Blank” cells
but ignores “Empty” cells.</p>
<p>As such, if you write an empty cell without formatting it is ignored:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>  <span class="c1"># write_blank()</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>               <span class="c1"># Ignored</span>
</pre></div>
</div>
<p>This seemingly uninteresting fact means that you can write arrays of data
without special treatment for <code class="docutils literal notranslate"><span class="pre">None</span></code> or empty string values.</p>
</div>
<div class="section" id="worksheet-write-boolean">
<h4>worksheet.write_boolean()</h4>
<dl class="function">
<dt id="write_boolean">
<code class="descname">write_boolean</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>boolean</em><span class="optional">[</span>, <em>cell_format</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Write a boolean value to a worksheet cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>boolean</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Boolean value to write to cell.</li>
<li><strong>cell_format</strong> (<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>) – Optional Format object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">write_boolean()</span></code> method writes a boolean value to the cell specified by
<code class="docutils literal notranslate"><span class="pre">row</span></code> and <code class="docutils literal notranslate"><span class="pre">column</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_boolean</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_boolean</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Both row-column and A1 style notation are supported, as shown above. See
<a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">cell_format</span></code> parameter is used to apply formatting to the cell. This
parameter is optional but when present is should be a valid
<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a> object.</p>
</div>
<div class="section" id="worksheet-write-datetime">
<h4>worksheet.write_datetime()</h4>
<dl class="function">
<dt id="write_datetime">
<code class="descname">write_datetime</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>datetime</em><span class="optional">[</span>, <em>cell_format</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Write a date or time to a worksheet cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>datetime</strong> (<a class="reference external" href="https://docs.python.org/3/library/datetime.html#module-datetime" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">datetime</span></code></a>) – A datetime.datetime, .date, .time or .delta object.</li>
<li><strong>cell_format</strong> (<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>) – Optional Format object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">write_datetime()</span></code> method can be used to write a date or time to the cell
specified by <code class="docutils literal notranslate"><span class="pre">row</span></code> and <code class="docutils literal notranslate"><span class="pre">column</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_datetime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date_format</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_datetime</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date_format</span><span class="p">)</span>
</pre></div>
</div>
<p>Both row-column and A1 style notation are supported, as shown above. See
<a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>The datetime should be a <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.date" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.date</span></code></a>
<a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.time" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.time</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.timedelta</span></code></a> object. The
<a class="reference external" href="https://docs.python.org/3/library/datetime.html#module-datetime" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">datetime</span></code></a> class is part of the standard Python libraries.</p>
<p>There are many ways to create datetime objects, for example the
<a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime.strptime" title="(in Python v3.8)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">datetime.datetime.strptime()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">date_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;2013-01-23&#39;</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See the <a class="reference external" href="https://docs.python.org/3/library/datetime.html#module-datetime" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">datetime</span></code></a> documentation for other date/time creation methods.</p>
<p>A date/time should have a <code class="docutils literal notranslate"><span class="pre">cell_format</span></code> of type <a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>,
otherwise it will appear as a number:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">date_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;d mmmm yyyy&#39;</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_datetime</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">date_time</span><span class="p">,</span> <span class="n">date_format</span><span class="p">)</span>
</pre></div>
</div>
<p>If required, a default date format string can be set using the <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a>
constructor <code class="docutils literal notranslate"><span class="pre">default_date_format</span></code> option.</p>
<p>See <a class="reference internal" href="index.html#working-with-dates-and-time"><span class="std std-ref">Working with Dates and Time</span></a> for more details and also
<a class="reference internal" href="index.html#timezone-handling"><span class="std std-ref">Timezone Handling in XlsxWriter</span></a>.</p>
</div>
<div class="section" id="worksheet-write-url">
<h4>worksheet.write_url()</h4>
<dl class="function">
<dt id="write_url">
<code class="descname">write_url</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>url</em><span class="optional">[</span>, <em>cell_format</em><span class="optional">[</span>, <em>string</em><span class="optional">[</span>, <em>tip</em><span class="optional">]</span><span class="optional">]</span><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Write a hyperlink to a worksheet cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>url</strong> (<em>string</em>) – Hyperlink url.</li>
<li><strong>cell_format</strong> (<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>) – Optional Format object. Defaults to the Excel hyperlink style.</li>
<li><strong>string</strong> (<em>string</em>) – An optional display string for the hyperlink.</li>
<li><strong>tip</strong> (<em>string</em>) – An optional tooltip.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">-2: String longer than 32k characters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">-3: Url longer than Excel limit of 2079 characters.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-4: Exceeds Excel limit of 65,530 urls per worksheet.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">write_url()</span></code> method is used to write a hyperlink in a worksheet cell.
The url is comprised of two elements: the displayed string and the
non-displayed link. The displayed string is the same as the link unless an
alternative string is specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;https://www.python.org/&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;https://www.python.org/&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Both row-column and A1 style notation are supported, as shown above. See
<a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">cell_format</span></code> parameter is used to apply formatting to the cell. This
parameter is optional and the default Excel hyperlink style will be used if it
isn’t specified. If required you can access the default url format using the
Workbook <a class="reference internal" href="index.html#get_default_url_format" title="get_default_url_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_default_url_format()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">url_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">get_default_url_format</span><span class="p">()</span>
</pre></div>
</div>
<p>Four web style URI’s are supported: <code class="docutils literal notranslate"><span class="pre">http://</span></code>, <code class="docutils literal notranslate"><span class="pre">https://</span></code>, <code class="docutils literal notranslate"><span class="pre">ftp://</span></code> and
<code class="docutils literal notranslate"><span class="pre">mailto:</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;ftp://www.python.org/&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;https://www.python.org/&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="s1">&#39;mailto:jmcnamara@cpan.org&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>All of the these URI types are recognized by the <a class="reference internal" href="#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method, so the
following are equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;https://www.python.org/&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span>    <span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;https://www.python.org/&#39;</span><span class="p">)</span>  <span class="c1"># Same.</span>
</pre></div>
</div>
<p>You can display an alternative string using the <code class="docutils literal notranslate"><span class="pre">string</span></code> parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;https://www.python.org&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s1">&#39;Python home&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>If you wish to have some other cell data such as a number or a formula you
can overwrite the cell using another call to <code class="docutils literal notranslate"><span class="pre">write_*()</span></code>:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;https://www.python.org/&#39;</span><span class="p">)</span>

<span class="c1"># Overwrite the URL string with a formula. The cell will still be a link.</span>
<span class="c1"># Note the use of the default url format for consistency with other links.</span>
<span class="n">url_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">get_default_url_format</span><span class="p">()</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;=1+1&#39;</span><span class="p">,</span> <span class="n">url_format</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>There are two local URIs supported: <code class="docutils literal notranslate"><span class="pre">internal:</span></code> and <code class="docutils literal notranslate"><span class="pre">external:</span></code>. These are
used for hyperlinks to internal worksheet references or external workbook and
worksheet references:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Link to a cell on the current worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span>  <span class="s1">&#39;internal:Sheet2!A1&#39;</span><span class="p">)</span>

<span class="c1"># Link to a cell on another worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span>  <span class="s1">&#39;internal:Sheet2!A1:B2&#39;</span><span class="p">)</span>

<span class="c1"># Worksheet names with spaces should be single quoted like in Excel.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span>  <span class="s2">&quot;internal:&#39;Sales Data&#39;!A1&quot;</span><span class="p">)</span>

<span class="c1"># Link to another Excel workbook.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;external:c:\temp\foo.xlsx&#39;</span><span class="p">)</span>

<span class="c1"># Link to a worksheet cell in another workbook.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;external:c:\foo.xlsx#Sheet2!A1&#39;</span><span class="p">)</span>

<span class="c1"># Link to a worksheet in another workbook with a relative link.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;external:..\foo.xlsx#Sheet2!A1&#39;</span><span class="p">)</span>

<span class="c1"># Link to a worksheet in another workbook with a network link.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A8&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;external:</span><span class="se">\\</span><span class="s1">NET\share\foo.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Worksheet references are typically of the form <code class="docutils literal notranslate"><span class="pre">Sheet1!A1</span></code>. You can also link
to a worksheet range using the standard Excel notation: <code class="docutils literal notranslate"><span class="pre">Sheet1!A1:B2</span></code>.</p>
<p>In external links the workbook and worksheet name must be separated by the
<code class="docutils literal notranslate"><span class="pre">#</span></code> character: <code class="docutils literal notranslate"><span class="pre">external:Workbook.xlsx#Sheet1!A1'</span></code>.</p>
<p>You can also link to a named range in the target worksheet. For example say you
have a named range called <code class="docutils literal notranslate"><span class="pre">my_name</span></code> in the workbook <code class="docutils literal notranslate"><span class="pre">c:\temp\foo.xlsx</span></code> you
could link to it as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A14&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;external:c:\temp\foo.xlsx#my_name&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Excel requires that worksheet names containing spaces or non alphanumeric
characters are single quoted as follows <code class="docutils literal notranslate"><span class="pre">'Sales</span> <span class="pre">Data'!A1</span></code>.</p>
<p>Links to network files are also supported. Network files normally begin with
two back slashes as follows <code class="docutils literal notranslate"><span class="pre">\\NETWORK\etc</span></code>. In order to generate this in a
single or double quoted string you will have to escape the backslashes,
<code class="docutils literal notranslate"><span class="pre">'\\\\NETWORK\\etc'</span></code> or use a raw string <code class="docutils literal notranslate"><span class="pre">r'\\NETWORK\etc'</span></code>.</p>
<p>Alternatively, you can avoid most of these quoting problems by using forward
slashes. These are translated internally to backslashes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A14&#39;</span><span class="p">,</span> <span class="s2">&quot;external:c:/temp/foo.xlsx&quot;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A15&#39;</span><span class="p">,</span> <span class="s1">&#39;external://NETWORK/share/foo.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="index.html#ex-hyperlink"><span class="std std-ref">Example: Adding hyperlinks</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">XlsxWriter will escape the following characters in URLs as required
by Excel: <code class="docutils literal notranslate"><span class="pre">\s</span> <span class="pre">&quot;</span> <span class="pre">&lt;</span> <span class="pre">&gt;</span> <span class="pre">\</span> <span class="pre">[</span> <span class="pre">]</span> <span class="pre">`</span> <span class="pre">^</span> <span class="pre">{</span> <span class="pre">}</span></code> unless the URL already contains <code class="docutils literal notranslate"><span class="pre">%xx</span></code>
style escapes. In which case it is assumed that the URL was escaped
correctly by the user and will by passed directly to Excel.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Versions of Excel prior to Excel 2015 limited hyperlink links and
anchor/locations to 255 characters each. Versions after that support urls
up to 2079 characters. XlsxWriter versions &gt;= 1.2.3 support this longer
limit by default. However, a lower or user defined limit can be set via
the <code class="docutils literal notranslate"><span class="pre">max_url_length</span></code> property in the <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> constructor.</p>
</div>
</div>
<div class="section" id="worksheet-write-rich-string">
<h4>worksheet.write_rich_string()</h4>
<dl class="function">
<dt id="write_rich_string">
<code class="descname">write_rich_string</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>*string_parts</em><span class="optional">[</span>, <em>cell_format</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Write a “rich” string with multiple formats to a worksheet cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>string_parts</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – String and format pairs.</li>
<li><strong>cell_format</strong> (<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>) – Optional Format object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">-2: String longer than 32k characters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">-3: 2 consecutive formats used.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">-4: Empty string used.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-5: Insufficient parameters.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">write_rich_string()</span></code> method is used to write strings with multiple
formats. For example to write the string “This is <strong>bold</strong> and this is
<em>italic</em>” you would use the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bold</span>   <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">italic</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;italic&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_rich_string</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;This is &#39;</span><span class="p">,</span>
                            <span class="n">bold</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                            <span class="s1">&#39; and this is &#39;</span><span class="p">,</span>
                            <span class="n">italic</span><span class="p">,</span> <span class="s1">&#39;italic&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/rich_strings_small.png" src="_images/rich_strings_small.png" />
<p>Both row-column and A1 style notation are supported. The following are
equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_rich_string</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;This is &#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_rich_string</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;This is &#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>The basic rule is to break the string into fragments and put a
<a class="reference external" href="https://docs.python.org/3/library/functions.html#format" title="(in Python v3.8)"><code class="xref py py-func docutils literal notranslate"><span class="pre">Format</span></code></a> object before the fragment that you want to format.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Unformatted string.</span>
<span class="s1">&#39;This is an example string&#39;</span>

<span class="c1"># Break it into fragments.</span>
<span class="s1">&#39;This is an &#39;</span><span class="p">,</span> <span class="s1">&#39;example&#39;</span><span class="p">,</span> <span class="s1">&#39; string&#39;</span>

<span class="c1"># Add formatting before the fragments you want formatted.</span>
<span class="s1">&#39;This is an &#39;</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="s1">&#39;example&#39;</span><span class="p">,</span> <span class="s1">&#39; string&#39;</span>

<span class="c1"># In XlsxWriter.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_rich_string</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;This is an &#39;</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="s1">&#39;example&#39;</span><span class="p">,</span> <span class="s1">&#39; string&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>String fragments that don’t have a format are given a default format. So for
example when writing the string “Some <strong>bold</strong> text” you would use the first
example below but it would be equivalent to the second:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Some bold format and a default format.</span>
<span class="n">bold</span>    <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">default</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>

<span class="c1"># With default formatting:</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_rich_string</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Some &#39;</span><span class="p">,</span>
                            <span class="n">bold</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                            <span class="s1">&#39; text&#39;</span><span class="p">)</span>

<span class="c1"># Or more explicitly:</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_rich_string</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span>
                             <span class="n">default</span><span class="p">,</span> <span class="s1">&#39;Some &#39;</span><span class="p">,</span>
                             <span class="n">bold</span><span class="p">,</span>    <span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                             <span class="n">default</span><span class="p">,</span> <span class="s1">&#39; text&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you have formats and segments in a list you can add them like this, using
the standard Python list unpacking syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">segments</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;This is &#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="s1">&#39; and this is &#39;</span><span class="p">,</span> <span class="n">blue</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_rich_string</span><span class="p">(</span><span class="s1">&#39;A9&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">segments</span><span class="p">)</span>
</pre></div>
</div>
<p>In Excel only the font properties of the format such as font name, style, size,
underline, color and effects are applied to the string fragments in a rich
string. Other features such as border, background, text wrap and alignment
must be applied to the cell.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">write_rich_string()</span></code> method allows you to do this by using the last
argument as a cell format (if it is a format object). The following example
centers a rich string in the cell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bold</span>   <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">center</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_rich_string</span><span class="p">(</span><span class="s1">&#39;A5&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Some &#39;</span><span class="p">,</span>
                            <span class="n">bold</span><span class="p">,</span> <span class="s1">&#39;bold text&#39;</span><span class="p">,</span>
                            <span class="s1">&#39; centered&#39;</span><span class="p">,</span>
                            <span class="n">center</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Excel doesn’t allow the use of two consecutive formats in a rich string or
an empty string fragment. For either of these conditions a warning is
raised and the input to <code class="docutils literal notranslate"><span class="pre">write_rich_string()</span></code> is ignored.</p>
</div>
<p>See also <a class="reference internal" href="index.html#ex-rich-strings"><span class="std std-ref">Example: Writing “Rich” strings with multiple formats</span></a> and <a class="reference internal" href="index.html#ex-merge-rich"><span class="std std-ref">Example: Merging Cells with a Rich String</span></a>.</p>
</div>
<div class="section" id="worksheet-write-row">
<h4>worksheet.write_row()</h4>
<dl class="function">
<dt id="write_row">
<code class="descname">write_row</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>data</em><span class="optional">[</span>, <em>cell_format</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Write a row of data starting from (row, col).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>data</strong> – Cell data to write. Variable types.</li>
<li><strong>cell_format</strong> (<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>) – Optional Format object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Other: Error return value of the <code class="docutils literal notranslate"><span class="pre">write()</span></code> method.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">write_row()</span></code> method can be used to write a list of data in one go. This
is useful for converting the results of a database query into an Excel
worksheet. The <a class="reference internal" href="#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method is  called for each element of the data.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Some sample data.</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Foo&#39;</span><span class="p">,</span> <span class="s1">&#39;Bar&#39;</span><span class="p">,</span> <span class="s1">&#39;Baz&#39;</span><span class="p">)</span>

<span class="c1"># Write the data to a sequence of cells.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="c1"># The above example is equivalent to:</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Both row-column and A1 style notation are supported. The following are
equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
</div>
<div class="section" id="worksheet-write-column">
<h4>worksheet.write_column()</h4>
<dl class="function">
<dt id="write_column">
<code class="descname">write_column</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>data</em><span class="optional">[</span>, <em>cell_format</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Write a column of data starting from (row, col).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>data</strong> – Cell data to write. Variable types.</li>
<li><strong>cell_format</strong> (<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>) – Optional Format object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Other: Error return value of the <code class="docutils literal notranslate"><span class="pre">write()</span></code> method.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">write_column()</span></code> method can be used to write a list of data in one go.
This is useful for converting the results of a database query into an Excel
worksheet. The <a class="reference internal" href="#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method is  called for each element of the data.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Some sample data.</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Foo&#39;</span><span class="p">,</span> <span class="s1">&#39;Bar&#39;</span><span class="p">,</span> <span class="s1">&#39;Baz&#39;</span><span class="p">)</span>

<span class="c1"># Write the data to a sequence of cells.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="c1"># The above example is equivalent to:</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Both row-column and A1 style notation are supported. The following are
equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
</div>
<div class="section" id="worksheet-set-row">
<h4>worksheet.set_row()</h4>
<dl class="function">
<dt id="set_row">
<code class="descname">set_row</code><span class="sig-paren">(</span><em>row</em>, <em>height</em>, <em>cell_format</em>, <em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Set properties for a row of cells.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The worksheet row (zero indexed).</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The row height.</li>
<li><strong>cell_format</strong> (<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>) – Optional Format object.</li>
<li><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Optional row parameters: hidden, level, collapsed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-1: Row is out of worksheet bounds.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_row()</span></code> method is used to change the default properties of a row. The
most common use for this method is to change the height of a row:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>  <span class="c1"># Set the height of Row 1 to 20.</span>
</pre></div>
</div>
<p>The other common use for <code class="docutils literal notranslate"><span class="pre">set_row()</span></code> is to set the <a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a> for
all cells in the row:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
</pre></div>
</div>
<p>If you wish to set the format of a row without changing the height you can pass
<code class="docutils literal notranslate"><span class="pre">None</span></code> as the height parameter or use the default row height of 15:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span>   <span class="n">cell_format</span><span class="p">)</span>  <span class="c1"># Same as above.</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">cell_format</span></code> parameter will be applied to any cells in the row that
don’t have a format. As with Excel it is overridden by an explicit cell
format. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">format1</span><span class="p">)</span>      <span class="c1"># Row 1 has format1.</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>           <span class="c1"># Cell A1 defaults to format1.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="n">format2</span><span class="p">)</span>  <span class="c1"># Cell B1 keeps format2.</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">options</span></code> parameter is a dictionary with the following possible keys:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">'hidden'</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">'level'</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">'collapsed'</span></code></li>
</ul>
<p>Options can be set as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Or use defaults for other properties and set the options only.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">'hidden'</span></code> option is used to hide a row. This can be used, for example,
to hide intermediary steps in a complicated calculation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">'level'</span></code> parameter is used to set the outline level of the row. Outlines
are described in <a class="reference internal" href="index.html#outlines"><span class="std std-ref">Working with Outlines and Grouping</span></a>. Adjacent rows with the same outline level
are grouped together into a single outline.</p>
<p>The following example sets an outline level of 1 for some rows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<p>Excel allows up to 7 outline levels. The <code class="docutils literal notranslate"><span class="pre">'level'</span></code> parameter should be in the
range <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">level</span> <span class="pre">&lt;=</span> <span class="pre">7</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'hidden'</span></code> parameter can also be used to hide collapsed outlined rows
when used in conjunction with the <code class="docutils literal notranslate"><span class="pre">'level'</span></code> parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">'collapsed'</span></code> parameter is used in collapsed outlines to indicate which
row has the collapsed <code class="docutils literal notranslate"><span class="pre">'+'</span></code> symbol:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;collapsed&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="worksheet-set-column">
<h4>worksheet.set_column()</h4>
<dl class="function">
<dt id="set_column">
<code class="descname">set_column</code><span class="sig-paren">(</span><em>first_col</em>, <em>last_col</em>, <em>width</em>, <em>cell_format</em>, <em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Set properties for one or more columns of cells.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>first_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – First column (zero-indexed).</li>
<li><strong>last_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Last column (zero-indexed). Can be same as first_col.</li>
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The width of the column(s).</li>
<li><strong>cell_format</strong> (<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>) – Optional Format object.</li>
<li><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Optional parameters: hidden, level, collapsed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-1: Column is out of worksheet bounds.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_column()</span></code>  method can be used to change the default properties of a
single column or a range of columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>  <span class="c1"># Width of columns B:D set to 30.</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">set_column()</span></code> is applied to a single column the value of <code class="docutils literal notranslate"><span class="pre">first_col</span></code>
and <code class="docutils literal notranslate"><span class="pre">last_col</span></code> should be the same:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>  <span class="c1"># Width of column B set to 30.</span>
</pre></div>
</div>
<p>It is also possible, and generally clearer, to specify a column range using the
form of A1 notation used for columns. See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more
details.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>   <span class="c1"># Column  A   width set to 20.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>   <span class="c1"># Columns B-D width set to 30.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;E:E&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>  <span class="c1"># Column  E   width set to 20.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;F:H&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>  <span class="c1"># Columns F-H width set to 30.</span>
</pre></div>
</div>
<p>Ranges cannot overlap. Each unique contiguous range should be specified
separately:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This won&#39;t work.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:D&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;C:C&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># It needs to be split into non-overlapping regions.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:B&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;C:C&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;D:E&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">width</span></code> parameter sets the column width in the same units used by Excel
which is: the number of characters in the default font. The default width is
8.43 in the default font of Calibri 11. The actual relationship between a
string width and a column width in Excel is complex. See the <a class="reference external" href="https://support.microsoft.com/en-us/kb/214123">following
explanation of column widths</a>
from the Microsoft support documentation for more details.</p>
<p>There is no way to specify “AutoFit” for a column in the Excel file
format. This feature is only available at runtime from within Excel. It is
possible to simulate “AutoFit” in your application by tracking the maximum
width of the data in the column as your write it and then adjusting the column
width at the end.</p>
<p>As usual the <code class="docutils literal notranslate"><span class="pre">cell_format</span></code> <a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>  parameter is optional. If
you wish to set the format without changing the width you can pass <code class="docutils literal notranslate"><span class="pre">None</span></code> as
the width parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">cell_format</span></code> parameter will be applied to any cells in the column that
don’t have a format. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">format1</span><span class="p">)</span>  <span class="c1"># Col 1 has format1.</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>              <span class="c1"># Cell A1 defaults to format1.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="n">format2</span><span class="p">)</span>     <span class="c1"># Cell A2 keeps format2.</span>
</pre></div>
</div>
<p>A  row format takes precedence over a default column format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">format1</span><span class="p">)</span>         <span class="c1"># Set format for row 1.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">format2</span><span class="p">)</span>  <span class="c1"># Set format for col 1.</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>              <span class="c1"># Defaults to format1</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>              <span class="c1"># Defaults to format2</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">options</span></code> parameter is a dictionary with the following possible keys:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">'hidden'</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">'level'</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">'collapsed'</span></code></li>
</ul>
<p>Options can be set as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;D:D&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Or use defaults for other properties and set the options only.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;E:E&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">'hidden'</span></code> option is used to hide a column. This can be used, for
example, to hide intermediary steps in a complicated calculation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;D:D&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>  <span class="n">cell_format</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">'level'</span></code> parameter is used to set the outline level of the column.
Outlines are described in <a class="reference internal" href="index.html#outlines"><span class="std std-ref">Working with Outlines and Grouping</span></a>. Adjacent columns with the same
outline level are grouped together into a single outline.</p>
<p>The following example sets an outline level of 1 for columns B to G:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<p>Excel allows up to 7 outline levels. The <code class="docutils literal notranslate"><span class="pre">'level'</span></code> parameter should be in the
range <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">level</span> <span class="pre">&lt;=</span> <span class="pre">7</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'hidden'</span></code> parameter can also be used to hide collapsed outlined columns
when used in conjunction with the <code class="docutils literal notranslate"><span class="pre">'level'</span></code> parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">'collapsed'</span></code> parameter is used in collapsed outlines to indicate which
column has the collapsed <code class="docutils literal notranslate"><span class="pre">'+'</span></code> symbol:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;H:H&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;collapsed&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="worksheet-insert-image">
<h4>worksheet.insert_image()</h4>
<dl class="function">
<dt id="insert_image">
<code class="descname">insert_image</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>image</em><span class="optional">[</span>, <em>options</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Insert an image in a worksheet cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>image</strong> (<em>string</em>) – Image filename (with path if required).</li>
<li><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Optional parameters for image position, scale and url.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>This method can be used to insert a image into a worksheet. The image can be in
PNG, JPEG, BMP, WMF or EMF format (see the notes about BMP and EMF below):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;python.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/insert_image.png" src="_images/insert_image.png" />
<p>Both row-column and A1 style notation are supported. The following are
equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;python.png&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;python.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>A file path can be specified with the image name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B10&#39;</span><span class="p">,</span> <span class="s1">&#39;../images/python.png&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B20&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;c:\images\python.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">insert_image()</span></code> method takes optional parameters in a dictionary to
position and scale the image. The available parameters with their default
values are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;x_offset&#39;</span><span class="p">:</span>        <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span>        <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;x_scale&#39;</span><span class="p">:</span>         <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;y_scale&#39;</span><span class="p">:</span>         <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;object_position&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;image_data&#39;</span><span class="p">:</span>      <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;url&#39;</span><span class="p">:</span>             <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;tip&#39;</span><span class="p">:</span>             <span class="kc">None</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The offset values are in pixels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;python.png&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
</pre></div>
</div>
<p>The offsets can be greater than the width or height of the underlying cell.
This can be occasionally useful if you wish to align two or more images
relative to the same cell.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">x_scale</span></code> and <code class="docutils literal notranslate"><span class="pre">y_scale</span></code> parameters can be used to scale the image
horizontally and vertically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;python.png&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_scale&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;y_scale&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">url</span></code> parameter can used to add a hyperlink/url to the image. The <code class="docutils literal notranslate"><span class="pre">tip</span></code>
parameter gives an optional mouseover tooltip for images with hyperlinks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;python.png&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://python.org&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="#write_url" title="write_url"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_url()</span></code></a> for details on supported URIs.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">image_data</span></code> parameter is used to add an in-memory byte stream in
<a class="reference external" href="https://docs.python.org/3/library/io.html#io.BytesIO" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">io.BytesIO</span></code></a> format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;python.png&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;image_data&#39;</span><span class="p">:</span> <span class="n">image_data</span><span class="p">})</span>
</pre></div>
</div>
<p>This is generally used for inserting images from URLs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://python.org/logo.png&#39;</span>
<span class="n">image_data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">urllib2</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;image_data&#39;</span><span class="p">:</span> <span class="n">image_data</span><span class="p">})</span>
</pre></div>
</div>
<p>When using the <code class="docutils literal notranslate"><span class="pre">image_data</span></code> parameter a filename must still be passed to
<code class="docutils literal notranslate"><span class="pre">insert_image()</span></code> since it is required by Excel. In the previous example
the filename is extracted from the URL string. See also
<a class="reference internal" href="index.html#ex-images-bytesio"><span class="std std-ref">Example: Inserting images from a URL or byte stream into a worksheet</span></a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">object_position</span></code> parameter can be used to control the object
positioning of the image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;python.png&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;object_position&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">object_position</span></code> has the following allowable values:</p>
<ol class="arabic simple">
<li>Move and size with cells.</li>
<li>Move but don’t size with cells (the default).</li>
<li>Don’t move or size with cells.</li>
<li>Same as Option 1 to “move and size with cells” except XlsxWriter applies
hidden cells after the image is inserted.</li>
</ol>
<p>See <a class="reference internal" href="index.html#object-position"><span class="std std-ref">Working with Object Positioning</span></a> for more detailed information about the positioning
and scaling of images within a worksheet.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>BMP images are only supported for backward compatibility. In general it
is best to avoid BMP images since they aren’t compressed. If used, BMP
images must be 24 bit, true color, bitmaps.</li>
<li>EMF images can have very small differences in width and height when
compared to Excel files. Despite a lot of effort and testing it wasn’t
possible to match exactly Excel’s calculations for handling the
dimensions of EMF files. However, the differences are small (&lt; 1%) and in
general aren’t visible.</li>
</ul>
</div>
<p>See also <a class="reference internal" href="index.html#ex-insert-image"><span class="std std-ref">Example: Inserting images into a worksheet</span></a>.</p>
</div>
<div class="section" id="worksheet-insert-chart">
<h4>worksheet.insert_chart()</h4>
<dl class="function">
<dt id="insert_chart">
<code class="descname">insert_chart</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>chart</em><span class="optional">[</span>, <em>options</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Write a string to a worksheet cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>chart</strong> – A chart object.</li>
<li><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Optional parameters to position and scale the chart.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>This method can be used to insert a chart into a worksheet. A chart object is
created via the Workbook <a class="reference internal" href="index.html#add_chart" title="add_chart"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_chart()</span></code></a> method where the chart type is
specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="nb">type</span><span class="p">,</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>It is then inserted into a worksheet as an embedded chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_simple.png"><img alt="_images/chart_simple.png" src="_images/chart_simple.png" style="width: 704.25px; height: 402.75px;" /></a>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A chart can only be inserted into a worksheet once. If several similar
charts are required then each one must be created separately with
<a class="reference internal" href="index.html#add_chart" title="add_chart"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_chart()</span></code></a>.</p>
</div>
<p>See <a class="reference internal" href="index.html#chart-class"><span class="std std-ref">The Chart Class</span></a>, <a class="reference internal" href="index.html#working-with-charts"><span class="std std-ref">Working with Charts</span></a> and <a class="reference internal" href="index.html#chart-examples"><span class="std std-ref">Chart Examples</span></a>.</p>
<p>Both row-column and A1 style notation are supported. The following are
equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">insert_chart()</span></code> method takes optional parameters in a dictionary to
position and scale the chart. The available parameters with their default
values are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;x_offset&#39;</span><span class="p">:</span>        <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span>        <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;x_scale&#39;</span><span class="p">:</span>         <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;y_scale&#39;</span><span class="p">:</span>         <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;object_position&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The offset values are in pixels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">x_scale</span></code> and <code class="docutils literal notranslate"><span class="pre">y_scale</span></code> parameters can be used to scale the chart
horizontally and vertically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_scale&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;y_scale&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>
</pre></div>
</div>
<p>These properties can also be set via the Chart <a class="reference internal" href="index.html#set_size" title="set_size"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_size()</span></code></a> method.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">object_position</span></code> parameter can be used to control the object
positioning of the image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;object_position&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">object_position</span></code> has the following allowable values:</p>
<ol class="arabic simple">
<li>Move and size with cells (the default).</li>
<li>Move but don’t size with cells.</li>
<li>Don’t move or size with cells.</li>
</ol>
<p>See <a class="reference internal" href="index.html#object-position"><span class="std std-ref">Working with Object Positioning</span></a> for more detailed information about the positioning
and scaling of images within a worksheet.</p>
</div>
<div class="section" id="worksheet-insert-textbox">
<h4>worksheet.insert_textbox()</h4>
<dl class="function">
<dt id="insert_textbox">
<code class="descname">insert_textbox</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>textbox</em><span class="optional">[</span>, <em>options</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Write a string to a worksheet cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>text</strong> (<em>string</em>) – The text in the textbox.</li>
<li><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Optional parameters to position and scale the textbox.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>This method can be used to insert a textbox into a worksheet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A simple textbox with some text&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/textbox03.png" src="_images/textbox03.png" />
<p>Both row-column and A1 style notation are supported. The following are
equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Some text&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;Some text&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>The size and formatting of the textbox can be controlled via the <code class="docutils literal notranslate"><span class="pre">options</span></code> dict:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Size and position</span>
<span class="n">width</span>
<span class="n">height</span>
<span class="n">x_scale</span>
<span class="n">y_scale</span>
<span class="n">x_offset</span>
<span class="n">y_offset</span>
<span class="n">object_position</span>

<span class="c1"># Formatting</span>
<span class="n">line</span>
<span class="n">border</span>
<span class="n">fill</span>
<span class="n">gradient</span>
<span class="n">font</span>
<span class="n">align</span>
<span class="n">text_rotation</span>

<span class="c1"># Links</span>
<span class="n">textlink</span>
<span class="n">url</span>
<span class="n">tip</span>
</pre></div>
</div>
<p>These options are explained in more detail in the
<a class="reference internal" href="index.html#working-with-textboxes"><span class="std std-ref">Working with Textboxes</span></a> section.</p>
<p>See also <a class="reference internal" href="index.html#ex-textbox"><span class="std std-ref">Example: Insert Textboxes into a Worksheet</span></a>.</p>
<p>See <a class="reference internal" href="index.html#object-position"><span class="std std-ref">Working with Object Positioning</span></a> for more detailed information about the positioning
and scaling of images within a worksheet.</p>
</div>
<div class="section" id="worksheet-insert-button">
<h4>worksheet.insert_button()</h4>
<dl class="function">
<dt id="insert_button">
<code class="descname">insert_button</code><span class="sig-paren">(</span><em>row</em>, <em>col</em><span class="optional">[</span>, <em>options</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Insert a VBA button control on a worksheet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Optional parameters to position and scale the button.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">insert_button(</span></code>) method can be used to insert an Excel form button into a worksheet.</p>
<p>This method is generally only useful when used in conjunction with the
Workbook <a class="reference internal" href="index.html#add_vba_project" title="add_vba_project"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_vba_project()</span></code></a> method to tie the button to a macro from an
embedded VBA project:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add the VBA project binary.</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">add_vba_project</span><span class="p">(</span><span class="s1">&#39;./vbaProject.bin&#39;</span><span class="p">)</span>

<span class="c1"># Add a button tied to a macro in the VBA project.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_button</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;macro&#39;</span><span class="p">:</span>   <span class="s1">&#39;say_hello&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;caption&#39;</span><span class="p">:</span> <span class="s1">&#39;Press Me&#39;</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/macros.png" src="_images/macros.png" />
<p>See <a class="reference internal" href="index.html#macros"><span class="std std-ref">Working with VBA Macros</span></a> and <a class="reference internal" href="index.html#ex-macros"><span class="std std-ref">Example: Adding a VBA macro to a Workbook</span></a> for more details.</p>
<p>Both row-column and A1 style notation are supported. The following are
equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_button</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;macro&#39;</span><span class="p">:</span>   <span class="s1">&#39;say_hello&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;caption&#39;</span><span class="p">:</span> <span class="s1">&#39;Press Me&#39;</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_button</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;macro&#39;</span><span class="p">:</span>   <span class="s1">&#39;say_hello&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;caption&#39;</span><span class="p">:</span> <span class="s1">&#39;Press Me&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">insert_button()</span></code> method takes optional parameters in a dictionary to
position and scale the chart. The available parameters with their default
values are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s1">&#39;macro&#39;</span><span class="p">:</span>    <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;caption&#39;</span><span class="p">:</span>  <span class="s1">&#39;Button 1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;width&#39;</span><span class="p">:</span>    <span class="mi">64</span><span class="p">,</span>
    <span class="s1">&#39;height&#39;</span><span class="p">:</span>   <span class="mf">20.</span>
    <span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;x_scale&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;y_scale&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">macro</span></code> option is used to set the macro that the button will invoke when
the user clicks on it. The macro should be included using the Workbook
<code class="docutils literal notranslate"><span class="pre">add_vba_project()</span></code> method shown above.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">caption</span></code> is used to set the caption on the button. The default is
<code class="docutils literal notranslate"><span class="pre">Button</span> <span class="pre">n</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the button number.</p>
<p>The default button <code class="docutils literal notranslate"><span class="pre">width</span></code> is 64 pixels which is the width of a default cell
and the default button <code class="docutils literal notranslate"><span class="pre">height</span></code> is 20 pixels which is the height of a
default cell.</p>
<p>The offset and scale options are the same as for <code class="docutils literal notranslate"><span class="pre">insert_chart()</span></code>, see above.</p>
</div>
<div class="section" id="worksheet-data-validation">
<h4>worksheet.data_validation()</h4>
<dl class="function">
<dt id="data_validation">
<code class="descname">data_validation</code><span class="sig-paren">(</span><em>first_row</em>, <em>first_col</em>, <em>last_row</em>, <em>last_col</em>, <em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Write a conditional format to range of cells.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>first_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first row of the range. (All zero indexed.)</li>
<li><strong>first_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first column of the range.</li>
<li><strong>last_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last row of the range.</li>
<li><strong>last_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last col of the range.</li>
<li><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Data validation options.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-2: Incorrect parameter or option.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">data_validation()</span></code> method is used to construct an Excel data validation
or to limit the user input to a dropdown list of values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>


<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B13&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]})</span>
</pre></div>
</div>
<img alt="_images/data_validate1.png" src="_images/data_validate1.png" />
<p>The data validation can be applied to a single cell or a range of cells. As
usual you can use A1 or Row/Column notation, see <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]})</span>
</pre></div>
</div>
<p>With Row/Column notation you must specify all four cells in the range:
<code class="docutils literal notranslate"><span class="pre">(first_row,</span> <span class="pre">first_col,</span> <span class="pre">last_row,</span> <span class="pre">last_col)</span></code>. If you need to refer to a
single cell set the <cite>last_</cite> values equal to the <cite>first_</cite> values. With A1
notation you can refer to a single cell or a range of cells:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="o">...</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span>       <span class="p">{</span><span class="o">...</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;C1:E5&#39;</span><span class="p">,</span>    <span class="p">{</span><span class="o">...</span><span class="p">})</span>
</pre></div>
</div>
<p>The options parameter in <code class="docutils literal notranslate"><span class="pre">data_validation()</span></code> must be a dictionary containing
the parameters that describe the type and style of the data validation. There
are a lot of available options which are described in detail in a separate
section: <a class="reference internal" href="index.html#working-with-data-validation"><span class="std std-ref">Working with Data Validation</span></a>. See also <a class="reference internal" href="index.html#ex-data-valid"><span class="std std-ref">Example: Data Validation and Drop Down Lists</span></a>.</p>
</div>
<div class="section" id="worksheet-conditional-format">
<h4>worksheet.conditional_format()</h4>
<dl class="function">
<dt id="conditional_format">
<code class="descname">conditional_format</code><span class="sig-paren">(</span><em>first_row</em>, <em>first_col</em>, <em>last_row</em>, <em>last_col</em>, <em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Write a conditional format to range of cells.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>first_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first row of the range. (All zero indexed.)</li>
<li><strong>first_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first column of the range.</li>
<li><strong>last_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last row of the range.</li>
<li><strong>last_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last col of the range.</li>
<li><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Conditional formatting options.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-2: Incorrect parameter or option.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">conditional_format()</span></code> method is used to add formatting to a cell or
range of cells based on user defined criteria:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mi">50</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/conditional_format1.png" src="_images/conditional_format1.png" />
<p>The conditional format can be applied to a single cell or a range of cells. As
usual you can use A1 or Row/Column notation, see <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                          <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mi">50</span><span class="p">,</span>
                                          <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>

<span class="c1"># This is equivalent to the following:</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:B3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mi">50</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>With Row/Column notation you must specify all four cells in the range:
<code class="docutils literal notranslate"><span class="pre">(first_row,</span> <span class="pre">first_col,</span> <span class="pre">last_row,</span> <span class="pre">last_col)</span></code>. If you need to refer to a
single cell set the <cite>last_</cite> values equal to the <cite>first_</cite> values. With A1
notation you can refer to a single cell or a range of cells:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="o">...</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span>       <span class="p">{</span><span class="o">...</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;C1:E5&#39;</span><span class="p">,</span>    <span class="p">{</span><span class="o">...</span><span class="p">})</span>
</pre></div>
</div>
<p>The options parameter in <code class="docutils literal notranslate"><span class="pre">conditional_format()</span></code> must be a dictionary
containing the parameters that describe the type and style of the conditional
format. There are a lot of available options which are described in detail in
a separate section: <a class="reference internal" href="index.html#working-with-conditional-formats"><span class="std std-ref">Working with Conditional Formatting</span></a>. See also
<a class="reference internal" href="index.html#ex-cond-format"><span class="std std-ref">Example: Conditional Formatting</span></a>.</p>
</div>
<div class="section" id="worksheet-add-table">
<h4>worksheet.add_table()</h4>
<dl class="function">
<dt id="add_table">
<code class="descname">add_table</code><span class="sig-paren">(</span><em>first_row</em>, <em>first_col</em>, <em>last_row</em>, <em>last_col</em>, <em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Add an Excel table to a worksheet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>first_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first row of the range. (All zero indexed.)</li>
<li><strong>first_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first column of the range.</li>
<li><strong>last_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last row of the range.</li>
<li><strong>last_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last col of the range.</li>
<li><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Table formatting options. (Optional)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-2: Incorrect parameter or option.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">add_table()</span></code> method is used to group a range of cells into an Excel
Table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span> <span class="o">...</span> <span class="p">})</span>
</pre></div>
</div>
<p>This method contains a lot of parameters and is described in <a class="reference internal" href="index.html#tables"><span class="std std-ref">Working with Worksheet Tables</span></a>.</p>
<p>Both row-column and A1 style notation are supported. The following are
equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">{</span> <span class="o">...</span> <span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span>    <span class="p">{</span> <span class="o">...</span> <span class="p">})</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>See also the examples in <a class="reference internal" href="index.html#ex-tables"><span class="std std-ref">Example: Worksheet Tables</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Tables aren’t available in XlsxWriter when <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a>
<code class="docutils literal notranslate"><span class="pre">'constant_memory'</span></code> mode is enabled.</p>
</div>
</div>
<div class="section" id="worksheet-add-sparkline">
<h4>worksheet.add_sparkline()</h4>
<dl class="function">
<dt id="add_sparkline">
<code class="descname">add_sparkline</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>options</em><span class="sig-paren">)</span></dt>
<dd><blockquote>
<div>Add sparklines to a worksheet.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Sparkline formatting options.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-2: Incorrect parameter or option.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Sparklines are small charts that fit in a single cell and are used to show
trends in data.</p>
<img alt="_images/sparklines1.png" src="_images/sparklines1.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">add_sparkline()</span></code> worksheet method is used to add sparklines to a cell or
a range of cells:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;A1:E1&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>Both row-column and A1 style notation are supported. The following are
equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;A1:E1&#39;</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;A1:E1&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>This method contains a lot of parameters and is described in detail in
<a class="reference internal" href="index.html#sparklines"><span class="std std-ref">Working with Sparklines</span></a>.</p>
<p>See also <a class="reference internal" href="index.html#ex-sparklines1"><span class="std std-ref">Example: Sparklines (Simple)</span></a> and <a class="reference internal" href="index.html#ex-sparklines2"><span class="std std-ref">Example: Sparklines (Advanced)</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Sparklines are a feature of Excel 2010+ only. You can write them to
an XLSX file that can be read by Excel 2007 but they won’t be displayed.</p>
</div>
</div>
<div class="section" id="worksheet-write-comment">
<h4>worksheet.write_comment()</h4>
<dl class="function">
<dt id="write_comment">
<code class="descname">write_comment</code><span class="sig-paren">(</span><em>row</em>, <em>col</em>, <em>comment</em><span class="optional">[</span>, <em>options</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Write a comment to a worksheet cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>comment</strong> (<em>string</em>) – String to write to cell.</li>
<li><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Comment formatting options.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-2: String longer than 32k characters.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">write_comment()</span></code> method is used to add a comment to a cell. A comment is
indicated in Excel by a small red triangle in the upper right-hand corner of
the cell. Moving the cursor over the red triangle will reveal the comment.</p>
<p>The following example shows how to add a comment to a cell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;This is a comment&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/comments1.png" src="_images/comments1.png" />
<p>Both row-column and A1 style notation are supported. The following are
equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;This is a comment&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;This is a comment&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>The properties of the cell comment can be modified by passing an optional
dictionary of key/value pairs to control the format of the comment. For
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_scale&#39;</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">,</span> <span class="s1">&#39;y_scale&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">})</span>
</pre></div>
</div>
<p>Most of these options are quite specific and in general the default comment
behavior will be all that you need. However, should you need greater control
over the format of the cell comment the following options are available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">author</span>
<span class="n">visible</span>
<span class="n">x_scale</span>
<span class="n">width</span>
<span class="n">y_scale</span>
<span class="n">height</span>
<span class="n">color</span>
<span class="n">font_name</span>
<span class="n">font_size</span>
<span class="n">start_cell</span>
<span class="n">start_row</span>
<span class="n">start_col</span>
<span class="n">x_offset</span>
<span class="n">y_offset</span>
</pre></div>
</div>
<p>For more details see <a class="reference internal" href="index.html#cell-comments"><span class="std std-ref">Working with Cell Comments</span></a> and <a class="reference internal" href="index.html#ex-comments2"><span class="std std-ref">Example: Adding Cell Comments to Worksheets (Advanced)</span></a> .</p>
</div>
<div class="section" id="worksheet-show-comments">
<h4>worksheet.show_comments()</h4>
<dl class="function">
<dt id="show_comments">
<code class="descname">show_comments</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Make any comments in the worksheet visible.</p>
</dd></dl>

<p>This method is used to make all cell comments visible when a worksheet is
opened:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">show_comments</span><span class="p">()</span>
</pre></div>
</div>
<p>Individual comments can be made visible using the <code class="docutils literal notranslate"><span class="pre">visible</span></code> parameter of the
<code class="docutils literal notranslate"><span class="pre">write_comment</span></code> method (see above):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;visible&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>If all of the cell comments have been made visible you can hide individual
comments as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">show_comments</span><span class="p">()</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;visible&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>
</div>
<p>For more details see <a class="reference internal" href="index.html#cell-comments"><span class="std std-ref">Working with Cell Comments</span></a> and <a class="reference internal" href="index.html#ex-comments2"><span class="std std-ref">Example: Adding Cell Comments to Worksheets (Advanced)</span></a> .</p>
</div>
<div class="section" id="worksheet-set-comments-author">
<h4>worksheet.set_comments_author()</h4>
<dl class="function">
<dt id="set_comments_author">
<code class="descname">set_comments_author</code><span class="sig-paren">(</span><em>author</em><span class="sig-paren">)</span></dt>
<dd><p>Set the default author of the cell comments.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>author</strong> (<em>string</em>) – Comment author.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>This method is used to set the default author of all cell comments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_comments_author</span><span class="p">(</span><span class="s1">&#39;John Smith&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Individual comment authors can be set using the <code class="docutils literal notranslate"><span class="pre">author</span></code> parameter of the
<code class="docutils literal notranslate"><span class="pre">write_comment</span></code> method (see above).</p>
<p>If no author is specified the default comment author name is an empty string.</p>
<p>For more details see <a class="reference internal" href="index.html#cell-comments"><span class="std std-ref">Working with Cell Comments</span></a> and <a class="reference internal" href="index.html#ex-comments2"><span class="std std-ref">Example: Adding Cell Comments to Worksheets (Advanced)</span></a> .</p>
</div>
<div class="section" id="worksheet-get-name">
<h4>worksheet.get_name()</h4>
<dl class="function">
<dt id="get_name">
<code class="descname">get_name</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Retrieve the worksheet name.</p>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">get_name()</span></code> method is used to retrieve the name of a worksheet. This is
something useful for debugging or logging:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">worksheet</span> <span class="ow">in</span> <span class="n">workbook</span><span class="o">.</span><span class="n">worksheets</span><span class="p">():</span>
    <span class="nb">print</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">get_name</span><span class="p">()</span>
</pre></div>
</div>
<p>There is no <code class="docutils literal notranslate"><span class="pre">set_name()</span></code> method. The only safe way to set the worksheet name
is via the <code class="docutils literal notranslate"><span class="pre">add_worksheet()</span></code> method.</p>
</div>
<div class="section" id="worksheet-activate">
<h4>worksheet.activate()</h4>
<dl class="function">
<dt id="activate">
<code class="descname">activate</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Make a worksheet the active, i.e., visible worksheet.</p>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">activate()</span></code> method is used to specify which worksheet is initially
visible in a multi-sheet workbook:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet3</span><span class="o">.</span><span class="n">activate</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/worksheet_activate.png" src="_images/worksheet_activate.png" />
<p>More than one worksheet can be selected via the <code class="docutils literal notranslate"><span class="pre">select()</span></code> method, see below,
however only one worksheet can be active.</p>
<p>The default active worksheet is the first worksheet.</p>
</div>
<div class="section" id="worksheet-select">
<h4>worksheet.select()</h4>
<dl class="function">
<dt id="select">
<code class="descname">select</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Set a worksheet tab as selected.</p>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">select()</span></code> method is used to indicate that a worksheet is selected in a
multi-sheet workbook:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">activate</span><span class="p">()</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
</pre></div>
</div>
<p>A selected worksheet has its tab highlighted. Selecting worksheets is a way of
grouping them together so that, for example, several worksheets could be
printed in one go. A worksheet that has been activated via the <code class="docutils literal notranslate"><span class="pre">activate()</span></code>
method will also appear as selected.</p>
</div>
<div class="section" id="worksheet-hide">
<h4>worksheet.hide()</h4>
<dl class="function">
<dt id="hide">
<code class="descname">hide</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Hide the current worksheet.</p>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">hide()</span></code> method is used to hide a worksheet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet2</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
</pre></div>
</div>
<p>You may wish to hide a worksheet in order to avoid confusing a user with
intermediate data or calculations.</p>
<img alt="_images/hide_sheet.png" src="_images/hide_sheet.png" />
<p>A hidden worksheet can not be activated or selected so this method is mutually
exclusive with the <a class="reference internal" href="#activate" title="activate"><code class="xref py py-func docutils literal notranslate"><span class="pre">activate()</span></code></a> and <a class="reference internal" href="#select" title="select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a> methods. In
addition, since the first worksheet will default to being the active
worksheet, you cannot hide the first worksheet without activating another
sheet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet2</span><span class="o">.</span><span class="n">activate</span><span class="p">()</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#ex-hide-sheet"><span class="std std-ref">Example: Hiding Worksheets</span></a> for more details.</p>
</div>
<div class="section" id="worksheet-set-first-sheet">
<h4>worksheet.set_first_sheet()</h4>
<dl class="function">
<dt id="set_first_sheet">
<code class="descname">set_first_sheet</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Set current worksheet as the first visible sheet tab.</p>
</dd></dl>

<p>The <a class="reference internal" href="#activate" title="activate"><code class="xref py py-func docutils literal notranslate"><span class="pre">activate()</span></code></a> method determines which worksheet is initially selected.
However, if there are a large number of worksheets the selected worksheet may
not appear on the screen. To avoid this you can select which is the leftmost
visible worksheet tab using <code class="docutils literal notranslate"><span class="pre">set_first_sheet()</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">):</span>
    <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span>

<span class="n">worksheet19</span><span class="o">.</span><span class="n">set_first_sheet</span><span class="p">()</span>  <span class="c1"># First visible worksheet tab.</span>
<span class="n">worksheet20</span><span class="o">.</span><span class="n">activate</span><span class="p">()</span>         <span class="c1"># First visible worksheet.</span>
</pre></div>
</div>
<p>This method is not required very often. The default value is the first
worksheet.</p>
</div>
<div class="section" id="worksheet-merge-range">
<h4>worksheet.merge_range()</h4>
<dl class="function">
<dt id="merge_range">
<code class="descname">merge_range</code><span class="sig-paren">(</span><em>first_row</em>, <em>first_col</em>, <em>last_row</em>, <em>last_col</em>, <em>data</em><span class="optional">[</span>, <em>cell_format</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Merge a range of cells.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>first_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first row of the range. (All zero indexed.)</li>
<li><strong>first_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first column of the range.</li>
<li><strong>last_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last row of the range.</li>
<li><strong>last_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last col of the range.</li>
<li><strong>data</strong> – Cell data to write. Variable types.</li>
<li><strong>cell_format</strong> (<a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>) – Optional Format object.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Other: Error return value of the called <code class="docutils literal notranslate"><span class="pre">write()</span></code> method.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">merge_range()</span></code> method allows cells to be merged together so that they
act as a single area.</p>
<p>Excel generally merges and centers cells at same time. To get similar behavior
with XlsxWriter you need to apply a <a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">merge_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="s1">&#39;B3:D4&#39;</span><span class="p">,</span> <span class="s1">&#39;Merged Cells&#39;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>
</pre></div>
</div>
<p>Both row-column and A1 style notation are supported. The following are
equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Merged Cells&#39;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="s1">&#39;B3:D4&#39;</span><span class="p">,</span>    <span class="s1">&#39;Merged Cells&#39;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>It is possible to apply other formatting to the merged cells as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">merge_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
    <span class="s1">&#39;bold&#39;</span><span class="p">:</span>     <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span>   <span class="mi">6</span><span class="p">,</span>
    <span class="s1">&#39;align&#39;</span><span class="p">:</span>    <span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="s1">&#39;valign&#39;</span><span class="p">:</span>   <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#D7E4BC&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="s1">&#39;B3:D4&#39;</span><span class="p">,</span> <span class="s1">&#39;Merged Cells&#39;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/merge_range.png" src="_images/merge_range.png" />
<p>See <a class="reference internal" href="index.html#ex-merge1"><span class="std std-ref">Example: Merging Cells</span></a> for more details.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">merge_range()</span></code> method writes its <code class="docutils literal notranslate"><span class="pre">data</span></code> argument using
<a class="reference internal" href="#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a>. Therefore it will handle numbers, strings and formulas as
usual. If this doesn’t handle your data correctly then you can overwrite the
first cell with a call to one of the other
<code class="docutils literal notranslate"><span class="pre">write_*()</span></code> methods using the same <a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a> as in the merged cells. See <a class="reference internal" href="index.html#ex-merge-rich"><span class="std std-ref">Example: Merging Cells with a Rich String</span></a>.</p>
<img alt="_images/merge_rich.png" src="_images/merge_rich.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Merged ranges generally don’t work in XlsxWriter when <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a>
<code class="docutils literal notranslate"><span class="pre">'constant_memory'</span></code> mode is enabled.</p>
</div>
</div>
<div class="section" id="worksheet-autofilter">
<h4>worksheet.autofilter()</h4>
<dl class="function">
<dt id="autofilter">
<code class="descname">autofilter</code><span class="sig-paren">(</span><em>first_row</em>, <em>first_col</em>, <em>last_row</em>, <em>last_col</em><span class="sig-paren">)</span></dt>
<dd><p>Set the autofilter area in the worksheet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>first_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first row of the range. (All zero indexed.)</li>
<li><strong>first_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first column of the range.</li>
<li><strong>last_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last row of the range.</li>
<li><strong>last_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last col of the range.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">autofilter()</span></code> method allows an autofilter to be added to a worksheet. An
autofilter is a way of adding drop down lists to the headers of a 2D range of
worksheet data. This allows users to filter the data based on simple criteria
so that some data is shown and some is hidden.</p>
<img alt="_images/autofilter3.png" src="_images/autofilter3.png" />
<p>To add an autofilter to a worksheet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">autofilter</span><span class="p">(</span><span class="s1">&#39;A1:D11&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Both row-column and A1 style notation are supported. The following are
equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">autofilter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">autofilter</span><span class="p">(</span><span class="s1">&#39;A1:D11&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>Filter conditions can be applied using the <a class="reference internal" href="#filter_column" title="filter_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter_column()</span></code></a> or
<a class="reference internal" href="#filter_column_list" title="filter_column_list"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter_column_list()</span></code></a> methods.</p>
<p>See <a class="reference internal" href="index.html#working-with-autofilters"><span class="std std-ref">Working with Autofilters</span></a> for more details.</p>
</div>
<div class="section" id="worksheet-filter-column">
<h4>worksheet.filter_column()</h4>
<dl class="function">
<dt id="filter_column">
<code class="descname">filter_column</code><span class="sig-paren">(</span><em>col</em>, <em>criteria</em><span class="sig-paren">)</span></dt>
<dd><p>Set the column filter criteria.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Filter column (zero-indexed).</li>
<li><strong>criteria</strong> (<em>string</em>) – Filter criteria.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">filter_column</span></code> method can be used to filter columns in a autofilter
range based on simple conditions.</p>
<p>The conditions for the filter are specified using simple expressions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;x &gt; 2000&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;x &gt; 2000 and x &lt; 5000&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">col</span></code> parameter can either be a zero indexed column number or a string
column name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>   <span class="s1">&#39;x &gt; 2000&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;x &gt; 2000&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>It isn’t sufficient to just specify the filter condition. You must also hide
any rows that don’t match the filter condition. See
<a class="reference internal" href="index.html#working-with-autofilters"><span class="std std-ref">Working with Autofilters</span></a> for more details.</p>
</div>
<div class="section" id="worksheet-filter-column-list">
<h4>worksheet.filter_column_list()</h4>
<dl class="function">
<dt id="filter_column_list">
<code class="descname">filter_column_list</code><span class="sig-paren">(</span><em>col</em>, <em>filters</em><span class="sig-paren">)</span></dt>
<dd><p>Set the column filter criteria in Excel 2007 list style.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Filter column (zero-indexed).</li>
<li><strong>filters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – List of filter criteria to match.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">filter_column_list()</span></code> method can be used to represent filters with
multiple selected criteria:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column_list</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;March&#39;</span><span class="p">,</span> <span class="s1">&#39;April&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">col</span></code> parameter can either be a zero indexed column number or a string
column name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column_list</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span>   <span class="p">[</span><span class="s1">&#39;March&#39;</span><span class="p">,</span> <span class="s1">&#39;April&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column_list</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;March&#39;</span><span class="p">,</span> <span class="s1">&#39;April&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>One or more criteria can be selected:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column_list</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;March&#39;</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column_list</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>
</pre></div>
</div>
<p>To filter blanks as part of the list use <cite>Blanks</cite> as a list item:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column_list</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;March&#39;</span><span class="p">,</span> <span class="s1">&#39;April&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Blanks&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>It isn’t sufficient to just specify filters. You must also hide any rows that
don’t match the filter condition. See <a class="reference internal" href="index.html#working-with-autofilters"><span class="std std-ref">Working with Autofilters</span></a> for more
details.</p>
</div>
<div class="section" id="worksheet-set-selection">
<h4>worksheet.set_selection()</h4>
<dl class="function">
<dt id="set_selection">
<code class="descname">set_selection</code><span class="sig-paren">(</span><em>first_row</em>, <em>first_col</em>, <em>last_row</em>, <em>last_col</em><span class="sig-paren">)</span></dt>
<dd><p>Set the selected cell or cells in a worksheet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>first_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first row of the range. (All zero indexed.)</li>
<li><strong>first_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first column of the range.</li>
<li><strong>last_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last row of the range.</li>
<li><strong>last_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last col of the range.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_selection()</span></code> method can be used to specify which cell or range of
cells is selected in a worksheet. The most common requirement is to select a
single cell, in which case the <code class="docutils literal notranslate"><span class="pre">first_</span></code> and <code class="docutils literal notranslate"><span class="pre">last_</span></code> parameters should be
the same.</p>
<p>The active cell within a selected range is determined by the order in which
<code class="docutils literal notranslate"><span class="pre">first_</span></code> and <code class="docutils literal notranslate"><span class="pre">last_</span></code> are specified.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">set_selection</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 1. Cell D4.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_selection</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c1"># 2. Cells D4 to G7.</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_selection</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 3. Cells G7 to D4.</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_selection</span><span class="p">(</span><span class="s1">&#39;D4&#39;</span><span class="p">)</span>        <span class="c1"># Same as 1.</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">set_selection</span><span class="p">(</span><span class="s1">&#39;D4:G7&#39;</span><span class="p">)</span>     <span class="c1"># Same as 2.</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">set_selection</span><span class="p">(</span><span class="s1">&#39;G7:D4&#39;</span><span class="p">)</span>     <span class="c1"># Same as 3.</span>
</pre></div>
</div>
<p>As shown above, both row-column and A1 style notation are supported. See
<a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details. The default cell selection is
<code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">0)</span></code>, <code class="docutils literal notranslate"><span class="pre">'A1'</span></code>.</p>
</div>
<div class="section" id="worksheet-freeze-panes">
<h4>worksheet.freeze_panes()</h4>
<dl class="function">
<dt id="freeze_panes">
<code class="descname">freeze_panes</code><span class="sig-paren">(</span><em>row</em>, <em>col</em><span class="optional">[</span>, <em>top_row</em>, <em>left_col</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Create worksheet panes and mark them as frozen.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row (zero indexed).</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column (zero indexed).</li>
<li><strong>top_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Topmost visible row in scrolling region of pane.</li>
<li><strong>left_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Leftmost visible row in scrolling region of pane.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>This <code class="docutils literal notranslate"><span class="pre">freeze_panes</span></code> method can be used to divide a worksheet into horizontal
or vertical regions known as panes and to “freeze” these panes so that the
splitter bars are not visible.</p>
<p>The parameters <code class="docutils literal notranslate"><span class="pre">row</span></code> and <code class="docutils literal notranslate"><span class="pre">col</span></code> are used to specify the location of the
split. It should be noted that the split is specified at the top or left of a
cell and that the method uses zero based indexing. Therefore to freeze the
first row of a worksheet it is necessary to specify the split at row 2 (which
is 1 as the zero-based index).</p>
<p>You can set one of the <code class="docutils literal notranslate"><span class="pre">row</span></code> and <code class="docutils literal notranslate"><span class="pre">col</span></code> parameters as zero if you do not
want either a vertical or horizontal split.</p>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">freeze_panes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Freeze the first row.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">freeze_panes</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">)</span>  <span class="c1"># Same using A1 notation.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">freeze_panes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Freeze the first column.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">freeze_panes</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">)</span>  <span class="c1"># Same using A1 notation.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">freeze_panes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Freeze first row and first 2 columns.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">freeze_panes</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">)</span>  <span class="c1"># Same using A1 notation.</span>
</pre></div>
</div>
<p>As shown above, both row-column and A1 style notation are supported. See
<a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for more details.</p>
<p>The parameters <code class="docutils literal notranslate"><span class="pre">top_row</span></code> and <code class="docutils literal notranslate"><span class="pre">left_col</span></code> are optional. They are used to
specify the top-most or left-most visible row or column in the scrolling
region of the panes. For example to freeze the first row and to have the
scrolling region begin at row twenty:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">freeze_panes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>You cannot use A1 notation for the <code class="docutils literal notranslate"><span class="pre">top_row</span></code> and <code class="docutils literal notranslate"><span class="pre">left_col</span></code> parameters.</p>
<p>See <a class="reference internal" href="index.html#ex-panes"><span class="std std-ref">Example: Freeze Panes and Split Panes</span></a> for more details.</p>
</div>
<div class="section" id="worksheet-split-panes">
<h4>worksheet.split_panes()</h4>
<dl class="function">
<dt id="split_panes">
<code class="descname">split_panes</code><span class="sig-paren">(</span><em>x</em>, <em>y</em><span class="optional">[</span>, <em>top_row</em>, <em>left_col</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Create worksheet panes and mark them as split.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The position for the vertical split.</li>
<li><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The position for the horizontal split.</li>
<li><strong>top_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Topmost visible row in scrolling region of pane.</li>
<li><strong>left_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Leftmost visible row in scrolling region of pane.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">split_panes</span></code>  method can be used to divide a worksheet into horizontal
or vertical regions known as panes. This method is different from the
<code class="docutils literal notranslate"><span class="pre">freeze_panes()</span></code> method in that the splits between the panes will be visible
to the user and each pane will have its own scroll bars.</p>
<p>The parameters <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">x</span></code> are used to specify the vertical and horizontal
position of the split. The units for <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">x</span></code> are the same as those
used by Excel to specify row height and column width. However, the vertical
and horizontal units are different from each other. Therefore you must specify
the <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">x</span></code> parameters in terms of the row heights and column widths
that you have set or the default values which are <code class="docutils literal notranslate"><span class="pre">15</span></code> for a row and
<code class="docutils literal notranslate"><span class="pre">8.43</span></code> for a column.</p>
<p>You can set one of the <code class="docutils literal notranslate"><span class="pre">y</span></code> and <code class="docutils literal notranslate"><span class="pre">x</span></code> parameters as zero if you do not want
either a vertical or horizontal split. The parameters <code class="docutils literal notranslate"><span class="pre">top_row</span></code> and
<code class="docutils literal notranslate"><span class="pre">left_col</span></code> are optional. They are used to specify the top-most or left-most
visible row or column in the bottom-right pane.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">split_panes</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>     <span class="c1"># First row.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">split_panes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">8.43</span><span class="p">)</span>   <span class="c1"># First column.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">split_panes</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mf">8.43</span><span class="p">)</span>  <span class="c1"># First row and column.</span>
</pre></div>
</div>
<p>You cannot use A1 notation with this method.</p>
<p>See <a class="reference internal" href="index.html#ex-panes"><span class="std std-ref">Example: Freeze Panes and Split Panes</span></a> for more details.</p>
</div>
<div class="section" id="worksheet-set-zoom">
<h4>worksheet.set_zoom()</h4>
<dl class="function">
<dt id="set_zoom">
<code class="descname">set_zoom</code><span class="sig-paren">(</span><em>zoom</em><span class="sig-paren">)</span></dt>
<dd><p>Set the worksheet zoom factor.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>zoom</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Worksheet zoom factor.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Set the worksheet zoom factor in the range <code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">&lt;=</span> <span class="pre">zoom</span> <span class="pre">&lt;=</span> <span class="pre">400</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">set_zoom</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_zoom</span><span class="p">(</span><span class="mi">75</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_zoom</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_zoom</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
<p>The default zoom factor is 100. It isn’t possible to set the zoom to
“Selection” because it is calculated by Excel at run-time.</p>
<p>Note, <code class="docutils literal notranslate"><span class="pre">set_zoom()</span></code> does not affect the scale of the printed page. For that
you should use <a class="reference internal" href="index.html#set_print_scale" title="set_print_scale"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_print_scale()</span></code></a>.</p>
</div>
<div class="section" id="worksheet-right-to-left">
<h4>worksheet.right_to_left()</h4>
<dl class="function">
<dt id="right_to_left">
<code class="descname">right_to_left</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Display the worksheet cells from right to left for some versions of Excel.</p>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">right_to_left()</span></code> method is used to change the default direction of the
worksheet from left-to-right, with the A1 cell in the top left, to
right-to-left, with the A1 cell in the top right:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">right_to_left</span><span class="p">()</span>
</pre></div>
</div>
<p>This is useful when creating Arabic, Hebrew or other near or far eastern
worksheets that use right-to-left as the default direction.</p>
<img alt="_images/right_to_left.png" src="_images/right_to_left.png" />
<p>See also the Format <a class="reference internal" href="index.html#set_reading_order" title="set_reading_order"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_reading_order()</span></code></a> property to set the direction of the
text withing cells and the <a class="reference internal" href="index.html#ex-right-to-left"><span class="std std-ref">Example: Left to Right worksheets and text</span></a> example program.</p>
</div>
<div class="section" id="worksheet-hide-zero">
<h4>worksheet.hide_zero()</h4>
<dl class="function">
<dt id="hide_zero">
<code class="descname">hide_zero</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Hide zero values in worksheet cells.</p>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">hide_zero()</span></code> method is used to hide any zero values that appear in
cells:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">hide_zero</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="worksheet-set-tab-color">
<h4>worksheet.set_tab_color()</h4>
<dl class="function">
<dt id="set_tab_color">
<code class="descname">set_tab_color</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Set the color of the worksheet tab.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>color</strong> (<em>string</em>) – The tab color.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_tab_color()</span></code> method is used to change the color of the worksheet
tab:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">set_tab_color</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_tab_color</span><span class="p">(</span><span class="s1">&#39;#FF9900&#39;</span><span class="p">)</span>  <span class="c1"># Orange</span>
</pre></div>
</div>
<p>The color can be a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string or a limited number named
colors, see <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>.</p>
<p>See <a class="reference internal" href="index.html#ex-tab-colors"><span class="std std-ref">Example: Setting Worksheet Tab Colors</span></a> for more details.</p>
</div>
<div class="section" id="worksheet-protect">
<h4>worksheet.protect()</h4>
<dl class="function">
<dt id="protect">
<code class="descname">protect</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Protect elements of a worksheet from modification.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>password</strong> (<em>string</em>) – A worksheet password.</li>
<li><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary of worksheet options to protect.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">protect()</span></code> method is used to protect a worksheet from modification:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">protect</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">protect()</span></code> method also has the effect of enabling a cell’s <code class="docutils literal notranslate"><span class="pre">locked</span></code>
and <code class="docutils literal notranslate"><span class="pre">hidden</span></code> properties if they have been set. A <em>locked</em> cell cannot be
edited and this property is on by default for all cells. A <em>hidden</em> cell will
display the results of a formula but not the formula itself. These properties
can be set using the <a class="reference internal" href="index.html#set_locked" title="set_locked"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_locked()</span></code></a> and <a class="reference internal" href="index.html#set_hidden" title="set_hidden"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_hidden()</span></code></a> format methods.</p>
<p>You can optionally add a password to the worksheet protection:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">protect</span><span class="p">(</span><span class="s1">&#39;abc123&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Passing the empty string <code class="docutils literal notranslate"><span class="pre">''</span></code> is the same as turning on protection without a
password.</p>
<p>You can specify which worksheet elements you wish to protect by passing a
dictionary in the <code class="docutils literal notranslate"><span class="pre">options</span></code> argument with any or all of the following keys:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Default values shown.</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;objects&#39;</span><span class="p">:</span>               <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;scenarios&#39;</span><span class="p">:</span>             <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;format_cells&#39;</span><span class="p">:</span>          <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;format_columns&#39;</span><span class="p">:</span>        <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;format_rows&#39;</span><span class="p">:</span>           <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;insert_columns&#39;</span><span class="p">:</span>        <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;insert_rows&#39;</span><span class="p">:</span>           <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;insert_hyperlinks&#39;</span><span class="p">:</span>     <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;delete_columns&#39;</span><span class="p">:</span>        <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;delete_rows&#39;</span><span class="p">:</span>           <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;select_locked_cells&#39;</span><span class="p">:</span>   <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;sort&#39;</span><span class="p">:</span>                  <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;autofilter&#39;</span><span class="p">:</span>            <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;pivot_tables&#39;</span><span class="p">:</span>          <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;select_unlocked_cells&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The default boolean values are shown above. Individual elements can be
protected as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">protect</span><span class="p">(</span><span class="s1">&#39;abc123&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;insert_rows&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>For chartsheets the allowable options and default values are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;objects&#39;</span><span class="p">:</span>               <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;content&#39;</span><span class="p">:</span>               <span class="kc">True</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>See also the <a class="reference internal" href="index.html#set_locked" title="set_locked"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_locked()</span></code></a> and <a class="reference internal" href="index.html#set_hidden" title="set_hidden"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_hidden()</span></code></a> format methods and
<a class="reference internal" href="index.html#ex-protection"><span class="std std-ref">Example: Enabling Cell protection in Worksheets</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Worksheet level passwords in Excel offer very weak protection. They do not
encrypt your data and are very easy to deactivate. Full workbook encryption
is not supported by <code class="docutils literal notranslate"><span class="pre">XlsxWriter</span></code>. However, it is possible to encrypt an
XlsxWriter file using a third party open source tool called <a class="reference external" href="https://github.com/herumi/msoffice">msoffice-crypt</a>. This works for macOS, Linux and
Windows:</p>
<div class="last highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">msoffice</span><span class="o">-</span><span class="n">crypt</span><span class="o">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">e</span> <span class="o">-</span><span class="n">p</span> <span class="n">password</span> <span class="n">clear</span><span class="o">.</span><span class="n">xlsx</span> <span class="n">encrypted</span><span class="o">.</span><span class="n">xlsx</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="worksheet-set-default-row">
<h4>worksheet.set_default_row()</h4>
<dl class="function">
<dt id="set_default_row">
<code class="descname">set_default_row</code><span class="sig-paren">(</span><em>height</em>, <em>hide_unused_rows</em><span class="sig-paren">)</span></dt>
<dd><p>Set the default row properties.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Default height. Optional, defaults to 15.</li>
<li><strong>hide_unused_rows</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Hide unused rows. Optional, defaults to False.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_default_row()</span></code> method is used to set the limited number of default
row properties allowed by Excel which are the default height and the option to
hide unused rows. These parameters are an optimization used by Excel to set
row properties without generating a very large file with an entry for each row.</p>
<p>To set the default row height:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_default_row</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
<p>To hide unused rows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_default_row</span><span class="p">(</span><span class="n">hide_unused_rows</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#ex-hide-row-col"><span class="std std-ref">Example: Hiding Rows and Columns</span></a> for more details.</p>
</div>
<div class="section" id="worksheet-outline-settings">
<h4>worksheet.outline_settings()</h4>
<dl class="function">
<dt id="outline_settings">
<code class="descname">outline_settings</code><span class="sig-paren">(</span><em>visible</em>, <em>symbols_below</em>, <em>symbols_right</em>, <em>auto_style</em><span class="sig-paren">)</span></dt>
<dd><p>Control outline settings.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>visible</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Outlines are visible. Optional, defaults to True.</li>
<li><strong>symbols_below</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Show row outline symbols below the outline bar.
Optional, defaults to True.</li>
<li><strong>symbols_right</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Show column outline symbols to the right of the
outline bar. Optional, defaults to True.</li>
<li><strong>auto_style</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Use Automatic style. Optional, defaults to False.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">outline_settings()</span></code> method is used to control the appearance of outlines
in Excel. Outlines are described in <a class="reference internal" href="index.html#outlines"><span class="std std-ref">Working with Outlines and Grouping</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">outline_settings</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">'visible'</span></code> parameter is used to control whether or not outlines are
visible. Setting this parameter to <code class="docutils literal notranslate"><span class="pre">False</span></code> will cause all outlines on the
worksheet to be hidden. They can be un-hidden in Excel by means of the “Show
Outline Symbols” command button. The default setting is <code class="docutils literal notranslate"><span class="pre">True</span></code> for visible
outlines.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'symbols_below'</span></code> parameter is used to control whether the row outline
symbol will appear above or below the outline level bar. The default setting
is <code class="docutils literal notranslate"><span class="pre">True</span></code> for symbols to appear below the outline level bar.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'symbols_right'</span></code> parameter is used to control whether the column outline
symbol will appear to the left or the right of the outline level bar. The
default setting is <code class="docutils literal notranslate"><span class="pre">True</span></code> for symbols to appear to the right of the outline
level bar.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'auto_style'</span></code> parameter is used to control whether the automatic outline
generator in Excel uses automatic styles when creating an outline. This has no
effect on a file generated by <code class="docutils literal notranslate"><span class="pre">XlsxWriter</span></code> but it does have an effect on how
the worksheet behaves after it is created. The default setting is <code class="docutils literal notranslate"><span class="pre">False</span></code>
for “Automatic Styles” to be turned off.</p>
<p>The default settings for all of these parameters correspond to Excel’s default
parameters.</p>
<p>The worksheet parameters controlled by <code class="docutils literal notranslate"><span class="pre">outline_settings()</span></code> are rarely used.</p>
</div>
<div class="section" id="worksheet-set-vba-name">
<h4>worksheet.set_vba_name()</h4>
<dl class="function">
<dt>
<code class="descname">set_vba_name</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span></dt>
<dd><p>Set the VBA name for the worksheet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>string</em>) – The VBA name for the worksheet.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_vba_name()</span></code> method can be used to set the VBA codename for the
worksheet (there is a similar method for the workbook VBA name). This is
sometimes required when a vbaProject macro included via <code class="docutils literal notranslate"><span class="pre">add_vba_project()</span></code>
refers to the worksheet. The default Excel VBA name of <code class="docutils literal notranslate"><span class="pre">Sheet1</span></code>, etc., is
used if a user defined name isn’t specified.</p>
<p>See <a class="reference internal" href="index.html#macros"><span class="std std-ref">Working with VBA Macros</span></a> for more details.</p>
</div>
</div>
<span id="document-page_setup"></span><div class="section" id="the-worksheet-class-page-setup">
<span id="page-setup"></span><h3>The Worksheet Class (Page Setup)</h3>
<p>Page set-up methods affect the way that a worksheet looks to the user or when
it is printed. They control features such as paper size, orientation, page
headers and margins and gridlines.</p>
<p>These methods are really just standard <a class="reference internal" href="index.html#worksheet"><span class="std std-ref">worksheet</span></a> methods.
They are documented separately for the sake of clarity.</p>
<div class="section" id="worksheet-set-landscape">
<h4>worksheet.set_landscape()</h4>
<dl class="function">
<dt id="set_landscape">
<code class="descname">set_landscape</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Set the page orientation as landscape.</p>
</dd></dl>

<p>This method is used to set the orientation of a worksheet’s printed page to
landscape:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_landscape</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="worksheet-set-portrait">
<h4>worksheet.set_portrait()</h4>
<dl class="function">
<dt id="set_portrait">
<code class="descname">set_portrait</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Set the page orientation as portrait.</p>
</dd></dl>

<p>This method is used to set the orientation of a worksheet’s printed page to
portrait. The default worksheet orientation is portrait, so you won’t
generally need to call this method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_portrait</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="worksheet-set-page-view">
<h4>worksheet.set_page_view()</h4>
<dl class="function">
<dt id="set_page_view">
<code class="descname">set_page_view</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Set the page view mode.</p>
</dd></dl>

<p>This method is used to display the worksheet in “Page View/Layout” mode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_page_view</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="worksheet-set-paper">
<h4>worksheet.set_paper()</h4>
<dl class="function">
<dt id="set_paper">
<code class="descname">set_paper</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span></dt>
<dd><p>Set the paper type.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The Excel paper format index.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>This method is used to set the paper format for the printed output of a
worksheet. The following paper styles are available:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="46%" />
<col width="40%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Index</th>
<th class="head">Paper format</th>
<th class="head">Paper size</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>Printer default</td>
<td>Printer default</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>Letter</td>
<td>8 1/2 x 11 in</td>
</tr>
<tr class="row-even"><td>2</td>
<td>Letter Small</td>
<td>8 1/2 x 11 in</td>
</tr>
<tr class="row-odd"><td>3</td>
<td>Tabloid</td>
<td>11 x 17 in</td>
</tr>
<tr class="row-even"><td>4</td>
<td>Ledger</td>
<td>17 x 11 in</td>
</tr>
<tr class="row-odd"><td>5</td>
<td>Legal</td>
<td>8 1/2 x 14 in</td>
</tr>
<tr class="row-even"><td>6</td>
<td>Statement</td>
<td>5 1/2 x 8 1/2 in</td>
</tr>
<tr class="row-odd"><td>7</td>
<td>Executive</td>
<td>7 1/4 x 10 1/2 in</td>
</tr>
<tr class="row-even"><td>8</td>
<td>A3</td>
<td>297 x 420 mm</td>
</tr>
<tr class="row-odd"><td>9</td>
<td>A4</td>
<td>210 x 297 mm</td>
</tr>
<tr class="row-even"><td>10</td>
<td>A4 Small</td>
<td>210 x 297 mm</td>
</tr>
<tr class="row-odd"><td>11</td>
<td>A5</td>
<td>148 x 210 mm</td>
</tr>
<tr class="row-even"><td>12</td>
<td>B4</td>
<td>250 x 354 mm</td>
</tr>
<tr class="row-odd"><td>13</td>
<td>B5</td>
<td>182 x 257 mm</td>
</tr>
<tr class="row-even"><td>14</td>
<td>Folio</td>
<td>8 1/2 x 13 in</td>
</tr>
<tr class="row-odd"><td>15</td>
<td>Quarto</td>
<td>215 x 275 mm</td>
</tr>
<tr class="row-even"><td>16</td>
<td>—</td>
<td>10x14 in</td>
</tr>
<tr class="row-odd"><td>17</td>
<td>—</td>
<td>11x17 in</td>
</tr>
<tr class="row-even"><td>18</td>
<td>Note</td>
<td>8 1/2 x 11 in</td>
</tr>
<tr class="row-odd"><td>19</td>
<td>Envelope 9</td>
<td>3 7/8 x 8 7/8</td>
</tr>
<tr class="row-even"><td>20</td>
<td>Envelope 10</td>
<td>4 1/8 x 9 1/2</td>
</tr>
<tr class="row-odd"><td>21</td>
<td>Envelope 11</td>
<td>4 1/2 x 10 3/8</td>
</tr>
<tr class="row-even"><td>22</td>
<td>Envelope 12</td>
<td>4 3/4 x 11</td>
</tr>
<tr class="row-odd"><td>23</td>
<td>Envelope 14</td>
<td>5 x 11 1/2</td>
</tr>
<tr class="row-even"><td>24</td>
<td>C size sheet</td>
<td>—</td>
</tr>
<tr class="row-odd"><td>25</td>
<td>D size sheet</td>
<td>—</td>
</tr>
<tr class="row-even"><td>26</td>
<td>E size sheet</td>
<td>—</td>
</tr>
<tr class="row-odd"><td>27</td>
<td>Envelope DL</td>
<td>110 x 220 mm</td>
</tr>
<tr class="row-even"><td>28</td>
<td>Envelope C3</td>
<td>324 x 458 mm</td>
</tr>
<tr class="row-odd"><td>29</td>
<td>Envelope C4</td>
<td>229 x 324 mm</td>
</tr>
<tr class="row-even"><td>30</td>
<td>Envelope C5</td>
<td>162 x 229 mm</td>
</tr>
<tr class="row-odd"><td>31</td>
<td>Envelope C6</td>
<td>114 x 162 mm</td>
</tr>
<tr class="row-even"><td>32</td>
<td>Envelope C65</td>
<td>114 x 229 mm</td>
</tr>
<tr class="row-odd"><td>33</td>
<td>Envelope B4</td>
<td>250 x 353 mm</td>
</tr>
<tr class="row-even"><td>34</td>
<td>Envelope B5</td>
<td>176 x 250 mm</td>
</tr>
<tr class="row-odd"><td>35</td>
<td>Envelope B6</td>
<td>176 x 125 mm</td>
</tr>
<tr class="row-even"><td>36</td>
<td>Envelope</td>
<td>110 x 230 mm</td>
</tr>
<tr class="row-odd"><td>37</td>
<td>Monarch</td>
<td>3.875 x 7.5 in</td>
</tr>
<tr class="row-even"><td>38</td>
<td>Envelope</td>
<td>3 5/8 x 6 1/2 in</td>
</tr>
<tr class="row-odd"><td>39</td>
<td>Fanfold</td>
<td>14 7/8 x 11 in</td>
</tr>
<tr class="row-even"><td>40</td>
<td>German Std Fanfold</td>
<td>8 1/2 x 12 in</td>
</tr>
<tr class="row-odd"><td>41</td>
<td>German Legal Fanfold</td>
<td>8 1/2 x 13 in</td>
</tr>
</tbody>
</table>
<p>Note, it is likely that not all of these paper types will be available to the
end user since it will depend on the paper formats that the user’s printer
supports. Therefore, it is best to stick to standard paper types:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_paper</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># US Letter</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_paper</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>  <span class="c1"># A4</span>
</pre></div>
</div>
<p>If you do not specify a paper type the worksheet will print using the printer’s
default paper style.</p>
</div>
<div class="section" id="worksheet-center-horizontally">
<h4>worksheet.center_horizontally()</h4>
<dl class="function">
<dt id="center_horizontally">
<code class="descname">center_horizontally</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Center the printed page horizontally.</p>
</dd></dl>

<p>Center the worksheet data horizontally between the margins on the printed page:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">center_horizontally</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="worksheet-center-vertically">
<h4>worksheet.center_vertically()</h4>
<dl class="function">
<dt id="center_vertically">
<code class="descname">center_vertically</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Center the printed page vertically.</p>
</dd></dl>

<p>Center the worksheet data vertically between the margins on the printed page:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">center_vertically</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="worksheet-set-margins">
<h4>worksheet.set_margins()</h4>
<dl class="function">
<dt id="set_margins">
<code class="descname">set_margins</code><span class="sig-paren">(</span><em>[left=0.7,] right=0.7,] top=0.75,] bottom=0.75]]]</em><span class="sig-paren">)</span></dt>
<dd><p>Set the worksheet margins for the printed page.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>left</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Left margin in inches. Default 0.7.</li>
<li><strong>right</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Right margin in inches. Default 0.7.</li>
<li><strong>top</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Top margin in inches. Default 0.75.</li>
<li><strong>bottom</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Bottom margin in inches. Default 0.75.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_margins()</span></code> method is used to set the margins of the worksheet when
it is printed. The units are in inches. All parameters are optional and have
default values corresponding to the default Excel values.</p>
</div>
<div class="section" id="worksheet-set-header">
<h4>worksheet.set_header()</h4>
<dl class="function">
<dt id="set_header">
<code class="descname">set_header</code><span class="sig-paren">(</span><em>[header='',] options]]</em><span class="sig-paren">)</span></dt>
<dd><p>Set the printed page header caption and options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>header</strong> (<em>string</em>) – Header string with Excel control characters.</li>
<li><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Header options.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Headers and footers are generated using a string which is a combination of
plain text and control characters.</p>
<p>The available control character are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="28%" />
<col width="43%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Control</th>
<th class="head">Category</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&amp;L</td>
<td>Justification</td>
<td>Left</td>
</tr>
<tr class="row-odd"><td>&amp;C</td>
<td>&#160;</td>
<td>Center</td>
</tr>
<tr class="row-even"><td>&amp;R</td>
<td>&#160;</td>
<td>Right</td>
</tr>
<tr class="row-odd"><td>&amp;P</td>
<td>Information</td>
<td>Page number</td>
</tr>
<tr class="row-even"><td>&amp;N</td>
<td>&#160;</td>
<td>Total number of pages</td>
</tr>
<tr class="row-odd"><td>&amp;D</td>
<td>&#160;</td>
<td>Date</td>
</tr>
<tr class="row-even"><td>&amp;T</td>
<td>&#160;</td>
<td>Time</td>
</tr>
<tr class="row-odd"><td>&amp;F</td>
<td>&#160;</td>
<td>File name</td>
</tr>
<tr class="row-even"><td>&amp;A</td>
<td>&#160;</td>
<td>Worksheet name</td>
</tr>
<tr class="row-odd"><td>&amp;Z</td>
<td>&#160;</td>
<td>Workbook path</td>
</tr>
<tr class="row-even"><td>&amp;fontsize</td>
<td>Font</td>
<td>Font size</td>
</tr>
<tr class="row-odd"><td>&amp;”font,style”</td>
<td>&#160;</td>
<td>Font name and style</td>
</tr>
<tr class="row-even"><td>&amp;U</td>
<td>&#160;</td>
<td>Single underline</td>
</tr>
<tr class="row-odd"><td>&amp;E</td>
<td>&#160;</td>
<td>Double underline</td>
</tr>
<tr class="row-even"><td>&amp;S</td>
<td>&#160;</td>
<td>Strikethrough</td>
</tr>
<tr class="row-odd"><td>&amp;X</td>
<td>&#160;</td>
<td>Superscript</td>
</tr>
<tr class="row-even"><td>&amp;Y</td>
<td>&#160;</td>
<td>Subscript</td>
</tr>
<tr class="row-odd"><td>&amp;[Picture]</td>
<td>Images</td>
<td>Image placeholder</td>
</tr>
<tr class="row-even"><td>&amp;G</td>
<td>&#160;</td>
<td>Same as &amp;[Picture]</td>
</tr>
</tbody>
</table>
<p>Text in headers and footers can be justified (aligned) to the left, center and
right by prefixing the text with the control characters <code class="docutils literal notranslate"><span class="pre">&amp;L</span></code>, <code class="docutils literal notranslate"><span class="pre">&amp;C</span></code> and
<code class="docutils literal notranslate"><span class="pre">&amp;R</span></code>.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>worksheet.set_header(&#39;&amp;LHello&#39;)

    ---------------------------------------------------------------
   |                                                               |
   | Hello                                                         |
   |                                                               |


$worksheet-&gt;set_header(&#39;&amp;CHello&#39;);

    ---------------------------------------------------------------
   |                                                               |
   |                          Hello                                |
   |                                                               |


$worksheet-&gt;set_header(&#39;&amp;RHello&#39;);

    ---------------------------------------------------------------
   |                                                               |
   |                                                         Hello |
   |                                                               |
</pre></div>
</div>
<p>For simple text, if you do not specify any justification the text will be
centered. However, you must prefix the text with <code class="docutils literal notranslate"><span class="pre">&amp;C</span></code> if you specify a font
name or any other formatting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;Hello&#39;</span><span class="p">)</span>

    <span class="o">---------------------------------------------------------------</span>
   <span class="o">|</span>                                                               <span class="o">|</span>
   <span class="o">|</span>                          <span class="n">Hello</span>                                <span class="o">|</span>
   <span class="o">|</span>                                                               <span class="o">|</span>
</pre></div>
</div>
<p>You can have text in each of the justification regions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;&amp;LCiao&amp;CBello&amp;RCielo&#39;</span><span class="p">)</span>

    <span class="o">---------------------------------------------------------------</span>
   <span class="o">|</span>                                                               <span class="o">|</span>
   <span class="o">|</span> <span class="n">Ciao</span>                     <span class="n">Bello</span>                          <span class="n">Cielo</span> <span class="o">|</span>
   <span class="o">|</span>                                                               <span class="o">|</span>
</pre></div>
</div>
<p>The information control characters act as variables that Excel will update as
the workbook or worksheet changes. Times and dates are in the users default
format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;&amp;CPage &amp;P of &amp;N&#39;</span><span class="p">)</span>

    <span class="o">---------------------------------------------------------------</span>
   <span class="o">|</span>                                                               <span class="o">|</span>
   <span class="o">|</span>                        <span class="n">Page</span> <span class="mi">1</span> <span class="n">of</span> <span class="mi">6</span>                            <span class="o">|</span>
   <span class="o">|</span>                                                               <span class="o">|</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;&amp;CUpdated at &amp;T&#39;</span><span class="p">)</span>

    <span class="o">---------------------------------------------------------------</span>
   <span class="o">|</span>                                                               <span class="o">|</span>
   <span class="o">|</span>                    <span class="n">Updated</span> <span class="n">at</span> <span class="mi">12</span><span class="p">:</span><span class="mi">30</span> <span class="n">PM</span>                        <span class="o">|</span>
   <span class="o">|</span>                                                               <span class="o">|</span>
</pre></div>
</div>
<p>Images can be inserted using the <code class="docutils literal notranslate"><span class="pre">options</span></code> shown below. Each image must
have a placeholder in header string using the <code class="docutils literal notranslate"><span class="pre">&amp;[Picture]</span></code> or <code class="docutils literal notranslate"><span class="pre">&amp;G</span></code>
control characters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;&amp;L&amp;G&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;image_left&#39;</span><span class="p">:</span> <span class="s1">&#39;logo.jpg&#39;</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/header_image.png" src="_images/header_image.png" />
<p>You can specify the font size of a section of the text by prefixing it with the
control character <code class="docutils literal notranslate"><span class="pre">&amp;n</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the font size:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;&amp;C&amp;30Hello Big&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;&amp;C&amp;10Hello Small&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can specify the font of a section of the text by prefixing it with the
control sequence <code class="docutils literal notranslate"><span class="pre">&amp;&quot;font,style&quot;</span></code> where <code class="docutils literal notranslate"><span class="pre">fontname</span></code> is a font name such as
“Courier New” or “Times New Roman” and <code class="docutils literal notranslate"><span class="pre">style</span></code> is one of the standard
Windows font descriptions: “Regular”, “Italic”, “Bold” or “Bold Italic”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;&amp;C&amp;&quot;Courier New,Italic&quot;Hello&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;&amp;C&amp;&quot;Courier New,Bold Italic&quot;Hello&#39;</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;&amp;C&amp;&quot;Times New Roman,Regular&quot;Hello&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>It is possible to combine all of these features together to create
sophisticated headers and footers. As an aid to setting up complicated headers
and footers you can record a page set-up as a macro in Excel and look at the
format strings that VBA produces. Remember however that VBA uses two double
quotes <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> to indicate a single double quote. For the last example above
the equivalent VBA code looks like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span><span class="n">LeftHeader</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="o">.</span><span class="n">CenterHeader</span> <span class="o">=</span> <span class="s2">&quot;&amp;&quot;&quot;Times New Roman,Regular&quot;&quot;Hello&quot;</span>
<span class="o">.</span><span class="n">RightHeader</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
<p>Alternatively you can inspect the header and footer strings in an Excel file
by unzipping it and grepping the XML sub-files. The following shows how to do
that using <a class="reference external" href="http://xmlsoft.org/xmllint.html">libxml’s xmllint</a> to format the
XML for clarity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ unzip myfile.xlsm -d myfile
$ xmllint --format `find myfile -name &quot;*.xml&quot; | xargs` | egrep &quot;Header|Footer&quot;

  &lt;headerFooter scaleWithDoc=&quot;0&quot;&gt;
    &lt;oddHeader&gt;&amp;amp;L&amp;amp;P&lt;/oddHeader&gt;
  &lt;/headerFooter&gt;
</pre></div>
</div>
<p>Note that in this case you need to unescape the Html. In the above example the
header string would be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;&amp;L&amp;P&#39;</span>
</pre></div>
</div>
<p>To include a single literal ampersand <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> in a header or footer you should
use a double ampersand <code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;&amp;CCuriouser &amp;&amp; Curiouser - Attorneys at Law&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The available options are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">margin</span></code>: (float) Header margin in inches. Defaults to 0.3 inch.</li>
<li><code class="docutils literal notranslate"><span class="pre">image_left</span></code>: (string) The path to the image. Needs <code class="docutils literal notranslate"><span class="pre">&amp;G</span></code> placeholder.</li>
<li><code class="docutils literal notranslate"><span class="pre">image_center</span></code>: (string) Same as above.</li>
<li><code class="docutils literal notranslate"><span class="pre">image_right</span></code>: (string) Same as above.</li>
<li><code class="docutils literal notranslate"><span class="pre">image_data_left</span></code>: (BytesIO) A byte stream of the image data.</li>
<li><code class="docutils literal notranslate"><span class="pre">image_data_center</span></code>: (BytesIO) Same as above.</li>
<li><code class="docutils literal notranslate"><span class="pre">image_data_right</span></code>: (BytesIO) Same as above.</li>
<li><code class="docutils literal notranslate"><span class="pre">scale_with_doc</span></code>: (boolean) Scale header with document. Defaults to True.</li>
<li><code class="docutils literal notranslate"><span class="pre">align_with_margins</span></code>: (boolean) Align header to margins. Defaults to True.</li>
</ul>
<p>As with the other margins the <code class="docutils literal notranslate"><span class="pre">margin</span></code> value should be in inches. The
default header and footer margin is 0.3 inch. It can be changed as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;&amp;CHello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;margin&#39;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">})</span>
</pre></div>
</div>
<p>The header and footer margins are independent of, and should not be confused
with, the top and bottom worksheet margins.</p>
<p>The image options must have an accompanying <code class="docutils literal notranslate"><span class="pre">&amp;[Picture]</span></code> or <code class="docutils literal notranslate"><span class="pre">&amp;G</span></code> control
character in the header string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;&amp;L&amp;[Picture]&amp;C&amp;[Picture]&amp;R&amp;[Picture]&#39;</span><span class="p">,</span>
                     <span class="p">{</span><span class="s1">&#39;image_left&#39;</span><span class="p">:</span>   <span class="s1">&#39;red.jpg&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;image_center&#39;</span><span class="p">:</span> <span class="s1">&#39;blue.jpg&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;image_right&#39;</span><span class="p">:</span>  <span class="s1">&#39;yellow.jpg&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">image_data_</span></code> parameters are used to add an in-memory byte stream in
<a class="reference external" href="https://docs.python.org/3/library/io.html#io.BytesIO" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">io.BytesIO</span></code></a> format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">image_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;logo.jpg&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
<span class="n">image_data</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">image_file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="s1">&#39;&amp;L&amp;G&#39;</span><span class="p">,</span>
                     <span class="p">{</span><span class="s1">&#39;image_left&#39;</span><span class="p">:</span> <span class="s1">&#39;logo.jpg&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;image_data_left&#39;</span><span class="p">:</span> <span class="n">image_data</span><span class="p">})</span>
</pre></div>
</div>
<p>When using the <code class="docutils literal notranslate"><span class="pre">image_data_</span></code> parameters a filename must still be passed to
to the equivalent <code class="docutils literal notranslate"><span class="pre">image_</span></code> parameter since it is required by Excel. See also
<a class="reference internal" href="index.html#insert_image" title="insert_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_image()</span></code></a> for details on handling images from byte streams.</p>
<p>Note, Excel does not allow header or footer strings longer than 255 characters,
including control characters. Strings longer than this will not be written
and an exception will be thrown.</p>
<p>See also <a class="reference internal" href="index.html#ex-headers-footers"><span class="std std-ref">Example: Adding Headers and Footers to Worksheets</span></a>.</p>
</div>
<div class="section" id="worksheet-set-footer">
<h4>worksheet.set_footer()</h4>
<dl class="function">
<dt id="set_footer">
<code class="descname">set_footer</code><span class="sig-paren">(</span><em>[footer='',] options]]</em><span class="sig-paren">)</span></dt>
<dd><p>Set the printed page footer caption and options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>footer</strong> (<em>string</em>) – Footer string with Excel control characters.</li>
<li><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Footer options.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The syntax of the <code class="docutils literal notranslate"><span class="pre">set_footer()</span></code> method is the same as <a class="reference internal" href="#set_header" title="set_header"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_header()</span></code></a>.</p>
</div>
<div class="section" id="worksheet-repeat-rows">
<h4>worksheet.repeat_rows()</h4>
<dl class="function">
<dt id="repeat_rows">
<code class="descname">repeat_rows</code><span class="sig-paren">(</span><em>first_row</em><span class="optional">[</span>, <em>last_row</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Set the number of rows to repeat at the top of each printed page.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>first_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – First row of repeat range.</li>
<li><strong>last_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Last row of repeat range. Optional.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>For large Excel documents it is often desirable to have the first row or rows
of the worksheet print out at the top of each page.</p>
<p>This can be achieved by using the <code class="docutils literal notranslate"><span class="pre">repeat_rows()</span></code> method. The parameters
<code class="docutils literal notranslate"><span class="pre">first_row</span></code> and <code class="docutils literal notranslate"><span class="pre">last_row</span></code> are zero based. The <code class="docutils literal notranslate"><span class="pre">last_row</span></code> parameter is
optional if you only wish to specify one row:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">repeat_rows</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>     <span class="c1"># Repeat the first row.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">repeat_rows</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Repeat the first two rows.</span>
</pre></div>
</div>
</div>
<div class="section" id="worksheet-repeat-columns">
<h4>worksheet.repeat_columns()</h4>
<dl class="function">
<dt id="repeat_columns">
<code class="descname">repeat_columns</code><span class="sig-paren">(</span><em>first_col</em><span class="optional">[</span>, <em>last_col</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Set the columns to repeat at the left hand side of each printed page.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>first_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – First column of repeat range.</li>
<li><strong>last_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Last column of repeat range. Optional.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>For large Excel documents it is often desirable to have the first column or
columns of the worksheet print out at the left hand side of each page.</p>
<p>This can be achieved by using the <code class="docutils literal notranslate"><span class="pre">repeat_columns()</span></code> method. The parameters
<code class="docutils literal notranslate"><span class="pre">first_column</span></code> and <code class="docutils literal notranslate"><span class="pre">last_column</span></code> are zero based. The <code class="docutils literal notranslate"><span class="pre">last_column</span></code>
parameter is optional if you only wish to specify one column. You can also
specify the columns using A1 column notation, see <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a> for
more details.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">repeat_columns</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>      <span class="c1"># Repeat the first column.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">repeat_columns</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># Repeat the first two columns.</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">repeat_columns</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">)</span>  <span class="c1"># Repeat the first column.</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">repeat_columns</span><span class="p">(</span><span class="s1">&#39;A:B&#39;</span><span class="p">)</span>  <span class="c1"># Repeat the first two columns.</span>
</pre></div>
</div>
</div>
<div class="section" id="worksheet-hide-gridlines">
<h4>worksheet.hide_gridlines()</h4>
<dl class="function">
<dt id="hide_gridlines">
<code class="descname">hide_gridlines</code><span class="sig-paren">(</span><span class="optional">[</span><em>option=1</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Set the option to hide gridlines on the screen and the printed page.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>option</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Hide gridline options. See below.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>This method is used to hide the gridlines on the screen and printed page.
Gridlines are the lines that divide the cells on a worksheet. Screen and
printed gridlines are turned on by default in an Excel worksheet.</p>
<p>If you have defined your own cell borders you may wish to hide the default
gridlines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">hide_gridlines</span><span class="p">()</span>
</pre></div>
</div>
<p>The following values of <code class="docutils literal notranslate"><span class="pre">option</span></code> are valid:</p>
<ol class="arabic simple" start="0">
<li>Don’t hide gridlines.</li>
<li>Hide printed gridlines only.</li>
<li>Hide screen and printed gridlines.</li>
</ol>
<p>If you don’t supply an argument the default option is 1, i.e. only the printed
gridlines are hidden.</p>
</div>
<div class="section" id="worksheet-print-row-col-headers">
<h4>worksheet.print_row_col_headers()</h4>
<dl class="function">
<dt id="print_row_col_headers">
<code class="descname">print_row_col_headers</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Set the option to print the row and column headers on the printed page.</p>
</dd></dl>

<p>When you print a worksheet from Excel you get the data selected in the print
area. By default the Excel row and column headers (the row numbers on the left
and the column letters at the top) aren’t printed.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">print_row_col_headers()</span></code> method sets the printer option to print these
headers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">print_row_col_headers</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="worksheet-hide-row-col-headers">
<h4>worksheet.hide_row_col_headers()</h4>
<dl class="function">
<dt id="hide_row_col_headers">
<code class="descname">hide_row_col_headers</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Set the option to hide the row and column headers in a worksheet.</p>
</dd></dl>

<p>This method is similar to the <code class="docutils literal notranslate"><span class="pre">print_row_col_headers()</span></code> except that it hides
the row and column headers on the worksheet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">hide_row_col_headers</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/hide_row_col_headers.png" src="_images/hide_row_col_headers.png" />
</div>
<div class="section" id="worksheet-print-area">
<h4>worksheet.print_area()</h4>
<dl class="function">
<dt id="print_area">
<code class="descname">print_area</code><span class="sig-paren">(</span><em>first_row</em>, <em>first_col</em>, <em>last_row</em>, <em>last_col</em><span class="sig-paren">)</span></dt>
<dd><p>Set the print area in the current worksheet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>first_row</strong> (<em>integer</em>) – The first row of the range. (All zero indexed.)</li>
<li><strong>first_col</strong> (<em>integer</em>) – The first column of the range.</li>
<li><strong>last_row</strong> (<em>integer</em>) – The last row of the range.</li>
<li><strong>last_col</strong> (<em>integer</em>) – The last col of the range.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">0: Success.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">-1: Row or column is out of worksheet bounds.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>This method is used to specify the area of the worksheet that will be printed.</p>
<p>All four parameters must be specified. You can also use A1 notation, see
<a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">print_area</span><span class="p">(</span><span class="s1">&#39;A1:H20&#39;</span><span class="p">)</span>     <span class="c1"># Cells A1 to H20.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">print_area</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>  <span class="c1"># The same as above.</span>
</pre></div>
</div>
<p>In order to set a row or column range you must specify the entire range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet3</span><span class="o">.</span><span class="n">print_area</span><span class="p">(</span><span class="s1">&#39;A1:H1048576&#39;</span><span class="p">)</span>  <span class="c1"># Same as A:H.</span>
</pre></div>
</div>
</div>
<div class="section" id="worksheet-print-across">
<h4>worksheet.print_across()</h4>
<dl class="function">
<dt id="print_across">
<code class="descname">print_across</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Set the order in which pages are printed.</p>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">print_across</span></code> method is used to change the default print direction. This
is referred to by Excel as the sheet “page order”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">print_across</span><span class="p">()</span>
</pre></div>
</div>
<p>The default page order is shown below for a worksheet that extends over 4
pages. The order is called “down then across”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
<p>However, by using the <code class="docutils literal notranslate"><span class="pre">print_across</span></code> method the print order will be changed
to “across then down”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="worksheet-fit-to-pages">
<h4>worksheet.fit_to_pages()</h4>
<dl class="function">
<dt id="fit_to_pages">
<code class="descname">fit_to_pages</code><span class="sig-paren">(</span><em>width</em>, <em>height</em><span class="sig-paren">)</span></dt>
<dd><p>Fit the printed area to a specific number of pages both vertically and
horizontally.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of pages horizontally.</li>
<li><strong>height</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of pages vertically.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">fit_to_pages()</span></code> method is used to fit the printed area to a specific
number of pages both vertically and horizontally. If the printed area exceeds
the specified number of pages it will be scaled down to fit. This ensures that
the printed area will always appear on the specified number of pages even if
the page size or margins change:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">fit_to_pages</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Fit to 1x1 pages.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">fit_to_pages</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Fit to 2x1 pages.</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">fit_to_pages</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Fit to 1x2 pages.</span>
</pre></div>
</div>
<p>The print area can be defined using the <code class="docutils literal notranslate"><span class="pre">print_area()</span></code> method as described
above.</p>
<p>A common requirement is to fit the printed output to <code class="docutils literal notranslate"><span class="pre">n</span></code> pages wide but have
the height be as long as necessary. To achieve this set the <code class="docutils literal notranslate"><span class="pre">height</span></code> to
zero:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">fit_to_pages</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># 1 page wide and as long as necessary.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although it is valid to use both <a class="reference internal" href="#fit_to_pages" title="fit_to_pages"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_to_pages()</span></code></a> and
<a class="reference internal" href="#set_print_scale" title="set_print_scale"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_print_scale()</span></code></a> on the same worksheet in Excel only allows one of
these options to be active at a time. The last method call made will set
the active option.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="#fit_to_pages" title="fit_to_pages"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_to_pages()</span></code></a> will override any manual page breaks that are
defined in the worksheet.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When using <a class="reference internal" href="#fit_to_pages" title="fit_to_pages"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_to_pages()</span></code></a> it may also be required to set the
printer paper size using <a class="reference internal" href="#set_paper" title="set_paper"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_paper()</span></code></a> or else Excel will default
to “US Letter”.</p>
</div>
</div>
<div class="section" id="worksheet-set-start-page">
<h4>worksheet.set_start_page()</h4>
<dl class="function">
<dt id="set_start_page">
<code class="descname">set_start_page</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Set the start page number when printing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>start_page</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Starting page number.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_start_page()</span></code> method is used to set the number of the starting page
when the worksheet is printed out:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start print from page 2.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_start_page</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="worksheet-set-print-scale">
<h4>worksheet.set_print_scale()</h4>
<dl class="function">
<dt id="set_print_scale">
<code class="descname">set_print_scale</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Set the scale factor for the printed page.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Print scale of worksheet to be printed.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Set the scale factor of the printed page. Scale factors in the range
<code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">&lt;=</span> <span class="pre">$scale</span> <span class="pre">&lt;=</span> <span class="pre">400</span></code> are valid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">set_print_scale</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_print_scale</span><span class="p">(</span><span class="mi">75</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_print_scale</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_print_scale</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
</pre></div>
</div>
<p>The default scale factor is 100. Note, <code class="docutils literal notranslate"><span class="pre">set_print_scale()</span></code> does not affect
the scale of the visible page in Excel. For that you should use
<a class="reference internal" href="index.html#set_zoom" title="set_zoom"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_zoom()</span></code></a>.</p>
<p>Note also that although it is valid to use both <code class="docutils literal notranslate"><span class="pre">fit_to_pages()</span></code> and
<code class="docutils literal notranslate"><span class="pre">set_print_scale()</span></code> on the same worksheet Excel only allows one of these
options to be active at a time. The last method call made will set the active
option.</p>
</div>
<div class="section" id="worksheet-set-h-pagebreaks">
<h4>worksheet.set_h_pagebreaks()</h4>
<dl class="function">
<dt id="set_h_pagebreaks">
<code class="descname">set_h_pagebreaks</code><span class="sig-paren">(</span><em>breaks</em><span class="sig-paren">)</span></dt>
<dd><p>Set the horizontal page breaks on a worksheet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>breaks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – List of page break rows.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_h_pagebreaks()</span></code> method adds horizontal page breaks to a worksheet. A
page break causes all the data that follows it to be printed on the next page.
Horizontal page breaks act between rows.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">set_h_pagebreaks()</span></code> method takes a list of one or more page breaks:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet1</span><span class="o">.</span><span class="n">set_v_pagebreaks</span><span class="p">([</span><span class="mi">20</span><span class="p">])</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_v_pagebreaks</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
</pre></div>
</div>
<p>To create a page break between rows 20 and 21 you must specify the break at row
21. However in zero index notation this is actually row 20. So you can pretend
for a small while that you are using 1 index notation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_h_pagebreaks</span><span class="p">([</span><span class="mi">20</span><span class="p">])</span>  <span class="c1"># Break between row 20 and 21.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note: If you specify the “fit to page” option via the <code class="docutils literal notranslate"><span class="pre">fit_to_pages()</span></code>
method it will override all manual page breaks.</p>
</div>
<p>There is a silent limitation of 1023 horizontal page breaks per worksheet in
line with an Excel internal limitation.</p>
</div>
<div class="section" id="worksheet-set-v-pagebreaks">
<h4>worksheet.set_v_pagebreaks()</h4>
<dl class="function">
<dt id="set_v_pagebreaks">
<code class="descname">set_v_pagebreaks</code><span class="sig-paren">(</span><em>breaks</em><span class="sig-paren">)</span></dt>
<dd><p>Set the vertical page breaks on a worksheet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>breaks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – List of page break columns.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_v_pagebreaks()</span></code> method is the same as the above
<a class="reference internal" href="#set_h_pagebreaks" title="set_h_pagebreaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_h_pagebreaks()</span></code></a> method except it adds page breaks between columns.</p>
</div>
</div>
<span id="document-format"></span><div class="section" id="the-format-class">
<span id="format"></span><h3>The Format Class</h3>
<p>This section describes the methods and properties that are available for
formatting cells in Excel.</p>
<p>The properties of a cell that can be formatted include: fonts, colors,
patterns, borders, alignment and number formatting.</p>
<img alt="_images/formats_intro.png" src="_images/formats_intro.png" />
<div class="section" id="creating-and-using-a-format-object">
<h4>Creating and using a Format object</h4>
<p>Cell formatting is defined through a Format object. Format objects are created
by calling the workbook <a class="reference internal" href="index.html#add_format" title="add_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_format()</span></code></a> method as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>       <span class="c1"># Set properties later.</span>
<span class="n">cell_format2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">(</span><span class="n">props</span><span class="p">)</span>  <span class="c1"># Set properties at creation.</span>
</pre></div>
</div>
<p>There are two ways of setting Format properties: by using the object interface
or by setting the property as a dictionary of key/value pairs in the
constructor. For example, a typical use of the object interface would be as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>
<span class="n">cell_format</span><span class="o">.</span><span class="n">set_bold</span><span class="p">()</span>
<span class="n">cell_format</span><span class="o">.</span><span class="n">set_font_color</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>By comparison the properties can be set by passing a dictionary of properties
to the <a class="reference internal" href="index.html#add_format" title="add_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_format()</span></code></a> constructor:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>In general the key/value interface is more flexible and clearer than the
object method and is the recommended method for setting format
properties. However, both methods produce the same result.</p>
<p>Once a Format object has been constructed and its properties have been set it
can be passed as an argument to the worksheet <a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> methods as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write</span>       <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Foo&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Bar&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_number</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span>     <span class="n">cell_format</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_blank</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>    <span class="n">cell_format</span><span class="p">)</span>
</pre></div>
</div>
<p>Formats can also be passed to the worksheet <a class="reference internal" href="index.html#set_row" title="set_row"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_row()</span></code></a> and
<a class="reference internal" href="index.html#set_column" title="set_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_column()</span></code></a> methods to define the default formatting properties for a
row or column:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:D&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="format-defaults">
<h4>Format Defaults</h4>
<p>The default Excel 2007+ cell format is Calibri 11 with all other properties off.</p>
<p>In general a format method call without an argument will turn a property on,
for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>

<span class="n">cell_format</span><span class="o">.</span><span class="n">set_bold</span><span class="p">()</span>      <span class="c1"># Turns bold on.</span>
<span class="n">cell_format</span><span class="o">.</span><span class="n">set_bold</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Also turns bold on.</span>
</pre></div>
</div>
<p>Since most properties are already off by default it isn’t generally required to
turn them off. However, it is possible if required:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span><span class="o">.</span><span class="n">set_bold</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Turns bold off.</span>
</pre></div>
</div>
</div>
<div class="section" id="modifying-formats">
<h4>Modifying Formats</h4>
<p>Each unique cell format in an XlsxWriter spreadsheet must have a corresponding
Format object. It isn’t possible to use a Format with a <a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method
and then redefine it for use at a later stage. This is because a Format is
applied to a cell not in its current state but in its final state. Consider
the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Cell A1&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>

<span class="c1"># Later...</span>
<span class="n">cell_format</span><span class="o">.</span><span class="n">set_font_color</span><span class="p">(</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;Cell B1&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
</pre></div>
</div>
<p>Cell A1 is assigned a format which initially has the font set to the color
red. However, the color is subsequently set to green. When Excel displays
Cell A1 it will display the final state of the Format which in this case will
be the color green.</p>
</div>
<div class="section" id="number-format-categories">
<span id="num-format-categories"></span><h4>Number Format Categories</h4>
<p>The <a class="reference internal" href="#set_num_format" title="set_num_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_num_format()</span></code></a> method, shown below, is used to set the number
format for numbers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;currency_format.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">currency_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;$#,##0.00&#39;</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="mf">1234.56</span><span class="p">,</span> <span class="n">currency_format</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>If the number format you use is the same as one of Excel’s built in number
formats then it will have a number category such as General, Number, Currency,
Accounting, Date, Time, Percentage, Fraction, Scientific, Text, Special or
Custom. In the case of the example above the formatted output shows up as a
Number category:</p>
<img alt="_images/currency_format1.png" src="_images/currency_format1.png" />
<p>If we wanted it to have a different category, such as Currency, then
we would have to match the number format string with the number format used by
Excel. The easiest way to do this is to open the Number Formatting dialog in
Excel and set the format that you want:</p>
<img alt="_images/currency_format2.png" src="_images/currency_format2.png" />
<p>Then, while still in the dialog, change to Custom. The format displayed is the
format used by Excel.</p>
<img alt="_images/currency_format3.png" src="_images/currency_format3.png" />
<p>If we put the format that we found (<code class="docutils literal notranslate"><span class="pre">'[$$-409]#,##0.00'</span></code>) into our previous
example and rerun it we will get a number format in the Currency category:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;currency_format.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">currency_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;[$$-409]#,##0.00&#39;</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="mf">1234.56</span><span class="p">,</span> <span class="n">currency_format</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Here is the output:</p>
<img alt="_images/currency_format4.png" src="_images/currency_format4.png" />
<p>The same process can be used to find format strings for Date or Accountancy
formats. However, you also need to be aware of the OS settings Excel uses for
number separators such as the “grouping/thousands” separator and the “decimal”
point. See the next section for details.</p>
</div>
<div class="section" id="number-formats-in-different-locales">
<span id="num-format-locale"></span><h4>Number Formats in different locales</h4>
<p>As shown in the previous section the <a class="reference internal" href="#set_num_format" title="set_num_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_num_format()</span></code></a> method is used to
set the number format for Xlsxwriter formats. A common use case is to set a
number format with a “grouping/thousands” separator and a “decimal” point:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;number_format.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">number_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;#,##0.00&#39;</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="mf">1234.56</span><span class="p">,</span> <span class="n">number_format</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>In the US locale (and some others) where the number “grouping/thousands”
separator is “,” and the “decimal” point is “.” this would be shown in Excel
as:</p>
<img alt="_images/currency_format5.png" src="_images/currency_format5.png" />
<p>In other locales these values may be reversed or different. They are generally
set in the “Region” settings of Windows or Mac OS.  Excel handles this by
storing the number format in the file format in the US locale, in this case
<code class="docutils literal notranslate"><span class="pre">#,##0.00</span></code>, but renders it according to the regional settings of the host
OS. For example, here is the same, unmodified, output file shown above in a
German locale:</p>
<img alt="_images/currency_format6.png" src="_images/currency_format6.png" />
<p>And here is the same file in a Russian locale. Note the use of a space as the
“grouping/thousands” separator:</p>
<img alt="_images/currency_format7.png" src="_images/currency_format7.png" />
<p>In order to replicate Excel’s behavior all XlsxWriter programs should use US
locale formatting which will then be rendered in the settings of your host OS.</p>
</div>
<div class="section" id="format-methods-and-format-properties">
<h4>Format methods and Format properties</h4>
<p>The following table shows the Excel format categories, the formatting
properties that can be applied and the equivalent object method:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="22%" />
<col width="27%" />
<col width="37%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Category</th>
<th class="head">Description</th>
<th class="head">Property</th>
<th class="head">Method Name</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Font</td>
<td>Font type</td>
<td><code class="docutils literal notranslate"><span class="pre">'font_name'</span></code></td>
<td><a class="reference internal" href="#set_font_name" title="set_font_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_font_name()</span></code></a></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Font size</td>
<td><code class="docutils literal notranslate"><span class="pre">'font_size'</span></code></td>
<td><a class="reference internal" href="#set_font_size" title="set_font_size"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_font_size()</span></code></a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Font color</td>
<td><code class="docutils literal notranslate"><span class="pre">'font_color'</span></code></td>
<td><a class="reference internal" href="#set_font_color" title="set_font_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_font_color()</span></code></a></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Bold</td>
<td><code class="docutils literal notranslate"><span class="pre">'bold'</span></code></td>
<td><a class="reference internal" href="#set_bold" title="set_bold"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_bold()</span></code></a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Italic</td>
<td><code class="docutils literal notranslate"><span class="pre">'italic'</span></code></td>
<td><a class="reference internal" href="#set_italic" title="set_italic"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_italic()</span></code></a></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Underline</td>
<td><code class="docutils literal notranslate"><span class="pre">'underline'</span></code></td>
<td><a class="reference internal" href="#set_underline" title="set_underline"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_underline()</span></code></a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Strikeout</td>
<td><code class="docutils literal notranslate"><span class="pre">'font_strikeout'</span></code></td>
<td><a class="reference internal" href="#set_font_strikeout" title="set_font_strikeout"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_font_strikeout()</span></code></a></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Super/Subscript</td>
<td><code class="docutils literal notranslate"><span class="pre">'font_script'</span></code></td>
<td><a class="reference internal" href="#set_font_script" title="set_font_script"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_font_script()</span></code></a></td>
</tr>
<tr class="row-even"><td>Number</td>
<td>Numeric format</td>
<td><code class="docutils literal notranslate"><span class="pre">'num_format'</span></code></td>
<td><a class="reference internal" href="#set_num_format" title="set_num_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_num_format()</span></code></a></td>
</tr>
<tr class="row-odd"><td>Protection</td>
<td>Lock cells</td>
<td><code class="docutils literal notranslate"><span class="pre">'locked'</span></code></td>
<td><a class="reference internal" href="#set_locked" title="set_locked"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_locked()</span></code></a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Hide formulas</td>
<td><code class="docutils literal notranslate"><span class="pre">'hidden'</span></code></td>
<td><a class="reference internal" href="#set_hidden" title="set_hidden"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_hidden()</span></code></a></td>
</tr>
<tr class="row-odd"><td>Alignment</td>
<td>Horizontal align</td>
<td><code class="docutils literal notranslate"><span class="pre">'align'</span></code></td>
<td><a class="reference internal" href="#set_align" title="set_align"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_align()</span></code></a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Vertical align</td>
<td><code class="docutils literal notranslate"><span class="pre">'valign'</span></code></td>
<td><a class="reference internal" href="#set_align" title="set_align"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_align()</span></code></a></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Rotation</td>
<td><code class="docutils literal notranslate"><span class="pre">'rotation'</span></code></td>
<td><a class="reference internal" href="#set_rotation" title="set_rotation"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_rotation()</span></code></a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Text wrap</td>
<td><code class="docutils literal notranslate"><span class="pre">'text_wrap'</span></code></td>
<td><a class="reference internal" href="#set_text_wrap" title="set_text_wrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_text_wrap()</span></code></a></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Reading order</td>
<td><code class="docutils literal notranslate"><span class="pre">'reading_order'</span></code></td>
<td><a class="reference internal" href="#set_reading_order" title="set_reading_order"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_reading_order()</span></code></a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Justify last</td>
<td><code class="docutils literal notranslate"><span class="pre">'text_justlast'</span></code></td>
<td><a class="reference internal" href="#set_text_justlast" title="set_text_justlast"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_text_justlast()</span></code></a></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Center across</td>
<td><code class="docutils literal notranslate"><span class="pre">'center_across'</span></code></td>
<td><a class="reference internal" href="#set_center_across" title="set_center_across"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_center_across()</span></code></a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Indentation</td>
<td><code class="docutils literal notranslate"><span class="pre">'indent'</span></code></td>
<td><a class="reference internal" href="#set_indent" title="set_indent"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_indent()</span></code></a></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Shrink to fit</td>
<td><code class="docutils literal notranslate"><span class="pre">'shrink'</span></code></td>
<td><a class="reference internal" href="#set_shrink" title="set_shrink"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_shrink()</span></code></a></td>
</tr>
<tr class="row-even"><td>Pattern</td>
<td>Cell pattern</td>
<td><code class="docutils literal notranslate"><span class="pre">'pattern'</span></code></td>
<td><a class="reference internal" href="#set_pattern" title="set_pattern"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_pattern()</span></code></a></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Background color</td>
<td><code class="docutils literal notranslate"><span class="pre">'bg_color'</span></code></td>
<td><a class="reference internal" href="#set_bg_color" title="set_bg_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_bg_color()</span></code></a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Foreground color</td>
<td><code class="docutils literal notranslate"><span class="pre">'fg_color'</span></code></td>
<td><a class="reference internal" href="#set_fg_color" title="set_fg_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_fg_color()</span></code></a></td>
</tr>
<tr class="row-odd"><td>Border</td>
<td>Cell border</td>
<td><code class="docutils literal notranslate"><span class="pre">'border'</span></code></td>
<td><a class="reference internal" href="#set_border" title="set_border"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_border()</span></code></a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Bottom border</td>
<td><code class="docutils literal notranslate"><span class="pre">'bottom'</span></code></td>
<td><a class="reference internal" href="#set_bottom" title="set_bottom"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_bottom()</span></code></a></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Top border</td>
<td><code class="docutils literal notranslate"><span class="pre">'top'</span></code></td>
<td><a class="reference internal" href="#set_top" title="set_top"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_top()</span></code></a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Left border</td>
<td><code class="docutils literal notranslate"><span class="pre">'left'</span></code></td>
<td><a class="reference internal" href="#set_left" title="set_left"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_left()</span></code></a></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Right border</td>
<td><code class="docutils literal notranslate"><span class="pre">'right'</span></code></td>
<td><a class="reference internal" href="#set_right" title="set_right"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_right()</span></code></a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Border color</td>
<td><code class="docutils literal notranslate"><span class="pre">'border_color'</span></code></td>
<td><a class="reference internal" href="#set_border_color" title="set_border_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_border_color()</span></code></a></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Bottom color</td>
<td><code class="docutils literal notranslate"><span class="pre">'bottom_color'</span></code></td>
<td><a class="reference internal" href="#set_bottom_color" title="set_bottom_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_bottom_color()</span></code></a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Top color</td>
<td><code class="docutils literal notranslate"><span class="pre">'top_color'</span></code></td>
<td><a class="reference internal" href="#set_top_color" title="set_top_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_top_color()</span></code></a></td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>Left color</td>
<td><code class="docutils literal notranslate"><span class="pre">'left_color'</span></code></td>
<td><a class="reference internal" href="#set_left_color" title="set_left_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_left_color()</span></code></a></td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>Right color</td>
<td><code class="docutils literal notranslate"><span class="pre">'right_color'</span></code></td>
<td><a class="reference internal" href="#set_right_color" title="set_right_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_right_color()</span></code></a></td>
</tr>
</tbody>
</table>
<p>The format properties and methods are explained in the following sections.</p>
</div>
<div class="section" id="format-set-font-name">
<h4>format.set_font_name()</h4>
<dl class="function">
<dt id="set_font_name">
<code class="descname">set_font_name</code><span class="sig-paren">(</span><em>fontname</em><span class="sig-paren">)</span></dt>
<dd><p>Set the font used in the cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fontname</strong> (<em>string</em>) – Cell font.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Specify the font used used in the cell format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span><span class="o">.</span><span class="n">set_font_name</span><span class="p">(</span><span class="s1">&#39;Times New Roman&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/format_font_name.png" src="_images/format_font_name.png" />
<p>Excel can only display fonts that are installed on the system that it is
running on. Therefore it is best to use the fonts that come as standard such
as ‘Calibri’, ‘Times New Roman’ and ‘Courier New’.</p>
<p>The default font for an unformatted cell in Excel 2007+ is ‘Calibri’.</p>
</div>
<div class="section" id="format-set-font-size">
<h4>format.set_font_size()</h4>
<dl class="function">
<dt id="set_font_size">
<code class="descname">set_font_size</code><span class="sig-paren">(</span><em>size</em><span class="sig-paren">)</span></dt>
<dd><p>Set the size of the font used in the cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell font size.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Set the font size of the cell format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>
<span class="n">cell_format</span><span class="o">.</span><span class="n">set_font_size</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/format_font_size.png" src="_images/format_font_size.png" />
<p>Excel adjusts the height of a row to accommodate the largest font size in the
row. You can also explicitly specify the height of a row using the
<a class="reference internal" href="index.html#set_row" title="set_row"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_row()</span></code></a> worksheet method.</p>
</div>
<div class="section" id="format-set-font-color">
<h4>format.set_font_color()</h4>
<dl class="function">
<dt id="set_font_color">
<code class="descname">set_font_color</code><span class="sig-paren">(</span><em>color</em><span class="sig-paren">)</span></dt>
<dd><p>Set the color of the font used in the cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>color</strong> (<em>string</em>) – The cell font color.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Set the font color:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>

<span class="n">cell_format</span><span class="o">.</span><span class="n">set_font_color</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Wheelbarrow&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/format_font_color.png" src="_images/format_font_color.png" />
<p>The color can be a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string or a limited number of named
colors, see <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>.</p>
<p>Note: The <a class="reference internal" href="#set_font_color" title="set_font_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_font_color()</span></code></a> method is used to set the color of the font
in a cell. To set the color of a cell use the <a class="reference internal" href="#set_bg_color" title="set_bg_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_bg_color()</span></code></a> and
<a class="reference internal" href="#set_pattern" title="set_pattern"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_pattern()</span></code></a> methods.</p>
</div>
<div class="section" id="format-set-bold">
<h4>format.set_bold()</h4>
<dl class="function">
<dt id="set_bold">
<code class="descname">set_bold</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Turn on bold for the format font.</p>
</dd></dl>

<p>Set the bold property of the font:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span><span class="o">.</span><span class="n">set_bold</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/format_font_bold.png" src="_images/format_font_bold.png" />
</div>
<div class="section" id="format-set-italic">
<h4>format.set_italic()</h4>
<dl class="function">
<dt id="set_italic">
<code class="descname">set_italic</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Turn on italic for the format font.</p>
</dd></dl>

<p>Set the italic property of the font:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span><span class="o">.</span><span class="n">set_italic</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/format_font_italic.png" src="_images/format_font_italic.png" />
</div>
<div class="section" id="format-set-underline">
<h4>format.set_underline()</h4>
<dl class="function">
<dt id="set_underline">
<code class="descname">set_underline</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Turn on underline for the format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>style</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Underline style.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Set the underline property of the format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span><span class="o">.</span><span class="n">set_underline</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/format_font_underlined.png" src="_images/format_font_underlined.png" />
<p>The available underline styles are:</p>
<ul class="simple">
<li>1 = Single underline (the default)</li>
<li>2 = Double underline</li>
<li>33 = Single accounting underline</li>
<li>34 = Double accounting underline</li>
</ul>
</div>
<div class="section" id="format-set-font-strikeout">
<h4>format.set_font_strikeout()</h4>
<dl class="function">
<dt id="set_font_strikeout">
<code class="descname">set_font_strikeout</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Set the strikeout property of the font.</p>
</dd></dl>

<img alt="_images/format_font_strikeout.png" src="_images/format_font_strikeout.png" />
</div>
<div class="section" id="format-set-font-script">
<h4>format.set_font_script()</h4>
<dl class="function">
<dt id="set_font_script">
<code class="descname">set_font_script</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Set the superscript/subscript property of the font.</p>
</dd></dl>

<p>The available options are:</p>
<ul class="simple">
<li>1 = Superscript</li>
<li>2 = Subscript</li>
</ul>
<img alt="_images/format_font_script.png" src="_images/format_font_script.png" />
<p>This property is generally only useful when used in conjunction with
<a class="reference internal" href="index.html#write_rich_string" title="write_rich_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_rich_string()</span></code></a>.</p>
</div>
<div class="section" id="format-set-num-format">
<h4>format.set_num_format()</h4>
<dl class="function">
<dt id="set_num_format">
<code class="descname">set_num_format</code><span class="sig-paren">(</span><em>format_string</em><span class="sig-paren">)</span></dt>
<dd><p>Set the number format for a cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>format_string</strong> (<em>string</em>) – The cell number format.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>This method is used to define the numerical format of a number in Excel. It
controls whether a number is displayed as an integer, a floating point number,
a date, a currency value or some other user defined format.</p>
<p>The numerical format of a cell can be specified by using a format string or an
index to one of Excel’s built-in formats:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>
<span class="n">cell_format2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>

<span class="n">cell_format1</span><span class="o">.</span><span class="n">set_num_format</span><span class="p">(</span><span class="s1">&#39;d mmm yyyy&#39;</span><span class="p">)</span>  <span class="c1"># Format string.</span>
<span class="n">cell_format2</span><span class="o">.</span><span class="n">set_num_format</span><span class="p">(</span><span class="mh">0x0F</span><span class="p">)</span>          <span class="c1"># Format index.</span>
</pre></div>
</div>
<p>Format strings can control any aspect of number formatting allowed by Excel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format01</span><span class="o">.</span><span class="n">set_num_format</span><span class="p">(</span><span class="s1">&#39;0.000&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">3.1415926</span><span class="p">,</span> <span class="n">cell_format01</span><span class="p">)</span>       <span class="c1"># -&gt; 3.142</span>

<span class="n">cell_format02</span><span class="o">.</span><span class="n">set_num_format</span><span class="p">(</span><span class="s1">&#39;#,##0&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1234.56</span><span class="p">,</span> <span class="n">cell_format02</span><span class="p">)</span>         <span class="c1"># -&gt; 1,235</span>

<span class="n">cell_format03</span><span class="o">.</span><span class="n">set_num_format</span><span class="p">(</span><span class="s1">&#39;#,##0.00&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1234.56</span><span class="p">,</span> <span class="n">cell_format03</span><span class="p">)</span>         <span class="c1"># -&gt; 1,234.56</span>

<span class="n">cell_format04</span><span class="o">.</span><span class="n">set_num_format</span><span class="p">(</span><span class="s1">&#39;0.00&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">49.99</span><span class="p">,</span> <span class="n">cell_format04</span><span class="p">)</span>           <span class="c1"># -&gt; 49.99</span>

<span class="n">cell_format05</span><span class="o">.</span><span class="n">set_num_format</span><span class="p">(</span><span class="s1">&#39;mm/dd/yy&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">36892.521</span><span class="p">,</span> <span class="n">cell_format05</span><span class="p">)</span>       <span class="c1"># -&gt; 01/01/01</span>

<span class="n">cell_format06</span><span class="o">.</span><span class="n">set_num_format</span><span class="p">(</span><span class="s1">&#39;mmm d yyyy&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">36892.521</span><span class="p">,</span> <span class="n">cell_format06</span><span class="p">)</span>       <span class="c1"># -&gt; Jan 1 2001</span>

<span class="n">cell_format07</span><span class="o">.</span><span class="n">set_num_format</span><span class="p">(</span><span class="s1">&#39;d mmmm yyyy&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">36892.521</span><span class="p">,</span> <span class="n">cell_format07</span><span class="p">)</span>       <span class="c1"># -&gt; 1 January 2001</span>

<span class="n">cell_format08</span><span class="o">.</span><span class="n">set_num_format</span><span class="p">(</span><span class="s1">&#39;dd/mm/yyyy hh:mm AM/PM&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">36892.521</span><span class="p">,</span> <span class="n">cell_format08</span><span class="p">)</span>       <span class="c1"># -&gt; 01/01/2001 12:30 AM</span>

<span class="n">cell_format09</span><span class="o">.</span><span class="n">set_num_format</span><span class="p">(</span><span class="s1">&#39;0 &quot;dollar and&quot; .00 &quot;cents&quot;&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.87</span><span class="p">,</span> <span class="n">cell_format09</span><span class="p">)</span>            <span class="c1"># -&gt; 1 dollar and .87 cents</span>

<span class="c1"># Conditional numerical formatting.</span>
<span class="n">cell_format10</span><span class="o">.</span><span class="n">set_num_format</span><span class="p">(</span><span class="s1">&#39;[Green]General;[Red]-General;General&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="n">cell_format10</span><span class="p">)</span>  <span class="c1"># &gt; 0 Green</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">,</span> <span class="n">cell_format10</span><span class="p">)</span>  <span class="c1"># &lt; 0 Red</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>   <span class="mi">0</span><span class="p">,</span> <span class="n">cell_format10</span><span class="p">)</span>  <span class="c1"># = 0 Default color</span>

<span class="c1"># Zip code.</span>
<span class="n">cell_format11</span><span class="o">.</span><span class="n">set_num_format</span><span class="p">(</span><span class="s1">&#39;00000&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1209</span><span class="p">,</span> <span class="n">cell_format11</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/formats_num_str.png" src="_images/formats_num_str.png" />
<p>The number system used for dates is described in
<a class="reference internal" href="index.html#working-with-dates-and-time"><span class="std std-ref">Working with Dates and Time</span></a>.</p>
<p>The color format should have one of the following values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Black</span><span class="p">]</span> <span class="p">[</span><span class="n">Blue</span><span class="p">]</span> <span class="p">[</span><span class="n">Cyan</span><span class="p">]</span> <span class="p">[</span><span class="n">Green</span><span class="p">]</span> <span class="p">[</span><span class="n">Magenta</span><span class="p">]</span> <span class="p">[</span><span class="n">Red</span><span class="p">]</span> <span class="p">[</span><span class="n">White</span><span class="p">]</span> <span class="p">[</span><span class="n">Yellow</span><span class="p">]</span>
</pre></div>
</div>
<p>For more information refer to the <a class="reference external" href="https://support.office.com/en-us/article/create-or-delete-a-custom-number-format-78f2a361-936b-4c03-8772-09fab54be7f4">Microsoft documentation on cell formats</a>.</p>
<p>For information on how to get a number format to show up as one of the number
format categories such as Currency, Accounting, Date, Time, Percentage,
Fraction, Scientific or Text, see <a class="reference internal" href="#num-format-categories"><span class="std std-ref">Number Format Categories</span></a>, above.</p>
<p>For backwards compatibility XlsxWriter also supports Excel’s built-in formats
which are set via an index number, rather than a string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span><span class="o">.</span><span class="n">set_num_format</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># Same as #,##0</span>
</pre></div>
</div>
<p>The format indexes and the equivalent strings are shown in the following
table:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Index</th>
<th class="head">Format String</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td><code class="docutils literal notranslate"><span class="pre">General</span></code></td>
</tr>
<tr class="row-odd"><td>1</td>
<td><code class="docutils literal notranslate"><span class="pre">0</span></code></td>
</tr>
<tr class="row-even"><td>2</td>
<td><code class="docutils literal notranslate"><span class="pre">0.00</span></code></td>
</tr>
<tr class="row-odd"><td>3</td>
<td><code class="docutils literal notranslate"><span class="pre">#,##0</span></code></td>
</tr>
<tr class="row-even"><td>4</td>
<td><code class="docutils literal notranslate"><span class="pre">#,##0.00</span></code></td>
</tr>
<tr class="row-odd"><td>5</td>
<td><code class="docutils literal notranslate"><span class="pre">($#,##0_);($#,##0)</span></code></td>
</tr>
<tr class="row-even"><td>6</td>
<td><code class="docutils literal notranslate"><span class="pre">($#,##0_);[Red]($#,##0)</span></code></td>
</tr>
<tr class="row-odd"><td>7</td>
<td><code class="docutils literal notranslate"><span class="pre">($#,##0.00_);($#,##0.00)</span></code></td>
</tr>
<tr class="row-even"><td>8</td>
<td><code class="docutils literal notranslate"><span class="pre">($#,##0.00_);[Red]($#,##0.00)</span></code></td>
</tr>
<tr class="row-odd"><td>9</td>
<td><code class="docutils literal notranslate"><span class="pre">0%</span></code></td>
</tr>
<tr class="row-even"><td>10</td>
<td><code class="docutils literal notranslate"><span class="pre">0.00%</span></code></td>
</tr>
<tr class="row-odd"><td>11</td>
<td><code class="docutils literal notranslate"><span class="pre">0.00E+00</span></code></td>
</tr>
<tr class="row-even"><td>12</td>
<td><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">?/?</span></code></td>
</tr>
<tr class="row-odd"><td>13</td>
<td><code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">??/??</span></code></td>
</tr>
<tr class="row-even"><td>14</td>
<td><code class="docutils literal notranslate"><span class="pre">m/d/yy</span></code></td>
</tr>
<tr class="row-odd"><td>15</td>
<td><code class="docutils literal notranslate"><span class="pre">d-mmm-yy</span></code></td>
</tr>
<tr class="row-even"><td>16</td>
<td><code class="docutils literal notranslate"><span class="pre">d-mmm</span></code></td>
</tr>
<tr class="row-odd"><td>17</td>
<td><code class="docutils literal notranslate"><span class="pre">mmm-yy</span></code></td>
</tr>
<tr class="row-even"><td>18</td>
<td><code class="docutils literal notranslate"><span class="pre">h:mm</span> <span class="pre">AM/PM</span></code></td>
</tr>
<tr class="row-odd"><td>19</td>
<td><code class="docutils literal notranslate"><span class="pre">h:mm:ss</span> <span class="pre">AM/PM</span></code></td>
</tr>
<tr class="row-even"><td>20</td>
<td><code class="docutils literal notranslate"><span class="pre">h:mm</span></code></td>
</tr>
<tr class="row-odd"><td>21</td>
<td><code class="docutils literal notranslate"><span class="pre">h:mm:ss</span></code></td>
</tr>
<tr class="row-even"><td>22</td>
<td><code class="docutils literal notranslate"><span class="pre">m/d/yy</span> <span class="pre">h:mm</span></code></td>
</tr>
<tr class="row-odd"><td>…</td>
<td>…</td>
</tr>
<tr class="row-even"><td>37</td>
<td><code class="docutils literal notranslate"><span class="pre">(#,##0_);(#,##0)</span></code></td>
</tr>
<tr class="row-odd"><td>38</td>
<td><code class="docutils literal notranslate"><span class="pre">(#,##0_);[Red](#,##0)</span></code></td>
</tr>
<tr class="row-even"><td>39</td>
<td><code class="docutils literal notranslate"><span class="pre">(#,##0.00_);(#,##0.00)</span></code></td>
</tr>
<tr class="row-odd"><td>40</td>
<td><code class="docutils literal notranslate"><span class="pre">(#,##0.00_);[Red](#,##0.00)</span></code></td>
</tr>
<tr class="row-even"><td>41</td>
<td><code class="docutils literal notranslate"><span class="pre">_(*</span> <span class="pre">#,##0_);_(*</span> <span class="pre">(#,##0);_(*</span> <span class="pre">&quot;-&quot;_);_(&#64;_)</span></code></td>
</tr>
<tr class="row-odd"><td>42</td>
<td><code class="docutils literal notranslate"><span class="pre">_($*</span> <span class="pre">#,##0_);_($*</span> <span class="pre">(#,##0);_($*</span> <span class="pre">&quot;-&quot;_);_(&#64;_)</span></code></td>
</tr>
<tr class="row-even"><td>43</td>
<td><code class="docutils literal notranslate"><span class="pre">_(*</span> <span class="pre">#,##0.00_);_(*</span> <span class="pre">(#,##0.00);_(*</span> <span class="pre">&quot;-&quot;??_);_(&#64;_)</span></code></td>
</tr>
<tr class="row-odd"><td>44</td>
<td><code class="docutils literal notranslate"><span class="pre">_($*</span> <span class="pre">#,##0.00_);_($*</span> <span class="pre">(#,##0.00);_($*</span> <span class="pre">&quot;-&quot;??_);_(&#64;_)</span></code></td>
</tr>
<tr class="row-even"><td>45</td>
<td><code class="docutils literal notranslate"><span class="pre">mm:ss</span></code></td>
</tr>
<tr class="row-odd"><td>46</td>
<td><code class="docutils literal notranslate"><span class="pre">[h]:mm:ss</span></code></td>
</tr>
<tr class="row-even"><td>47</td>
<td><code class="docutils literal notranslate"><span class="pre">mm:ss.0</span></code></td>
</tr>
<tr class="row-odd"><td>48</td>
<td><code class="docutils literal notranslate"><span class="pre">##0.0E+0</span></code></td>
</tr>
<tr class="row-even"><td>49</td>
<td><code class="docutils literal notranslate"><span class="pre">&#64;</span></code></td>
</tr>
</tbody>
</table>
<p>Numeric formats 23 to 36 are not documented by Microsoft and may differ in
international versions. The listed date and currency formats may also vary
depending on system settings.</p>
<p>The dollar sign in the above format usually appears as the defined local
currency symbol. To get more locale specific formatting see see
<a class="reference internal" href="#num-format-categories"><span class="std std-ref">Number Format Categories</span></a>, above.</p>
</div>
<div class="section" id="format-set-locked">
<h4>format.set_locked()</h4>
<dl class="function">
<dt id="set_locked">
<code class="descname">set_locked</code><span class="sig-paren">(</span><em>state</em><span class="sig-paren">)</span></dt>
<dd><p>Set the cell locked state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Turn cell locking on or off. Defaults to True.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>This property can be used to prevent modification of a cell’s contents.
Following Excel’s convention, cell locking is turned on by default. However,
it only has an effect if the worksheet has been protected using the worksheet
<a class="reference internal" href="index.html#protect" title="protect"><code class="xref py py-func docutils literal notranslate"><span class="pre">protect()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">locked</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>
<span class="n">locked</span><span class="o">.</span><span class="n">set_locked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

<span class="n">unlocked</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>
<span class="n">unlocked</span><span class="o">.</span><span class="n">set_locked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Enable worksheet protection</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">protect</span><span class="p">()</span>

<span class="c1"># This cell cannot be edited.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;=1+2&#39;</span><span class="p">,</span> <span class="n">locked</span><span class="p">)</span>

<span class="c1"># This cell can be edited.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;=1+2&#39;</span><span class="p">,</span> <span class="n">unlocked</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="format-set-hidden">
<h4>format.set_hidden()</h4>
<dl class="function">
<dt id="set_hidden">
<code class="descname">set_hidden</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Hide formulas in a cell.</p>
</dd></dl>

<p>This property is used to hide a formula while still displaying its
result. This is generally used to hide complex calculations from end users who
are only interested in the result. It only has an effect if the worksheet has
been protected using the worksheet <a class="reference internal" href="index.html#protect" title="protect"><code class="xref py py-func docutils literal notranslate"><span class="pre">protect()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hidden</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>
<span class="n">hidden</span><span class="o">.</span><span class="n">set_hidden</span><span class="p">()</span>

<span class="c1"># Enable worksheet protection</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">protect</span><span class="p">()</span>

<span class="c1"># The formula in this cell isn&#39;t visible</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;=1+2&#39;</span><span class="p">,</span> <span class="n">hidden</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="format-set-align">
<h4>format.set_align()</h4>
<dl class="function">
<dt id="set_align">
<code class="descname">set_align</code><span class="sig-paren">(</span><em>alignment</em><span class="sig-paren">)</span></dt>
<dd><p>Set the alignment for data in the cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>alignment</strong> (<em>string</em>) – The vertical and or horizontal alignment direction.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>This method is used to set the horizontal and vertical text alignment within a
cell. The following are the available horizontal alignments:</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Horizontal alignment</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>left</td>
</tr>
<tr class="row-odd"><td>center</td>
</tr>
<tr class="row-even"><td>right</td>
</tr>
<tr class="row-odd"><td>fill</td>
</tr>
<tr class="row-even"><td>justify</td>
</tr>
<tr class="row-odd"><td>center_across</td>
</tr>
<tr class="row-even"><td>distributed</td>
</tr>
</tbody>
</table>
<p>The following are the available vertical alignments:</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Vertical alignment</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>top</td>
</tr>
<tr class="row-odd"><td>vcenter</td>
</tr>
<tr class="row-even"><td>bottom</td>
</tr>
<tr class="row-odd"><td>vjustify</td>
</tr>
<tr class="row-even"><td>vdistributed</td>
</tr>
</tbody>
</table>
<p>As in Excel, vertical and horizontal alignments can be combined:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>

<span class="n">cell_format</span><span class="o">.</span><span class="n">set_align</span><span class="p">(</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">cell_format</span><span class="o">.</span><span class="n">set_align</span><span class="p">(</span><span class="s1">&#39;vcenter&#39;</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Some Text&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/format_font_align.png" src="_images/format_font_align.png" />
<p>Text can be aligned across two or more adjacent cells using the
<code class="docutils literal notranslate"><span class="pre">'center_across'</span></code> property. However, for genuine merged cells it is better
to use the <a class="reference internal" href="index.html#merge_range" title="merge_range"><code class="xref py py-func docutils literal notranslate"><span class="pre">merge_range()</span></code></a> worksheet method.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'vjustify'</span></code> (vertical justify) option can be used to provide automatic
text wrapping in a cell. The height of the cell will be adjusted to
accommodate the wrapped text. To specify where the text wraps use the
<a class="reference internal" href="#set_text_wrap" title="set_text_wrap"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_text_wrap()</span></code></a> method.</p>
</div>
<div class="section" id="format-set-center-across">
<h4>format.set_center_across()</h4>
<dl class="function">
<dt id="set_center_across">
<code class="descname">set_center_across</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Center text across adjacent cells.</p>
</dd></dl>

<p>Text can be aligned across two or more adjacent cells using the
<a class="reference internal" href="#set_center_across" title="set_center_across"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_center_across()</span></code></a> method. This is an alias for the
<code class="docutils literal notranslate"><span class="pre">set_align('center_across')</span></code> method call.</p>
<p>Only the leftmost cell should contain the text. The other cells in the range
should be blank but should include the formatting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>
<span class="n">cell_format</span><span class="o">.</span><span class="n">set_center_across</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Center across selection&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_blank</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
</pre></div>
</div>
<p>For actual merged cells it is better to use the <a class="reference internal" href="index.html#merge_range" title="merge_range"><code class="xref py py-func docutils literal notranslate"><span class="pre">merge_range()</span></code></a> worksheet
method.</p>
</div>
<div class="section" id="format-set-text-wrap">
<h4>format.set_text_wrap()</h4>
<dl class="function">
<dt id="set_text_wrap">
<code class="descname">set_text_wrap</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Wrap text in a cell.</p>
</dd></dl>

<p>Turn text wrapping on for text in a cell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>
<span class="n">cell_format</span><span class="o">.</span><span class="n">set_text_wrap</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Some long text to wrap in a cell&quot;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
</pre></div>
</div>
<p>If you wish to control where the text is wrapped you can add newline characters
to the string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;It&#39;s</span><span class="se">\n</span><span class="s2">a bum</span><span class="se">\n</span><span class="s2">wrap&quot;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/format_font_text_wrap.png" src="_images/format_font_text_wrap.png" />
<p>Excel will adjust the height of the row to accommodate the wrapped text. A
similar effect can be obtained without newlines using the
<code class="docutils literal notranslate"><span class="pre">set_align('vjustify')</span></code> method.</p>
</div>
<div class="section" id="format-set-rotation">
<h4>format.set_rotation()</h4>
<dl class="function">
<dt id="set_rotation">
<code class="descname">set_rotation</code><span class="sig-paren">(</span><em>angle</em><span class="sig-paren">)</span></dt>
<dd><p>Set the rotation of the text in a cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>angle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Rotation angle in the range -90 to 90 and 270.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Set the rotation of the text in a cell. The rotation can be any angle in the
range -90 to 90 degrees:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>
<span class="n">cell_format</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;This text is rotated&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/format_font_text_rotated.png" src="_images/format_font_text_rotated.png" />
<p>The angle 270 is also supported. This indicates text where the letters run from
top to bottom.</p>
</div>
<div class="section" id="format-set-reading-order">
<h4>format.set_reading_order()</h4>
<dl class="function">
<dt id="set_reading_order">
<code class="descname">set_reading_order</code><span class="sig-paren">(</span><em>direction</em><span class="sig-paren">)</span></dt>
<dd><p>Set the reading order for the text in a cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>direction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Reading order direction.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Set the text reading direction. This is useful when creating Arabic, Hebrew or
other near or far eastern worksheets. It can be used in conjunction with the
Worksheet <a class="reference internal" href="index.html#right_to_left" title="right_to_left"><code class="xref py py-func docutils literal notranslate"><span class="pre">right_to_left()</span></code></a> method to also change the direction of the
worksheet.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">format_left_to_right</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>
<span class="n">format_left_to_right</span><span class="o">.</span><span class="n">set_reading_order</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">format_right_to_left</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>
<span class="n">format_right_to_left</span><span class="o">.</span><span class="n">set_reading_order</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">right_to_left</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;نص عربي / English text&#39;</span><span class="p">)</span>  <span class="c1"># Default direction.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;نص عربي / English text&#39;</span><span class="p">,</span> <span class="n">format_left_to_right</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;نص عربي / English text&#39;</span><span class="p">,</span> <span class="n">format_right_to_left</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/right_to_left.png" src="_images/right_to_left.png" />
</div>
<div class="section" id="format-set-indent">
<h4>format.set_indent()</h4>
<dl class="function">
<dt id="set_indent">
<code class="descname">set_indent</code><span class="sig-paren">(</span><em>level</em><span class="sig-paren">)</span></dt>
<dd><p>Set the cell text indentation level.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>level</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Indentation level.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>This method can be used to indent text in a cell. The argument, which should be
an integer, is taken as the level of indentation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>
<span class="n">cell_format2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>

<span class="n">cell_format1</span><span class="o">.</span><span class="n">set_indent</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cell_format2</span><span class="o">.</span><span class="n">set_indent</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;This text is indented 1 level&#39;</span><span class="p">,</span>  <span class="n">cell_format1</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;This text is indented 2 levels&#39;</span><span class="p">,</span> <span class="n">cell_format2</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/text_indent.png" src="_images/text_indent.png" />
<p>Indentation is a horizontal alignment property. It will override any other
horizontal properties but it can be used in conjunction with vertical
properties.</p>
</div>
<div class="section" id="format-set-shrink">
<h4>format.set_shrink()</h4>
<dl class="function">
<dt id="set_shrink">
<code class="descname">set_shrink</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Turn on the text “shrink to fit” for a cell.</p>
</dd></dl>

<p>This method can be used to shrink text so that it fits in a cell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>
<span class="n">cell_format</span><span class="o">.</span><span class="n">set_shrink</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Honey, I shrunk the text!&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="format-set-text-justlast">
<h4>format.set_text_justlast()</h4>
<dl class="function">
<dt id="set_text_justlast">
<code class="descname">set_text_justlast</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Turn on the justify last text property.</p>
</dd></dl>

<p>Only applies to Far Eastern versions of Excel.</p>
</div>
<div class="section" id="format-set-pattern">
<h4>format.set_pattern()</h4>
<dl class="function">
<dt id="set_pattern">
<code class="descname">set_pattern</code><span class="sig-paren">(</span><em>index</em><span class="sig-paren">)</span></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Pattern index. 0 - 18.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Set the background pattern of a cell.</p>
<p>The most common pattern is 1 which is a solid fill of the background color.</p>
</div>
<div class="section" id="format-set-bg-color">
<h4>format.set_bg_color()</h4>
<dl class="function">
<dt id="set_bg_color">
<code class="descname">set_bg_color</code><span class="sig-paren">(</span><em>color</em><span class="sig-paren">)</span></dt>
<dd><p>Set the color of the background pattern in a cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>color</strong> (<em>string</em>) – The cell font color.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <a class="reference internal" href="#set_bg_color" title="set_bg_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_bg_color()</span></code></a> method can be used to set the background color of a
pattern. Patterns are defined via the <a class="reference internal" href="#set_pattern" title="set_pattern"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_pattern()</span></code></a> method. If a pattern
hasn’t been defined then a solid fill pattern is used as the default.</p>
<p>Here is an example of how to set up a solid fill in a cell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">()</span>

<span class="n">cell_format</span><span class="o">.</span><span class="n">set_pattern</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># This is optional when using a solid fill.</span>
<span class="n">cell_format</span><span class="o">.</span><span class="n">set_bg_color</span><span class="p">(</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Ray&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/formats_set_bg_color.png" src="_images/formats_set_bg_color.png" />
<p>The color can be a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string or a limited number of named
colors, see <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>.</p>
</div>
<div class="section" id="format-set-fg-color">
<h4>format.set_fg_color()</h4>
<dl class="function">
<dt id="set_fg_color">
<code class="descname">set_fg_color</code><span class="sig-paren">(</span><em>color</em><span class="sig-paren">)</span></dt>
<dd><p>Set the color of the foreground pattern in a cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>color</strong> (<em>string</em>) – The cell font color.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <a class="reference internal" href="#set_fg_color" title="set_fg_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_fg_color()</span></code></a> method can be used to set the foreground color of a
pattern.</p>
<p>The color can be a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string or a limited number of named
colors, see <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>.</p>
</div>
<div class="section" id="format-set-border">
<h4>format.set_border()</h4>
<dl class="function">
<dt id="set_border">
<code class="descname">set_border</code><span class="sig-paren">(</span><em>style</em><span class="sig-paren">)</span></dt>
<dd><p>Set the cell border style.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>style</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Border style index. Default is 1.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Individual border elements can be configured using the following methods with
the same parameters:</p>
<ul class="simple">
<li><a class="reference internal" href="#set_bottom" title="set_bottom"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_bottom()</span></code></a></li>
<li><a class="reference internal" href="#set_top" title="set_top"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_top()</span></code></a></li>
<li><a class="reference internal" href="#set_left" title="set_left"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_left()</span></code></a></li>
<li><a class="reference internal" href="#set_right" title="set_right"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_right()</span></code></a></li>
</ul>
<p>A cell border is comprised of a border on the bottom, top, left and right.
These can be set to the same value using <a class="reference internal" href="#set_border" title="set_border"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_border()</span></code></a> or individually
using the relevant method calls shown above.</p>
<p>The following shows the border styles sorted by XlsxWriter index number:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="32%" />
<col width="17%" />
<col width="36%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Index</th>
<th class="head">Name</th>
<th class="head">Weight</th>
<th class="head">Style</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>None</td>
<td>0</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>1</td>
<td>Continuous</td>
<td>1</td>
<td><code class="docutils literal notranslate"><span class="pre">-----------</span></code></td>
</tr>
<tr class="row-even"><td>2</td>
<td>Continuous</td>
<td>2</td>
<td><code class="docutils literal notranslate"><span class="pre">-----------</span></code></td>
</tr>
<tr class="row-odd"><td>3</td>
<td>Dash</td>
<td>1</td>
<td><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span></code></td>
</tr>
<tr class="row-even"><td>4</td>
<td>Dot</td>
<td>1</td>
<td><code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">.</span> <span class="pre">.</span> <span class="pre">.</span> <span class="pre">.</span> <span class="pre">.</span></code></td>
</tr>
<tr class="row-odd"><td>5</td>
<td>Continuous</td>
<td>3</td>
<td><code class="docutils literal notranslate"><span class="pre">-----------</span></code></td>
</tr>
<tr class="row-even"><td>6</td>
<td>Double</td>
<td>3</td>
<td><code class="docutils literal notranslate"><span class="pre">===========</span></code></td>
</tr>
<tr class="row-odd"><td>7</td>
<td>Continuous</td>
<td>0</td>
<td><code class="docutils literal notranslate"><span class="pre">-----------</span></code></td>
</tr>
<tr class="row-even"><td>8</td>
<td>Dash</td>
<td>2</td>
<td><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span></code></td>
</tr>
<tr class="row-odd"><td>9</td>
<td>Dash Dot</td>
<td>1</td>
<td><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">.</span> <span class="pre">-</span> <span class="pre">.</span> <span class="pre">-</span> <span class="pre">.</span></code></td>
</tr>
<tr class="row-even"><td>10</td>
<td>Dash Dot</td>
<td>2</td>
<td><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">.</span> <span class="pre">-</span> <span class="pre">.</span> <span class="pre">-</span> <span class="pre">.</span></code></td>
</tr>
<tr class="row-odd"><td>11</td>
<td>Dash Dot Dot</td>
<td>1</td>
<td><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">.</span> <span class="pre">.</span> <span class="pre">-</span> <span class="pre">.</span> <span class="pre">.</span></code></td>
</tr>
<tr class="row-even"><td>12</td>
<td>Dash Dot Dot</td>
<td>2</td>
<td><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">.</span> <span class="pre">.</span> <span class="pre">-</span> <span class="pre">.</span> <span class="pre">.</span></code></td>
</tr>
<tr class="row-odd"><td>13</td>
<td>SlantDash Dot</td>
<td>2</td>
<td><code class="docutils literal notranslate"><span class="pre">/</span> <span class="pre">-</span> <span class="pre">.</span> <span class="pre">/</span> <span class="pre">-</span> <span class="pre">.</span></code></td>
</tr>
</tbody>
</table>
<p>The following shows the borders in the order shown in the Excel Dialog:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="35%" />
<col width="15%" />
<col width="35%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Index</th>
<th class="head">Style</th>
<th class="head">Index</th>
<th class="head">Style</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0</td>
<td>None</td>
<td>12</td>
<td><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">.</span> <span class="pre">.</span> <span class="pre">-</span> <span class="pre">.</span> <span class="pre">.</span></code></td>
</tr>
<tr class="row-odd"><td>7</td>
<td><code class="docutils literal notranslate"><span class="pre">-----------</span></code></td>
<td>13</td>
<td><code class="docutils literal notranslate"><span class="pre">/</span> <span class="pre">-</span> <span class="pre">.</span> <span class="pre">/</span> <span class="pre">-</span> <span class="pre">.</span></code></td>
</tr>
<tr class="row-even"><td>4</td>
<td><code class="docutils literal notranslate"><span class="pre">.</span> <span class="pre">.</span> <span class="pre">.</span> <span class="pre">.</span> <span class="pre">.</span> <span class="pre">.</span></code></td>
<td>10</td>
<td><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">.</span> <span class="pre">-</span> <span class="pre">.</span> <span class="pre">-</span> <span class="pre">.</span></code></td>
</tr>
<tr class="row-odd"><td>11</td>
<td><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">.</span> <span class="pre">.</span> <span class="pre">-</span> <span class="pre">.</span> <span class="pre">.</span></code></td>
<td>8</td>
<td><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span></code></td>
</tr>
<tr class="row-even"><td>9</td>
<td><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">.</span> <span class="pre">-</span> <span class="pre">.</span> <span class="pre">-</span> <span class="pre">.</span></code></td>
<td>2</td>
<td><code class="docutils literal notranslate"><span class="pre">-----------</span></code></td>
</tr>
<tr class="row-odd"><td>3</td>
<td><code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span> <span class="pre">-</span></code></td>
<td>5</td>
<td><code class="docutils literal notranslate"><span class="pre">-----------</span></code></td>
</tr>
<tr class="row-even"><td>1</td>
<td><code class="docutils literal notranslate"><span class="pre">-----------</span></code></td>
<td>6</td>
<td><code class="docutils literal notranslate"><span class="pre">===========</span></code></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="format-set-bottom">
<h4>format.set_bottom()</h4>
<dl class="function">
<dt id="set_bottom">
<code class="descname">set_bottom</code><span class="sig-paren">(</span><em>style</em><span class="sig-paren">)</span></dt>
<dd><p>Set the cell bottom border style.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>style</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Border style index. Default is 1.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Set the cell bottom border style. See <a class="reference internal" href="#set_border" title="set_border"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_border()</span></code></a> for details on the
border styles.</p>
</div>
<div class="section" id="format-set-top">
<h4>format.set_top()</h4>
<dl class="function">
<dt id="set_top">
<code class="descname">set_top</code><span class="sig-paren">(</span><em>style</em><span class="sig-paren">)</span></dt>
<dd><p>Set the cell top border style.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>style</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Border style index. Default is 1.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Set the cell top border style. See <a class="reference internal" href="#set_border" title="set_border"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_border()</span></code></a> for details on the
border styles.</p>
</div>
<div class="section" id="format-set-left">
<h4>format.set_left()</h4>
<dl class="function">
<dt id="set_left">
<code class="descname">set_left</code><span class="sig-paren">(</span><em>style</em><span class="sig-paren">)</span></dt>
<dd><p>Set the cell left border style.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>style</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Border style index. Default is 1.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Set the cell left border style. See <a class="reference internal" href="#set_border" title="set_border"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_border()</span></code></a> for details on the
border styles.</p>
</div>
<div class="section" id="format-set-right">
<h4>format.set_right()</h4>
<dl class="function">
<dt id="set_right">
<code class="descname">set_right</code><span class="sig-paren">(</span><em>style</em><span class="sig-paren">)</span></dt>
<dd><p>Set the cell right border style.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>style</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Border style index. Default is 1.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Set the cell right border style. See <a class="reference internal" href="#set_border" title="set_border"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_border()</span></code></a> for details on the
border styles.</p>
</div>
<div class="section" id="format-set-border-color">
<h4>format.set_border_color()</h4>
<dl class="function">
<dt id="set_border_color">
<code class="descname">set_border_color</code><span class="sig-paren">(</span><em>color</em><span class="sig-paren">)</span></dt>
<dd><p>Set the color of the cell border.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>color</strong> (<em>string</em>) – The cell border color.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Individual border elements can be configured using the following methods with
the same parameters:</p>
<ul class="simple">
<li><a class="reference internal" href="#set_bottom_color" title="set_bottom_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_bottom_color()</span></code></a></li>
<li><a class="reference internal" href="#set_top_color" title="set_top_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_top_color()</span></code></a></li>
<li><a class="reference internal" href="#set_left_color" title="set_left_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_left_color()</span></code></a></li>
<li><a class="reference internal" href="#set_right_color" title="set_right_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_right_color()</span></code></a></li>
</ul>
<p>Set the color of the cell borders. A cell border is comprised of a border on
the bottom, top, left and right. These can be set to the same color using
<a class="reference internal" href="#set_border_color" title="set_border_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_border_color()</span></code></a> or individually using the relevant method calls shown
above.</p>
<p>The color can be a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string or a limited number of named
colors, see <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>.</p>
</div>
<div class="section" id="format-set-bottom-color">
<h4>format.set_bottom_color()</h4>
<dl class="function">
<dt id="set_bottom_color">
<code class="descname">set_bottom_color</code><span class="sig-paren">(</span><em>color</em><span class="sig-paren">)</span></dt>
<dd><p>Set the color of the bottom cell border.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>color</strong> (<em>string</em>) – The cell border color.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>See <a class="reference internal" href="#set_border_color" title="set_border_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_border_color()</span></code></a> for details on the border colors.</p>
</div>
<div class="section" id="format-set-top-color">
<h4>format.set_top_color()</h4>
<dl class="function">
<dt id="set_top_color">
<code class="descname">set_top_color</code><span class="sig-paren">(</span><em>color</em><span class="sig-paren">)</span></dt>
<dd><p>Set the color of the top cell border.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>color</strong> (<em>string</em>) – The cell border color.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>See <a class="reference internal" href="#set_border_color" title="set_border_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_border_color()</span></code></a> for details on the border colors.</p>
</div>
<div class="section" id="format-set-left-color">
<h4>format.set_left_color()</h4>
<dl class="function">
<dt id="set_left_color">
<code class="descname">set_left_color</code><span class="sig-paren">(</span><em>color</em><span class="sig-paren">)</span></dt>
<dd><p>Set the color of the left cell border.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>color</strong> (<em>string</em>) – The cell border color.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>See <a class="reference internal" href="#set_border_color" title="set_border_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_border_color()</span></code></a> for details on the border colors.</p>
</div>
<div class="section" id="format-set-right-color">
<h4>format.set_right_color()</h4>
<dl class="function">
<dt id="set_right_color">
<code class="descname">set_right_color</code><span class="sig-paren">(</span><em>color</em><span class="sig-paren">)</span></dt>
<dd><p>Set the color of the right cell border.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>color</strong> (<em>string</em>) – The cell border color.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>See <a class="reference internal" href="#set_border_color" title="set_border_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_border_color()</span></code></a> for details on the border colors.</p>
</div>
<div class="section" id="format-set-diag-border">
<h4>format.set_diag_border()</h4>
<dl class="function">
<dt id="set_diag_border">
<code class="descname">set_diag_border</code><span class="sig-paren">(</span><em>style</em><span class="sig-paren">)</span></dt>
<dd><p>Set the diagonal cell border style.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>style</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Border style index. Default is 1.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Set the style for a diagonal border. The <cite>style</cite> is the same as those used in
<a class="reference internal" href="#set_border" title="set_border"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_border()</span></code></a>.</p>
<p>See <a class="reference internal" href="index.html#ex-diagonal-border"><span class="std std-ref">Example: Diagonal borders in cells</span></a>.</p>
<img alt="_images/diagonal_border.png" src="_images/diagonal_border.png" />
</div>
<div class="section" id="format-set-diag-type">
<h4>format.set_diag_type()</h4>
<dl class="function">
<dt id="set_diag_type">
<code class="descname">set_diag_type</code><span class="sig-paren">(</span><em>style</em><span class="sig-paren">)</span></dt>
<dd><p>Set the diagonal cell border type.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>style</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Border type, 1-3. No default.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>Set the type of the diagonal border. The <cite>style</cite> should be one of the
following values:</p>
<ol class="arabic simple">
<li>From bottom left to top right.</li>
<li>From top left to bottom right.</li>
<li>Same as type 1 and 2 combined.</li>
</ol>
</div>
<div class="section" id="format-set-diag-color">
<h4>format.set_diag_color()</h4>
<dl class="function">
<dt id="set_diag_color">
<code class="descname">set_diag_color</code><span class="sig-paren">(</span><em>color</em><span class="sig-paren">)</span></dt>
<dd><p>Set the color of the diagonal cell border.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>color</strong> (<em>string</em>) – The cell border color.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>See <a class="reference internal" href="#set_border_color" title="set_border_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_border_color()</span></code></a> for details on the border colors.</p>
</div>
</div>
<span id="document-chart"></span><div class="section" id="the-chart-class">
<span id="chart-class"></span><h3>The Chart Class</h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Chart</span></code> module is a base class for modules that implement charts in
XlsxWriter. The information in this section is applicable to all of the
available chart subclasses, such as Area, Bar, Column, Doughnut, Line, Pie,
Scatter, Stock and Radar.</p>
<p>A chart object is created via the Workbook <a class="reference internal" href="index.html#add_chart" title="add_chart"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_chart()</span></code></a> method where the
chart type is specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>It is then inserted into a worksheet as an embedded chart using the
<a class="reference internal" href="index.html#insert_chart" title="insert_chart"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_chart()</span></code></a> Worksheet method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>
</pre></div>
</div>
<p>Or it can be set in a chartsheet using the <a class="reference internal" href="index.html#set_chart" title="set_chart"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_chart()</span></code></a> Chartsheet method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chartsheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chartsheet</span><span class="p">()</span>
<span class="c1"># ...</span>
<span class="n">chartsheet</span><span class="o">.</span><span class="n">set_chart</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
</pre></div>
</div>
<p>The following is a small working example or adding an embedded chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Create a new Chart object.</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Write some data to add to plot on the chart.</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># Configure the chart. In simplest case we add one or more data series.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$5&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$1:$B$5&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$1:$C$5&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_simple.png"><img alt="_images/chart_simple.png" src="_images/chart_simple.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The supported chart types are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">area</span></code>: Creates an Area (filled line) style chart.</li>
<li><code class="docutils literal notranslate"><span class="pre">bar</span></code>: Creates a Bar style (transposed histogram) chart.</li>
<li><code class="docutils literal notranslate"><span class="pre">column</span></code>: Creates a column style (histogram) chart.</li>
<li><code class="docutils literal notranslate"><span class="pre">line</span></code>: Creates a Line style chart.</li>
<li><code class="docutils literal notranslate"><span class="pre">pie</span></code>: Creates a Pie style chart.</li>
<li><code class="docutils literal notranslate"><span class="pre">doughnut</span></code>: Creates a Doughnut style chart.</li>
<li><code class="docutils literal notranslate"><span class="pre">scatter</span></code>: Creates a Scatter style chart.</li>
<li><code class="docutils literal notranslate"><span class="pre">stock</span></code>: Creates a Stock style chart.</li>
<li><code class="docutils literal notranslate"><span class="pre">radar</span></code>: Creates a Radar style chart.</li>
</ul>
<p>Chart subtypes are also supported for some chart types:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;stacked&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The available subtypes are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">area</span>
    <span class="n">stacked</span>
    <span class="n">percent_stacked</span>

<span class="n">bar</span>
    <span class="n">stacked</span>
    <span class="n">percent_stacked</span>

<span class="n">column</span>
    <span class="n">stacked</span>
    <span class="n">percent_stacked</span>

<span class="n">scatter</span>
    <span class="n">straight_with_markers</span>
    <span class="n">straight</span>
    <span class="n">smooth_with_markers</span>
    <span class="n">smooth</span>

<span class="n">line</span>
    <span class="n">stacked</span>
    <span class="n">percent_stacked</span>

<span class="n">radar</span>
    <span class="n">with_markers</span>
    <span class="n">filled</span>
</pre></div>
</div>
<p>Methods that are common to all chart types are documented below. See
<a class="reference internal" href="index.html#working-with-charts"><span class="std std-ref">Working with Charts</span></a> for chart specific information.</p>
<div class="section" id="chart-add-series">
<h4>chart.add_series()</h4>
<dl class="function">
<dt id="add_series">
<code class="descname">add_series</code><span class="sig-paren">(</span><em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Add a data series to a chart.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary of chart series options.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>In Excel a chart <strong>series</strong> is a collection of information that defines which
data is plotted such as values, axis labels and formatting.</p>
<p>For an XlsxWriter chart object the <code class="docutils literal notranslate"><span class="pre">add_series()</span></code> method is used to set the
properties for a series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$1:$B$5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;line&#39;</span><span class="p">:</span>       <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span>
<span class="p">})</span>

<span class="c1"># Or using a list of values instead of category/value formulas:</span>
<span class="c1">#     [sheetname, first_row, first_col, last_row, last_col]</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="s1">&#39;line&#39;</span><span class="p">:</span>       <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>As shown above the <code class="docutils literal notranslate"><span class="pre">categories</span></code> and <code class="docutils literal notranslate"><span class="pre">values</span></code> can take either a range
formula such as <code class="docutils literal notranslate"><span class="pre">=Sheet1!$A$2:$A$7</span></code> or, more usefully when generating the
range programmatically, a list with zero indexed row/column values.</p>
<p>The series options that can be set are:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">values</span></code>: This is the most important property of a series and is the only
mandatory option for every chart object. This option links the chart with
the worksheet data that it displays. The data range can be set using a
formula as shown in the first example above or using a list of values as
shown in the second example.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">categories</span></code>: This sets the chart category labels. The category is more
or less the same as the X axis. In most chart types the <code class="docutils literal notranslate"><span class="pre">categories</span></code>
property is optional and the chart will just assume a sequential series from
<code class="docutils literal notranslate"><span class="pre">1..n</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">name</span></code>: Set the name for the series. The name is displayed in the formula
bar. For non-Pie/Doughnut charts it is also displayed in the legend. The
name property is optional and if it isn’t supplied it will default to
<code class="docutils literal notranslate"><span class="pre">Series</span> <span class="pre">1..n</span></code>. The name can also be a formula such as <code class="docutils literal notranslate"><span class="pre">=Sheet1!$A$1</span></code> or
a list with a sheetname, row and column such as <code class="docutils literal notranslate"><span class="pre">['Sheet1',</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">line</span></code>: Set the properties of the series line type such as color and
width. See <a class="reference internal" href="index.html#chart-formatting-line"><span class="std std-ref">Chart formatting: Line</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">border</span></code>: Set the border properties of the series such as color and
style. See <a class="reference internal" href="index.html#chart-formatting-border"><span class="std std-ref">Chart formatting: Border</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">fill</span></code>: Set the solid fill properties of the series such as color. See
<a class="reference internal" href="index.html#chart-formatting-fill"><span class="std std-ref">Chart formatting: Solid Fill</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">pattern</span></code>: Set the pattern fill properties of the series. See
<a class="reference internal" href="index.html#chart-formatting-pattern"><span class="std std-ref">Chart formatting: Pattern Fill</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">gradient</span></code>: Set the gradient fill properties of the series. See
<a class="reference internal" href="index.html#chart-formatting-gradient"><span class="std std-ref">Chart formatting: Gradient Fill</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">marker</span></code>: Set the properties of the series marker such as style and
color. See <a class="reference internal" href="index.html#chart-series-option-marker"><span class="std std-ref">Chart series option: Marker</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">trendline</span></code>: Set the properties of the series trendline such as linear,
polynomial and moving average types. See
<a class="reference internal" href="index.html#chart-series-option-trendline"><span class="std std-ref">Chart series option: Trendline</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">smooth</span></code>: Set the smooth property of a line series.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">y_error_bars</span></code>: Set vertical error bounds for a chart series. See
<a class="reference internal" href="index.html#chart-series-option-error-bars"><span class="std std-ref">Chart series option: Error Bars</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">x_error_bars</span></code>: Set horizontal error bounds for a chart series. See
<a class="reference internal" href="index.html#chart-series-option-error-bars"><span class="std std-ref">Chart series option: Error Bars</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">data_labels</span></code>: Set data labels for the series. See
<a class="reference internal" href="index.html#chart-series-option-data-labels"><span class="std std-ref">Chart series option: Data Labels</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">points</span></code>: Set properties for individual points in a series. See
<a class="reference internal" href="index.html#chart-series-option-points"><span class="std std-ref">Chart series option: Points</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">invert_if_negative</span></code>: Invert the fill color for negative values. Usually
only applicable to column and bar charts.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">overlap</span></code>: Set the overlap between series in a Bar/Column chart. The
range is +/- 100. The default is 0:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$1:$B$5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;overlap&#39;</span><span class="p">:</span>    <span class="mi">10</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
<p>Note, it is only necessary to apply the <code class="docutils literal notranslate"><span class="pre">overlap</span></code> property to one series
in the chart.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">gap</span></code>: Set the gap between series in a Bar/Column chart. The range is 0
to 500. The default is 150:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$1:$B$5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;gap&#39;</span><span class="p">:</span>        <span class="mi">200</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
<p>Note, it is only necessary to apply the <code class="docutils literal notranslate"><span class="pre">gap</span></code> property to one series in
the chart.</p>
</li>
</ul>
<p>More than one series can be added to a chart. In fact, some chart types such as
<code class="docutils literal notranslate"><span class="pre">stock</span></code> require it. The series numbering and order in the Excel chart will
be the same as the order in which they are added in XlsxWriter.</p>
<p>It is also possible to specify non-contiguous ranges:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=(Sheet1!$A$1:$A$9,Sheet1!$A$14:$A$25)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=(Sheet1!$B$1:$B$9,Sheet1!$B$14:$B$25)&#39;</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="chart-set-x-axis">
<h4>chart.set_x_axis()</h4>
<dl class="function">
<dt id="set_x_axis">
<code class="descname">set_x_axis</code><span class="sig-paren">(</span><em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Set the chart X axis options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary of axis options.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_x_axis()</span></code> method is used to set properties of the X axis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Earnings per Quarter&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name_font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="s1">&#39;num_font&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;italic&#39;</span><span class="p">:</span> <span class="kc">True</span> <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_x_axis.png"><img alt="_images/chart_x_axis.png" src="_images/chart_x_axis.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The options that can be set are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span>
<span class="n">name_font</span>
<span class="n">name_layout</span>
<span class="n">num_font</span>
<span class="n">num_format</span>
<span class="n">line</span>
<span class="n">fill</span>
<span class="n">pattern</span>
<span class="n">gradient</span>
<span class="nb">min</span>
<span class="nb">max</span>
<span class="n">minor_unit</span>
<span class="n">major_unit</span>
<span class="n">interval_unit</span>
<span class="n">interval_tick</span>
<span class="n">crossing</span>
<span class="n">position_axis</span>
<span class="n">reverse</span>
<span class="n">log_base</span>
<span class="n">label_position</span>
<span class="n">label_align</span>
<span class="n">major_gridlines</span>
<span class="n">minor_gridlines</span>
<span class="n">visible</span>
<span class="n">date_axis</span>
<span class="n">text_axis</span>
<span class="n">minor_unit_type</span>
<span class="n">major_unit_type</span>
<span class="n">minor_tick_mark</span>
<span class="n">major_tick_mark</span>
<span class="n">display_units</span>
<span class="n">display_units_visible</span>
</pre></div>
</div>
<p>These options are explained below. Some properties are only applicable to
<strong>value</strong>, <strong>category</strong> or <strong>date</strong> axes (this is noted in each case). See
<a class="reference internal" href="index.html#chart-val-cat-axes"><span class="std std-ref">Chart Value and Category Axes</span></a> for an explanation of Excel’s distinction between
the axis types.</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">name</span></code>: Set the name (also known as title or caption) for the axis. The
name is displayed below the X axis. (Applicable to category, date and value
axes.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Earnings per Quarter&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>This property is optional. The default is to have no axis name.</p>
<p>The name can also be a formula such as <code class="docutils literal notranslate"><span class="pre">=Sheet1!$A$1</span></code> or a list with a
sheetname, row and column such as <code class="docutils literal notranslate"><span class="pre">['Sheet1',</span> <span class="pre">0,</span> <span class="pre">0]</span></code>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">name_font</span></code>: Set the font properties for the axis name. (Applicable to
category, date and value axes.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name_font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;italic&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}})</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="index.html#chart-fonts"><span class="std std-ref">Chart Fonts</span></a> section for more details on font properties.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">name_layout</span></code>: Set the <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> position of the axis caption in chart
relative units. (Applicable to category, date and value axes.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;X axis&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name_layout&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mf">0.34</span><span class="p">,</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="index.html#chart-layout"><span class="std std-ref">Chart Layout</span></a> section for more details.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">num_font</span></code>: Set the font properties for the axis numbers. (Applicable to
category, date and value axes.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name_font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;italic&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}})</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="index.html#chart-fonts"><span class="std std-ref">Chart Fonts</span></a> section for more details on font properties.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">num_format</span></code>: Set the number format for the axis. (Applicable to
category, date and value axes.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;#,##0.00&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;0.00%&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The number format is similar to the Worksheet Cell Format <code class="docutils literal notranslate"><span class="pre">num_format</span></code>
apart from the fact that a format index cannot be used. An explicit format
string must be used as shown above. See <a class="reference internal" href="index.html#set_num_format" title="set_num_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_num_format()</span></code></a> for more
information.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">line</span></code>: Set the properties of the axis line type such as color and
width. See <a class="reference internal" href="index.html#chart-formatting-line"><span class="std std-ref">Chart formatting: Line</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">fill</span></code>: Set the solid fill properties of the axis such as color. See
<a class="reference internal" href="index.html#chart-formatting-fill"><span class="std std-ref">Chart formatting: Solid Fill</span></a>.  Note, in Excel the axis fill is applied to
the area of the numbers of the axis and not to the area of the axis bounding
box. That background is set from the chartarea fill.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">pattern</span></code>: Set the pattern fill properties of the axis. See
<a class="reference internal" href="index.html#chart-formatting-pattern"><span class="std std-ref">Chart formatting: Pattern Fill</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">gradient</span></code>: Set the gradient fill properties of the axis. See
<a class="reference internal" href="index.html#chart-formatting-gradient"><span class="std std-ref">Chart formatting: Gradient Fill</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">min</span></code>: Set the minimum value for the axis range. (Applicable to value and
date axes only.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_max_min.png"><img alt="_images/chart_max_min.png" src="_images/chart_max_min.png" style="width: 705.0px; height: 402.75px;" /></a>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">max</span></code>: Set the maximum value for the axis range. (Applicable to value and
date axes only.)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">minor_unit</span></code>: Set the increment of the minor units in the axis range.
(Applicable to value and date axes only.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;minor_unit&#39;</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">,</span> <span class="s1">&#39;major_unit&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">major_unit</span></code>: Set the increment of the major units in the axis range.
(Applicable to value and date axes only.)</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">interval_unit</span></code>: Set the interval unit for a category axis. Should be an
integer value. (Applicable to category axes only.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;interval_unit&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">interval_tick</span></code>: Set the tick interval for a category axis. Should be an
integer value. (Applicable to category axes only.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;interval_tick&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">crossing</span></code>: Set the position where the y axis will cross the x axis.
(Applicable to all axes.)</p>
<p>The <code class="docutils literal notranslate"><span class="pre">crossing</span></code> value can either be the string <code class="docutils literal notranslate"><span class="pre">'max'</span></code> to set the
crossing at the maximum axis value or a numeric value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;crossing&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;crossing&#39;</span><span class="p">:</span> <span class="s1">&#39;max&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p><strong>For category axes the numeric value must be an integer</strong> to represent the
category number that the axis crosses at. For value and date axes it can
have any value associated with the axis. See also <a class="reference internal" href="index.html#chart-val-cat-axes"><span class="std std-ref">Chart Value and Category Axes</span></a>.</p>
<p>If crossing is omitted (the default) the crossing will be set automatically
by Excel based on the chart data.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">position_axis</span></code>: Position the axis on or between the axis tick marks.
(Applicable to category axes only.)</p>
<p>There are two allowable values <code class="docutils literal notranslate"><span class="pre">on_tick</span></code> and <code class="docutils literal notranslate"><span class="pre">between</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;position_axis&#39;</span><span class="p">:</span> <span class="s1">&#39;on_tick&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;position_axis&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">reverse</span></code>: Reverse the order of the axis categories or values.
(Applicable to category, date and value axes.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;reverse&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_reverse.png"><img alt="_images/chart_reverse.png" src="_images/chart_reverse.png" style="width: 704.25px; height: 402.75px;" /></a>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">log_base</span></code>: Set the log base of the axis range. (Applicable to value axes
only.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;log_base&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">label_position</span></code>: Set the “Axis labels” position for the axis. The
following positions are available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">next_to</span> <span class="p">(</span><span class="n">the</span> <span class="n">default</span><span class="p">)</span>
<span class="n">high</span>
<span class="n">low</span>
<span class="n">none</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;label_position&#39;</span><span class="p">:</span> <span class="s1">&#39;high&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;label_position&#39;</span><span class="p">:</span> <span class="s1">&#39;low&#39;</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">label_align</span></code>: Align the “Axis labels” the axis. (Applicable to category
axes only.)</p>
<p>The following Excel alignments are available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">center</span> <span class="p">(</span><span class="n">the</span> <span class="n">default</span><span class="p">)</span>
<span class="n">right</span>
<span class="n">left</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;label_align&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">major_gridlines</span></code>: Configure the major gridlines for the axis. The
available properties are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">visible</span>
<span class="n">line</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span>
    <span class="s1">&#39;major_gridlines&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;visible&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">1.25</span><span class="p">,</span> <span class="s1">&#39;dash_type&#39;</span><span class="p">:</span> <span class="s1">&#39;dash&#39;</span><span class="p">}</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_gridlines.png"><img alt="_images/chart_gridlines.png" src="_images/chart_gridlines.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">visible</span></code> property is usually on for the X axis but it depends on the
type of chart.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">line</span></code> property sets the gridline properties such as color and
width. See <a class="reference internal" href="index.html#chart-formatting"><span class="std std-ref">Chart Formatting</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">minor_gridlines</span></code>: This takes the same options as <code class="docutils literal notranslate"><span class="pre">major_gridlines</span></code>
above.</p>
<p>The minor gridline <code class="docutils literal notranslate"><span class="pre">visible</span></code> property is off by default for all chart
types.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">visible</span></code>: Configure the visibility of the axis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;visible&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>
</div>
<p>Axes are visible by default.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">date_axis</span></code>: This option is used to treat a category axis with date or
time data as a Date Axis. (Applicable to date category axes only.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;date_axis&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>This option also allows you to set <code class="docutils literal notranslate"><span class="pre">max</span></code> and <code class="docutils literal notranslate"><span class="pre">min</span></code> values for a
category axis which isn’t allowed by Excel for non-date category axes.</p>
<p>See <a class="reference internal" href="index.html#date-category-axes"><span class="std std-ref">Date Category Axes</span></a> for more details.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">text_axis</span></code>: This option is used to treat a category axis explicitly
as a Text Axis. (Applicable to category axes only.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;text_axis&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">minor_unit_type</span></code>: For <code class="docutils literal notranslate"><span class="pre">date_axis</span></code> axes, see above, this option is used
to set the type of the minor units. (Applicable to date category axes
only.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span>
    <span class="s1">&#39;date_axis&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;minor_unit&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
    <span class="s1">&#39;minor_unit_type&#39;</span><span class="p">:</span> <span class="s1">&#39;months&#39;</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">major_unit_type</span></code>: Same as <code class="docutils literal notranslate"><span class="pre">minor_unit_type</span></code>, see above, but for major
axes unit types.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">minor_tick_mark</span></code>: Set the axis minor tick mark type/position to one of
the following values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">none</span>
<span class="n">inside</span>
<span class="n">outside</span>
<span class="n">cross</span>   <span class="p">(</span><span class="n">inside</span> <span class="ow">and</span> <span class="n">outside</span><span class="p">)</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;major_tick_mark&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;minor_tick_mark&#39;</span><span class="p">:</span> <span class="s1">&#39;inside&#39;</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">major_tick_mark</span></code>: Same as <code class="docutils literal notranslate"><span class="pre">minor_tick_mark</span></code>, see above, but for major
axes ticks.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">display_units</span></code>: Set the display units for the axis. This can be useful if
the axis numbers are very large but you don’t want to represent them in
scientific notation. The available display units are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hundreds</span>
<span class="n">thousands</span>
<span class="n">ten_thousands</span>
<span class="n">hundred_thousands</span>
<span class="n">millions</span>
<span class="n">ten_millions</span>
<span class="n">hundred_millions</span>
<span class="n">billions</span>
<span class="n">trillions</span>
</pre></div>
</div>
<p>Applicable to value axes only.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;display_units&#39;</span><span class="p">:</span> <span class="s1">&#39;thousands&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;display_units&#39;</span><span class="p">:</span> <span class="s1">&#39;millions&#39;</span><span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_display_units.png"><img alt="_images/chart_display_units.png" src="_images/chart_display_units.png" style="width: 705.0px; height: 402.75px;" /></a>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">display_units_visible</span></code>: Control the visibility of the display units
turned on by the previous option. This option is on by default. (Applicable
to value axes only.):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;display_units&#39;</span><span class="p">:</span> <span class="s1">&#39;hundreds&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;display_units_visible&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="chart-set-y-axis">
<h4>chart.set_y_axis()</h4>
<dl class="function">
<dt id="set_y_axis">
<code class="descname">set_y_axis</code><span class="sig-paren">(</span><em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Set the chart Y axis options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary of axis options.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_y_axis()</span></code> method is used to set properties of the Y axis.</p>
<p>The properties that can be set are the same as for <code class="docutils literal notranslate"><span class="pre">set_x_axis</span></code>, see above.</p>
</div>
<div class="section" id="chart-set-x2-axis">
<h4>chart.set_x2_axis()</h4>
<dl class="function">
<dt id="set_x2_axis">
<code class="descname">set_x2_axis</code><span class="sig-paren">(</span><em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Set the chart secondary X axis options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary of axis options.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_x2_axis()</span></code> method is used to set properties of the secondary X axis,
see <code class="xref py py-func docutils literal notranslate"><span class="pre">chart_secondary_axes()</span></code>.</p>
<p>The properties that can be set are the same as for <code class="docutils literal notranslate"><span class="pre">set_x_axis</span></code>, see above.</p>
<p>The default properties for this axis are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;label_position&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span>
<span class="s1">&#39;crossing&#39;</span><span class="p">:</span>       <span class="s1">&#39;max&#39;</span><span class="p">,</span>
<span class="s1">&#39;visible&#39;</span><span class="p">:</span>        <span class="kc">False</span><span class="p">,</span>
</pre></div>
</div>
</div>
<div class="section" id="chart-set-y2-axis">
<h4>chart.set_y2_axis()</h4>
<dl class="function">
<dt id="set_y2_axis">
<code class="descname">set_y2_axis</code><span class="sig-paren">(</span><em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Set the chart secondary Y axis options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary of axis options.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_y2_axis()</span></code> method is used to set properties of the secondary Y axis,
see <code class="xref py py-func docutils literal notranslate"><span class="pre">chart_secondary_axes()</span></code>.</p>
<p>The properties that can be set are the same as for <code class="docutils literal notranslate"><span class="pre">set_x_axis</span></code>, see above.</p>
<p>The default properties for this axis are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;major_gridlines&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;visible&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="chart-combine">
<h4>chart.combine()</h4>
<dl class="function">
<dt id="combine">
<code class="descname">combine</code><span class="sig-paren">(</span><em>chart</em><span class="sig-paren">)</span></dt>
<dd><p>Combine two charts of different types.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>chart</strong> – A chart object created with <a class="reference internal" href="index.html#add_chart" title="add_chart"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_chart()</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The chart <code class="docutils literal notranslate"><span class="pre">combine()</span></code> method is used to combine two charts of different
types, for example a column and line chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a primary chart.</span>
<span class="n">column_chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>
<span class="n">column_chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span><span class="o">...</span><span class="p">})</span>

<span class="c1"># Create a secondary chart.</span>
<span class="n">line_chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>
<span class="n">line_chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span><span class="o">...</span><span class="p">})</span>

<span class="c1"># Combine the charts.</span>
<span class="n">column_chart</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">line_chart</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_combined1.png"><img alt="_images/chart_combined1.png" src="_images/chart_combined1.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>See the <a class="reference internal" href="index.html#chart-combined-charts"><span class="std std-ref">Combined Charts</span></a> section for more details.</p>
</div>
<div class="section" id="chart-set-size">
<h4>chart.set_size()</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">set_size()</span></code> method is used to set the dimensions of the chart. The size
properties that can be set are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">width</span>
<span class="n">height</span>
<span class="n">x_scale</span>
<span class="n">y_scale</span>
<span class="n">x_offset</span>
<span class="n">y_offset</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">width</span></code> and <code class="docutils literal notranslate"><span class="pre">height</span></code> are in pixels. The default chart width x height is
480 x 288 pixels. The size of the chart can be modified by setting the
<code class="docutils literal notranslate"><span class="pre">width</span></code> and <code class="docutils literal notranslate"><span class="pre">height</span></code> or by setting the <code class="docutils literal notranslate"><span class="pre">x_scale</span></code> and <code class="docutils literal notranslate"><span class="pre">y_scale</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_size</span><span class="p">({</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">720</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">576</span><span class="p">})</span>
<span class="c1"># Same as:</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_size</span><span class="p">({</span><span class="s1">&#39;x_scale&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;y_scale&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">x_offset</span></code> and <code class="docutils literal notranslate"><span class="pre">y_offset</span></code> position the top left corner of the chart in
the cell that it is inserted into.</p>
<p>Note: the <code class="docutils literal notranslate"><span class="pre">x_offset</span></code> and <code class="docutils literal notranslate"><span class="pre">y_offset</span></code> parameters can also be set via the
<a class="reference internal" href="index.html#insert_chart" title="insert_chart"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_chart()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;E2&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="chart-set-title">
<h4>chart.set_title()</h4>
<dl class="function">
<dt id="set_title">
<code class="descname">set_title</code><span class="sig-paren">(</span><em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Set the chart title options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary of chart size options.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_title()</span></code> method is used to set properties of the chart title:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Year End Results&#39;</span><span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_title.png"><img alt="_images/chart_title.png" src="_images/chart_title.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The properties that can be set are:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">name</span></code>: Set the name (title) for the chart. The name is displayed above
the chart. The name can also be a formula such as <code class="docutils literal notranslate"><span class="pre">=Sheet1!$A$1</span></code> or a list
with a sheetname, row and column such as <code class="docutils literal notranslate"><span class="pre">['Sheet1',</span> <span class="pre">0,</span> <span class="pre">0]</span></code>. The name
property is optional. The default is to have no chart title.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">name_font</span></code>: Set the font properties for the chart title. See
<a class="reference internal" href="index.html#chart-fonts"><span class="std std-ref">Chart Fonts</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">overlay</span></code>: Allow the title to be overlaid on the chart. Generally used
with the layout property below.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">layout</span></code>: Set the <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> position of the title in chart relative
units:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Title&#39;</span><span class="p">,</span>
    <span class="s1">&#39;overlay&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;layout&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mf">0.42</span><span class="p">,</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mf">0.14</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="index.html#chart-layout"><span class="std std-ref">Chart Layout</span></a> section for more details.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">none</span></code>: By default Excel adds an automatic chart title to charts with a
single series and a user defined series name. The <code class="docutils literal notranslate"><span class="pre">none</span></code> option turns this
default title off. It also turns off all other <code class="docutils literal notranslate"><span class="pre">set_title()</span></code> options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="chart-set-legend">
<h4>chart.set_legend()</h4>
<dl class="function">
<dt id="set_legend">
<code class="descname">set_legend</code><span class="sig-paren">(</span><em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Set the chart legend options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary of chart legend options.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_legend()</span></code> method is used to set properties of the chart legend. For
example it can be used to turn off the default chart legend:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_legend_none.png"><img alt="_images/chart_legend_none.png" src="_images/chart_legend_none.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The options that can be set are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">none</span>
<span class="n">position</span>
<span class="n">font</span>
<span class="n">border</span>
<span class="n">fill</span>
<span class="n">pattern</span>
<span class="n">gradient</span>
<span class="n">delete_series</span>
<span class="n">layout</span>
</pre></div>
</div>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">none</span></code>: In Excel chart legends are on by default. The <code class="docutils literal notranslate"><span class="pre">none</span></code> option
turns off the chart legend:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>For backward compatibility, it is also possible to turn off the legend via
the <code class="docutils literal notranslate"><span class="pre">position</span></code> property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;position&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">position</span></code>: Set the position of the chart legend:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;position&#39;</span><span class="p">:</span> <span class="s1">&#39;bottom&#39;</span><span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_legend_bottom.png"><img alt="_images/chart_legend_bottom.png" src="_images/chart_legend_bottom.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The default legend position is <code class="docutils literal notranslate"><span class="pre">right</span></code>. The available positions are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">top</span>
<span class="n">bottom</span>
<span class="n">left</span>
<span class="n">right</span>
<span class="n">overlay_left</span>
<span class="n">overlay_right</span>
<span class="n">none</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">font</span></code>: Set the font properties of the chart legend:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}})</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="index.html#chart-fonts"><span class="std std-ref">Chart Fonts</span></a> section for more details on font properties.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">border</span></code>: Set the border properties of the legend such as color and
style. See <a class="reference internal" href="index.html#chart-formatting-border"><span class="std std-ref">Chart formatting: Border</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">fill</span></code>: Set the solid fill properties of the legend such as color. See
<a class="reference internal" href="index.html#chart-formatting-fill"><span class="std std-ref">Chart formatting: Solid Fill</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">pattern</span></code>: Set the pattern fill properties of the legend. See
<a class="reference internal" href="index.html#chart-formatting-pattern"><span class="std std-ref">Chart formatting: Pattern Fill</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">gradient</span></code>: Set the gradient fill properties of the legend. See
<a class="reference internal" href="index.html#chart-formatting-gradient"><span class="std std-ref">Chart formatting: Gradient Fill</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">delete_series</span></code>: This allows you to remove one or more series from the
legend (the series will still display on the chart). This property takes
a list as an argument and the series are zero indexed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Delete/hide series index 0 and 2 from the legend.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;delete_series&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_legend_delete.png"><img alt="_images/chart_legend_delete.png" src="_images/chart_legend_delete.png" style="width: 704.25px; height: 402.75px;" /></a>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">layout</span></code>: Set the <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> position of the legend in chart relative
units:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span>
    <span class="s1">&#39;layout&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span>      <span class="mf">0.80</span><span class="p">,</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span>      <span class="mf">0.37</span><span class="p">,</span>
        <span class="s1">&#39;width&#39;</span><span class="p">:</span>  <span class="mf">0.12</span><span class="p">,</span>
        <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="index.html#chart-layout"><span class="std std-ref">Chart Layout</span></a> section for more details.</p>
</li>
</ul>
</div>
<div class="section" id="chart-set-chartarea">
<h4>chart.set_chartarea()</h4>
<dl class="function">
<dt id="set_chartarea">
<code class="descname">set_chartarea</code><span class="sig-paren">(</span><em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Set the chart area options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary of chart area options.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_chartarea()</span></code> method is used to set the properties of the chart area.
In Excel the chart area is the background area behind the chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_chartarea</span><span class="p">({</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_chartarea.png"><img alt="_images/chart_chartarea.png" src="_images/chart_chartarea.png" style="width: 702.75px; height: 401.25px;" /></a>
<p>The properties that can be set are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">border</span></code>: Set the border properties of the chartarea such as color and
style. See <a class="reference internal" href="index.html#chart-formatting-border"><span class="std std-ref">Chart formatting: Border</span></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">fill</span></code>: Set the solid fill properties of the chartarea such as color. See
<a class="reference internal" href="index.html#chart-formatting-fill"><span class="std std-ref">Chart formatting: Solid Fill</span></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">pattern</span></code>: Set the pattern fill properties of the chartarea. See
<a class="reference internal" href="index.html#chart-formatting-pattern"><span class="std std-ref">Chart formatting: Pattern Fill</span></a>.</li>
<li><code class="docutils literal notranslate"><span class="pre">gradient</span></code>: Set the gradient fill properties of the chartarea. See
<a class="reference internal" href="index.html#chart-formatting-gradient"><span class="std std-ref">Chart formatting: Gradient Fill</span></a>.</li>
</ul>
</div>
<div class="section" id="chart-set-plotarea">
<h4>chart.set_plotarea()</h4>
<dl class="function">
<dt id="set_plotarea">
<code class="descname">set_plotarea</code><span class="sig-paren">(</span><em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Set the plot area options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary of plot area options.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_plotarea()</span></code> method is used to set properties of the plot area of a
chart. In Excel the plot area is the area between the axes on which the chart
series are plotted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_plotarea</span><span class="p">({</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;dash_type&#39;</span><span class="p">:</span> <span class="s1">&#39;dash&#39;</span><span class="p">},</span>
    <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#FFFFC2&#39;</span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_plotarea.png"><img alt="_images/chart_plotarea.png" src="_images/chart_plotarea.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The properties that can be set are:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">border</span></code>: Set the border properties of the plotarea such as color and
style. See <a class="reference internal" href="index.html#chart-formatting-border"><span class="std std-ref">Chart formatting: Border</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">fill</span></code>: Set the solid fill properties of the plotarea such as color. See
<a class="reference internal" href="index.html#chart-formatting-fill"><span class="std std-ref">Chart formatting: Solid Fill</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">pattern</span></code>: Set the pattern fill properties of the plotarea. See
<a class="reference internal" href="index.html#chart-formatting-pattern"><span class="std std-ref">Chart formatting: Pattern Fill</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">gradient</span></code>: Set the gradient fill properties of the plotarea. See
<a class="reference internal" href="index.html#chart-formatting-gradient"><span class="std std-ref">Chart formatting: Gradient Fill</span></a>.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">layout</span></code>: Set the <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> position of the plotarea in chart relative
units:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_plotarea</span><span class="p">({</span>
    <span class="s1">&#39;layout&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span>      <span class="mf">0.13</span><span class="p">,</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span>      <span class="mf">0.26</span><span class="p">,</span>
        <span class="s1">&#39;width&#39;</span><span class="p">:</span>  <span class="mf">0.73</span><span class="p">,</span>
        <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mf">0.57</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="index.html#chart-layout"><span class="std std-ref">Chart Layout</span></a> section for more details.</p>
</li>
</ul>
</div>
<div class="section" id="chart-set-style">
<h4>chart.set_style()</h4>
<dl class="function">
<dt id="set_style">
<code class="descname">set_style</code><span class="sig-paren">(</span><em>style_id</em><span class="sig-paren">)</span></dt>
<dd><p>Set the chart style type.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>style_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – An index representing the chart style.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_style()</span></code> method is used to set the style of the chart to one of the
48 built-in styles available on the ‘Design’ tab in Excel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_style.png"><img alt="_images/chart_style.png" src="_images/chart_style.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The style index number is counted from 1 on the top left. The default style is
2.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In Excel 2013 the Styles section of the ‘Design’ tab in Excel shows what
were referred to as ‘Layouts’ in previous versions of Excel. These layouts
are not defined in the file format. They are a collection of modifications
to the base chart type. They can be replicated using the XlsxWriter Chart
API but they cannot be defined by the <code class="docutils literal notranslate"><span class="pre">set_style()</span></code> method.</p>
</div>
</div>
<div class="section" id="chart-set-table">
<h4>chart.set_table()</h4>
<dl class="function">
<dt id="set_table">
<code class="descname">set_table</code><span class="sig-paren">(</span><em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Set properties for an axis data table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary of axis table options.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_table()</span></code> method adds a data table below the horizontal axis with the
data used to plot the chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_table</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_table.png"><img alt="_images/chart_table.png" src="_images/chart_table.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The available options, with default values are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;horizontal&#39;</span><span class="p">:</span> <span class="kc">True</span>   <span class="c1"># Display vertical lines in the table.</span>
<span class="s1">&#39;vertical&#39;</span><span class="p">:</span>   <span class="kc">True</span>   <span class="c1"># Display horizontal lines in the table.</span>
<span class="s1">&#39;outline&#39;</span><span class="p">:</span>    <span class="kc">True</span>   <span class="c1"># Display an outline in the table.</span>
<span class="s1">&#39;show_keys&#39;</span><span class="p">:</span>  <span class="kc">False</span>  <span class="c1"># Show the legend keys with the table data.</span>
<span class="s1">&#39;font&#39;</span><span class="p">:</span>       <span class="p">{}</span>     <span class="c1"># Standard chart font properties.</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_table</span><span class="p">({</span><span class="s1">&#39;show_keys&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>The data table can only be shown with Bar, Column, Line, Area and stock
charts.  See the <a class="reference internal" href="index.html#chart-fonts"><span class="std std-ref">Chart Fonts</span></a> section for more details on font
properties.</p>
</div>
<div class="section" id="chart-set-up-down-bars">
<h4>chart.set_up_down_bars()</h4>
<dl class="function">
<dt id="set_up_down_bars">
<code class="descname">set_up_down_bars</code><span class="sig-paren">(</span><em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Set properties for the chart up-down bars.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary of options.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_up_down_bars()</span></code> method adds Up-Down bars to Line charts to indicate
the difference between the first and last data series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_up_down_bars</span><span class="p">()</span>
</pre></div>
</div>
<p>It is possible to format the up and down bars to add <code class="docutils literal notranslate"><span class="pre">fill</span></code>, <code class="docutils literal notranslate"><span class="pre">pattern</span></code> or
<code class="docutils literal notranslate"><span class="pre">gradient</span></code> and <code class="docutils literal notranslate"><span class="pre">border</span></code> properties if required. See
<a class="reference internal" href="index.html#chart-formatting"><span class="std std-ref">Chart Formatting</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_up_down_bars</span><span class="p">({</span>
    <span class="s1">&#39;up&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#00B050&#39;</span><span class="p">},</span>
        <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">}</span>
    <span class="p">},</span>
    <span class="s1">&#39;down&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span>
        <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">},</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_up_down_bars.png"><img alt="_images/chart_up_down_bars.png" src="_images/chart_up_down_bars.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>Up-down bars can only be applied to Line charts and to Stock charts (by
default).</p>
</div>
<div class="section" id="chart-set-drop-lines">
<h4>chart.set_drop_lines()</h4>
<dl class="function">
<dt id="set_drop_lines">
<code class="descname">set_drop_lines</code><span class="sig-paren">(</span><em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Set properties for the chart drop lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary of options.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_drop_lines()</span></code> method adds Drop Lines to charts to show the Category
value of points in the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_drop_lines</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_drop_lines.png"><img alt="_images/chart_drop_lines.png" src="_images/chart_drop_lines.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>It is possible to format the Drop Line <code class="docutils literal notranslate"><span class="pre">line</span></code> properties if required. See
<a class="reference internal" href="index.html#chart-formatting"><span class="std std-ref">Chart Formatting</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_drop_lines</span><span class="p">({</span><span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;dash_type&#39;</span><span class="p">:</span> <span class="s1">&#39;square_dot&#39;</span><span class="p">}})</span>
</pre></div>
</div>
<p>Drop Lines are only available in Line, Area and Stock charts.</p>
</div>
<div class="section" id="chart-set-high-low-lines">
<h4>chart.set_high_low_lines()</h4>
<dl class="function">
<dt id="set_high_low_lines">
<code class="descname">set_high_low_lines</code><span class="sig-paren">(</span><em>options</em><span class="sig-paren">)</span></dt>
<dd><p>Set properties for the chart high-low lines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary of options.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_high_low_lines()</span></code> method adds High-Low lines to charts to show the
maximum and minimum values of points in a Category:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_high_low_lines</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_high_low_lines.png"><img alt="_images/chart_high_low_lines.png" src="_images/chart_high_low_lines.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>It is possible to format the High-Low Line <code class="docutils literal notranslate"><span class="pre">line</span></code> properties if required. See
<a class="reference internal" href="index.html#chart-formatting"><span class="std std-ref">Chart Formatting</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_high_low_lines</span><span class="p">({</span>
    <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
        <span class="s1">&#39;dash_type&#39;</span><span class="p">:</span> <span class="s1">&#39;square_dot&#39;</span>
    <span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>High-Low Lines are only available in Line and Stock charts.</p>
</div>
<div class="section" id="chart-show-blanks-as">
<h4>chart.show_blanks_as()</h4>
<dl class="function">
<dt id="show_blanks_as">
<code class="descname">show_blanks_as</code><span class="sig-paren">(</span><em>option</em><span class="sig-paren">)</span></dt>
<dd><p>Set the option for displaying blank data in a chart.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>option</strong> (<em>string</em>) – A string representing the display option.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">show_blanks_as()</span></code> method controls how blank data is displayed in a
chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">show_blanks_as</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The available options are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;gap&#39;</span>   <span class="c1"># Blank data is shown as a gap. The default.</span>
<span class="s1">&#39;zero&#39;</span>  <span class="c1"># Blank data is displayed as zero.</span>
<span class="s1">&#39;span&#39;</span>  <span class="c1"># Blank data is connected with a line.</span>
</pre></div>
</div>
</div>
<div class="section" id="chart-show-hidden-data">
<h4>chart.show_hidden_data()</h4>
<dl class="function">
<dt id="show_hidden_data">
<code class="descname">show_hidden_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Display data on charts from hidden rows or columns.</p>
</dd></dl>

<p>Display data in hidden rows or columns on the chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">show_hidden_data</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="chart-set-rotation">
<h4>chart.set_rotation()</h4>
<dl class="function">
<dt>
<code class="descname">set_rotation</code><span class="sig-paren">(</span><em>rotation</em><span class="sig-paren">)</span></dt>
<dd><p>Set the Pie/Doughnut chart rotation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rotation</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The angle of rotation.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_rotation()</span></code> method is used to set the rotation of the first segment
of a Pie/Doughnut chart. This has the effect of rotating the entire chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">-&gt;</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
<p>The angle of rotation must be in the range <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">rotation</span> <span class="pre">&lt;=</span> <span class="pre">360</span></code>.</p>
<p>This option is only available for Pie/Doughnut charts.</p>
</div>
<div class="section" id="chart-set-hole-size">
<h4>chart.set_hole_size()</h4>
<dl class="function">
<dt id="set_hole_size">
<code class="descname">set_hole_size</code><span class="sig-paren">(</span><em>size</em><span class="sig-paren">)</span></dt>
<dd><p>Set the Doughnut chart hole size.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The hole size as a percentage.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_hole_size()</span></code> method is used to set the hole size of a Doughnut
chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">-&gt;</span><span class="n">set_hole_size</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>
</pre></div>
</div>
<p>The value of the hole size must be in the range <code class="docutils literal notranslate"><span class="pre">10</span> <span class="pre">&lt;=</span> <span class="pre">size</span> <span class="pre">&lt;=</span> <span class="pre">90</span></code>.</p>
<p>This option is only available for Doughnut charts.</p>
<p>See also <a class="reference internal" href="index.html#working-with-charts"><span class="std std-ref">Working with Charts</span></a> and <a class="reference internal" href="index.html#chart-examples"><span class="std std-ref">Chart Examples</span></a>.</p>
</div>
</div>
<span id="document-chartsheet"></span><div class="section" id="the-chartsheet-class">
<span id="chartsheet"></span><h3>The Chartsheet Class</h3>
<p>In Excel a chartsheet is a worksheet that only contains a chart.</p>
<img alt="_images/chartsheet.png" src="_images/chartsheet.png" />
<p>The <strong>Chartsheet</strong> class has some of the functionality of data
<a class="reference internal" href="index.html#worksheet"><span class="std std-ref">Worksheets</span></a> such as tab selection, headers, footers, margins
and print properties but its primary purpose is to display a single chart.
This makes it different from ordinary data worksheets which can have one or
more <em>embedded</em> charts.</p>
<p>Like a data worksheet a chartsheet object isn’t instantiated directly. Instead
a new chartsheet is created by calling the <a class="reference internal" href="index.html#add_chartsheet" title="add_chartsheet"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_chartsheet()</span></code></a> method
from a <a class="reference internal" href="index.html#workbook"><span class="std std-ref">Workbook</span></a> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span>   <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;filename.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span>  <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>  <span class="c1"># Required for the chart data.</span>
<span class="n">chartsheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chartsheet</span><span class="p">()</span>
<span class="c1">#...</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>A chartsheet object functions as a worksheet and not as a chart. In order to
have it display data a <a class="reference internal" href="index.html#chart-class"><span class="std std-ref">Chart</span></a> object must be created and
added to the chartsheet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chartsheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chartsheet</span><span class="p">()</span>
<span class="n">chart</span>      <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">})</span>

<span class="c1"># Configure the chart.</span>

<span class="n">chartsheet</span><span class="o">.</span><span class="n">set_chart</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
</pre></div>
</div>
<p>The data for the chartsheet chart must be contained on a separate worksheet.
That is why it is always created in conjunction with at least one data
worksheet, as shown above.</p>
<div class="section" id="chartsheet-set-chart">
<h4>chartsheet.set_chart()</h4>
<dl class="function">
<dt id="set_chart">
<code class="descname">set_chart</code><span class="sig-paren">(</span><em>chart</em><span class="sig-paren">)</span></dt>
<dd><p>Add a chart to a chartsheet.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>chart</strong> – A chart object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">set_chart()</span></code> method is used to insert a chart into a chartsheet. A chart
object is created via the Workbook <a class="reference internal" href="index.html#add_chart" title="add_chart"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_chart()</span></code></a> method where the chart
type is specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="nb">type</span><span class="p">,</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="n">chartsheet</span><span class="o">.</span><span class="n">set_chart</span><span class="p">(</span><span class="n">chart</span><span class="p">)</span>
</pre></div>
</div>
<p>Only one chart can be added to an individual chartsheet.</p>
<p>See <a class="reference internal" href="index.html#chart-class"><span class="std std-ref">The Chart Class</span></a>, <a class="reference internal" href="index.html#working-with-charts"><span class="std std-ref">Working with Charts</span></a> and <a class="reference internal" href="index.html#chart-examples"><span class="std std-ref">Chart Examples</span></a>.</p>
</div>
<div class="section" id="worksheet-methods">
<h4>Worksheet methods</h4>
<p>The following <a class="reference internal" href="index.html#worksheet"><span class="std std-ref">The Worksheet Class</span></a> methods are also available through a chartsheet:</p>
<ul class="simple">
<li><a class="reference internal" href="index.html#activate" title="activate"><code class="xref py py-func docutils literal notranslate"><span class="pre">activate()</span></code></a></li>
<li><a class="reference internal" href="index.html#select" title="select"><code class="xref py py-func docutils literal notranslate"><span class="pre">select()</span></code></a></li>
<li><a class="reference internal" href="index.html#hide" title="hide"><code class="xref py py-func docutils literal notranslate"><span class="pre">hide()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_first_sheet" title="set_first_sheet"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_first_sheet()</span></code></a></li>
<li><a class="reference internal" href="index.html#protect" title="protect"><code class="xref py py-func docutils literal notranslate"><span class="pre">protect()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_zoom" title="set_zoom"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_zoom()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_tab_color" title="set_tab_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_tab_color()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_landscape" title="set_landscape"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_landscape()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_portrait" title="set_portrait"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_portrait()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_paper" title="set_paper"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_paper()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_margins" title="set_margins"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_margins()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_header" title="set_header"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_header()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_footer" title="set_footer"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_footer()</span></code></a></li>
<li><a class="reference internal" href="index.html#get_name" title="get_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_name()</span></code></a></li>
</ul>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chartsheet</span><span class="o">.</span><span class="n">set_tab_color</span><span class="p">(</span><span class="s1">&#39;#FF9900&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="index.html#set_zoom" title="set_zoom"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_zoom()</span></code></a> method can be used to modify the displayed size of the
chart.</p>
</div>
<div class="section" id="chartsheet-example">
<h4>Chartsheet Example</h4>
<p>See <a class="reference internal" href="index.html#ex-chartsheet"><span class="std std-ref">Example: Chartsheet</span></a>.</p>
</div>
</div>
<span id="document-exceptions"></span><div class="section" id="the-exceptions-class">
<span id="exceptions"></span><h3>The Exceptions Class</h3>
<p>The Exception class contains the various exceptions that can be raised by
XlsxWriter. In general XlsxWriter only raised exceptions for un-recoverable
errors or for errors that would lead to file corruption such as creating two
worksheets with the same name.</p>
<p>The hierarchy of exceptions in XlsxWriter is:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">XlsxWriterException(Exception)</span></code><ul>
<li><code class="docutils literal notranslate"><span class="pre">XlsxFileError(XlsxWriterException)</span></code><ul>
<li><code class="docutils literal notranslate"><span class="pre">FileCreateError(XlsxFileError)</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">UndefinedImageSize(XlsxFileError)</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">UndefinedImageSize(XlsxFileError)</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">FileSizeError(XlsxFileError)</span></code></li>
</ul>
</li>
<li><code class="docutils literal notranslate"><span class="pre">XlsxInputError(XlsxWriterException)</span></code><ul>
<li><code class="docutils literal notranslate"><span class="pre">DuplicateTableName(XlsxInputError)</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">InvalidWorksheetName(XlsxInputError)</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">DuplicateWorksheetName(XlsxInputError)</span></code></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="section" id="exception-xlsxwriterexception">
<h4>Exception: XlsxWriterException</h4>
<dl class="exception">
<dt id="XlsxWriterException">
<em class="property">exception </em><code class="descname">XlsxWriterException</code></dt>
<dd></dd></dl>

<p>Base exception for XlsxWriter.</p>
</div>
<div class="section" id="exception-xlsxfileerror">
<h4>Exception: XlsxFileError</h4>
<dl class="exception">
<dt id="XlsxFileError">
<em class="property">exception </em><code class="descname">XlsxFileError</code></dt>
<dd></dd></dl>

<p>Base exception for all file related errors.</p>
</div>
<div class="section" id="exception-xlsxinputerror">
<h4>Exception: XlsxInputError</h4>
<dl class="exception">
<dt id="XlsxInputError">
<em class="property">exception </em><code class="descname">XlsxInputError</code></dt>
<dd></dd></dl>

<p>Base exception for all input data related errors.</p>
</div>
<div class="section" id="exception-filecreateerror">
<h4>Exception: FileCreateError</h4>
<dl class="exception">
<dt id="FileCreateError">
<em class="property">exception </em><code class="descname">FileCreateError</code></dt>
<dd></dd></dl>

<p>This exception is raised if there is a file permission, or IO error, when
writing the xlsx file to disk. This can be caused by an non-existent directory
or (in Windows) if the file is already open in Excel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;exception.xlsx&#39;</span><span class="p">)</span>

<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># The file exception.xlsx is already open in Excel.</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Raises:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xlsxwriter</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">FileCreateError</span><span class="p">:</span>
    <span class="p">[</span><span class="n">Errno</span> <span class="mi">13</span><span class="p">]</span> <span class="n">Permission</span> <span class="n">denied</span><span class="p">:</span> <span class="s1">&#39;exception.xlsx&#39;</span>
</pre></div>
</div>
<p>This exception can be caught in a <code class="docutils literal notranslate"><span class="pre">try</span></code> block where you can instruct the
user to close the open file before overwriting it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">FileCreateError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># For Python 3 use input() instead of raw_input().</span>
        <span class="n">decision</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s2">&quot;Exception caught in workbook.close(): </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Please close the file if it is open in Excel.</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Try to write file again? [Y/n]: &quot;</span> <span class="o">%</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">decision</span> <span class="o">!=</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
            <span class="k">continue</span>

    <span class="k">break</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="index.html#ex-check-close"><span class="std std-ref">Example: Catch exception on closing</span></a>.</p>
</div>
<div class="section" id="exception-undefinedimagesize">
<h4>Exception: UndefinedImageSize</h4>
<dl class="exception">
<dt id="UndefinedImageSize">
<em class="property">exception </em><code class="descname">UndefinedImageSize</code></dt>
<dd></dd></dl>

<p>This exception is raised if an image added via <a class="reference internal" href="index.html#insert_image" title="insert_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_image()</span></code></a> doesn’t
contain height or width information. The exception is raised during Workbook
<a class="reference internal" href="index.html#close" title="close"><code class="xref py py-func docutils literal notranslate"><span class="pre">close()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;exception.xlsx&#39;</span><span class="p">)</span>

<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;logo.png&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Raises:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xlsxwriter</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">UndefinedImageSize</span><span class="p">:</span>
     <span class="n">logo</span><span class="o">.</span><span class="n">png</span><span class="p">:</span> <span class="n">no</span> <span class="n">size</span> <span class="n">data</span> <span class="n">found</span> <span class="ow">in</span> <span class="n">image</span> <span class="n">file</span><span class="o">.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is a relatively rare error that is most commonly caused by XlsxWriter
failing to parse the dimensions of the image rather than the image not
containing the information. In these cases you should raise a GitHub issue
with the image attached, or provided via a link.</p>
</div>
</div>
<div class="section" id="exception-unsupportedimageformat">
<h4>Exception: UnsupportedImageFormat</h4>
<dl class="exception">
<dt id="UnsupportedImageFormat">
<em class="property">exception </em><code class="descname">UnsupportedImageFormat</code></dt>
<dd></dd></dl>

<p>This exception is raised if if an image added via <a class="reference internal" href="index.html#insert_image" title="insert_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_image()</span></code></a> isn’t
one of the supported file formats: PNG, JPEG, BMP, WMF or EMF. The exception
is raised during Workbook <a class="reference internal" href="index.html#close" title="close"><code class="xref py py-func docutils literal notranslate"><span class="pre">close()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;exception.xlsx&#39;</span><span class="p">)</span>

<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;logo.xyz&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Raises:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xlsxwriter</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">UnsupportedImageFormat</span><span class="p">:</span>
    <span class="n">logo</span><span class="o">.</span><span class="n">xyz</span><span class="p">:</span> <span class="n">Unknown</span> <span class="ow">or</span> <span class="n">unsupported</span> <span class="n">image</span> <span class="n">file</span> <span class="nb">format</span><span class="o">.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the image type is one of the supported types, and you are sure that the
file format is correct, then the exception may be caused by XlsxWriter
failing to parse the type of the image correctly. In these cases you should
raise a GitHub issue with the image attached, or provided via a link.</p>
</div>
</div>
<div class="section" id="exception-filesizeerror">
<h4>Exception: FileSizeError</h4>
<dl class="exception">
<dt id="FileSizeError">
<em class="property">exception </em><code class="descname">FileSizeError</code></dt>
<dd></dd></dl>

<p>This exception is raised if one of the XML files that is part of the xlsx file, or the xlsx file itself, exceeds 4GB in size:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;exception.xlsx&#39;</span><span class="p">)</span>

<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Write lots of data to create a very big file.</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Raises:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xlsxwriter</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">FileSizeError</span><span class="p">:</span>
    <span class="n">Filesize</span> <span class="n">would</span> <span class="n">require</span> <span class="n">ZIP64</span> <span class="n">extensions</span><span class="o">.</span> <span class="n">Use</span> <span class="n">workbook</span><span class="o">.</span><span class="n">use_zip64</span><span class="p">()</span><span class="o">.</span>
</pre></div>
</div>
<p>As noted in the exception message, files larger than 4GB can be created by
turning on the zipfile.py ZIP64 extensions using the <a class="reference internal" href="index.html#use_zip64" title="use_zip64"><code class="xref py py-func docutils literal notranslate"><span class="pre">use_zip64()</span></code></a> method.</p>
</div>
<div class="section" id="exception-emptychartseries">
<h4>Exception: EmptyChartSeries</h4>
<dl class="exception">
<dt id="EmptyChartSeries">
<em class="property">exception </em><code class="descname">EmptyChartSeries</code></dt>
<dd></dd></dl>

<p>This exception is raised if a chart is added to a worksheet without a data
series. The exception is raised during Workbook <a class="reference internal" href="index.html#close" title="close"><code class="xref py py-func docutils literal notranslate"><span class="pre">close()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;exception.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Raises:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xlsxwriter</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">EmptyChartSeries</span><span class="p">:</span>
    <span class="n">Chart1</span> <span class="n">must</span> <span class="n">contain</span> <span class="n">at</span> <span class="n">least</span> <span class="n">one</span> <span class="n">data</span> <span class="n">series</span><span class="o">.</span> <span class="n">See</span> <span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">()</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="exception-duplicatetablename">
<h4>Exception: DuplicateTableName</h4>
<dl class="exception">
<dt id="DuplicateTableName">
<em class="property">exception </em><code class="descname">DuplicateTableName</code></dt>
<dd></dd></dl>

<p>This exception is raised if a duplicate worksheet table name in used via
<a class="reference internal" href="index.html#add_table" title="add_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_table()</span></code></a>. The exception is raised during Workbook <a class="reference internal" href="index.html#close" title="close"><code class="xref py py-func docutils literal notranslate"><span class="pre">close()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;exception.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B1:F3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SalesData&#39;</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B4:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SalesData&#39;</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Raises:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xlsxwriter</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">DuplicateTableName</span><span class="p">:</span>
    <span class="n">Duplicate</span> <span class="n">name</span> <span class="s1">&#39;SalesData&#39;</span> <span class="n">used</span> <span class="ow">in</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">()</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="exception-invalidworksheetname">
<h4>Exception: InvalidWorksheetName</h4>
<dl class="exception">
<dt id="InvalidWorksheetName">
<em class="property">exception </em><code class="descname">InvalidWorksheetName</code></dt>
<dd></dd></dl>

<p>This exception is raised during Workbook <a class="reference internal" href="index.html#add_worksheet" title="add_worksheet"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_worksheet()</span></code></a> if a
worksheet name is too long or contains restricted characters.</p>
<p>For example with a 32 character worksheet name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;exception.xlsx&#39;</span><span class="p">)</span>

<span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;name_that_is_longer_than_thirty_one_characters&#39;</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Raises:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xlsxwriter</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InvalidWorksheetName</span><span class="p">:</span>
    <span class="n">Excel</span> <span class="n">worksheet</span> <span class="n">name</span> <span class="s1">&#39;name_that_is_longer_than_thirty_one_characters&#39;</span>
    <span class="n">must</span> <span class="n">be</span> <span class="o">&lt;=</span> <span class="mi">31</span> <span class="n">chars</span><span class="o">.</span>
</pre></div>
</div>
<p>Or for a worksheet name containing one of the Excel restricted characters,
i.e. <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">]</span> <span class="pre">:</span> <span class="pre">*</span> <span class="pre">?</span> <span class="pre">/</span> <span class="pre">\</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;exception.xlsx&#39;</span><span class="p">)</span>

<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Data[Jan]&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Raises:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xlsxwriter</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InvalidWorksheetName</span><span class="p">:</span>
    <span class="n">Invalid</span> <span class="n">Excel</span> <span class="n">character</span> <span class="s1">&#39;[]:*?/</span><span class="se">\&#39;</span><span class="s1"> in sheetname &#39;</span><span class="n">Data</span><span class="p">[</span><span class="n">Jan</span><span class="p">]</span><span class="s1">&#39;.</span>
</pre></div>
</div>
<p>Or for a worksheet name start or ends with an apostrophe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;exception.xlsx&#39;</span><span class="p">)</span>

<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s2">&quot;&#39;Sheet1&#39;&quot;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Raises:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xlsxwriter</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">InvalidWorksheetName</span><span class="p">:</span>
    <span class="n">Sheet</span> <span class="n">name</span> <span class="n">cannot</span> <span class="n">start</span> <span class="ow">or</span> <span class="n">end</span> <span class="k">with</span> <span class="n">an</span> <span class="n">apostrophe</span> <span class="s2">&quot;&#39;Sheet1&#39;&quot;</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="exception-duplicateworksheetname">
<h4>Exception: DuplicateWorksheetName</h4>
<dl class="exception">
<dt id="DuplicateWorksheetName">
<em class="property">exception </em><code class="descname">DuplicateWorksheetName</code></dt>
<dd></dd></dl>

<p>This exception is raised during Workbook <a class="reference internal" href="index.html#add_worksheet" title="add_worksheet"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_worksheet()</span></code></a> if a
worksheet name has already been used. As with Excel the check is case
insensitive:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;exception.xlsx&#39;</span><span class="p">)</span>

<span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;sheet1&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Raises:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xlsxwriter</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">DuplicateWorksheetName</span><span class="p">:</span>
    <span class="n">Sheetname</span> <span class="s1">&#39;sheet1&#39;</span><span class="p">,</span> <span class="k">with</span> <span class="n">case</span> <span class="n">ignored</span><span class="p">,</span> <span class="ow">is</span> <span class="n">already</span> <span class="ow">in</span> <span class="n">use</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>
<span id="document-working_with_cell_notation"></span><div class="section" id="working-with-cell-notation">
<span id="cell-notation"></span><h3>Working with Cell Notation</h3>
<p>XlsxWriter supports two forms of notation to designate the position of cells:
<strong>Row-column</strong> notation and <strong>A1</strong> notation.</p>
<p>Row-column notation uses a zero based index for both row and column while A1
notation uses the standard Excel alphanumeric sequence of column letter and
1-based row. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>      <span class="c1"># Row-column notation.</span>
<span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">)</span>      <span class="c1"># The same cell in A1 notation.</span>

<span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>      <span class="c1"># Row-column notation.</span>
<span class="p">(</span><span class="s1">&#39;C7&#39;</span><span class="p">)</span>      <span class="c1"># The same cell in A1 notation.</span>
</pre></div>
</div>
<p>Row-column notation is useful if you are referring to cells programmatically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>A1 notation is useful for setting up a worksheet manually and for working with
formulas:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;H1&#39;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;H2&#39;</span><span class="p">,</span> <span class="s1">&#39;=H1+1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In general when using the XlsxWriter module you can use A1 notation anywhere
you can use row-column notation. This also applies to methods that take a
range of cells:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Merged Cells&#39;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="s1">&#39;B3:D4&#39;</span><span class="p">,</span>    <span class="s1">&#39;Merged Cells&#39;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>
</pre></div>
</div>
<p>XlsxWriter supports Excel’s worksheet limits of 1,048,576 rows by 16,384
columns.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Ranges in A1 notation must be in uppercase, like in Excel.</li>
<li>In Excel it is also possible to use R1C1 notation. This is not
supported by XlsxWriter.</li>
</ul>
</div>
<div class="section" id="row-and-column-ranges">
<span id="full-row-col"></span><h4>Row and Column Ranges</h4>
<p>In Excel you can specify row or column ranges such as <code class="docutils literal notranslate"><span class="pre">1:1</span></code> for all of the
first row or <code class="docutils literal notranslate"><span class="pre">A:A</span></code> for all of the first column. In XlsxWriter these can be
set by specifying the full cell range for the row or column:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">print_area</span><span class="p">(</span><span class="s1">&#39;A1:XFD1&#39;</span><span class="p">)</span>      <span class="c1"># Same as 1:1</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">print_area</span><span class="p">(</span><span class="s1">&#39;A1:A1048576&#39;</span><span class="p">)</span>  <span class="c1"># Same as A:A</span>
</pre></div>
</div>
<p>This is actually how Excel stores ranges such as <code class="docutils literal notranslate"><span class="pre">1:1</span></code> and <code class="docutils literal notranslate"><span class="pre">A:A</span></code>
internally.</p>
<p>These ranges can also be specified using row-column notation, as explained
above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">print_area</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>       <span class="mi">0</span><span class="p">,</span> <span class="mi">16383</span><span class="p">)</span>  <span class="c1"># Same as 1:1</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">print_area</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1048575</span><span class="p">,</span>     <span class="mi">0</span><span class="p">)</span>  <span class="c1"># Same as A:A</span>
</pre></div>
</div>
<p>To select the entire worksheet range you can specify
<code class="docutils literal notranslate"><span class="pre">A1:XFD1048576</span></code>.</p>
</div>
<div class="section" id="relative-and-absolute-cell-references">
<span id="abs-reference"></span><h4>Relative and Absolute cell references</h4>
<p>When dealing with Excel cell references it is important to distinguish between
relative and absolute cell references in Excel.</p>
<p><strong>Relative</strong> cell references change when they are copied while <strong>Absolute</strong>
references maintain fixed row and/or column references. In Excel absolute
references are prefixed by the dollar symbol as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;A1&#39;</span>    <span class="c1"># Column and row are relative.</span>
<span class="s1">&#39;$A1&#39;</span>   <span class="c1"># Column is absolute and row is relative.</span>
<span class="s1">&#39;A$1&#39;</span>   <span class="c1"># Column is relative and row is absolute.</span>
<span class="s1">&#39;$A$1&#39;</span>  <span class="c1"># Column and row are absolute.</span>
</pre></div>
</div>
<p>See the Microsoft Office documentation for
<a class="reference external" href="http://office.microsoft.com/en-001/excel-help/switch-between-relative-absolute-and-mixed-references-HP010342940.aspx">more information on relative and absolute references</a>.</p>
<p>Some functions such as <a class="reference internal" href="index.html#conditional_format" title="conditional_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">conditional_format()</span></code></a> may require absolute
references, depending on the range being specified.</p>
</div>
<div class="section" id="defined-names-and-named-ranges">
<h4>Defined Names and Named Ranges</h4>
<p>It is also possible to define and use “Defined names/Named ranges” in
workbooks and worksheets, see <a class="reference internal" href="index.html#define_name" title="define_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">define_name()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span><span class="o">.</span><span class="n">define_name</span><span class="p">(</span><span class="s1">&#39;Exchange_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;=0.96&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;=B2*Exchange_rate&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="index.html#ex-defined-name"><span class="std std-ref">Example: Defined names/Named ranges</span></a>.</p>
</div>
<div class="section" id="cell-utility-functions">
<span id="cell-utility"></span><h4>Cell Utility Functions</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">XlsxWriter</span></code> <code class="docutils literal notranslate"><span class="pre">utility</span></code> module contains several helper functions for
dealing with A1 notation as shown below. These functions can be imported as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">xlsxwriter.utility</span> <span class="k">import</span> <span class="n">xl_rowcol_to_cell</span>

<span class="n">cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># C2</span>
</pre></div>
</div>
<div class="section" id="xl-rowcol-to-cell">
<h5>xl_rowcol_to_cell()</h5>
<dl class="function">
<dt id="xl_rowcol_to_cell">
<code class="descname">xl_rowcol_to_cell</code><span class="sig-paren">(</span><em>row</em>, <em>col</em><span class="optional">[</span>, <em>row_abs</em>, <em>col_abs</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Convert a zero indexed row and column cell reference to a A1 style string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell row.</li>
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column.</li>
<li><strong>row_abs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Optional flag to make the row absolute.</li>
<li><strong>col_abs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Optional flag to make the column absolute.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">A1 style string.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">xl_rowcol_to_cell()</span></code> function converts a zero indexed row and column
cell values to an <code class="docutils literal notranslate"><span class="pre">A1</span></code> style string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># A1</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>   <span class="c1"># B1</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>   <span class="c1"># A2</span>
</pre></div>
</div>
<p>The optional parameters <code class="docutils literal notranslate"><span class="pre">row_abs</span></code> and <code class="docutils literal notranslate"><span class="pre">col_abs</span></code> can be used to indicate
that the row or column is absolute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">str</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">col_abs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                <span class="c1"># $A1</span>
<span class="nb">str</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">row_abs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>                <span class="c1"># A$1</span>
<span class="nb">str</span> <span class="o">=</span> <span class="n">xl_rowcol_to_cell</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">row_abs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">col_abs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># $A$1</span>
</pre></div>
</div>
</div>
<div class="section" id="xl-cell-to-rowcol">
<h5>xl_cell_to_rowcol()</h5>
<dl class="function">
<dt id="xl_cell_to_rowcol">
<code class="descname">xl_cell_to_rowcol</code><span class="sig-paren">(</span><em>cell_str</em><span class="sig-paren">)</span></dt>
<dd><p>Convert a cell reference in A1 notation to a zero indexed row and column.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cell_str</strong> (<em>string</em>) – A1 style string, absolute or relative.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">Tuple of ints for (row, col)</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">xl_cell_to_rowcol()</span></code> function converts an Excel cell reference in <code class="docutils literal notranslate"><span class="pre">A1</span></code>
notation to a zero based row and column. The function will also handle Excel’s
absolute, <code class="docutils literal notranslate"><span class="pre">$</span></code>, cell notation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="o">=</span> <span class="n">xl_cell_to_rowcol</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">)</span>    <span class="c1"># (0, 0)</span>
<span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="o">=</span> <span class="n">xl_cell_to_rowcol</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">)</span>    <span class="c1"># (0, 1)</span>
<span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="o">=</span> <span class="n">xl_cell_to_rowcol</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">)</span>    <span class="c1"># (1, 2)</span>
<span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="o">=</span> <span class="n">xl_cell_to_rowcol</span><span class="p">(</span><span class="s1">&#39;$C2&#39;</span><span class="p">)</span>   <span class="c1"># (1, 2)</span>
<span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="o">=</span> <span class="n">xl_cell_to_rowcol</span><span class="p">(</span><span class="s1">&#39;C$2&#39;</span><span class="p">)</span>   <span class="c1"># (1, 2)</span>
<span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span> <span class="o">=</span> <span class="n">xl_cell_to_rowcol</span><span class="p">(</span><span class="s1">&#39;$C$2&#39;</span><span class="p">)</span>  <span class="c1"># (1, 2)</span>
</pre></div>
</div>
</div>
<div class="section" id="xl-col-to-name">
<h5>xl_col_to_name()</h5>
<dl class="function">
<dt id="xl_col_to_name">
<code class="descname">xl_col_to_name</code><span class="sig-paren">(</span><em>col</em><span class="optional">[</span>, <em>col_abs</em><span class="optional">]</span><span class="sig-paren">)</span></dt>
<dd><p>Convert a zero indexed column cell reference to a string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cell column.</li>
<li><strong>col_abs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Optional flag to make the column absolute.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Column style string.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">xl_col_to_name()</span></code> converts a zero based column reference to a string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    <span class="c1"># A</span>
<span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>    <span class="c1"># B</span>
<span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="mi">702</span><span class="p">)</span>  <span class="c1"># AAA</span>
</pre></div>
</div>
<p>The optional parameter <code class="docutils literal notranslate"><span class="pre">col_abs</span></code> can be used to indicate if the column is
absolute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># A</span>
<span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>   <span class="c1"># $A</span>
<span class="n">column</span> <span class="o">=</span> <span class="n">xl_col_to_name</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>   <span class="c1"># $B</span>
</pre></div>
</div>
</div>
<div class="section" id="xl-range">
<h5>xl_range()</h5>
<dl class="function">
<dt id="xl_range">
<code class="descname">xl_range</code><span class="sig-paren">(</span><em>first_row</em>, <em>first_col</em>, <em>last_row</em>, <em>last_col</em><span class="sig-paren">)</span></dt>
<dd><p>Converts zero indexed row and column cell references to a A1:B1 range
string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>first_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first cell row.</li>
<li><strong>first_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first cell column.</li>
<li><strong>last_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last cell row.</li>
<li><strong>last_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last cell column.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">A1:B1 style range string.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">xl_range()</span></code> function converts zero based row and column cell references
to an <code class="docutils literal notranslate"><span class="pre">A1:B1</span></code> style range string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_range</span> <span class="o">=</span> <span class="n">xl_range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># A1:A10</span>
<span class="n">cell_range</span> <span class="o">=</span> <span class="n">xl_range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># C2:C9</span>
<span class="n">cell_range</span> <span class="o">=</span> <span class="n">xl_range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># A1:E4</span>
</pre></div>
</div>
</div>
<div class="section" id="xl-range-abs">
<h5>xl_range_abs()</h5>
<dl class="function">
<dt id="xl_range_abs">
<code class="descname">xl_range_abs</code><span class="sig-paren">(</span><em>first_row</em>, <em>first_col</em>, <em>last_row</em>, <em>last_col</em><span class="sig-paren">)</span></dt>
<dd><p>Converts zero indexed row and column cell references to a $A$1:$B$1
absolute range string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>first_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first cell row.</li>
<li><strong>first_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first cell column.</li>
<li><strong>last_row</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last cell row.</li>
<li><strong>last_col</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last cell column.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">$A$1:$B$1 style range string.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The <code class="docutils literal notranslate"><span class="pre">xl_range_abs()</span></code> function converts zero based row and column cell
references to an absolute <code class="docutils literal notranslate"><span class="pre">$A$1:$B$1</span></code> style range string:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_range</span> <span class="o">=</span> <span class="n">xl_range_abs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># $A$1:$A$10</span>
<span class="n">cell_range</span> <span class="o">=</span> <span class="n">xl_range_abs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># $C$2:$C$9</span>
<span class="n">cell_range</span> <span class="o">=</span> <span class="n">xl_range_abs</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>  <span class="c1"># $A$1:$E$4</span>
</pre></div>
</div>
</div>
</div>
</div>
<span id="document-working_with_data"></span><div class="section" id="working-with-and-writing-data">
<span id="working-with-data"></span><h3>Working with and Writing Data</h3>
<p>The following sections explain how to write various types of data to an Excel
worksheet using XlsxWriter.</p>
<div class="section" id="writing-data-to-a-worksheet-cell">
<span id="writing-cells"></span><h4>Writing data to a worksheet cell</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">worksheet</span></code> <a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method is the most common means of writing
Python data to cells based on its type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;write_data.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1234</span><span class="p">)</span>     <span class="c1"># Writes an int</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1234.56</span><span class="p">)</span>  <span class="c1"># Writes a float</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>  <span class="c1"># Writes a string</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>     <span class="c1"># Writes None</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>     <span class="c1"># Writes a bool</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/write_data1.png" src="_images/write_data1.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">write()</span></code> method uses the <code class="docutils literal notranslate"><span class="pre">type()</span></code> of the data to determine which
specific method to use for writing the data. These methods then map some basic
Python types to corresponding Excel types. The mapping is as follows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="19%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Python type</th>
<th class="head">Excel type</th>
<th class="head">Worksheet methods</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">int</span></code></td>
<td>Number</td>
<td><a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a>, <a class="reference internal" href="index.html#write_number" title="write_number"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_number()</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">long</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">float</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">Decimal</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">Fraction</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">basestring</span></code></td>
<td>String</td>
<td><a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a>, <a class="reference internal" href="index.html#write_string" title="write_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_string()</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">str</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">unicode</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">None</span></code></td>
<td>String (blank)</td>
<td><a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a>, <a class="reference internal" href="index.html#write_blank" title="write_blank"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_blank()</span></code></a></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">datetime.date</span></code></td>
<td>Number</td>
<td><a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a>, <a class="reference internal" href="index.html#write_datetime" title="write_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_datetime()</span></code></a></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">datetime.datetime</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">datetime.time</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">datetime.timedelta</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">bool</span></code></td>
<td>Boolean</td>
<td><a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a>, <a class="reference internal" href="index.html#write_boolean" title="write_boolean"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_boolean()</span></code></a></td>
</tr>
</tbody>
</table>
<p>The <code class="docutils literal notranslate"><span class="pre">write()</span></code> method also handles a few other Excel types that are
encoded as Python strings in XlsxWriter:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="19%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Pseudo-type</th>
<th class="head">Excel type</th>
<th class="head">Worksheet methods</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>formula string</td>
<td>Formula</td>
<td><a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a>, <a class="reference internal" href="index.html#write_formula" title="write_formula"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_formula()</span></code></a></td>
</tr>
<tr class="row-odd"><td>url string</td>
<td>URL</td>
<td><a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a>, <a class="reference internal" href="index.html#write_url" title="write_url"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_url()</span></code></a></td>
</tr>
</tbody>
</table>
<p>It should be noted that Excel has a very limited set of types to map to. The
Python types that the <code class="docutils literal notranslate"><span class="pre">write()</span></code> method can handle can be extended as
explained in the <a class="reference internal" href="#writing-user-types"><span class="std std-ref">Writing user defined types</span></a> section below.</p>
</div>
<div class="section" id="writing-unicode-data">
<span id="writing-unicode"></span><h4>Writing unicode data</h4>
<p>Unicode data in Excel is encoded as UTF-8. XlsxWriter also supports writing
UTF-8 data.  This generally requires that your source file in also UTF-8
encoded:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># _*_ coding: utf-8</span>
<span class="c1"># Python 2 example.</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;Some UTF-8 text&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/worksheet02.png" src="_images/worksheet02.png" />
<p>See <a class="reference internal" href="index.html#ex-unicode-python2"><span class="std std-ref">Example: Simple Unicode with Python 2</span></a> and <a class="reference internal" href="index.html#ex-unicode-python3"><span class="std std-ref">Example: Simple Unicode with Python 3</span></a> for more complete
examples.</p>
<p>Alternatively, you can read data from an encoded file, convert it to UTF-8
during reading and then write the data to an Excel file. See
<a class="reference internal" href="index.html#ex-unicode-polish-utf8"><span class="std std-ref">Example: Unicode - Polish in UTF-8</span></a> and <a class="reference internal" href="index.html#ex-unicode-shift-jis"><span class="std std-ref">Example: Unicode - Shift JIS</span></a>.</p>
</div>
<div class="section" id="writing-lists-of-data">
<span id="writing-lists"></span><h4>Writing lists of data</h4>
<p>Writing compound data types such as lists with XlsxWriter is done the same way
it would be in any other Python program: with a loop. The Python
<a class="reference external" href="https://docs.python.org/3/library/functions.html#enumerate" title="(in Python v3.8)"><code class="xref py py-func docutils literal notranslate"><span class="pre">enumerate()</span></code></a> function is also very useful in this context:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;write_list.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="k">for</span> <span class="n">row_num</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">my_list</span><span class="p">):</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row_num</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/write_list1.png" src="_images/write_list1.png" />
<p>Or if you wanted to write this horizontally as a row:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;write_list.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="k">for</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">my_list</span><span class="p">):</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/write_list2.png" src="_images/write_list2.png" />
<p>For a list of lists structure you would use two loop levels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;write_list.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">my_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
           <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>

<span class="k">for</span> <span class="n">row_num</span><span class="p">,</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">my_list</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">col_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row_data</span><span class="p">):</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row_num</span><span class="p">,</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">col_data</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/write_list3.png" src="_images/write_list3.png" />
<p>The <a class="reference internal" href="index.html#worksheet"><span class="std std-ref">worksheet</span></a> class has two utility functions called
<a class="reference internal" href="index.html#write_row" title="write_row"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_row()</span></code></a> and <a class="reference internal" href="index.html#write_column" title="write_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_column()</span></code></a> which are basically a loop around
the <a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;write_list.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">my_list</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">my_list</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/write_list4.png" src="_images/write_list4.png" />
</div>
<div class="section" id="writing-dicts-of-data">
<span id="writing-dicts"></span><h4>Writing dicts of data</h4>
<p>Unlike lists there is no single simple way to write a Python dictionary to an
Excel worksheet using Xlsxwriter. The method will depend of the structure of
the data in the dictionary. Here is a simple example for a simple data
structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;write_dict.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">my_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Bob&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
           <span class="s1">&#39;Ann&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span>
           <span class="s1">&#39;May&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">]}</span>

<span class="n">col_num</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">my_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">col_num</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/write_dict1.png" src="_images/write_dict1.png" />
</div>
<div class="section" id="writing-dataframes">
<span id="id1"></span><h4>Writing dataframes</h4>
<p>The best way to deal with dataframes or complex data structure is to use
Python <a class="reference external" href="https://pandas.pydata.org/">Pandas</a>. Pandas is a Python data analysis
library. It can read, filter and re-arrange small and large data sets and
output them in a range of formats including Excel.</p>
<p>To use XlsxWriter with Pandas you specify it as the Excel writer <em>engine</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Create a Pandas dataframe from the data.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">]})</span>

<span class="c1"># Create a Pandas Excel writer using XlsxWriter as the engine.</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;pandas_simple.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>

<span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>

<span class="c1"># Close the Pandas Excel writer and output the Excel file.</span>
<span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p>The output from this would look like the following:</p>
<img alt="_images/pandas_simple.png" src="_images/pandas_simple.png" />
<p>For more information on using Pandas with XlsxWriter see <a class="reference internal" href="index.html#ewx-pandas"><span class="std std-ref">Working with Python Pandas and XlsxWriter</span></a>.</p>
</div>
<div class="section" id="writing-user-defined-types">
<span id="writing-user-types"></span><h4>Writing user defined types</h4>
<p>As shown in the the first section above, the worksheet <a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method
maps the main Python data types to Excel’s data types. If you want to write an
unsupported type then you can either avoid <code class="docutils literal notranslate"><span class="pre">write()</span></code> and map the user type
in your code to one of the more specific write methods or you can extend it
using the <a class="reference internal" href="index.html#add_write_handler" title="add_write_handler"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_write_handler()</span></code></a> method. This can occasionally be more
convenient then adding a lot of if/else logic to your code.</p>
<p>As an example, say you wanted to modify <code class="docutils literal notranslate"><span class="pre">write()</span></code> to automatically write
<a class="reference external" href="https://docs.python.org/3/library/uuid.html#module-uuid" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">uuid</span></code></a> types as strings. You would start by creating a function that
takes the uuid, converts it to a string and then writes it using
<a class="reference internal" href="index.html#write_string" title="write_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_string()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">write_uuid</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="p">),</span> <span class="nb">format</span><span class="p">)</span>
</pre></div>
</div>
<p>You could then add a handler that matches the <code class="docutils literal notranslate"><span class="pre">uuid</span></code> type and calls your
user defined function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#                           match,     action()</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_write_handler</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="n">write_uuid</span><span class="p">)</span>
</pre></div>
</div>
<p>Then you can use <code class="docutils literal notranslate"><span class="pre">write()</span></code> without further modification:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_uuid</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid3</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">NAMESPACE_DNS</span><span class="p">,</span> <span class="s1">&#39;python.org&#39;</span><span class="p">)</span>

<span class="c1"># Write the UUID. This would raise a TypeError without the handler.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">my_uuid</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/user_types4.png" src="_images/user_types4.png" />
<p>Multiple callback functions can be added using <a class="reference internal" href="index.html#add_write_handler" title="add_write_handler"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_write_handler()</span></code></a> but
only one callback action is allowed per type. However, it is valid to use the
same callback function for different types:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_write_handler</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span>   <span class="n">test_number_range</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_write_handler</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">test_number_range</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="how-the-write-handler-feature-works">
<span id="writing-user-types2"></span><h5>How the write handler feature works</h5>
<p>The <a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method is mainly a large <code class="docutils literal notranslate"><span class="pre">if()</span></code> statement that checks the
<code class="docutils literal notranslate"><span class="pre">type()</span></code> of the input value and call the appropriate worksheet method to
write the data. The <a class="reference internal" href="index.html#add_write_handler" title="add_write_handler"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_write_handler()</span></code></a> method works by injecting
additional type checks and associated actions into this <code class="docutils literal notranslate"><span class="pre">if()</span></code> statement.</p>
<p>Here is a simplified version of the <code class="docutils literal notranslate"><span class="pre">write()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>

    <span class="c1"># The first arg should be the token for all write calls.</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Get the token type.</span>
    <span class="n">token_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

    <span class="c1"># Check for any user defined type handlers with callback functions.</span>
    <span class="k">if</span> <span class="n">token_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_handlers</span><span class="p">:</span>
        <span class="n">write_handler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_handlers</span><span class="p">[</span><span class="n">token_type</span><span class="p">]</span>
        <span class="n">function_return</span> <span class="o">=</span> <span class="n">write_handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

        <span class="c1"># If the return value is None then the callback has returned</span>
        <span class="c1"># control to this function and we should continue as</span>
        <span class="c1"># normal. Otherwise we return the value to the caller and exit.</span>
        <span class="k">if</span> <span class="n">function_return</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">function_return</span>

    <span class="c1"># Check for standard Python types, if we haven&#39;t returned already.</span>
    <span class="k">if</span> <span class="n">token_type</span> <span class="ow">is</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_boolean</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="c1"># Etc. ...</span>
</pre></div>
</div>
</div>
<div class="section" id="the-syntax-of-write-handler-functions">
<span id="writing-user-types3"></span><h5>The syntax of write handler functions</h5>
<p>Functions used in the <a class="reference internal" href="index.html#add_write_handler" title="add_write_handler"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_write_handler()</span></code></a> method should have the
following method signature/parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_function</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>
</pre></div>
</div>
<p>The function will be passed a <a class="reference internal" href="index.html#worksheet"><span class="std std-ref">worksheet</span></a> instance, an
integer <code class="docutils literal notranslate"><span class="pre">row</span></code> and <code class="docutils literal notranslate"><span class="pre">col</span></code> value, a <code class="docutils literal notranslate"><span class="pre">token</span></code> that matches the type added to
<a class="reference internal" href="index.html#add_write_handler" title="add_write_handler"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_write_handler()</span></code></a> and some additional parameters. Usually the
additional parameter(s) will only be a cell <a class="reference internal" href="index.html#format"><span class="std std-ref">format</span></a>
instance. However, if you need to handle other additional parameters, such as
those passed to <a class="reference internal" href="index.html#write_url" title="write_url"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_url()</span></code></a> then you can have more generic handling
like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_function</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>
</pre></div>
</div>
<p>Note, you don’t have to explicitly handle <code class="docutils literal notranslate"><span class="pre">A1</span></code> style cell ranges. These will
be converted to row and column values prior to your function being called.</p>
<p>You can also make use of the <code class="docutils literal notranslate"><span class="pre">row</span></code> and <code class="docutils literal notranslate"><span class="pre">col</span></code> parameters to control the
logic of the function. Say for example you wanted to hide/replace user
passwords with ‘****’ when writing string data. If your data was
structured so that the password data was in the second column, apart from the
header row, you could write a handler function like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">hide_password</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">col</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">row</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/user_types5.png" src="_images/user_types5.png" />
</div>
<div class="section" id="the-return-value-of-write-handler-functions">
<span id="writing-user-types4"></span><h5>The return value of write handler functions</h5>
<p>Functions used in the <a class="reference internal" href="index.html#add_write_handler" title="add_write_handler"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_write_handler()</span></code></a> method should return one of
the following values:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">None</span></code>: to indicate that control is return to the parent <a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a>
method to continue as normal. This is used if your handler function logic
decides that you don’t need to handle the matched token.</li>
<li>The return value of the called <code class="docutils literal notranslate"><span class="pre">write_xxx()</span></code> function. This is generally 0
for no error and a negative number errors. This causes an immediate return
from the calling <code class="docutils literal notranslate"><span class="pre">write()</span></code> method with the return value that was passed
back.</li>
</ul>
<p>For example, say you wanted to ignore <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values in your data since Excel
doesn’t support them. You could create a handler function like the following
that matched against floats and which wrote a blank cell if it was a <code class="docutils literal notranslate"><span class="pre">NaN</span></code>
or else just returned to <code class="docutils literal notranslate"><span class="pre">write()</span></code> to continue as normal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ignore_nan</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">write_blank</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Return control to the calling write() method.</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
<p>If you wanted to just drop the <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values completely and not add any
formatting to the cell you could just return 0, for no error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ignore_nan</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Return control to the calling write() method.</span>
        <span class="k">return</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
<div class="section" id="write-handler-examples">
<h5>Write handler examples</h5>
<p>See the following, more complete, examples of handling user data types:</p>
<ul class="simple">
<li><a class="reference internal" href="index.html#ex-user-type1"><span class="std std-ref">Example: Writing User Defined Types (1)</span></a></li>
<li><a class="reference internal" href="index.html#ex-user-type2"><span class="std std-ref">Example: Writing User Defined Types (2)</span></a></li>
<li><a class="reference internal" href="index.html#ex-user-type3"><span class="std std-ref">Example: Writing User Defined types (3)</span></a></li>
</ul>
</div>
</div>
</div>
<span id="document-working_with_formulas"></span><div class="section" id="working-with-formulas">
<span id="id1"></span><h3>Working with Formulas</h3>
<p>In general a formula in Excel can be used directly in the
<a class="reference internal" href="index.html#write_formula" title="write_formula"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_formula()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;=10*B1 + C1&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/working_with_formulas1.png" src="_images/working_with_formulas1.png" />
<p>However, there are a few potential issues and differences that the user should
be aware of. These are explained in the following sections.</p>
<div class="section" id="non-us-excel-functions-and-syntax">
<span id="formula-syntax"></span><h4>Non US Excel functions and syntax</h4>
<p>Excel stores formulas in the format of the US English version, regardless
of the language or locale of the end-user’s version of Excel. Therefore all
formula function names written using XlsxWriter must be in English:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUM(1, 2, 3)&#39;</span><span class="p">)</span>    <span class="c1"># OK</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;=SOMME(1, 2, 3)&#39;</span><span class="p">)</span>  <span class="c1"># French. Error on load.</span>
</pre></div>
</div>
<p>Also, formulas must be written with the US style separator/range operator
which is a comma (not semi-colon). Therefore a formula with multiple values
should be written as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUM(1, 2, 3)&#39;</span><span class="p">)</span>   <span class="c1"># OK</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUM(1; 2; 3)&#39;</span><span class="p">)</span>   <span class="c1"># Semi-colon. Error on load.</span>
</pre></div>
</div>
<p>If you have a non-English version of Excel you can use the following
multi-lingual <a class="reference external" href="https://en.excel-translator.de/language/">formula translator</a>
to help you convert the formula. It can also replace semi-colons with commas.</p>
</div>
<div class="section" id="formulas-added-in-excel-2010-and-later">
<span id="formula-future"></span><h4>Formulas added in Excel 2010 and later</h4>
<p>Excel 2010 and later added functions which weren’t defined in the original
file specification. These functions are referred to by Microsoft as <em>future</em>
functions. Examples of these functions are <code class="docutils literal notranslate"><span class="pre">ACOT</span></code>, <code class="docutils literal notranslate"><span class="pre">CHISQ.DIST.RT</span></code> ,
<code class="docutils literal notranslate"><span class="pre">CONFIDENCE.NORM</span></code>, <code class="docutils literal notranslate"><span class="pre">STDEV.P</span></code>, <code class="docutils literal notranslate"><span class="pre">STDEV.S</span></code> and <code class="docutils literal notranslate"><span class="pre">WORKDAY.INTL</span></code>.</p>
<p>When written using <code class="docutils literal notranslate"><span class="pre">write_formula()</span></code> these functions need to be fully
qualified with a <code class="docutils literal notranslate"><span class="pre">_xlfn.</span></code> (or other) prefix as they are shown the list
below. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;=_xlfn.STDEV.S(B1:B10)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>They will appear without the prefix in Excel:</p>
<img alt="_images/working_with_formulas2.png" src="_images/working_with_formulas2.png" />
<p>The following list is taken from
<a class="reference external" href="http://msdn.microsoft.com/en-us/library/dd907480%28v=office.12%29.aspx">MS XLSX extensions documentation on future functions</a>.</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.ACOT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.ACOTH</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.AGGREGATE</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.ARABIC</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.BASE</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.BETA.DIST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.BETA.INV</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.BINOM.DIST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.BINOM.DIST.RANGE</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.BINOM.INV</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.BITAND</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.BITLSHIFT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.BITOR</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.BITRSHIFT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.BITXOR</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.CEILING.MATH</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.CEILING.PRECISE</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.CHISQ.DIST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.CHISQ.DIST.RT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.CHISQ.INV</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.CHISQ.INV.RT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.CHISQ.TEST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.COMBINA</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.CONCAT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.CONFIDENCE.NORM</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.CONFIDENCE.T</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.COT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.COTH</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.COVARIANCE.P</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.COVARIANCE.S</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.CSC</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.CSCH</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.DAYS</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.DECIMAL</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">ECMA.CEILING</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.ERF.PRECISE</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.ERFC.PRECISE</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.EXPON.DIST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.F.DIST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.F.DIST.RT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.F.INV</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.F.INV.RT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.F.TEST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.FILTERXML</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.FLOOR.MATH</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.FLOOR.PRECISE</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.FORECAST.ETS</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.FORECAST.ETS.CONFINT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.FORECAST.ETS.SEASONALITY</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.FORECAST.ETS.STAT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.FORECAST.LINEAR</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.FORMULATEXT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.GAMMA</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.GAMMA.DIST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.GAMMA.INV</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.GAMMALN.PRECISE</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.GAUSS</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.HYPGEOM.DIST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.IFNA</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.IFS</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.IMCOSH</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.IMCOT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.IMCSC</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.IMCSCH</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.IMSEC</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.IMSECH</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.IMSINH</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.IMTAN</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.ISFORMULA</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">ISO.CEILING</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.ISOWEEKNUM</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.LOGNORM.DIST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.LOGNORM.INV</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.MAXIFS</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.MINIFS</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.MODE.MULT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.MODE.SNGL</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.MUNIT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.NEGBINOM.DIST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">NETWORKDAYS.INTL</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.NORM.DIST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.NORM.INV</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.NORM.S.DIST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.NORM.S.INV</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.NUMBERVALUE</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.PDURATION</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.PERCENTILE.EXC</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.PERCENTILE.INC</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.PERCENTRANK.EXC</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.PERCENTRANK.INC</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.PERMUTATIONA</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.PHI</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.POISSON.DIST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.QUARTILE.EXC</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.QUARTILE.INC</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.QUERYSTRING</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.RANK.AVG</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.RANK.EQ</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.RRI</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.SEC</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.SECH</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.SHEET</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.SHEETS</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.SKEW.P</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.STDEV.P</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.STDEV.S</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.SWITCH</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.T.DIST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.T.DIST.2T</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.T.DIST.RT</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.T.INV</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.T.INV.2T</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.T.TEST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.TEXTJOIN</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.UNICHAR</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.UNICODE</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.VAR.P</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.VAR.S</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.WEBSERVICE</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.WEIBULL.DIST</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">WORKDAY.INTL</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.XOR</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">_xlfn.Z.TEST</span></code></li>
</ul>
</div>
<div class="section" id="using-tables-in-formulas">
<span id="formula-tables"></span><h4>Using Tables in Formulas</h4>
<p>Worksheet tables can be added with XlsxWriter using the <a class="reference internal" href="index.html#add_table" title="add_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_table()</span></code></a>
method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">options</span><span class="p">})</span>
</pre></div>
</div>
<p>By default tables are named <code class="docutils literal notranslate"><span class="pre">Table1</span></code>, <code class="docutils literal notranslate"><span class="pre">Table2</span></code>, etc., in the order that
they are added. However it can also be set by the user using the <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SalesData&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>If you need to know the name of the table, for example to use it in a formula,
you can get it as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">)</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
<p>When used in a formula a table name such as <code class="docutils literal notranslate"><span class="pre">TableX</span></code> should be referred to
as <code class="docutils literal notranslate"><span class="pre">TableX[]</span></code> (like a Python list):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="s1">&#39;=VLOOKUP(&quot;Sales&quot;, Table1[], 2, FALSE&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="dealing-with-formula-errors">
<span id="formula-errors"></span><h4>Dealing with formula errors</h4>
<p>If there is an error in the syntax of a formula it is usually displayed in
Excel as <code class="docutils literal notranslate"><span class="pre">#NAME?</span></code>. Alternatively you may get a warning from Excel when the
file is loaded. If you encounter an error like this you can debug it as
follows:</p>
<ol class="arabic simple">
<li>Ensure the formula is valid in Excel by copying and pasting it into a
cell. Note, this should be done in Excel and not other applications such as
OpenOffice or LibreOffice since they may have slightly different syntax.</li>
<li>Ensure the formula is using comma separators instead of semi-colons, see
<a class="reference internal" href="#formula-syntax"><span class="std std-ref">Non US Excel functions and syntax</span></a> above.</li>
<li>Ensure the formula is in English, see <a class="reference internal" href="#formula-syntax"><span class="std std-ref">Non US Excel functions and syntax</span></a> above.</li>
<li>Ensure that the formula doesn’t contain an Excel 2010+ future function as
listed above (<a class="reference internal" href="#formula-future"><span class="std std-ref">Formulas added in Excel 2010 and later</span></a>). If it does then ensure that the
correct prefix is used.</li>
<li>If the function loads in Excel without calculating and appears with one or
more <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> symbols added then it is probably an array function and should
be written using <a class="reference internal" href="index.html#write_array_formula" title="write_array_formula"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_array_formula()</span></code></a>.</li>
</ol>
<p>Finally if you have completed all the previous steps and still get a
<code class="docutils literal notranslate"><span class="pre">#NAME?</span></code> error you can examine a valid Excel file to see what the correct
syntax should be. To do this you should create a valid formula in Excel and
save the file. You can then examine the XML in the unzipped file.</p>
<p>The following shows how to do that using Linux <code class="docutils literal notranslate"><span class="pre">unzip</span></code> and <a class="reference external" href="http://xmlsoft.org/xmllint.html">libxml’s xmllint</a> to format the XML for clarity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ unzip myfile.xlsx -d myfile
$ xmllint --format myfile/xl/worksheets/sheet1.xml | grep &#39;&lt;/f&gt;&#39;

        &lt;f&gt;SUM(1, 2, 3)&lt;/f&gt;
</pre></div>
</div>
</div>
<div class="section" id="formula-results">
<span id="formula-result"></span><h4>Formula Results</h4>
<p>XlsxWriter doesn’t calculate the result of a formula and instead stores the
value 0 as the formula result. It then sets a global flag in the XLSX file to
say that all formulas and functions should be recalculated when the file is
opened.</p>
<p>This is the method recommended in the Excel documentation and in general it
works fine with spreadsheet applications. However, applications that don’t
have a facility to calculate formulas will only display the 0
results. Examples of such applications are Excel Viewer, PDF Converters, and
some mobile device applications.</p>
<p>If required, it is also possible to specify the calculated result of the
formula using the optional <code class="docutils literal notranslate"><span class="pre">value</span></code> parameter for <a class="reference internal" href="index.html#write_formula" title="write_formula"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_formula()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;=2+2&#39;</span><span class="p">,</span> <span class="n">num_format</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">value</span></code> parameter can be a number, a string, a bool or one of the
following Excel error codes:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#DIV/0!</span>
<span class="c1">#N/A</span>
<span class="c1">#NAME?</span>
<span class="c1">#NULL!</span>
<span class="c1">#NUM!</span>
<span class="c1">#REF!</span>
<span class="c1">#VALUE!</span>
</pre></div>
</div>
<p>It is also possible to specify the calculated result of an array formula
created with <a class="reference internal" href="index.html#write_array_formula" title="write_array_formula"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_array_formula()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the result for a single cell range.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_array_formula</span><span class="p">(</span><span class="s1">&#39;A1:A1&#39;</span><span class="p">,</span> <span class="s1">&#39;{=SUM(B1:C1*B2:C2)}&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">,</span> <span class="mi">2005</span><span class="p">)</span>
</pre></div>
</div>
<p>However, using this parameter only writes a single value to the upper left
cell in the result array. For a multi-cell array formula where the results are
required, the other result values can be specified by using <code class="docutils literal notranslate"><span class="pre">write_number()</span></code>
to write to the appropriate cell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the results for a multi cell range.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_array_formula</span><span class="p">(</span><span class="s1">&#39;A1:A3&#39;</span><span class="p">,</span> <span class="s1">&#39;{=TREND(C1:C3,B1:B3)}&#39;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_number</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_number</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<span id="document-working_with_dates_and_time"></span><div class="section" id="working-with-dates-and-time">
<span id="id1"></span><h3>Working with Dates and Time</h3>
<p>Dates and times in Excel are represented by real numbers, for example “Jan 1
2013 12:00 PM” is represented by the number 41275.5.</p>
<p>The integer part of the number stores the number of days since the epoch and
the fractional part stores the percentage of the day.</p>
<p>A date or time in Excel is just like any other number. To display the number as
a date you must apply an Excel number format to it. Here are some examples:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;date_examples.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Widen column A for extra visibility.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="c1"># A number to convert to a date.</span>
<span class="n">number</span> <span class="o">=</span> <span class="mf">41333.5</span>

<span class="c1"># Write it as a number without formatting.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>                <span class="c1"># 41333.5</span>

<span class="n">format2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;dd/mm/yy&#39;</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">format2</span><span class="p">)</span>       <span class="c1"># 28/02/13</span>

<span class="n">format3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;mm/dd/yy&#39;</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">format3</span><span class="p">)</span>       <span class="c1"># 02/28/13</span>

<span class="n">format4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;d-m-yyyy&#39;</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">format4</span><span class="p">)</span>       <span class="c1"># 28-2-2013</span>

<span class="n">format5</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;dd/mm/yy hh:mm&#39;</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">format5</span><span class="p">)</span>       <span class="c1"># 28/02/13 12:00</span>

<span class="n">format6</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;d mmm yyyy&#39;</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A6&#39;</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">format6</span><span class="p">)</span>       <span class="c1"># 28 Feb 2013</span>

<span class="n">format7</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;mmm d yyyy hh:mm AM/PM&#39;</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">format7</span><span class="p">)</span>       <span class="c1"># Feb 28 2013 12:00 PM</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/working_with_dates_and_times01.png" src="_images/working_with_dates_and_times01.png" />
<p>To make working with dates and times a little easier the XlsxWriter module
provides a <a class="reference internal" href="index.html#write_datetime" title="write_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_datetime()</span></code></a> method to write dates in standard library
<a class="reference external" href="https://docs.python.org/3/library/datetime.html#module-datetime" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">datetime</span></code></a> format.</p>
<p>Specifically it supports datetime objects of type <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a>,
<a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.date" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.date</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.time" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.time</span></code></a> and <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.timedelta" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.timedelta</span></code></a>.</p>
<p>There are many way to create datetime objects, for example the
<a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime.strptime" title="(in Python v3.8)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">datetime.datetime.strptime()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">date_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;2013-01-23&#39;</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See the <a class="reference external" href="https://docs.python.org/3/library/datetime.html#module-datetime" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">datetime</span></code></a> documentation for other date/time creation methods.</p>
<p>As explained above you also need to create and apply a number format to format
the date/time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">date_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;d mmmm yyyy&#39;</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_datetime</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">date_time</span><span class="p">,</span> <span class="n">date_format</span><span class="p">)</span>

<span class="c1"># Displays &quot;23 January 2013&quot;</span>
</pre></div>
</div>
<p>Here is a longer example that displays the same date in a several different
formats:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="c1"># Create a workbook and add a worksheet.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;datetimes.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="bp">True</span><span class="p">})</span>

<span class="c1"># Expand the first columns so that the dates are visible.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:B&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="c1"># Write the column headers.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Formatted date&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;Format&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="c1"># Create a datetime object to use in the examples.</span>

<span class="n">date_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;2013-01-23 12:30:05.123&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S.</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Examples date and time formats.</span>
<span class="n">date_formats</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;dd/mm/yy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mm/dd/yy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;dd m yy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;d mm yy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;d mmm yy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;d mmmm yy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;d mmmm yyy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;d mmmm yyyy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;dd/mm/yy hh:mm&#39;</span><span class="p">,</span>
    <span class="s1">&#39;dd/mm/yy hh:mm:ss&#39;</span><span class="p">,</span>
    <span class="s1">&#39;dd/mm/yy hh:mm:ss.000&#39;</span><span class="p">,</span>
    <span class="s1">&#39;hh:mm&#39;</span><span class="p">,</span>
    <span class="s1">&#39;hh:mm:ss&#39;</span><span class="p">,</span>
    <span class="s1">&#39;hh:mm:ss.000&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Start from first row after headers.</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Write the same date and time using each of the above formats.</span>
<span class="k">for</span> <span class="n">date_format_str</span> <span class="ow">in</span> <span class="n">date_formats</span><span class="p">:</span>

    <span class="c1"># Create a format for the date or time.</span>
    <span class="n">date_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="n">date_format_str</span><span class="p">,</span>
                                      <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">})</span>

    <span class="c1"># Write the same date using different formats.</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write_datetime</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">date_time</span><span class="p">,</span> <span class="n">date_format</span><span class="p">)</span>

    <span class="c1"># Also write the format string for comparison.</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">date_format_str</span><span class="p">)</span>

    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/working_with_dates_and_times02.png" src="_images/working_with_dates_and_times02.png" />
<div class="section" id="default-date-formatting">
<h4>Default Date Formatting</h4>
<p>In certain circumstances you may wish to apply a default date format when
writing datetime objects, for example, when handling a row of data with
<a class="reference internal" href="index.html#write_row" title="write_row"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_row()</span></code></a>.</p>
<p>In these cases it is possible to specify a default date format string using the
<a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> constructor <code class="docutils literal notranslate"><span class="pre">default_date_format</span></code> option:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;datetimes.xlsx&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;default_date_format&#39;</span><span class="p">:</span>
                                                  <span class="s1">&#39;dd/mm/yy&#39;</span><span class="p">})</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">date_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_datetime</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">date_time</span><span class="p">)</span>  <span class="c1"># Formatted as &#39;dd/mm/yy&#39;</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="timezone-handling">
<span id="id2"></span><h4>Timezone Handling</h4>
<p>Excel doesn’t support timezones in datetimes/times so there isn’t any fail-safe
way that XlsxWriter can map a Python timezone aware datetime into an Excel
datetime. As such the user should handle the timezones in some way that makes
sense according to their requirements. Usually this will require some
conversion to a timezone adjusted time and the removal of the <code class="docutils literal notranslate"><span class="pre">tzinfo</span></code> from
the datetime object so that it can be passed to <a class="reference internal" href="index.html#write_datetime" title="write_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_datetime()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">utc_datetime</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="n">tzinfo</span><span class="o">=</span><span class="n">utc</span><span class="p">)</span>
<span class="n">naive_datetime</span> <span class="o">=</span> <span class="n">utc_datetime</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">tzinfo</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_datetime</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">naive_datetime</span><span class="p">,</span> <span class="n">date_format</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively the <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> constructor option <code class="docutils literal notranslate"><span class="pre">remove_timezone</span></code> can
be used to strip the timezone from datetime values passed to
<a class="reference internal" href="index.html#write_datetime" title="write_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_datetime()</span></code></a>. The default is <code class="docutils literal notranslate"><span class="pre">False</span></code>. To enable this option use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;remove_timezone&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>When <a class="reference internal" href="index.html#ewx-pandas"><span class="std std-ref">Working with Python Pandas and XlsxWriter</span></a> you can pass the argument as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;pandas_example.xlsx&#39;</span><span class="p">,</span>
                        <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">,</span>
                        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;remove_timezone&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<span id="document-working_with_colors"></span><div class="section" id="working-with-colors">
<span id="colors"></span><h3>Working with Colors</h3>
<p>Throughout XlsxWriter colors are specified using a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code>
value. For example with a <a class="reference internal" href="index.html#format"><span class="std std-ref">Format</span></a> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span><span class="o">.</span><span class="n">set_font_color</span><span class="p">(</span><span class="s1">&#39;#FF0000&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For backward compatibility a limited number of color names are supported:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cell_format</span><span class="o">.</span><span class="n">set_font_color</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The color names and corresponding <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> value are shown below:</p>
<table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="57%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Color name</th>
<th class="head">RGB color code</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>black</td>
<td><code class="docutils literal notranslate"><span class="pre">#000000</span></code></td>
</tr>
<tr class="row-odd"><td>blue</td>
<td><code class="docutils literal notranslate"><span class="pre">#0000FF</span></code></td>
</tr>
<tr class="row-even"><td>brown</td>
<td><code class="docutils literal notranslate"><span class="pre">#800000</span></code></td>
</tr>
<tr class="row-odd"><td>cyan</td>
<td><code class="docutils literal notranslate"><span class="pre">#00FFFF</span></code></td>
</tr>
<tr class="row-even"><td>gray</td>
<td><code class="docutils literal notranslate"><span class="pre">#808080</span></code></td>
</tr>
<tr class="row-odd"><td>green</td>
<td><code class="docutils literal notranslate"><span class="pre">#008000</span></code></td>
</tr>
<tr class="row-even"><td>lime</td>
<td><code class="docutils literal notranslate"><span class="pre">#00FF00</span></code></td>
</tr>
<tr class="row-odd"><td>magenta</td>
<td><code class="docutils literal notranslate"><span class="pre">#FF00FF</span></code></td>
</tr>
<tr class="row-even"><td>navy</td>
<td><code class="docutils literal notranslate"><span class="pre">#000080</span></code></td>
</tr>
<tr class="row-odd"><td>orange</td>
<td><code class="docutils literal notranslate"><span class="pre">#FF6600</span></code></td>
</tr>
<tr class="row-even"><td>pink</td>
<td><code class="docutils literal notranslate"><span class="pre">#FF00FF</span></code></td>
</tr>
<tr class="row-odd"><td>purple</td>
<td><code class="docutils literal notranslate"><span class="pre">#800080</span></code></td>
</tr>
<tr class="row-even"><td>red</td>
<td><code class="docutils literal notranslate"><span class="pre">#FF0000</span></code></td>
</tr>
<tr class="row-odd"><td>silver</td>
<td><code class="docutils literal notranslate"><span class="pre">#C0C0C0</span></code></td>
</tr>
<tr class="row-even"><td>white</td>
<td><code class="docutils literal notranslate"><span class="pre">#FFFFFF</span></code></td>
</tr>
<tr class="row-odd"><td>yellow</td>
<td><code class="docutils literal notranslate"><span class="pre">#FFFF00</span></code></td>
</tr>
</tbody>
</table>
</div>
<span id="document-working_with_charts"></span><div class="section" id="working-with-charts">
<span id="id1"></span><h3>Working with Charts</h3>
<p>This section explains how to work with some of the options and features of
<a class="reference internal" href="index.html#chart-class"><span class="std std-ref">The Chart Class</span></a>.</p>
<p>The majority of the examples in this section are based on a variation of the
following program:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_line.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Add the worksheet data to be plotted.</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="c1"># Create a new chart object.</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>

<span class="c1"># Add a series to the chart.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/chart_working.png" src="_images/chart_working.png" />
<p>See also <a class="reference internal" href="index.html#chart-examples"><span class="std std-ref">Chart Examples</span></a>.</p>
<div class="section" id="chart-value-and-category-axes">
<span id="chart-val-cat-axes"></span><h4>Chart Value and Category Axes</h4>
<p>When working with charts it is important to understand how Excel
differentiates between a chart axis that is used for series categories and a
chart axis that is used for series values.</p>
<p>In the majority of Excel charts the X axis is the <strong>category</strong> axis and each
of the values is evenly spaced and sequential. The Y axis is the <strong>value</strong>
axis and points are displayed according to their value:</p>
<img alt="_images/chart_axes01.png" src="_images/chart_axes01.png" />
<p>Excel treats these two types of axis differently and exposes different
properties for each. For example, here are the properties for a category axis:</p>
<img alt="_images/chart_axes02.png" src="_images/chart_axes02.png" />
<p>Here are properties for a value axis:</p>
<img alt="_images/chart_axes03.png" src="_images/chart_axes03.png" />
<p>As such, some of the <cite>XlsxWriter</cite> axis properties can be set for a value
axis, some can be set for a category axis and some properties can be set for
both. For example <code class="docutils literal notranslate"><span class="pre">reverse</span></code> can be set for either category or value axes while the
<code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code> properties can only be set for value axes (and Date Axes).
The documentation calls out the type of axis to which properties apply.</p>
<p>For a Bar chart the Category and Value axes are reversed:</p>
<img alt="_images/chart_axes04.png" src="_images/chart_axes04.png" />
<p>A Scatter chart (but not a Line chart) has 2 value axes:</p>
<img alt="_images/chart_axes05.png" src="_images/chart_axes05.png" />
<p><a class="reference internal" href="#date-category-axes"><span class="std std-ref">Date Category Axes</span></a> are a special type of category axis that give them
some of the properties of values axes such as <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code> when used
with date or time values.</p>
</div>
<div class="section" id="chart-series-options">
<span id="id2"></span><h4>Chart Series Options</h4>
<p>This following sections detail the more complex options of the
<a class="reference internal" href="index.html#add_series" title="add_series"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_series()</span></code></a> Chart method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">marker</span>
<span class="n">trendline</span>
<span class="n">y_error_bars</span>
<span class="n">x_error_bars</span>
<span class="n">data_labels</span>
<span class="n">points</span>
<span class="n">smooth</span>
</pre></div>
</div>
</div>
<div class="section" id="chart-series-option-marker">
<span id="id3"></span><h4>Chart series option: Marker</h4>
<p>The marker format specifies the properties of the markers used to distinguish
series on a chart. In general only Line and Scatter chart types and trendlines
use markers.</p>
<p>The following properties can be set for <code class="docutils literal notranslate"><span class="pre">marker</span></code> formats in a chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span>
<span class="n">size</span>
<span class="n">border</span>
<span class="n">fill</span>
<span class="n">pattern</span>
<span class="n">gradient</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type</span></code> property sets the type of marker that is used with a series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;diamond&#39;</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_marker1.png"><img alt="_images/chart_marker1.png" src="_images/chart_marker1.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The following <code class="docutils literal notranslate"><span class="pre">type</span></code> properties can be set for <code class="docutils literal notranslate"><span class="pre">marker</span></code> formats in a chart.
These are shown in the same order as in the Excel format dialog:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">automatic</span>
<span class="n">none</span>
<span class="n">square</span>
<span class="n">diamond</span>
<span class="n">triangle</span>
<span class="n">x</span>
<span class="n">star</span>
<span class="n">short_dash</span>
<span class="n">long_dash</span>
<span class="n">circle</span>
<span class="n">plus</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">automatic</span></code> type is a special case which turns on a marker using the
default marker style for the particular series number:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;automatic&#39;</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">automatic</span></code> is on then other marker properties such as size, border or
fill cannot be set.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">size</span></code> property sets the size of the marker and is generally used in
conjunction with <code class="docutils literal notranslate"><span class="pre">type</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;diamond&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>Nested <code class="docutils literal notranslate"><span class="pre">border</span></code> and <code class="docutils literal notranslate"><span class="pre">fill</span></code> properties can also be set for a marker:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;square&#39;</span><span class="p">,</span>
        <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
        <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">},</span>
        <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_marker2.png"><img alt="_images/chart_marker2.png" src="_images/chart_marker2.png" style="width: 704.25px; height: 402.75px;" /></a>
</div>
<div class="section" id="chart-series-option-trendline">
<span id="id4"></span><h4>Chart series option: Trendline</h4>
<p>A trendline can be added to a chart series to indicate trends in the data such
as a moving average or a polynomial fit.</p>
<p>The following properties can be set for trendlines in a chart series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span>
<span class="n">order</span>               <span class="p">(</span><span class="k">for</span> <span class="n">polynomial</span> <span class="n">trends</span><span class="p">)</span>
<span class="n">period</span>              <span class="p">(</span><span class="k">for</span> <span class="n">moving</span> <span class="n">average</span><span class="p">)</span>
<span class="n">forward</span>             <span class="p">(</span><span class="k">for</span> <span class="nb">all</span> <span class="k">except</span> <span class="n">moving</span> <span class="n">average</span><span class="p">)</span>
<span class="n">backward</span>            <span class="p">(</span><span class="k">for</span> <span class="nb">all</span> <span class="k">except</span> <span class="n">moving</span> <span class="n">average</span><span class="p">)</span>
<span class="n">name</span>
<span class="n">line</span>
<span class="n">intercept</span>           <span class="p">(</span><span class="k">for</span> <span class="n">exponential</span><span class="p">,</span> <span class="n">linear</span> <span class="ow">and</span> <span class="n">polynomial</span> <span class="n">only</span><span class="p">)</span>
<span class="n">display_equation</span>    <span class="p">(</span><span class="k">for</span> <span class="nb">all</span> <span class="k">except</span> <span class="n">moving</span> <span class="n">average</span><span class="p">)</span>
<span class="n">display_r_squared</span>   <span class="p">(</span><span class="k">for</span> <span class="nb">all</span> <span class="k">except</span> <span class="n">moving</span> <span class="n">average</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type</span></code> property sets the type of trendline in the series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>    <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;trendline&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The available <code class="docutils literal notranslate"><span class="pre">trendline</span></code> types are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">exponential</span>
<span class="n">linear</span>
<span class="n">log</span>
<span class="n">moving_average</span>
<span class="n">polynomial</span>
<span class="n">power</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">polynomial</span></code> trendline can also specify the <code class="docutils literal notranslate"><span class="pre">order</span></code> of the polynomial.
The default value is 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;trendline&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;polynomial&#39;</span><span class="p">,</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_trendline1.png"><img alt="_images/chart_trendline1.png" src="_images/chart_trendline1.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>A <code class="docutils literal notranslate"><span class="pre">moving_average</span></code> trendline can also specify the <code class="docutils literal notranslate"><span class="pre">period</span></code> of the moving
average. The default value is 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;trendline&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;moving_average&#39;</span><span class="p">,</span>
        <span class="s1">&#39;period&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_trendline2.png"><img alt="_images/chart_trendline2.png" src="_images/chart_trendline2.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">forward</span></code> and <code class="docutils literal notranslate"><span class="pre">backward</span></code> properties set the forecast period of the
trendline:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;trendline&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;polynomial&#39;</span><span class="p">,</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;forward&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s1">&#39;backward&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">name</span></code> property sets an optional name for the trendline that will appear
in the chart legend. If it isn’t specified the Excel default name will be
displayed. This is usually a combination of the trendline type and the series
name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;trendline&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;polynomial&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;My trend name&#39;</span><span class="p">,</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">intercept</span></code> property sets the point where the trendline crosses the Y
(value) axis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$1:$B$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;trendline&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;intercept&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">display_equation</span></code> property displays the trendline equation on the
chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$1:$B$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;trendline&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;display_equation&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">display_r_squared</span></code> property displays the R squared value of the
trendline on the chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$1:$B$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;trendline&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;display_r_squared&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>Several of these properties can be set in one go:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;trendline&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;polynomial&#39;</span><span class="p">,</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;My trend name&#39;</span><span class="p">,</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;forward&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s1">&#39;backward&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s1">&#39;display_equation&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
            <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s1">&#39;dash_type&#39;</span><span class="p">:</span> <span class="s1">&#39;long_dash&#39;</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_trendline3.png"><img alt="_images/chart_trendline3.png" src="_images/chart_trendline3.png" style="width: 618.75px; height: 317.25px;" /></a>
<p>Trendlines cannot be added to series in a stacked chart or pie chart, doughnut
chart, radar chart or (when implemented) to 3D or surface charts.</p>
</div>
<div class="section" id="chart-series-option-error-bars">
<span id="id5"></span><h4>Chart series option: Error Bars</h4>
<p>Error bars can be added to a chart series to indicate error bounds in the data.
The error bars can be vertical <code class="docutils literal notranslate"><span class="pre">y_error_bars</span></code> (the most common type) or
horizontal <code class="docutils literal notranslate"><span class="pre">x_error_bars</span></code> (for Bar and Scatter charts only).</p>
<p>The following properties can be set for error bars in a chart series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span>
<span class="n">value</span>        <span class="p">(</span><span class="k">for</span> <span class="nb">all</span> <span class="n">types</span> <span class="k">except</span> <span class="n">standard</span> <span class="n">error</span> <span class="ow">and</span> <span class="n">custom</span><span class="p">)</span>
<span class="n">plus_values</span>  <span class="p">(</span><span class="k">for</span> <span class="n">custom</span> <span class="n">only</span><span class="p">)</span>
<span class="n">minus_values</span> <span class="p">(</span><span class="k">for</span> <span class="n">custom</span> <span class="n">only</span><span class="p">)</span>
<span class="n">direction</span>
<span class="n">end_style</span>
<span class="n">line</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type</span></code> property sets the type of error bars in the series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;y_error_bars&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;standard_error&#39;</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_error_bars1.png"><img alt="_images/chart_error_bars1.png" src="_images/chart_error_bars1.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The available error bars types are available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fixed</span>
<span class="n">percentage</span>
<span class="n">standard_deviation</span>
<span class="n">standard_error</span>
<span class="n">custom</span>
</pre></div>
</div>
<p>All error bar types, except for <code class="docutils literal notranslate"><span class="pre">standard_error</span></code> and <code class="docutils literal notranslate"><span class="pre">custom</span></code> must also
have a value associated with it for the error bounds:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;y_error_bars&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;percentage&#39;</span><span class="p">,</span>
        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">custom</span></code> error bar type must specify <code class="docutils literal notranslate"><span class="pre">plus_values</span></code> and <code class="docutils literal notranslate"><span class="pre">minus_values</span></code>
which should either by a <code class="docutils literal notranslate"><span class="pre">Sheet1!$A$1:$A$6</span></code> type range formula or a list of
values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$1:$B$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;y_error_bars&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>         <span class="s1">&#39;custom&#39;</span><span class="p">,</span>
        <span class="s1">&#39;plus_values&#39;</span><span class="p">:</span>  <span class="s1">&#39;=Sheet1!$C$1:$C$6&#39;</span><span class="p">,</span>
        <span class="s1">&#39;minus_values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$D$1:$D$6&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">})</span>

<span class="c1"># or</span>

<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$1:$B$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;y_error_bars&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span>         <span class="s1">&#39;custom&#39;</span><span class="p">,</span>
        <span class="s1">&#39;plus_values&#39;</span><span class="p">:</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="s1">&#39;minus_values&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>Note, as in Excel the items in the <code class="docutils literal notranslate"><span class="pre">minus_values</span></code> do not need to be negative.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">direction</span></code> property sets the direction of the error bars. It should be
one of the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plus</span>   <span class="c1"># Positive direction only.</span>
<span class="n">minus</span>  <span class="c1"># Negative direction only.</span>
<span class="n">both</span>   <span class="c1"># Plus and minus directions, The default.</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">end_style</span></code> property sets the style of the error bar end cap. The options
are 1 (the default) or 0 (for no end cap):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;y_error_bars&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;fixed&#39;</span><span class="p">,</span>
        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s1">&#39;end_style&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;minus&#39;</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_error_bars2.png"><img alt="_images/chart_error_bars2.png" src="_images/chart_error_bars2.png" style="width: 704.25px; height: 402.75px;" /></a>
</div>
<div class="section" id="chart-series-option-data-labels">
<span id="id6"></span><h4>Chart series option: Data Labels</h4>
<p>Data labels can be added to a chart series to indicate the values of the
plotted data points.</p>
<p>The following properties can be set for <code class="docutils literal notranslate"><span class="pre">data_labels</span></code> formats in a chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">value</span>
<span class="n">category</span>
<span class="n">series_name</span>
<span class="n">position</span>
<span class="n">leader_lines</span>
<span class="n">percentage</span>
<span class="n">separator</span>
<span class="n">legend_key</span>
<span class="n">num_format</span>
<span class="n">font</span>
<span class="n">border</span>
<span class="n">fill</span>
<span class="n">pattern</span>
<span class="n">gradient</span>
<span class="n">custom</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">value</span></code> property turns on the <em>Value</em> data label for a series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>      <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_data_labels1.png"><img alt="_images/chart_data_labels1.png" src="_images/chart_data_labels1.png" style="width: 618.75px; height: 317.25px;" /></a>
<p>By default data labels are displayed in Excel with only the values
shown. However, it is possible to configure other display options, as shown
below.</p>
<img alt="_images/chart_data_labels2.png" src="_images/chart_data_labels2.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">category</span></code> property turns on the <em>Category Name</em> data label for a series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>      <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">series_name</span></code> property turns on the <em>Series Name</em> data label for a
series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>      <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;series_name&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>Here is an example with all three data label types shown:</p>
<a class="reference internal image-reference" href="_images/chart_data_labels3.png"><img alt="_images/chart_data_labels3.png" src="_images/chart_data_labels3.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">position</span></code> property is used to position the data label for a series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>      <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;series_name&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;position&#39;</span><span class="p">:</span> <span class="s1">&#39;above&#39;</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_data_labels5.png"><img alt="_images/chart_data_labels5.png" src="_images/chart_data_labels5.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>In Excel the allowable data label positions vary for different chart types.
The allowable positions are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="21%" />
<col width="17%" />
<col width="21%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Position</th>
<th class="head">Line,
Scatter,
Stock</th>
<th class="head">Bar,
Column</th>
<th class="head">Pie,
Doughnut</th>
<th class="head">Area,
Radar</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>center</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes</td>
<td>Yes*</td>
</tr>
<tr class="row-odd"><td>right</td>
<td>Yes*</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>left</td>
<td>Yes</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>above</td>
<td>Yes</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>below</td>
<td>Yes</td>
<td>&#160;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>inside_base</td>
<td>&#160;</td>
<td>Yes</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>inside_end</td>
<td>&#160;</td>
<td>Yes</td>
<td>Yes</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>outside_end</td>
<td>&#160;</td>
<td>Yes*</td>
<td>Yes</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>best_fit</td>
<td>&#160;</td>
<td>&#160;</td>
<td>Yes*</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<p>Note: The * indicates the default position for each chart type in Excel, if
a position isn’t specified by the user.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">percentage</span></code> property is used to turn on the display of data labels as a
<em>Percentage</em> for a series. In Excel the <code class="docutils literal notranslate"><span class="pre">percentage</span></code> data label option is
only available for Pie and Doughnut chart variants:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>      <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;percentage&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_data_labels7.png"><img alt="_images/chart_data_labels7.png" src="_images/chart_data_labels7.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">leader_lines</span></code> property is used to turn on <em>Leader Lines</em> for the data
label of a series. It is mainly used for pie charts:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>      <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;leader_lines&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Even when leader lines are turned on they aren’t automatically visible in
Excel or XlsxWriter. Due to an Excel limitation (or design) leader lines
only appear if the data label is moved manually or if the data labels are
very close and need to be adjusted automatically.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">separator</span></code> property is used to change the separator between multiple
data label items:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>      <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;series_name&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;separator&#39;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_data_labels4.png"><img alt="_images/chart_data_labels4.png" src="_images/chart_data_labels4.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The separator value must be one of the following strings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;,&#39;</span>
<span class="s1">&#39;;&#39;</span>
<span class="s1">&#39;.&#39;</span>
<span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="s1">&#39; &#39;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">legend_key</span></code> property is used to turn on the <em>Legend Key</em> for the data
label of a series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>      <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;legend_key&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_data_labels6.png"><img alt="_images/chart_data_labels6.png" src="_images/chart_data_labels6.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">num_format</span></code> property is used to set the number format for the data
labels of a series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>      <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;#,##0.00&#39;</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_data_labels8.png"><img alt="_images/chart_data_labels8.png" src="_images/chart_data_labels8.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The number format is similar to the Worksheet Cell Format <code class="docutils literal notranslate"><span class="pre">num_format</span></code>
apart from the fact that a format index cannot be used. An explicit format
string must be used as shown above. See <a class="reference internal" href="index.html#set_num_format" title="set_num_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_num_format()</span></code></a> for more
information.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">font</span></code> property is used to set the font of the data labels of a series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Consolas&#39;</span><span class="p">,</span> <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_data_labels9.png"><img alt="_images/chart_data_labels9.png" src="_images/chart_data_labels9.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">font</span></code> property is also used to rotate the data labels of a series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>

    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;rotation&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="p">}</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#chart-fonts"><span class="std std-ref">Chart Fonts</span></a>.</p>
<p>Standard chart formatting such as <code class="docutils literal notranslate"><span class="pre">border</span></code> and <code class="docutils literal notranslate"><span class="pre">fill</span></code> can also be added to
the data labels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">}},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_data_labels24.png"><img alt="_images/chart_data_labels24.png" src="_images/chart_data_labels24.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">custom</span></code> property is used to set properties for individual data
labels. This is explained in detail in the next section.</p>
</div>
<div class="section" id="chart-series-option-custom-data-labels">
<span id="id7"></span><h4>Chart series option: Custom Data Labels</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">custom</span></code> data label property is used to set the properties of individual
data labels in a series. The most common use for this is to set custom text or
number labels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">custom_labels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Jan&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Feb&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Mar&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Apr&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;May&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Jun&#39;</span><span class="p">},</span>
<span class="p">]</span>

<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span> <span class="n">custom_labels</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_data_labels18.png"><img alt="_images/chart_data_labels18.png" src="_images/chart_data_labels18.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>As shown in the previous examples th <code class="docutils literal notranslate"><span class="pre">custom</span></code> property should be a list of
dicts. Any property dict that is set to <code class="docutils literal notranslate"><span class="pre">None</span></code> or not included in the list
will be assigned the default data label value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">custom_labels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Feb&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Mar&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Apr&#39;</span><span class="p">},</span>
<span class="p">]</span>

<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span> <span class="n">custom_labels</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_data_labels19.png"><img alt="_images/chart_data_labels19.png" src="_images/chart_data_labels19.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The property elements of the <code class="docutils literal notranslate"><span class="pre">custom</span></code> lists should be dicts with the
following allowable keys/sub-properties:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">value</span>
<span class="n">font</span>
<span class="n">delete</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">value</span></code> property should be a string, number or formula string that refers to
a cell from which the value will be taken:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">custom_labels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$2&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$3&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$4&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$5&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$6&#39;</span><span class="p">},</span>
<span class="p">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">font</span></code> property is used to set the font of the custom data label of a series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">custom_labels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$2&#39;</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$3&#39;</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$4&#39;</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$5&#39;</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$6&#39;</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}},</span>
<span class="p">]</span>

<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span> <span class="n">custom_labels</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="#chart-fonts"><span class="std std-ref">Chart Fonts</span></a> for details on the available font properties.</p>
<a class="reference internal image-reference" href="_images/chart_data_labels20.png"><img alt="_images/chart_data_labels20.png" src="_images/chart_data_labels20.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">delete</span></code> property can be used to delete labels in a series. This can be
useful if you want to highlight one or more cells in the series, for example
the maximum and the minimum:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">custom_labels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;delete&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;delete&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;delete&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;delete&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="kc">None</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span> <span class="n">custom_labels</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_data_labels21.png"><img alt="_images/chart_data_labels21.png" src="_images/chart_data_labels21.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>Standard chart formatting such as <code class="docutils literal notranslate"><span class="pre">border</span></code> and <code class="docutils literal notranslate"><span class="pre">fill</span></code> can also be added to
the custom data labels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">custom_labels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">}},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Feb&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Mar&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Apr&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;May&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Jun&#39;</span><span class="p">,</span> <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">}},</span>
<span class="p">]</span>

<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;circle&#39;</span><span class="p">},</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;custom&#39;</span><span class="p">:</span> <span class="n">custom_labels</span><span class="p">,</span>
                    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">}},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_data_labels25.png"><img alt="_images/chart_data_labels25.png" src="_images/chart_data_labels25.png" style="width: 704.25px; height: 402.75px;" /></a>
</div>
<div class="section" id="chart-series-option-points">
<span id="id8"></span><h4>Chart series option: Points</h4>
<p>In general formatting is applied to an entire series in a chart. However, it
is occasionally required to format individual points in a series. In
particular this is required for Pie/Doughnut charts where each segment is
represented by a point.</p>
<p>In these cases it is possible to use the <code class="docutils literal notranslate"><span class="pre">points</span></code> property of
<a class="reference internal" href="index.html#add_series" title="add_series"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_series()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_pie.xlsx&#39;</span><span class="p">)</span>

<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;pie&#39;</span><span class="p">})</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Pass&#39;</span><span class="p">,</span> <span class="s1">&#39;Fail&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$1:$B$2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">}},</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}},</span>
    <span class="p">],</span>
<span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_points1.png"><img alt="_images/chart_points1.png" src="_images/chart_points1.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">points</span></code> property takes a list of format options (see the “Chart
Formatting” section below). To assign default properties to points in a series
pass <code class="docutils literal notranslate"><span class="pre">None</span></code> values in the array ref:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Format point 3 of 3 only.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!A1:A3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="kc">None</span><span class="p">,</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#990000&#39;</span><span class="p">}},</span>
    <span class="p">],</span>
<span class="p">})</span>

<span class="c1"># Format point 1 of 3 only.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!A1:A3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#990000&#39;</span><span class="p">}},</span>
    <span class="p">],</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="chart-series-option-smooth">
<h4>Chart series option: Smooth</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">smooth</span></code> option is used to set the smooth property of a line series. It
is only applicable to the <code class="docutils literal notranslate"><span class="pre">line</span></code> and <code class="docutils literal notranslate"><span class="pre">scatter</span></code> chart types:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$1:$B$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;smooth&#39;</span><span class="p">:</span>     <span class="kc">True</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="chart-formatting">
<span id="id9"></span><h4>Chart Formatting</h4>
<p>The following chart formatting properties can be set for any chart object that
they apply to (and that are supported by XlsxWriter) such as chart lines,
column fill areas, plot area borders, markers, gridlines and other chart
elements:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">line</span>
<span class="n">border</span>
<span class="n">fill</span>
<span class="n">pattern</span>
<span class="n">gradient</span>
</pre></div>
</div>
<p>Chart formatting properties are generally set using dicts:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;line&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_formatting1.png"><img alt="_images/chart_formatting1.png" src="_images/chart_formatting1.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>In some cases the format properties can be nested. For example a <code class="docutils literal notranslate"><span class="pre">marker</span></code> may
contain <code class="docutils literal notranslate"><span class="pre">border</span></code> and <code class="docutils literal notranslate"><span class="pre">fill</span></code> sub-properties:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;line&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">},</span>
    <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;square&#39;</span><span class="p">,</span>
               <span class="s1">&#39;size,&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
               <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span>
               <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">}</span>
    <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_formatting2.png"><img alt="_images/chart_formatting2.png" src="_images/chart_formatting2.png" style="width: 704.25px; height: 402.75px;" /></a>
</div>
<div class="section" id="chart-formatting-line">
<span id="id10"></span><h4>Chart formatting: Line</h4>
<p>The line format is used to specify properties of line objects that appear in a
chart such as a plotted line on a chart or a border.</p>
<p>The following properties can be set for <code class="docutils literal notranslate"><span class="pre">line</span></code> formats in a chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">none</span>
<span class="n">color</span>
<span class="n">width</span>
<span class="n">dash_type</span>
<span class="n">transparency</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">none</span></code> property is uses to turn the <code class="docutils literal notranslate"><span class="pre">line</span></code> off (it is always on by
default except in Scatter charts). This is useful if you wish to plot a series
with markers but without a line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;line&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;automatic&#39;</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_formatting3.png"><img alt="_images/chart_formatting3.png" src="_images/chart_formatting3.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">color</span></code> property sets the color of the <code class="docutils literal notranslate"><span class="pre">line</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;line&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The available colors are shown in the main XlsxWriter documentation. It is
also possible to set the color of a line with a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string
or a limited number of named colors, see <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;line&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#FF9900&#39;</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_formatting4.png"><img alt="_images/chart_formatting4.png" src="_images/chart_formatting4.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">width</span></code> property sets the width of the <code class="docutils literal notranslate"><span class="pre">line</span></code>. It should be specified
in increments of 0.25 of a point as in Excel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;line&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">3.25</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">dash_type</span></code> property sets the dash style of the line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;line&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;dash_type&#39;</span><span class="p">:</span> <span class="s1">&#39;dash_dot&#39;</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_formatting5.png"><img alt="_images/chart_formatting5.png" src="_images/chart_formatting5.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The following <code class="docutils literal notranslate"><span class="pre">dash_type</span></code> values are available. They are shown in the order
that they appear in the Excel dialog:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solid</span>
<span class="n">round_dot</span>
<span class="n">square_dot</span>
<span class="n">dash</span>
<span class="n">dash_dot</span>
<span class="n">long_dash</span>
<span class="n">long_dash_dot</span>
<span class="n">long_dash_dot_dot</span>
</pre></div>
</div>
<p>The default line style is <code class="docutils literal notranslate"><span class="pre">solid</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">transparency</span></code> property sets the transparency of the line color in the
integer range 1 - 100. The color must be set for transparency to work, it
doesn’t work with an automatic/default color:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;line&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;transparency&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
<p>More than one <code class="docutils literal notranslate"><span class="pre">line</span></code> property can be specified at a time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
     <span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span>
         <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
         <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">1.25</span><span class="p">,</span>
         <span class="s1">&#39;dash_type&#39;</span><span class="p">:</span> <span class="s1">&#39;square_dot&#39;</span><span class="p">,</span>
     <span class="p">},</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="chart-formatting-border">
<span id="id11"></span><h4>Chart formatting: Border</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">border</span></code> property is a synonym for <code class="docutils literal notranslate"><span class="pre">line</span></code>.</p>
<p>It can be used as a descriptive substitute for <code class="docutils literal notranslate"><span class="pre">line</span></code> in chart types such as
Bar and Column that have a border and fill style rather than a line style. In
general chart objects with a <code class="docutils literal notranslate"><span class="pre">border</span></code> property will also have a fill
property.</p>
</div>
<div class="section" id="chart-formatting-solid-fill">
<span id="chart-formatting-fill"></span><h4>Chart formatting: Solid Fill</h4>
<p>The solid fill format is used to specify filled areas of chart objects such as
the interior of a column or the background of the chart itself.</p>
<p>The following properties can be set for <code class="docutils literal notranslate"><span class="pre">fill</span></code> formats in a chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">none</span>
<span class="n">color</span>
<span class="n">transparency</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">none</span></code> property is used to turn the <code class="docutils literal notranslate"><span class="pre">fill</span></code> property off (it is
generally on by default):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_fill1.png"><img alt="_images/chart_fill1.png" src="_images/chart_fill1.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">color</span></code> property sets the color of the <code class="docutils literal notranslate"><span class="pre">fill</span></code> area:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The available colors are shown in the main XlsxWriter documentation. It is
also possible to set the color of a fill with a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string
or a limited number of named colors, see <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#FF9900&#39;</span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_fill2.png"><img alt="_images/chart_fill2.png" src="_images/chart_fill2.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">transparency</span></code> property sets the transparency of the solid fill color in
the integer range 1 - 100. The color must be set for transparency to work, it
doesn’t work with an automatic/default color:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_chartarea</span><span class="p">({</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;transparency&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">}})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_fill3.png"><img alt="_images/chart_fill3.png" src="_images/chart_fill3.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The <code class="docutils literal notranslate"><span class="pre">fill</span></code> format is generally used in conjunction with a <code class="docutils literal notranslate"><span class="pre">border</span></code> format
which has the same properties as a <code class="docutils literal notranslate"><span class="pre">line</span></code> format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_fill4.png"><img alt="_images/chart_fill4.png" src="_images/chart_fill4.png" style="width: 704.25px; height: 402.75px;" /></a>
</div>
<div class="section" id="chart-formatting-pattern-fill">
<span id="chart-formatting-pattern"></span><h4>Chart formatting: Pattern Fill</h4>
<p>The pattern fill format is used to specify pattern filled areas of chart
objects such as the interior of a column or the background of the chart
itself.</p>
<a class="reference internal image-reference" href="_images/chart_pattern.png"><img alt="_images/chart_pattern.png" src="_images/chart_pattern.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The following properties can be set for <code class="docutils literal notranslate"><span class="pre">pattern</span></code> fill formats in a chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pattern</span><span class="p">:</span>   <span class="n">the</span> <span class="n">pattern</span> <span class="n">to</span> <span class="n">be</span> <span class="n">applied</span> <span class="p">(</span><span class="n">required</span><span class="p">)</span>
<span class="n">fg_color</span><span class="p">:</span>  <span class="n">the</span> <span class="n">foreground</span> <span class="n">color</span> <span class="n">of</span> <span class="n">the</span> <span class="n">pattern</span> <span class="p">(</span><span class="n">required</span><span class="p">)</span>
<span class="n">bg_color</span><span class="p">:</span>  <span class="n">the</span> <span class="n">background</span> <span class="n">color</span> <span class="p">(</span><span class="n">optional</span><span class="p">,</span> <span class="n">defaults</span> <span class="n">to</span> <span class="n">white</span><span class="p">)</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_plotarea</span><span class="p">({</span>
    <span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;percent_5&#39;</span><span class="p">,</span>
        <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
        <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The following patterns can be applied:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">percent_5</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">percent_10</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">percent_20</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">percent_25</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">percent_30</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">percent_40</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">percent_50</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">percent_60</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">percent_70</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">percent_75</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">percent_80</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">percent_90</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">light_downward_diagonal</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">light_upward_diagonal</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">dark_downward_diagonal</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">dark_upward_diagonal</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">wide_downward_diagonal</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">wide_upward_diagonal</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">light_vertical</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">light_horizontal</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">narrow_vertical</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">narrow_horizontal</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">dark_vertical</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">dark_horizontal</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">dashed_downward_diagonal</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">dashed_upward_diagonal</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">dashed_horizontal</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">dashed_vertical</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">small_confetti</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">large_confetti</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">zigzag</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">wave</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">diagonal_brick</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">horizontal_brick</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">weave</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">plaid</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">divot</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">dotted_grid</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">dotted_diamond</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">shingle</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">trellis</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">sphere</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">small_grid</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">large_grid</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">small_check</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">large_check</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">outlined_diamond</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">solid_diamond</span></code></li>
</ul>
<p>The foreground color, <code class="docutils literal notranslate"><span class="pre">fg_color</span></code>, is a required parameter and can be a Html
style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string or a limited number of named colors, see
<a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>.</p>
<p>The background color, <code class="docutils literal notranslate"><span class="pre">bg_color</span></code>, is optional and defaults to white.</p>
<p>If a pattern fill is used on a chart object it overrides the solid fill
properties of the object.</p>
</div>
<div class="section" id="chart-formatting-gradient-fill">
<span id="chart-formatting-gradient"></span><h4>Chart formatting: Gradient Fill</h4>
<p>The gradient fill format is used to specify gradient filled areas of chart
objects such as the interior of a column or the background of the chart
itself.</p>
<a class="reference internal image-reference" href="_images/chart_gradient.png"><img alt="_images/chart_gradient.png" src="_images/chart_gradient.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>The following properties can be set for <code class="docutils literal notranslate"><span class="pre">gradient</span></code> fill formats in a chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">colors</span><span class="p">:</span>    <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">colors</span>
<span class="n">positions</span><span class="p">:</span> <span class="n">an</span> <span class="n">optional</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">positions</span> <span class="k">for</span> <span class="n">the</span> <span class="n">colors</span>
<span class="nb">type</span><span class="p">:</span>      <span class="n">the</span> <span class="n">optional</span> <span class="nb">type</span> <span class="n">of</span> <span class="n">gradient</span> <span class="n">fill</span>
<span class="n">angle</span><span class="p">:</span>     <span class="n">the</span> <span class="n">optional</span> <span class="n">angle</span> <span class="n">of</span> <span class="n">the</span> <span class="n">linear</span> <span class="n">fill</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">colors</span></code> property sets a list of colors that define the <code class="docutils literal notranslate"><span class="pre">gradient</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_plotarea</span><span class="p">({</span>
    <span class="s1">&#39;gradient&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;#FFEFD1&#39;</span><span class="p">,</span> <span class="s1">&#39;#F0EBD5&#39;</span><span class="p">,</span> <span class="s1">&#39;#B69F66&#39;</span><span class="p">]}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>Excel allows between 2 and 10 colors in a gradient but it is unlikely that
you will require more than 2 or 3.</p>
<p>As with solid or pattern fill it is also possible to set the colors of a
gradient with a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string or a limited number of named
colors, see <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>   <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;gradient&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">]}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">positions</span></code> defines an optional list of positions, between 0 and 100, of
where the colors in the gradient are located. Default values are provided for
<code class="docutils literal notranslate"><span class="pre">colors</span></code> lists of between 2 and 4 but they can be specified if required:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;gradient&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;colors&#39;</span><span class="p">:</span>    <span class="p">[</span><span class="s1">&#39;#DDEBCF&#39;</span><span class="p">,</span> <span class="s1">&#39;#156B13&#39;</span><span class="p">],</span>
        <span class="s1">&#39;positions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span>        <span class="mi">90</span><span class="p">],</span>
    <span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type</span></code> property can have one of the following values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">linear</span>        <span class="p">(</span><span class="n">the</span> <span class="n">default</span><span class="p">)</span>
<span class="n">radial</span>
<span class="n">rectangular</span>
<span class="n">path</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;gradient&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;#DDEBCF&#39;</span><span class="p">,</span> <span class="s1">&#39;#9CB86E&#39;</span><span class="p">,</span> <span class="s1">&#39;#156B13&#39;</span><span class="p">],</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;radial&#39;</span>
    <span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">type</span></code> isn’t specified it defaults to <code class="docutils literal notranslate"><span class="pre">linear</span></code>.</p>
<p>For a <code class="docutils literal notranslate"><span class="pre">linear</span></code> fill the angle of the gradient can also be specified:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;gradient&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;#DDEBCF&#39;</span><span class="p">,</span> <span class="s1">&#39;#9CB86E&#39;</span><span class="p">,</span> <span class="s1">&#39;#156B13&#39;</span><span class="p">],</span>
                 <span class="s1">&#39;angle&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>The default angle is 90 degrees.</p>
<p>If gradient fill is used on a chart object it overrides the solid fill and
pattern fill properties of the object.</p>
</div>
<div class="section" id="chart-fonts">
<span id="id12"></span><h4>Chart Fonts</h4>
<p>The following font properties can be set for any chart object that they apply
to (and that are supported by XlsxWriter) such as chart titles, axis labels,
axis numbering and data labels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span>
<span class="n">size</span>
<span class="n">bold</span>
<span class="n">italic</span>
<span class="n">underline</span>
<span class="n">rotation</span>
<span class="n">color</span>
</pre></div>
</div>
<p>These properties correspond to the equivalent Worksheet cell Format object
properties. See the <a class="reference internal" href="index.html#format"><span class="std std-ref">The Format Class</span></a> section for more details about Format
properties and how to set them.</p>
<p>The following explains the available font properties:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">name</span></code>: Set the font name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;num_font&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Arial&#39;</span><span class="p">}})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">size</span></code>: Set the font size:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;num_font&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">}})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">bold</span></code>: Set the font bold property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;num_font&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">italic</span></code>: Set the font italic property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;num_font&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;italic&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">underline</span></code>: Set the font underline property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;num_font&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;underline&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">rotation</span></code>: Set the font rotation, angle, property in the integer
range -90 to 90 deg, and 270-271 deg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;num_font&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;rotation&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="p">}})</span>
</pre></div>
</div>
<p>The font rotation angle is useful for displaying axis data such as dates in
a more compact format.</p>
<p>There are 2 special case angles outside the range -90 to 90:</p>
<ul class="simple">
<li>270: Stacked text, where the text runs from top to bottom.</li>
<li>271: A special variant of stacked text for East Asian fonts.</li>
</ul>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">color</span></code>: Set the font color property. Can be a color index, a color name
or HTML style RGB color:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;num_font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span> <span class="p">}})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;num_font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#92D050&#39;</span><span class="p">}})</span>
</pre></div>
</div>
</li>
</ul>
<p>Here is an example of Font formatting in a Chart program:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test Results&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name_font&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Calibri&#39;</span><span class="p">,</span>
        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Month&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name_font&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier New&#39;</span><span class="p">,</span>
        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#92D050&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;num_font&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Arial&#39;</span><span class="p">,</span>
        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#00B0F0&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Units&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name_font&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Century&#39;</span><span class="p">,</span>
        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;num_font&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;italic&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;underline&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#7030A0&#39;</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;italic&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_font1.png"><img alt="_images/chart_font1.png" src="_images/chart_font1.png" style="width: 704.25px; height: 402.75px;" /></a>
</div>
<div class="section" id="chart-layout">
<span id="id13"></span><h4>Chart Layout</h4>
<p>The position of the chart in the worksheet is controlled by the
<a class="reference internal" href="index.html#set_size" title="set_size"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_size()</span></code></a> method.</p>
<p>It is also possible to change the layout of the following chart sub-objects:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plotarea</span>
<span class="n">legend</span>
<span class="n">title</span>
<span class="n">x_axis</span> <span class="n">caption</span>
<span class="n">y_axis</span> <span class="n">caption</span>
</pre></div>
</div>
<p>Here are some examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_plotarea</span><span class="p">({</span>
    <span class="s1">&#39;layout&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span>      <span class="mf">0.13</span><span class="p">,</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span>      <span class="mf">0.26</span><span class="p">,</span>
        <span class="s1">&#39;width&#39;</span><span class="p">:</span>  <span class="mf">0.73</span><span class="p">,</span>
        <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mf">0.57</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span>
    <span class="s1">&#39;layout&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span>      <span class="mf">0.80</span><span class="p">,</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span>      <span class="mf">0.37</span><span class="p">,</span>
        <span class="s1">&#39;width&#39;</span><span class="p">:</span>  <span class="mf">0.12</span><span class="p">,</span>
        <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>    <span class="s1">&#39;Title&#39;</span><span class="p">,</span>
    <span class="s1">&#39;overlay&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;layout&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mf">0.42</span><span class="p">,</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mf">0.14</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;X axis&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name_layout&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mf">0.34</span><span class="p">,</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mf">0.85</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">})</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#set_plotarea" title="set_plotarea"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_plotarea()</span></code></a>, <a class="reference internal" href="index.html#set_legend" title="set_legend"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_legend()</span></code></a>, <a class="reference internal" href="index.html#set_title" title="set_title"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_title()</span></code></a> and
<a class="reference internal" href="index.html#set_x_axis" title="set_x_axis"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_x_axis()</span></code></a>,</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is only possible to change the width and height for the <code class="docutils literal notranslate"><span class="pre">plotarea</span></code>
and <code class="docutils literal notranslate"><span class="pre">legend</span></code> objects. For the other text based objects the width and
height are changed by the font dimensions.</p>
</div>
<p>The layout units must be a float in the range <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;</span> <span class="pre">x</span> <span class="pre">&lt;=</span> <span class="pre">1</span></code> and are expressed
as a percentage of the chart dimensions as shown below:</p>
<a class="reference internal image-reference" href="_images/chart_layout.png"><img alt="_images/chart_layout.png" src="_images/chart_layout.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>From this the layout units are calculated as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">layout</span><span class="p">:</span>
    <span class="n">x</span>      <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">W</span>
    <span class="n">y</span>      <span class="o">=</span> <span class="n">b</span> <span class="o">/</span> <span class="n">H</span>
    <span class="n">width</span>  <span class="o">=</span> <span class="n">w</span> <span class="o">/</span> <span class="n">W</span>
    <span class="n">height</span> <span class="o">=</span> <span class="n">h</span> <span class="o">/</span> <span class="n">H</span>
</pre></div>
</div>
<p>These units are cumbersome and can vary depending on other elements in the
chart such as text lengths. However, these are the units that are required by
Excel to allow relative positioning. Some trial and error is generally
required.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">plotarea</span></code> origin is the top left corner in the plotarea itself and
does not take into account the axes.</p>
</div>
</div>
<div class="section" id="date-category-axes">
<span id="id14"></span><h4>Date Category Axes</h4>
<p>Date Category Axes are category axes that display time or date information. In
XlsxWriter Date Category Axes are set using the <code class="docutils literal notranslate"><span class="pre">date_axis</span></code> option in
<a class="reference internal" href="index.html#set_x_axis" title="set_x_axis"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_x_axis()</span></code></a> or <a class="reference internal" href="index.html#set_y_axis" title="set_y_axis"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_y_axis()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;date_axis&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>In general you should also specify a number format for a date axis although
Excel will usually default to the same format as the data being plotted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span>
    <span class="s1">&#39;date_axis&#39;</span><span class="p">:</span>  <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;dd/mm/yyyy&#39;</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
<p>Excel doesn’t normally allow minimum and maximum values to be set for category
axes. However, date axes are an exception. The <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code> values
should be set as Excel times or dates:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span>
    <span class="s1">&#39;date_axis&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
    <span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;dd/mm/yyyy&#39;</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
<p>For date axes it is also possible to set the type of the major and minor units:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span>
    <span class="s1">&#39;date_axis&#39;</span><span class="p">:</span>       <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;minor_unit&#39;</span><span class="p">:</span>      <span class="mi">4</span><span class="p">,</span>
    <span class="s1">&#39;minor_unit_type&#39;</span><span class="p">:</span> <span class="s1">&#39;months&#39;</span><span class="p">,</span>
    <span class="s1">&#39;major_unit&#39;</span><span class="p">:</span>      <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;major_unit_type&#39;</span><span class="p">:</span> <span class="s1">&#39;years&#39;</span><span class="p">,</span>
    <span class="s1">&#39;num_format&#39;</span><span class="p">:</span>      <span class="s1">&#39;dd/mm/yyyy&#39;</span><span class="p">,</span>
<span class="p">})</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#ex-chart-date-axis"><span class="std std-ref">Example: Date Axis Chart</span></a>.</p>
</div>
<div class="section" id="chart-secondary-axes">
<span id="id15"></span><h4>Chart Secondary Axes</h4>
<p>It is possible to add a secondary axis of the same type to a chart by setting
the <code class="docutils literal notranslate"><span class="pre">y2_axis</span></code> or <code class="docutils literal notranslate"><span class="pre">x2_axis</span></code> property of the series:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_secondary_axis.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>

<span class="c1"># Configure a series with a secondary axis.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;y2_axis&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure a primary (default) Axis.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;position&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Primary Y axis&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_y2_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Secondary Y axis&#39;</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_secondary_axis2.png"><img alt="_images/chart_secondary_axis2.png" src="_images/chart_secondary_axis2.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>It is also possible to have a secondary, combined, chart either with a shared
or secondary axis, see below.</p>
</div>
<div class="section" id="combined-charts">
<span id="chart-combined-charts"></span><h4>Combined Charts</h4>
<p>It is also possible to combine two different chart types, for example a column
and line chart to create a Pareto chart using the Chart <a class="reference internal" href="index.html#combine" title="combine"><code class="xref py py-func docutils literal notranslate"><span class="pre">combine()</span></code></a>
method:</p>
<a class="reference internal image-reference" href="_images/chart_pareto.png"><img alt="_images/chart_pareto.png" src="_images/chart_pareto.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>The combined charts can share the same Y axis like the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Usual setup to create workbook and add data...</span>

<span class="c1"># Create a new column chart. This will use this as the primary chart.</span>
<span class="n">column_chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Configure the data series for the primary chart.</span>
<span class="n">column_chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!B1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!A2:A7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!B2:B7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Create a new column chart. This will use this as the secondary chart.</span>
<span class="n">line_chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>

<span class="c1"># Configure the data series for the secondary chart.</span>
<span class="n">line_chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!C1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!A2:A7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!C2:C7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Combine the charts.</span>
<span class="n">column_chart</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">line_chart</span><span class="p">)</span>

<span class="c1"># Add a chart title and some axis labels. Note, this is done via the</span>
<span class="c1"># primary chart.</span>
<span class="n">column_chart</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Combined chart - same Y axis&#39;</span><span class="p">})</span>
<span class="n">column_chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">column_chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;E2&#39;</span><span class="p">,</span> <span class="n">column_chart</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_combined1.png"><img alt="_images/chart_combined1.png" src="_images/chart_combined1.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>The secondary chart can also be placed on a secondary axis using the methods
shown in the previous section.</p>
<p>In this case it is just necessary to add a <code class="docutils literal notranslate"><span class="pre">y2_axis</span></code> parameter to the series
and, if required, add a title using <a class="reference internal" href="index.html#set_y2_axis" title="set_y2_axis"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_y2_axis()</span></code></a>. The following are
the additions to the previous example to place the secondary chart on the
secondary axis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># ...</span>
<span class="n">line_chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!C1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!A2:A7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!C2:C7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;y2_axis&#39;</span><span class="p">:</span>    <span class="kc">True</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="c1"># ...</span>
<span class="n">column_chart</span><span class="o">.</span><span class="n">set_y2_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Target length (mm)&#39;</span><span class="p">})</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/chart_combined2.png"><img alt="_images/chart_combined2.png" src="_images/chart_combined2.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>The examples above use the concept of a <em>primary</em> and <em>secondary</em> chart. The
primary chart is the chart that defines the primary X and Y axis. It is also
used for setting all chart properties apart from the secondary data
series. For example the chart title and axes properties should be set via the
primary chart.</p>
<p>See also <a class="reference internal" href="index.html#ex-chart-combined"><span class="std std-ref">Example: Combined Chart</span></a> and <a class="reference internal" href="index.html#ex-chart-pareto"><span class="std std-ref">Example: Pareto Chart</span></a> for more detailed
examples.</p>
<p>There are some limitations on combined charts:</p>
<ul class="simple">
<li>Pie charts cannot currently be combined.</li>
<li>Scatter charts cannot currently be used as a primary chart but they can be
used as a secondary chart.</li>
<li>Bar charts can only combined secondary charts on a secondary axis. This is
an Excel limitation.</li>
</ul>
</div>
<div class="section" id="chartsheets">
<h4>Chartsheets</h4>
<p>The examples shown above and in general the most common type of charts in Excel
are embedded charts.</p>
<p>However, it is also possible to create “Chartsheets” which are worksheets that
are comprised of a single chart:</p>
<img alt="_images/chartsheet.png" src="_images/chartsheet.png" />
<p>See <a class="reference internal" href="index.html#chartsheet"><span class="std std-ref">The Chartsheet Class</span></a> for details.</p>
</div>
<div class="section" id="charts-from-worksheet-tables">
<span id="charts-from-tables"></span><h4>Charts from Worksheet Tables</h4>
<p>Charts can by created from <a class="reference internal" href="index.html#tables"><span class="std std-ref">Worksheet Tables</span></a>. However, Excel
has a limitation where the data series <code class="docutils literal notranslate"><span class="pre">name</span></code>, if specified, must refer to a
cell within the table (usually one of the headers).</p>
<p>To workaround this Excel limitation you can specify a user defined name in the
table and refer to that from the chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_pie.xlsx&#39;</span><span class="p">)</span>

<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Apple&#39;</span><span class="p">,</span>  <span class="mi">60</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Cherry&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Pecan&#39;</span><span class="p">,</span>  <span class="mi">10</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;A1:B4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
                              <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Types&#39;</span><span class="p">},</span>
                                         <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Number&#39;</span><span class="p">}]}</span>
<span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;pie&#39;</span><span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$A$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$4&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="chart-limitations">
<h4>Chart Limitations</h4>
<p>The following chart features aren’t supported in XlsxWriter:</p>
<ul class="simple">
<li>3D charts and controls.</li>
<li>Bubble, Surface or other chart types not listed in <a class="reference internal" href="index.html#chart-class"><span class="std std-ref">The Chart Class</span></a>.</li>
</ul>
</div>
<div class="section" id="chart-examples">
<h4>Chart Examples</h4>
<p>See <a class="reference internal" href="index.html#chart-examples"><span class="std std-ref">Chart Examples</span></a>.</p>
</div>
</div>
<span id="document-working_with_object_positioning"></span><div class="section" id="working-with-object-positioning">
<span id="object-position"></span><h3>Working with Object Positioning</h3>
<p>XlsxWriter positions worksheet objects such as images, charts and textboxes in
worksheets by calculating precise co-ordinates based on the object size, it’s
DPI (for images) and any scaling that the user specifies. It also takes into
account the heights and widths of the rows and columns that the object
crosses. In this way objects maintain their original sizes even if the rows or
columns underneath change size or are hidden.</p>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;image.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Original image.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;logo.png&#39;</span><span class="p">)</span>

<span class="c1"># Same size as original, despite row/col changes.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;E8&#39;</span><span class="p">,</span> <span class="s1">&#39;logo.png&#39;</span><span class="p">)</span>

<span class="c1"># Make column F narrower.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;F:F&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Hide row 10 (zero indexed).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/object_position1.png" src="_images/object_position1.png" />
<p>As can be seen the inserted image sizes are the same even though the second
image crosses changed rows and columns.</p>
<p>However, there are two cases where the image scale may change with row or
columns changes. These are explained in the next two sections.</p>
<div class="section" id="object-scaling-due-to-automatic-row-height-adjustment">
<h4>Object scaling due to automatic row height adjustment</h4>
<p>The scaling of a image may be affected if is crosses a row that has its
default height changed due to a font that is larger than the default font size
or that has text wrapping turned on. In these cases Excel will automatically
calculate a row height based on the text when it loads the file. Since this
row height isn’t available to XlsxWriter when it creates the file the object
may appear as if it is sized incorrectly. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;image.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">wrap_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A9&#39;</span><span class="p">,</span> <span class="s1">&#39;Some text that wraps&#39;</span><span class="p">,</span> <span class="n">wrap_format</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;logo.png&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B8&#39;</span><span class="p">,</span> <span class="s1">&#39;logo.png&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/object_position2.png" src="_images/object_position2.png" />
<p>As can be seen the second inserted image is distorted, compared to the first,
due to the row being scaled automatically. To avoid this you should explicitly
set the height of the row using <code class="docutils literal notranslate"><span class="pre">set_row()</span></code> if it crosses an inserted
object.</p>
</div>
<div class="section" id="object-positioning-with-cell-moving-and-sizing">
<h4>Object Positioning with Cell Moving and Sizing</h4>
<p>Excel supports three options for “Object Positioning” within a worksheet:</p>
<img alt="_images/object_position3.png" src="_images/object_position3.png" />
<p>Image, chart and textbox objects in XlsxWriter emulate these options using the
<code class="docutils literal notranslate"><span class="pre">object_position</span></code> parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;python.png&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;object_position&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">object_position</span></code> has one of the following allowable values:</p>
<ol class="arabic simple">
<li>Move and size with cells.</li>
<li>Move but don’t size with cells.</li>
<li>Don’t move or size with cells.</li>
<li>Same as Option 1 to “move and size with cells” except XlsxWriter applies
hidden cells after the object is inserted.</li>
</ol>
<p>Option 4 appears in Excel as Option 1. However, the worksheet object is sized
to take hidden rows or columns into account. This allows the user to hide an
image in a cell, possibly as part of an autofilter. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;image.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;logo.png&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B9&#39;</span><span class="p">,</span> <span class="s1">&#39;logo.png&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;object_position&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>

<span class="c1"># Hide some rows.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/object_position4.png" src="_images/object_position4.png" />
<p>In this example the first inserted image is visible over the hidden rows
whilst the second image is hidden with the rows. Unhiding the rows in Excel
would reveal the second image.</p>
</div>
<div class="section" id="image-sizing-and-dpi">
<h4>Image sizing and DPI</h4>
<p>When an image is imported into Excel the DPI (dots per inch) resolution of the
image is taken into account. Excel sizes the image according to a base DPI
of 96. Therefore an image with a DPI of 72 may appear slightly larger when
imported into Excel while an image with a DPI of 200 may appear twice as
small. XlsxWriter also reads the DPI of the images that the user inserts into
a worksheet and stores the image dimensions in the same way that Excel
does. If it cannot determine the DPI of the image it uses a default of 96.</p>
</div>
<div class="section" id="reporting-issues-with-image-insertion">
<h4>Reporting issues with image insertion</h4>
<p>A lot of work has gone into ensuring that XlsxWriter inserts images into
worksheets in exactly the same way that Excel does, even though the required
calculations and units are arcane. There are over 80 test cases that check
image insertion against files created in Excel to ensure that XlsxWriter’s
handling of images is correct.</p>
<p>As such, before reporting any issues with image handling in XlsxWriter please
check how the same image is handled in Excel (not OpenOffice, LibreOffice or
other third party applications). If you do report an issue please use the
XlsxWriter
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues">Issue tracker is on GitHub</a>
and attach the image that demonstrates the issue.</p>
</div>
</div>
<span id="document-working_with_autofilters"></span><div class="section" id="working-with-autofilters">
<span id="id1"></span><h3>Working with Autofilters</h3>
<p>An autofilter in Excel is a way of filtering a 2D range of data based on some
simple criteria.</p>
<img alt="_images/autofilter1.png" src="_images/autofilter1.png" />
<div class="section" id="applying-an-autofilter">
<h4>Applying an autofilter</h4>
<p>The first step is to apply an autofilter to a cell range in a worksheet using
the <a class="reference internal" href="index.html#autofilter" title="autofilter"><code class="xref py py-func docutils literal notranslate"><span class="pre">autofilter()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">autofilter</span><span class="p">(</span><span class="s1">&#39;A1:D11&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>As usual you can also use <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Row-Column</span></a> notation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">autofilter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># Same as above.</span>
</pre></div>
</div>
</div>
<div class="section" id="filter-data-in-an-autofilter">
<h4>Filter data in an autofilter</h4>
<p>The <a class="reference internal" href="index.html#autofilter" title="autofilter"><code class="xref py py-func docutils literal notranslate"><span class="pre">autofilter()</span></code></a> defines the cell range that the filter applies to and
creates drop-down selectors in the heading row. In order to filter out data it
is necessary to apply some criteria to the columns using either the
<a class="reference internal" href="index.html#filter_column" title="filter_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter_column()</span></code></a> or <a class="reference internal" href="index.html#filter_column_list" title="filter_column_list"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter_column_list()</span></code></a> methods.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">filter_column</span></code> method is used to filter columns in a autofilter range
based on simple criteria:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;x &gt; 2000&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;x &gt; 2000 and x &lt; 5000&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>It isn’t sufficient to just specify the filter condition. You must also hide
any rows that don’t match the filter condition. Rows are hidden using the
<a class="reference internal" href="index.html#set_row" title="set_row"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_row()</span></code></a> <code class="docutils literal notranslate"><span class="pre">hidden</span></code> parameter. <code class="docutils literal notranslate"><span class="pre">XlsxWriter</span></code> cannot filter rows
automatically since this isn’t part of the file format.</p>
<p>The following is an example of how you might filter a data range to match an
autofilter criteria:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set the autofilter.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">autofilter</span><span class="p">(</span><span class="s1">&#39;A1:D51&#39;</span><span class="p">)</span>

<span class="c1"># Add the filter criteria. The placeholder &quot;Region&quot; in the filter is</span>
<span class="c1"># ignored and can be any string that adds clarity to the expression.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Region == East&#39;</span><span class="p">)</span>

<span class="c1"># Hide the rows that don&#39;t match the filter criteria.</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">region</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Check for rows that match the filter.</span>
    <span class="k">if</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;East&#39;</span><span class="p">:</span>
        <span class="c1"># Row matches the filter, display the row as normal.</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># We need to hide rows that don&#39;t match the filter.</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

    <span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

    <span class="c1"># Move on to the next worksheet row.</span>
    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-a-filter-criteria-for-a-column">
<h4>Setting a filter criteria for a column</h4>
<p>The <a class="reference internal" href="index.html#filter_column" title="filter_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter_column()</span></code></a> method can be used to filter columns in a autofilter
range based on simple conditions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;x &gt; 2000&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">column</span></code> parameter can either be a zero indexed column number or a string
column name.</p>
<p>The following operators are available for setting the filter criteria:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Operator</span>
   <span class="o">==</span>
   <span class="o">!=</span>
   <span class="o">&gt;</span>
   <span class="o">&lt;</span>
   <span class="o">&gt;=</span>
   <span class="o">&lt;=</span>

   <span class="ow">and</span>
   <span class="ow">or</span>
</pre></div>
</div>
<p>An expression can comprise a single statement or two statements separated by
the <code class="docutils literal notranslate"><span class="pre">and</span></code> and <code class="docutils literal notranslate"><span class="pre">or</span></code> operators. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;x &lt;  2000&#39;</span>
<span class="s1">&#39;x &gt;  2000&#39;</span>
<span class="s1">&#39;x == 2000&#39;</span>
<span class="s1">&#39;x &gt;  2000 and x &lt;  5000&#39;</span>
<span class="s1">&#39;x == 2000 or  x == 5000&#39;</span>
</pre></div>
</div>
<p>Filtering of blank or non-blank data can be achieved by using a value of
<code class="docutils literal notranslate"><span class="pre">Blanks</span></code> or <code class="docutils literal notranslate"><span class="pre">NonBlanks</span></code> in the expression:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;x == Blanks&#39;</span>
<span class="s1">&#39;x == NonBlanks&#39;</span>
</pre></div>
</div>
<p>Excel also allows some simple string matching operations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;x == b*&#39;</span>      <span class="c1"># begins with b</span>
<span class="s1">&#39;x != b*&#39;</span>      <span class="c1"># doesn&#39;t begin with b</span>
<span class="s1">&#39;x == *b&#39;</span>      <span class="c1"># ends with b</span>
<span class="s1">&#39;x != *b&#39;</span>      <span class="c1"># doesn&#39;t end with b</span>
<span class="s1">&#39;x == *b*&#39;</span>     <span class="c1"># contains b</span>
<span class="s1">&#39;x != *b*&#39;</span>     <span class="c1"># doesn&#39;t contains b</span>
</pre></div>
</div>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">'*'</span></code> to match any character or number and <code class="docutils literal notranslate"><span class="pre">'?'</span></code> to match
any single character or number. No other regular expression quantifier is
supported by Excel’s filters. Excel’s regular expression characters can be
escaped using <code class="docutils literal notranslate"><span class="pre">'~'</span></code>.</p>
<p>The placeholder variable <code class="docutils literal notranslate"><span class="pre">x</span></code> in the above examples can be replaced by any
simple string. The actual placeholder name is ignored internally so the
following are all equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;x     &lt; 2000&#39;</span>
<span class="s1">&#39;col   &lt; 2000&#39;</span>
<span class="s1">&#39;Price &lt; 2000&#39;</span>
</pre></div>
</div>
<p>A filter condition can only be applied to a column in a range specified by the
<a class="reference internal" href="index.html#autofilter" title="autofilter"><code class="xref py py-func docutils literal notranslate"><span class="pre">autofilter()</span></code></a> method.</p>
</div>
<div class="section" id="setting-a-column-list-filter">
<h4>Setting a column list filter</h4>
<p>Prior to Excel 2007 it was only possible to have either 1 or 2 filter
conditions such as the ones shown above in the <a class="reference internal" href="index.html#filter_column" title="filter_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter_column()</span></code></a> method.</p>
<p>Excel 2007 introduced a new list style filter where it is possible to specify 1
or more ‘or’ style criteria. For example if your column contained data for the
months of the year you could filter the data based on certain months:</p>
<img alt="_images/autofilter2.png" src="_images/autofilter2.png" />
<p>The <a class="reference internal" href="index.html#filter_column_list" title="filter_column_list"><code class="xref py py-func docutils literal notranslate"><span class="pre">filter_column_list()</span></code></a> method can be used to represent these types of
filters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column_list</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;March&#39;</span><span class="p">,</span> <span class="s1">&#39;April&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>One or more criteria can be selected:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column_list</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;March&#39;</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column_list</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">130</span><span class="p">])</span>
</pre></div>
</div>
<p>To filter blanks as part of the list use <cite>Blanks</cite> as a list item:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">filter_column_list</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;March&#39;</span><span class="p">,</span> <span class="s1">&#39;April&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Blanks&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>As explained above, it isn’t sufficient to just specify filters. You must also
hide any rows that don’t match the filter condition.</p>
</div>
<div class="section" id="example">
<h4>Example</h4>
<p>See <a class="reference internal" href="index.html#ex-autofilter"><span class="std std-ref">Example: Applying Autofilters</span></a> for a full example of all these features.</p>
</div>
</div>
<span id="document-working_with_data_validation"></span><div class="section" id="working-with-data-validation">
<span id="id1"></span><h3>Working with Data Validation</h3>
<p>Data validation is a feature of Excel which allows you to restrict the data
that a user enters in a cell and to display associated help and warning
messages. It also allows you to restrict input to values in a dropdown list.</p>
<p>A typical use case might be to restrict data in a cell to integer values in a
certain range, to provide a help message to indicate the required value and to
issue a warning if the input data doesn’t meet the stated criteria. In
XlsxWriter we could do that as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B25&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                  <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                                  <span class="s1">&#39;input_title&#39;</span><span class="p">:</span> <span class="s1">&#39;Enter an integer:&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;input_message&#39;</span><span class="p">:</span> <span class="s1">&#39;between 1 and 100&#39;</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/data_validate1.png" src="_images/data_validate1.png" />
<p>If the user inputs a value that doesn’t match the specified criteria an error
message is displayed:</p>
<img alt="_images/data_validate4.png" src="_images/data_validate4.png" />
<p>For more information on data validation see the Microsoft support article
“Description and examples of data validation in Excel”:
<a class="reference external" href="http://support.microsoft.com/kb/211485">http://support.microsoft.com/kb/211485</a>.</p>
<p>The following sections describe how to use the <code class="docutils literal notranslate"><span class="pre">data_validation()</span></code> method and
its various options.</p>
<div class="section" id="data-validation">
<h4>data_validation()</h4>
<p>The <a class="reference internal" href="index.html#data_validation" title="data_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">data_validation()</span></code></a> method is used to construct an Excel data
validation.</p>
<p>The data validation can be applied to a single cell or a range of cells. As
usual you can use A1 or Row/Column notation, see <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a>.</p>
<p>With Row/Column notation you must specify all four cells in the range:
<code class="docutils literal notranslate"><span class="pre">(first_row,</span> <span class="pre">first_col,</span> <span class="pre">last_row,</span> <span class="pre">last_col)</span></code>. If you need to refer to a
single cell set the <cite>last_</cite> values equal to the <cite>first_</cite> values. With A1
notation you can refer to a single cell or a range of cells:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="o">...</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span>       <span class="p">{</span><span class="o">...</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;C1:E5&#39;</span><span class="p">,</span>    <span class="p">{</span><span class="o">...</span><span class="p">})</span>
</pre></div>
</div>
<p>The options parameter in <code class="docutils literal notranslate"><span class="pre">data_validation()</span></code> must be a dictionary containing
the parameters that describe the type and style of the data validation. The
main parameters are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="43%" />
<col width="30%" />
<col width="27%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">validate</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">criteria</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">value</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">minimum</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">source</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">maximum</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">ignore_blank</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">dropdown</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">input_title</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">input_message</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">show_input</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">error_title</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">error_message</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">error_type</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">show_error</span></code></td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<p>These parameters are explained in the following sections. Most of the
parameters are optional, however, you will generally require the three main
options <code class="docutils literal notranslate"><span class="pre">validate</span></code>, <code class="docutils literal notranslate"><span class="pre">criteria</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>
</pre></div>
</div>
<div class="section" id="validate">
<h5>validate</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">validate</span></code> parameter is used to set the type of data that you wish to
validate:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>
</pre></div>
</div>
<p>It is always required and it has no default value. Allowable values are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">integer</span>
<span class="n">decimal</span>
<span class="nb">list</span>
<span class="n">date</span>
<span class="n">time</span>
<span class="n">length</span>
<span class="n">custom</span>
<span class="nb">any</span>
</pre></div>
</div>
<ul class="simple">
<li><strong>integer</strong>: restricts the cell to integer values. Excel refers to this as
‘whole number’.</li>
<li><strong>decimal</strong>: restricts the cell to decimal values.</li>
<li><strong>list</strong>: restricts the cell to a set of user specified values. These can
be passed in a Python list or as an Excel cell range.</li>
<li><strong>date</strong>: restricts the cell to date values specified as a datetime object
as shown in <a class="reference internal" href="index.html#working-with-dates-and-time"><span class="std std-ref">Working with Dates and Time</span></a> or a date formula.</li>
<li><strong>time</strong>: restricts the cell to time values specified as a datetime object
as shown in <a class="reference internal" href="index.html#working-with-dates-and-time"><span class="std std-ref">Working with Dates and Time</span></a> or a time formula.</li>
<li><strong>length</strong>: restricts the cell data based on an integer string length.
Excel refers to this as ‘Text length’.</li>
<li><strong>custom</strong>: restricts the cell based on an external Excel formula that
returns a <code class="docutils literal notranslate"><span class="pre">TRUE/FALSE</span></code> value.</li>
<li><strong>any</strong>: is used to specify that the type of data is unrestricted. It is
mainly used for specifying cell input messages without a data validation.</li>
</ul>
</div>
<div class="section" id="criteria">
<h5>criteria</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">criteria</span></code> parameter is used to set the criteria by which the data in the
cell is validated. It is almost always required except for the <code class="docutils literal notranslate"><span class="pre">list</span></code>,
<code class="docutils literal notranslate"><span class="pre">custom</span></code> and <code class="docutils literal notranslate"><span class="pre">any</span></code> validate options. It has no default value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>
</pre></div>
</div>
<p>Allowable values are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="79%" />
<col width="21%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">between</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">between</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">equal</span> <span class="pre">to</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">==</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">equal</span> <span class="pre">to</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">!=</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">greater</span> <span class="pre">than</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">&gt;</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">less</span> <span class="pre">than</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">&lt;</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">greater</span> <span class="pre">than</span> <span class="pre">or</span> <span class="pre">equal</span> <span class="pre">to</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">&gt;=</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">less</span> <span class="pre">than</span> <span class="pre">or</span> <span class="pre">equal</span> <span class="pre">to</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">&lt;=</span></code></td>
</tr>
</tbody>
</table>
<p>You can either use Excel’s textual description strings, in the first column
above, or the more common symbolic alternatives. The following are equivalent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;greater than&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">custom</span></code> and <code class="docutils literal notranslate"><span class="pre">any</span></code> validate options don’t require a
<code class="docutils literal notranslate"><span class="pre">criteria</span></code>. If you specify one it will be ignored:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B13&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B23&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;custom&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=AND(F5=50,G5=60)&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="value-minimum-source">
<h5>value, minimum, source</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">value</span></code> parameter is used to set the limiting value to which the
<code class="docutils literal notranslate"><span class="pre">criteria</span></code> is applied. It is always required and it has no default value.
You can also use the synonyms <code class="docutils literal notranslate"><span class="pre">minimum</span></code> or <code class="docutils literal notranslate"><span class="pre">source</span></code> to make the validation
a little clearer and closer to Excel’s description of the parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using &#39;value&#39;.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;greater than&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>

<span class="c1"># Using &#39;minimum&#39;.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B11&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;decimal&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                                  <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>

<span class="c1"># Using &#39;source&#39;.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B10&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;=$E$4:$G$4&#39;</span><span class="p">})</span>

<span class="c1"># Using &#39;source&#39; with a string list.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B13&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]})</span>
</pre></div>
</div>
<p>Note, when using the <code class="docutils literal notranslate"><span class="pre">list</span></code> validation with a list of strings, like in the
last example above, Excel stores the strings internally as a Comma Separated
Variable string. The total length for this string, including commas, cannot
exceed the Excel limit of 255 characters. For longer sets of data you should
use a range reference like the prior example above.</p>
</div>
<div class="section" id="maximum">
<h5>maximum</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">maximum</span></code> parameter is used to set the upper limiting value when the
<code class="docutils literal notranslate"><span class="pre">criteria</span></code> is either <code class="docutils literal notranslate"><span class="pre">'between'</span></code> or <code class="docutils literal notranslate"><span class="pre">'not</span> <span class="pre">between'</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B11&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;decimal&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                                  <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="ignore-blank">
<h5>ignore_blank</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">ignore_blank</span></code> parameter is used to toggle on and off the ‘Ignore blank’
option in the Excel data validation dialog. When the option is on the data
validation is not applied to blank data in the cell. It is on by default:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                                 <span class="s1">&#39;ignore_blank&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                                 <span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="dropdown">
<h5>dropdown</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">dropdown</span></code> parameter is used to toggle on and off the ‘In-cell dropdown’
option in the Excel data validation dialog. When the option is on a dropdown
list will be shown for <code class="docutils literal notranslate"><span class="pre">list</span></code> validations. It is on by default.</p>
</div>
<div class="section" id="input-title">
<h5>input_title</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">input_title</span></code> parameter is used to set the title of the input message
that is displayed when a cell is entered. It has no default value and is only
displayed if the input message is displayed. See the <code class="docutils literal notranslate"><span class="pre">input_message</span></code>
parameter below.</p>
<p>The maximum title length is 32 characters.</p>
</div>
<div class="section" id="input-message">
<h5>input_message</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">input_message</span></code> parameter is used to set the input message that is
displayed when a cell is entered. It has no default value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B25&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                  <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                                  <span class="s1">&#39;input_title&#39;</span><span class="p">:</span> <span class="s1">&#39;Enter an integer:&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;input_message&#39;</span><span class="p">:</span> <span class="s1">&#39;between 1 and 100&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The input message generated from the above example is:</p>
<img alt="_images/data_validate3.png" src="_images/data_validate3.png" />
<p>The message can be split over several lines using newlines. The maximum message
length is 255 characters.</p>
</div>
<div class="section" id="show-input">
<h5>show_input</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">show_input</span></code> parameter is used to toggle on and off the ‘Show input
message when cell is selected’ option in the Excel data validation dialog.
When the option is off an input message is not displayed even if it has been
set using <code class="docutils literal notranslate"><span class="pre">input_message</span></code>. It is on by default.</p>
</div>
<div class="section" id="error-title">
<h5>error_title</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">error_title</span></code> parameter is used to set the title of the error message
that is displayed when the data validation criteria is not met. The default
error title is ‘Microsoft Excel’. The maximum title length is 32 characters.</p>
</div>
<div class="section" id="error-message">
<h5>error_message</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">error_message</span></code> parameter is used to set the error message that is
displayed when a cell is entered. The default error message is “The value you
entered is not valid. A user has restricted values that can be entered into
the cell.”. A non-default error message can be displayed as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B27&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                  <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                                  <span class="s1">&#39;input_title&#39;</span><span class="p">:</span> <span class="s1">&#39;Enter an integer:&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;input_message&#39;</span><span class="p">:</span> <span class="s1">&#39;between 1 and 100&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;error_title&#39;</span><span class="p">:</span> <span class="s1">&#39;Input value not valid!&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;error_message&#39;</span><span class="p">:</span> <span class="s1">&#39;It should be an integer between 1 and 100&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>Which give the following message:</p>
<img alt="_images/data_validate2.png" src="_images/data_validate2.png" />
<p>The message can be split over several lines using newlines. The maximum message
length is 255 characters.</p>
</div>
<div class="section" id="error-type">
<h5>error_type</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">error_type</span></code> parameter is used to specify the type of error dialog that
is displayed. There are 3 options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;stop&#39;</span>
<span class="s1">&#39;warning&#39;</span>
<span class="s1">&#39;information&#39;</span>
</pre></div>
</div>
<p>The default is <code class="docutils literal notranslate"><span class="pre">'stop'</span></code>.</p>
</div>
<div class="section" id="show-error">
<h5>show_error</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">show_error</span></code> parameter is used to toggle on and off the ‘Show error alert
after invalid data is entered’ option in the Excel data validation dialog.
When the option is off an error message is not displayed even if it has been
set using <code class="docutils literal notranslate"><span class="pre">error_message</span></code>. It is on by default.</p>
</div>
</div>
<div class="section" id="data-validation-examples">
<h4>Data Validation Examples</h4>
<p>Example 1. Limiting input to an integer greater than a fixed value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                                 <span class="p">})</span>
</pre></div>
</div>
<p>Example 2. Limiting input to an integer greater than a fixed value where the
value is referenced from a cell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=E3&#39;</span><span class="p">,</span>
                                 <span class="p">})</span>
</pre></div>
</div>
<p>Example 3. Limiting input to a decimal in a fixed range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;decimal&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                                 <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                                 <span class="p">})</span>
</pre></div>
</div>
<p>Example 4. Limiting input to a value in a dropdown list:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">],</span>
                                 <span class="p">})</span>
</pre></div>
</div>
<p>Example 5. Limiting input to a value in a dropdown list where the list is
specified as a cell range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;=$E$4:$G$4&#39;</span><span class="p">,</span>
                                 <span class="p">})</span>
</pre></div>
</div>
<p>Example 6. Limiting input to a date in a fixed range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">date</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;A6&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                                 <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span>
                                 <span class="p">})</span>
</pre></div>
</div>
<p>Example 7. Displaying a message when the cell is selected:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                                 <span class="s1">&#39;input_title&#39;</span><span class="p">:</span> <span class="s1">&#39;Enter an integer:&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;input_message&#39;</span><span class="p">:</span> <span class="s1">&#39;between 1 and 100&#39;</span><span class="p">,</span>
                                 <span class="p">})</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="index.html#ex-data-valid"><span class="std std-ref">Example: Data Validation and Drop Down Lists</span></a>.</p>
</div>
</div>
<span id="document-working_with_conditional_formats"></span><div class="section" id="working-with-conditional-formatting">
<span id="working-with-conditional-formats"></span><h3>Working with Conditional Formatting</h3>
<p>Conditional formatting is a feature of Excel which allows you to apply a format
to a cell or a range of cells based on certain criteria.</p>
<p>For example the following rules are used to highlight cells in the
<a class="reference internal" href="index.html#ex-cond-format"><span class="std std-ref">conditional_format.py</span></a> example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mi">50</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mi">50</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format2</span><span class="p">})</span>
</pre></div>
</div>
<p>Which gives criteria like this:</p>
<img alt="_images/conditional_format3.png" src="_images/conditional_format3.png" />
<p>And output which looks like this:</p>
<img alt="_images/conditional_format1.png" src="_images/conditional_format1.png" />
<p>It is also possible to create color scales and data bars:</p>
<img alt="_images/conditional_format2.png" src="_images/conditional_format2.png" />
<div class="section" id="the-conditional-format-method">
<h4>The conditional_format() method</h4>
<p>The <a class="reference internal" href="index.html#conditional_format" title="conditional_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">conditional_format()</span></code></a> worksheet method is used to apply formatting
based on user defined criteria to an XlsxWriter file.</p>
<p>The conditional format can be applied to a single cell or a range of cells. As
usual you can use A1 or Row/Column notation (<a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a>).</p>
<p>With Row/Column notation you must specify all four cells in the range:
<code class="docutils literal notranslate"><span class="pre">(first_row,</span> <span class="pre">first_col,</span> <span class="pre">last_row,</span> <span class="pre">last_col)</span></code>. If you need to refer to a
single cell set the <code class="docutils literal notranslate"><span class="pre">last_*</span></code> values equal to the <code class="docutils literal notranslate"><span class="pre">first_*</span></code> values. With A1
notation you can refer to a single cell or a range of cells:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">{</span><span class="o">...</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span>       <span class="p">{</span><span class="o">...</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;C1:E5&#39;</span><span class="p">,</span>    <span class="p">{</span><span class="o">...</span><span class="p">})</span>
</pre></div>
</div>
<p>The options parameter in <code class="docutils literal notranslate"><span class="pre">conditional_format()</span></code> must be a dictionary
containing the parameters that describe the type and style of the conditional
format. The main parameters are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">type</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">format</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">criteria</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">value</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">minimum</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">maximum</span></code></li>
</ul>
<p>Other, less commonly used parameters are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">min_type</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">mid_type</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">max_type</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">min_value</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">mid_value</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">max_value</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">min_color</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">mid_color</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">max_color</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">bar_color</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">bar_only</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">bar_solid</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">bar_negative_color</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">bar_border_color</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">bar_negative_border_color</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">bar_negative_color_same</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">bar_negative_border_color_same</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">bar_no_border</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">bar_direction</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">bar_axis_position</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">bar_axis_color</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">data_bar_2010</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">icon_style</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">icons</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">reverse_icons</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">icons_only</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">stop_if_true</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">multi_range</span></code></li>
</ul>
</div>
<div class="section" id="conditional-format-options">
<h4>Conditional Format Options</h4>
<p>The conditional format options that can be used with <a class="reference internal" href="index.html#conditional_format" title="conditional_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">conditional_format()</span></code></a>
are explained in the following sections.</p>
<div class="section" id="type">
<h5>type</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">type</span></code> option is a required parameter and it has no default value.
Allowable <code class="docutils literal notranslate"><span class="pre">type</span></code> values and their associated parameters are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="31%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Type</th>
<th class="head">Parameters</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>cell</td>
<td>criteria</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>value</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>minimum</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>maximum</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>format</td>
</tr>
<tr class="row-odd"><td>date</td>
<td>criteria</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>value</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>minimum</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>maximum</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>format</td>
</tr>
<tr class="row-even"><td>time_period</td>
<td>criteria</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>format</td>
</tr>
<tr class="row-even"><td>text</td>
<td>criteria</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>value</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>format</td>
</tr>
<tr class="row-odd"><td>average</td>
<td>criteria</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>format</td>
</tr>
<tr class="row-odd"><td>duplicate</td>
<td>format</td>
</tr>
<tr class="row-even"><td>unique</td>
<td>format</td>
</tr>
<tr class="row-odd"><td>top</td>
<td>criteria</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>value</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>format</td>
</tr>
<tr class="row-even"><td>bottom</td>
<td>criteria</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>value</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>format</td>
</tr>
<tr class="row-odd"><td>blanks</td>
<td>format</td>
</tr>
<tr class="row-even"><td>no_blanks</td>
<td>format</td>
</tr>
<tr class="row-odd"><td>errors</td>
<td>format</td>
</tr>
<tr class="row-even"><td>no_errors</td>
<td>format</td>
</tr>
<tr class="row-odd"><td>formula</td>
<td>criteria</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>format</td>
</tr>
<tr class="row-odd"><td>2_color_scale</td>
<td>min_type</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>max_type</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>min_value</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>max_value</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>min_color</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>max_color</td>
</tr>
<tr class="row-odd"><td>3_color_scale</td>
<td>min_type</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>mid_type</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>max_type</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>min_value</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>mid_value</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>max_value</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>min_color</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>mid_color</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>max_color</td>
</tr>
<tr class="row-even"><td>data_bar</td>
<td>min_type</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>max_type</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>min_value</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>max_value</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>bar_only</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>bar_color</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>bar_solid*</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>bar_negative_color*</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>bar_border_color*</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>bar_negative_border_color*</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>bar_negative_color_same*</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>bar_negative_border_color_same*</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>bar_no_border*</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>bar_direction*</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>bar_axis_position*</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>bar_axis_color*</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>data_bar_2010*</td>
</tr>
<tr class="row-odd"><td>icon_set</td>
<td>icon_style</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>reverse_icons</td>
</tr>
<tr class="row-odd"><td>&#160;</td>
<td>icons</td>
</tr>
<tr class="row-even"><td>&#160;</td>
<td>icons_only</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Data bar parameters marked with (*) are only available in Excel 2010 and
later. Files that use these properties can still be opened in Excel 2007
but the data bars will be displayed without them.</p>
</div>
</div>
<div class="section" id="type-cell">
<h5>type: cell</h5>
<p>This is the most common conditional formatting type. It is used when a format
is applied to a cell based on a simple criterion.</p>
<p>For example using a single cell and the <code class="docutils literal notranslate"><span class="pre">greater</span> <span class="pre">than</span></code> criteria:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;greater than&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span>     <span class="mi">5</span><span class="p">,</span>
                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span>    <span class="n">red_format</span><span class="p">})</span>
</pre></div>
</div>
<p>Or, using a range and the <code class="docutils literal notranslate"><span class="pre">between</span></code> criteria:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;C1:C4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;minimum&#39;</span><span class="p">:</span>  <span class="mi">20</span><span class="p">,</span>
                                       <span class="s1">&#39;maximum&#39;</span><span class="p">:</span>  <span class="mi">30</span><span class="p">,</span>
                                       <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">green_format</span><span class="p">})</span>
</pre></div>
</div>
<p>Other types are shown below, after the other main options.</p>
</div>
<div class="section" id="criteria">
<h5>criteria:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">criteria</span></code> parameter is used to set the criteria by which the cell data
will be evaluated. It has no default value. The most common criteria as
applied to <code class="docutils literal notranslate"><span class="pre">{'type':</span> <span class="pre">'cell'}</span></code> are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="79%" />
<col width="21%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">between</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">between</span></code></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">equal</span> <span class="pre">to</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">==</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">equal</span> <span class="pre">to</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">!=</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">greater</span> <span class="pre">than</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">&gt;</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">less</span> <span class="pre">than</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">&lt;</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">greater</span> <span class="pre">than</span> <span class="pre">or</span> <span class="pre">equal</span> <span class="pre">to</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">&gt;=</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">less</span> <span class="pre">than</span> <span class="pre">or</span> <span class="pre">equal</span> <span class="pre">to</span></code></td>
<td><code class="docutils literal notranslate"><span class="pre">&lt;=</span></code></td>
</tr>
</tbody>
</table>
<p>You can either use Excel’s textual description strings, in the first column
above, or the more common symbolic alternatives.</p>
<p>Additional criteria which are specific to other conditional format types are
shown in the relevant sections below.</p>
</div>
<div class="section" id="value">
<h5>value:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">value</span></code> is generally used along with the <code class="docutils literal notranslate"><span class="pre">criteria</span></code> parameter to set
the rule by which the cell data will be evaluated:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;equal to&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mi">5</span><span class="p">,</span>
                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">red_format</span><span class="p">})</span>
</pre></div>
</div>
<p>If the <code class="docutils literal notranslate"><span class="pre">type</span></code> is <code class="docutils literal notranslate"><span class="pre">cell</span></code> and the <code class="docutils literal notranslate"><span class="pre">value</span></code> is a string then it should be
double quoted, as required by Excel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;equal to&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="s1">&#39;&quot;Failed&quot;&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">red_format</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">value</span></code> property can also be an cell reference:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;equal to&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="s1">&#39;$C$1&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">red_format</span><span class="p">})</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In general any <code class="docutils literal notranslate"><span class="pre">value</span></code> property that refers to a cell reference should
use an <a class="reference internal" href="index.html#abs-reference"><span class="std std-ref">absolute reference</span></a>, especially if the
conditional formatting is applied to a range of values. Without an absolute
cell reference the conditional format will not be applied correctly by
Excel from the first cell in the formatted range.</p>
</div>
</div>
<div class="section" id="format">
<h5>format:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">format</span></code> parameter is used to specify the format that will be applied to
the cell when the conditional formatting criterion is met. The format is
created using the <a class="reference internal" href="index.html#add_format" title="add_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_format()</span></code></a> method in the same way as cell formats:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">format1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;italic&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mi">5</span><span class="p">,</span>
                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In Excel, a conditional format is superimposed over the existing cell
format and not all cell format properties can be modified. Properties that
<strong>cannot</strong> be modified in a conditional format are font name, font size,
superscript and subscript, diagonal borders, all alignment properties and
all protection properties.</p>
</div>
<p>Excel specifies some default formats to be used with conditional formatting.
These can be replicated using the following XlsxWriter formats:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Light red fill with dark red text.</span>
<span class="n">format1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bg_color&#39;</span><span class="p">:</span>   <span class="s1">&#39;#FFC7CE&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#9C0006&#39;</span><span class="p">})</span>

<span class="c1"># Light yellow fill with dark yellow text.</span>
<span class="n">format2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bg_color&#39;</span><span class="p">:</span>   <span class="s1">&#39;#FFEB9C&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#9C6500&#39;</span><span class="p">})</span>

<span class="c1"># Green fill with dark green text.</span>
<span class="n">format3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bg_color&#39;</span><span class="p">:</span>   <span class="s1">&#39;#C6EFCE&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#006100&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="index.html#format"><span class="std std-ref">The Format Class</span></a>.</p>
</div>
<div class="section" id="minimum">
<h5>minimum:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">minimum</span></code> parameter is used to set the lower limiting value when the
<code class="docutils literal notranslate"><span class="pre">criteria</span></code> is either <code class="docutils literal notranslate"><span class="pre">'between'</span></code> or <code class="docutils literal notranslate"><span class="pre">'not</span> <span class="pre">between'</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;minimum&#39;</span><span class="p">:</span>  <span class="mi">2</span><span class="p">,</span>
                                    <span class="s1">&#39;maximum&#39;</span><span class="p">:</span>  <span class="mi">6</span><span class="p">,</span>
                                    <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">,</span>
                                    <span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="maximum">
<h5>maximum:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">maximum</span></code> parameter is used to set the upper limiting value when the
<code class="docutils literal notranslate"><span class="pre">criteria</span></code> is either <code class="docutils literal notranslate"><span class="pre">'between'</span></code> or <code class="docutils literal notranslate"><span class="pre">'not</span> <span class="pre">between'</span></code>. See the previous
example.</p>
</div>
<div class="section" id="type-date">
<h5>type: date</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">date</span></code> type is similar the <code class="docutils literal notranslate"><span class="pre">cell</span></code> type and uses the same criteria and
values. However, the <code class="docutils literal notranslate"><span class="pre">value</span></code>, <code class="docutils literal notranslate"><span class="pre">minimum</span></code> and <code class="docutils literal notranslate"><span class="pre">maximum</span></code> properties are
specified as a datetime object as shown in <a class="reference internal" href="index.html#working-with-dates-and-time"><span class="std std-ref">Working with Dates and Time</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;2011-01-01&#39;</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;date&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;greater than&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="n">date</span><span class="p">,</span>
                                       <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="type-time-period">
<h5>type: time_period</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">time_period</span></code> type is used to specify Excel’s “Dates Occurring” style
conditional format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;time_period&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;yesterday&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>The period is set in the <code class="docutils literal notranslate"><span class="pre">criteria</span></code> and can have one of the following values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;yesterday&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;today&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;last 7 days&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;last week&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;this week&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;next week&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;last month&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;this month&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;next month&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="type-text">
<h5>type: text</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">text</span></code> type is used to specify Excel’s “Specific Text” style conditional
format. It is used to do simple string matching using the <code class="docutils literal notranslate"><span class="pre">criteria</span></code> and
<code class="docutils literal notranslate"><span class="pre">value</span></code> parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;text&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;containing&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="s1">&#39;foo&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">criteria</span></code> can have one of the following values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;containing&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;not containing&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;begins with&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;ends with&#39;</span><span class="p">,</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">value</span></code> parameter should be a string or single character.</p>
</div>
<div class="section" id="type-average">
<h5>type: average</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">average</span></code> type is used to specify Excel’s “Average” style conditional
format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;average&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;above&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>The type of average for the conditional format range is specified by the
<code class="docutils literal notranslate"><span class="pre">criteria</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;above&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;below&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;equal or above&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;equal or below&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;1 std dev above&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;1 std dev below&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;2 std dev above&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;2 std dev below&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;3 std dev above&#39;</span><span class="p">,</span>
<span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;3 std dev below&#39;</span><span class="p">,</span>
</pre></div>
</div>
</div>
<div class="section" id="type-duplicate">
<h5>type: duplicate</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">duplicate</span></code> type is used to highlight duplicate cells in a range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>   <span class="s1">&#39;duplicate&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="type-unique">
<h5>type: unique</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">unique</span></code> type is used to highlight unique cells in a range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>   <span class="s1">&#39;unique&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="type-top">
<h5>type: top</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">top</span></code> type is used to specify the top <code class="docutils literal notranslate"><span class="pre">n</span></code> values by number or
percentage in a range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>   <span class="s1">&#39;top&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;value&#39;</span><span class="p">:</span>  <span class="mi">10</span><span class="p">,</span>
                                       <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">criteria</span></code> can be used to indicate that a percentage condition is
required:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;top&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mi">10</span><span class="p">,</span>
                                       <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;%&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="type-bottom">
<h5>type: bottom</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">bottom</span></code> type is used to specify the bottom <code class="docutils literal notranslate"><span class="pre">n</span></code> values by number or
percentage in a range.</p>
<p>It takes the same parameters as <code class="docutils literal notranslate"><span class="pre">top</span></code>, see above.</p>
</div>
<div class="section" id="type-blanks">
<h5>type: blanks</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">blanks</span></code> type is used to highlight blank cells in a range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>   <span class="s1">&#39;blanks&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="type-no-blanks">
<h5>type: no_blanks</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">no_blanks</span></code> type is used to highlight non blank cells in a range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>   <span class="s1">&#39;no_blanks&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="type-errors">
<h5>type: errors</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">errors</span></code> type is used to highlight error cells in a range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>   <span class="s1">&#39;errors&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="type-no-errors">
<h5>type: no_errors</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">no_errors</span></code> type is used to highlight non error cells in a range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>   <span class="s1">&#39;no_errors&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="type-formula">
<h5>type: formula</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">formula</span></code> type is used to specify a conditional format based on a user
defined formula:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;formula&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;=$A$1&gt;5&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>The formula is specified in the <code class="docutils literal notranslate"><span class="pre">criteria</span></code>.</p>
<p>Formulas must be written with the US style separator/range operator which is a
comma (not semi-colon) and should follow the same rules as
<a class="reference internal" href="index.html#write_formula" title="write_formula"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_formula()</span></code></a>. See <a class="reference internal" href="index.html#formula-syntax"><span class="std std-ref">Non US Excel functions and syntax</span></a> for a full explanation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This formula will cause an Excel error on load due to</span>
<span class="c1"># non-English language and use of semi-colons.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A2:C9&#39;</span> <span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;formula&#39;</span><span class="p">,</span>
     <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;=ODER($B2&lt;$C2;UND($B2=&quot;&quot;;$C2&gt;HEUTE()))&#39;</span><span class="p">,</span>
     <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span>
    <span class="p">})</span>

<span class="c1"># This is the correct syntax.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A2:C9&#39;</span> <span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;formula&#39;</span><span class="p">,</span>
     <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;=OR($B2&lt;$C2,AND($B2=&quot;&quot;,$C2&gt;TODAY()))&#39;</span><span class="p">,</span>
     <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span>
    <span class="p">})</span>
</pre></div>
</div>
<p>Also, any cell or range references in the formula should
be <a class="reference internal" href="index.html#abs-reference"><span class="std std-ref">absolute references</span></a> if they are applied to the full
range of the conditional format. See the note in the <code class="docutils literal notranslate"><span class="pre">value</span></code> section above.</p>
</div>
<div class="section" id="type-2-color-scale">
<h5>type: 2_color_scale</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">2_color_scale</span></code> type is used to specify Excel’s “2 Color Scale” style
conditional format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;2_color_scale&#39;</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/conditional_format4.png" src="_images/conditional_format4.png" />
<p>This conditional type can be modified with <code class="docutils literal notranslate"><span class="pre">min_type</span></code>, <code class="docutils literal notranslate"><span class="pre">max_type</span></code>,
<code class="docutils literal notranslate"><span class="pre">min_value</span></code>, <code class="docutils literal notranslate"><span class="pre">max_value</span></code>, <code class="docutils literal notranslate"><span class="pre">min_color</span></code> and <code class="docutils literal notranslate"><span class="pre">max_color</span></code>, see below.</p>
</div>
<div class="section" id="type-3-color-scale">
<h5>type: 3_color_scale</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">3_color_scale</span></code> type is used to specify Excel’s “3 Color Scale” style
conditional format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;3_color_scale&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>This conditional type can be modified with <code class="docutils literal notranslate"><span class="pre">min_type</span></code>, <code class="docutils literal notranslate"><span class="pre">mid_type</span></code>,
<code class="docutils literal notranslate"><span class="pre">max_type</span></code>, <code class="docutils literal notranslate"><span class="pre">min_value</span></code>, <code class="docutils literal notranslate"><span class="pre">mid_value</span></code>, <code class="docutils literal notranslate"><span class="pre">max_value</span></code>, <code class="docutils literal notranslate"><span class="pre">min_color</span></code>,
<code class="docutils literal notranslate"><span class="pre">mid_color</span></code> and <code class="docutils literal notranslate"><span class="pre">max_color</span></code>, see below.</p>
</div>
<div class="section" id="type-data-bar">
<h5>type: data_bar</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">data_bar</span></code> type is used to specify Excel’s “Data Bar” style conditional
format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>This conditional type can be modified with the following parameters, which are
explained in the sections below. These properties were available in the
original xlsx file specification used in Excel 2007:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">min_type</span>
<span class="n">max_type</span>
<span class="n">min_value</span>
<span class="n">max_value</span>
<span class="n">bar_color</span>
<span class="n">bar_only</span>
</pre></div>
</div>
<p>In Excel 2010 additional data bar properties were added such as solid
(non-gradient) bars and control over how negative values are displayed. These
properties can be set using the following parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">bar_solid</span>
<span class="n">bar_negative_color</span>
<span class="n">bar_border_color</span>
<span class="n">bar_negative_border_color</span>
<span class="n">bar_negative_color_same</span>
<span class="n">bar_negative_border_color_same</span>
<span class="n">bar_no_border</span>
<span class="n">bar_direction</span>
<span class="n">bar_axis_position</span>
<span class="n">bar_axis_color</span>
<span class="n">data_bar_2010</span>
</pre></div>
</div>
<img alt="_images/conditional_format6.png" src="_images/conditional_format6.png" />
<p>Files that use these Excel 2010 properties can still be opened in Excel 2007
but the data bars will be displayed without them.</p>
</div>
<div class="section" id="type-icon-set">
<h5>type: icon_set</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">icon_set</span></code> type is used to specify a conditional format with a set of
icons such as traffic lights or arrows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:C1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;icon_set&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;icon_style&#39;</span><span class="p">:</span> <span class="s1">&#39;3_traffic_lights&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The icon set style is specified by the <code class="docutils literal notranslate"><span class="pre">icon_style</span></code> parameter. Valid options are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">3</span><span class="n">_arrows</span>
<span class="mi">3</span><span class="n">_arrows_gray</span>
<span class="mi">3</span><span class="n">_flags</span>
<span class="mi">3</span><span class="n">_signs</span>
<span class="mi">3</span><span class="n">_symbols</span>
<span class="mi">3</span><span class="n">_symbols_circled</span>
<span class="mi">3</span><span class="n">_traffic_lights</span>
<span class="mi">3</span><span class="n">_traffic_lights_rimmed</span>

<span class="mi">4</span><span class="n">_arrows</span>
<span class="mi">4</span><span class="n">_arrows_gray</span>
<span class="mi">4</span><span class="n">_ratings</span>
<span class="mi">4</span><span class="n">_red_to_black</span>
<span class="mi">4</span><span class="n">_traffic_lights</span>

<span class="mi">5</span><span class="n">_arrows</span>
<span class="mi">5</span><span class="n">_arrows_gray</span>
<span class="mi">5</span><span class="n">_quarters</span>
<span class="mi">5</span><span class="n">_ratings</span>
</pre></div>
</div>
<img alt="_images/conditional_format5.png" src="_images/conditional_format5.png" />
<p>The criteria, type and value of each icon can be specified using the <code class="docutils literal notranslate"><span class="pre">icon</span></code>
array of dicts with optional <code class="docutils literal notranslate"><span class="pre">criteria</span></code>, <code class="docutils literal notranslate"><span class="pre">type</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code> parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span>
    <span class="s1">&#39;A1:D1&#39;</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;icon_set&#39;</span><span class="p">,</span>
     <span class="s1">&#39;icon_style&#39;</span><span class="p">:</span> <span class="s1">&#39;4_red_to_black&#39;</span><span class="p">,</span>
     <span class="s1">&#39;icons&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;number&#39;</span><span class="p">,</span>     <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">},</span>
               <span class="p">{</span><span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span>  <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;percentile&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>
               <span class="p">{</span><span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;percent&#39;</span><span class="p">,</span>    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">}]}</span>
<span class="p">)</span>
</pre></div>
</div>
<ul>
<li><p class="first">The icons <code class="docutils literal notranslate"><span class="pre">criteria</span></code> parameter should be either <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code> or <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>. The default
<code class="docutils literal notranslate"><span class="pre">criteria</span></code> is <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>.</p>
</li>
<li><p class="first">The icons <code class="docutils literal notranslate"><span class="pre">type</span></code> parameter should be one of the following values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">number</span>
<span class="n">percentile</span>
<span class="n">percent</span>
<span class="n">formula</span>
</pre></div>
</div>
<p>The default <code class="docutils literal notranslate"><span class="pre">type</span></code> is <code class="docutils literal notranslate"><span class="pre">percent</span></code>.</p>
</li>
<li><p class="first">The icons <code class="docutils literal notranslate"><span class="pre">value</span></code> parameter can be a value or formula:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:D1&#39;</span><span class="p">,</span>
                             <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;icon_set&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;icon_style&#39;</span><span class="p">:</span> <span class="s1">&#39;4_red_to_black&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;icons&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">},</span>
                                        <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">},</span>
                                        <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">}]})</span>
</pre></div>
</div>
</li>
</ul>
<p>Note: The <code class="docutils literal notranslate"><span class="pre">icons</span></code> parameters should start with the highest value and with
each subsequent one being lower.
The default <code class="docutils literal notranslate"><span class="pre">value</span></code> is <code class="docutils literal notranslate"><span class="pre">(n</span> <span class="pre">*</span> <span class="pre">100)</span> <span class="pre">/</span> <span class="pre">number_of_icons</span></code>. The lowest number
icon in an icon set has properties defined by Excel. Therefore in a <code class="docutils literal notranslate"><span class="pre">n</span></code> icon
set, there is no <code class="docutils literal notranslate"><span class="pre">n-1</span></code> hash of parameters.</p>
<p>The order of the icons can be reversed using the <code class="docutils literal notranslate"><span class="pre">reverse_icons</span></code> parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:C1&#39;</span><span class="p">,</span>
                             <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;icon_set&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;icon_style&#39;</span><span class="p">:</span> <span class="s1">&#39;3_arrows&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;reverse_icons&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>The icons can be displayed without the cell value using the <code class="docutils literal notranslate"><span class="pre">icons_only</span></code>
parameter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:C1&#39;</span><span class="p">,</span>
                             <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;icon_set&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;icon_style&#39;</span><span class="p">:</span> <span class="s1">&#39;3_flags&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;icons_only&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="min-type">
<h5>min_type:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">min_type</span></code> and <code class="docutils literal notranslate"><span class="pre">max_type</span></code> properties are available when the conditional
formatting type is <code class="docutils literal notranslate"><span class="pre">2_color_scale</span></code>, <code class="docutils literal notranslate"><span class="pre">3_color_scale</span></code> or <code class="docutils literal notranslate"><span class="pre">data_bar</span></code>. The
<code class="docutils literal notranslate"><span class="pre">mid_type</span></code> is available for <code class="docutils literal notranslate"><span class="pre">3_color_scale</span></code>. The properties are used as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;2_color_scale&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;min_type&#39;</span><span class="p">:</span> <span class="s1">&#39;percent&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;max_type&#39;</span><span class="p">:</span> <span class="s1">&#39;percent&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The available min/mid/max types are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">min</span>        <span class="p">(</span><span class="k">for</span> <span class="n">min_type</span> <span class="n">only</span><span class="p">)</span>
<span class="n">num</span>
<span class="n">percent</span>
<span class="n">percentile</span>
<span class="n">formula</span>
<span class="nb">max</span>        <span class="p">(</span><span class="k">for</span> <span class="n">max_type</span> <span class="n">only</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="mid-type">
<h5>mid_type:</h5>
<p>Used for <code class="docutils literal notranslate"><span class="pre">3_color_scale</span></code>. Same as <code class="docutils literal notranslate"><span class="pre">min_type</span></code>, see above.</p>
</div>
<div class="section" id="max-type">
<h5>max_type:</h5>
<p>Same as <code class="docutils literal notranslate"><span class="pre">min_type</span></code>, see above.</p>
</div>
<div class="section" id="min-value">
<h5>min_value:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">min_value</span></code> and <code class="docutils literal notranslate"><span class="pre">max_value</span></code> properties are available when the
conditional formatting type is <code class="docutils literal notranslate"><span class="pre">2_color_scale</span></code>, <code class="docutils literal notranslate"><span class="pre">3_color_scale</span></code> or
<code class="docutils literal notranslate"><span class="pre">data_bar</span></code>. The <code class="docutils literal notranslate"><span class="pre">mid_value</span></code> is available for <code class="docutils literal notranslate"><span class="pre">3_color_scale</span></code>. The
properties are used as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="s1">&#39;2_color_scale&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;min_value&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                                        <span class="s1">&#39;max_value&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="mid-value">
<h5>mid_value:</h5>
<p>Used for <code class="docutils literal notranslate"><span class="pre">3_color_scale</span></code>. Same as <code class="docutils literal notranslate"><span class="pre">min_value</span></code>, see above.</p>
</div>
<div class="section" id="max-value">
<h5>max_value:</h5>
<p>Same as <code class="docutils literal notranslate"><span class="pre">min_value</span></code>, see above.</p>
</div>
<div class="section" id="min-color">
<h5>min_color:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">min_color</span></code> and <code class="docutils literal notranslate"><span class="pre">max_color</span></code> properties are available when the
conditional formatting type is <code class="docutils literal notranslate"><span class="pre">2_color_scale</span></code>, <code class="docutils literal notranslate"><span class="pre">3_color_scale</span></code> or
<code class="docutils literal notranslate"><span class="pre">data_bar</span></code>. The <code class="docutils literal notranslate"><span class="pre">mid_color</span></code> is available for <code class="docutils literal notranslate"><span class="pre">3_color_scale</span></code>. The
properties are used as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:A12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>      <span class="s1">&#39;2_color_scale&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;min_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#C5D9F1&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;max_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#538ED5&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The color can be a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string or a limited number named
colors, see <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>.</p>
</div>
<div class="section" id="mid-color">
<h5>mid_color:</h5>
<p>Used for <code class="docutils literal notranslate"><span class="pre">3_color_scale</span></code>. Same as <code class="docutils literal notranslate"><span class="pre">min_color</span></code>, see above.</p>
</div>
<div class="section" id="max-color">
<h5>max_color:</h5>
<p>Same as <code class="docutils literal notranslate"><span class="pre">min_color</span></code>, see above.</p>
</div>
<div class="section" id="bar-color">
<h5>bar_color:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">bar_color</span></code> parameter sets the fill color for data bars:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;F3:F14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;bar_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#63C384&#39;</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/conditional_format7.png" src="_images/conditional_format7.png" />
<p>The color can be a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string or a limited number named
colors, see <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>.</p>
</div>
<div class="section" id="bar-only">
<h5>bar_only:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">bar_only</span></code> property displays a bar data but not the data in the cells:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;D3:D14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;bar_only&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>See the image above.</p>
</div>
<div class="section" id="bar-solid">
<h5>bar_solid:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">bar_solid</span></code> property turns on a solid (non-gradient) fill for data
bars:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;H3:H14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;bar_solid&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>See the image above.</p>
<p>Note, this property is only visible in Excel 2010 and later.</p>
</div>
<div class="section" id="bar-negative-color">
<h5>bar_negative_color:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">bar_negative_color</span></code> property sets the color fill for the negative
portion of a data bar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;F3:F14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;bar_negative_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#63C384&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The color can be a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string or a limited number named
colors, see <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>.</p>
<p>Note, this property is only visible in Excel 2010 and later.</p>
</div>
<div class="section" id="bar-border-color">
<h5>bar_border_color:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">bar_border_color</span></code> property sets the color for the border line of a data
bar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;F3:F14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;bar_border_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#63C384&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The color can be a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string or a limited number named
colors, see <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>.</p>
<p>Note, this property is only visible in Excel 2010 and later.</p>
</div>
<div class="section" id="bar-negative-border-color">
<h5>bar_negative_border_color:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">bar_negative_border_color</span></code> property sets the color for the border of
the negative portion of a data bar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;F3:F14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;bar_negative_border_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#63C384&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The color can be a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string or a limited number named
colors, see <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>.</p>
<p>Note, this property is only visible in Excel 2010 and later.</p>
</div>
<div class="section" id="bar-negative-color-same">
<h5>bar_negative_color_same:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">bar_negative_color_same</span></code> property sets the fill color for the negative
portion of a data bar to be the same as the fill color for the positive
portion of the data bar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;F3:F14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;bar_negative_color_same&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/conditional_format6.png" src="_images/conditional_format6.png" />
<p>Note, this property is only visible in Excel 2010 and later.</p>
</div>
<div class="section" id="bar-negative-border-color-same">
<h5>bar_negative_border_color_same:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">bar_negative_border_color_same</span></code> property sets the border color for the
negative portion of a data bar to be the same as the border color for the
positive portion of the data bar:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;F3:F14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;bar_negative_border_color_same&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>See the image above.</p>
<p>Note, this property is only visible in Excel 2010 and later.</p>
</div>
<div class="section" id="bar-no-border">
<h5>bar_no_border:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">bar_no_border</span></code> property turns off the border for data bars:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;F3:F14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;bar_no_border&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>Note, this property is only visible in Excel 2010 and later, however the
default in Excel 2007 is to not have a border.</p>
</div>
<div class="section" id="bar-direction">
<h5>bar_direction:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">bar_direction</span></code> property sets the direction for data bars. This property
can be either <code class="docutils literal notranslate"><span class="pre">left</span></code> for left-to-right or <code class="docutils literal notranslate"><span class="pre">right</span></code> for right-to-left. If
the property isn’t set then Excel will adjust the position automatically based
on the context:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;J3:J14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;bar_direction&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/conditional_format6.png" src="_images/conditional_format6.png" />
<p>Note, this property is only visible in Excel 2010 and later.</p>
</div>
<div class="section" id="bar-axis-position">
<h5>bar_axis_position:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">bar_axis_position</span></code> property sets the position within the cells for the
axis that is shown in data bars when there are negative values to display. The
property can be either <code class="docutils literal notranslate"><span class="pre">middle</span></code> or <code class="docutils literal notranslate"><span class="pre">none</span></code>. If the property isn’t set then
Excel will position the axis based on the range of positive and negative
values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;J3:J14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;bar_axis_position&#39;</span><span class="p">:</span> <span class="s1">&#39;middle&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>Note, this property is only visible in Excel 2010 and later.</p>
</div>
<div class="section" id="bar-axis-color">
<h5>bar_axis_color:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">bar_axis_color</span></code> property sets the color for the axis that is shown in
data bars when there are negative values to display:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;J3:J14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;bar_axis_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#0070C0&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>Note, this property is only visible in Excel 2010 and later.</p>
</div>
<div class="section" id="data-bar-2010">
<h5>data_bar_2010:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">data_bar_2010</span></code> property sets Excel 2010 style data bars even when Excel
2010 specific properties aren’t used. This can be used for consistency across
all the data bar formatting in a worksheet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;L3:L14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;data_bar_2010&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="stop-if-true">
<h5>stop_if_true</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">stop_if_true</span></code> parameter can be used to set the “stop if true” feature
of a conditional formatting rule when more than one rule is applied to a cell
or a range of cells. When this parameter is set then subsequent rules are not
evaluated if the current rule is true:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span>
                             <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">cell_format</span><span class="p">,</span>
                              <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                              <span class="s1">&#39;stop_if_true&#39;</span><span class="p">:</span> <span class="kc">True</span>
                              <span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="multi-range">
<h5>multi_range:</h5>
<p>The <code class="docutils literal notranslate"><span class="pre">multi_range</span></code> option is used to extend a conditional format over
non-contiguous ranges.</p>
<p>It is possible to apply the conditional format to different cell ranges in a
worksheet using multiple calls to <code class="docutils literal notranslate"><span class="pre">conditional_format()</span></code>. However, as a
minor optimization it is also possible in Excel to apply the same conditional
format to different non-contiguous cell ranges.</p>
<p>This is replicated in <code class="docutils literal notranslate"><span class="pre">conditional_format()</span></code> using the <code class="docutils literal notranslate"><span class="pre">multi_range</span></code>
option. The range must contain the primary range for the conditional format
and any others separated by spaces.</p>
<p>For example to apply one conditional format to two ranges, <code class="docutils literal notranslate"><span class="pre">'B3:K6'</span></code> and
<code class="docutils literal notranslate"><span class="pre">'B9:K12'</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K6&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                                       <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">,</span>
                                       <span class="s1">&#39;multi_range&#39;</span><span class="p">:</span> <span class="s1">&#39;B3:K6 B9:K12&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="conditional-formatting-examples">
<h4>Conditional Formatting Examples</h4>
<p>Highlight cells greater than an integer value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:F10&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;greater than&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="mi">5</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>Highlight cells greater than a value in a reference cell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:F10&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;greater than&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="s1">&#39;H1&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>Highlight cells more recent (greater) than a certain date:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;2011-01-01&#39;</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:F10&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;date&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;greater than&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="n">date</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>Highlight cells with a date in the last seven days:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:F10&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;time_period&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;last 7 days&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>Highlight cells with strings starting with the letter <code class="docutils literal notranslate"><span class="pre">b</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:F10&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>     <span class="s1">&#39;text&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;begins with&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span>    <span class="s1">&#39;b&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span>   <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>Highlight cells that are 1 standard deviation above the average for the range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:F10&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>   <span class="s1">&#39;average&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>Highlight duplicate cells in a range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:F10&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>   <span class="s1">&#39;duplicate&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>Highlight unique cells in a range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:F10&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>   <span class="s1">&#39;unique&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>Highlight the top 10 cells:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:F10&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>   <span class="s1">&#39;top&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span>  <span class="mi">10</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>Highlight blank cells:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;A1:F10&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span>   <span class="s1">&#39;blanks&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>
</pre></div>
</div>
<p>Set traffic light icons in 3 cells:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:D3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;icon_set&#39;</span><span class="p">,</span>
                                       <span class="s1">&#39;icon_style&#39;</span><span class="p">:</span> <span class="s1">&#39;3_traffic_lights&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="index.html#ex-cond-format"><span class="std std-ref">Example: Conditional Formatting</span></a>.</p>
</div>
</div>
<span id="document-working_with_tables"></span><div class="section" id="working-with-worksheet-tables">
<span id="tables"></span><h3>Working with Worksheet Tables</h3>
<p>Tables in Excel are a way of grouping a range of cells into a single entity
that has common formatting or that can be referenced from formulas. Tables can
have column headers, autofilters, total rows, column formulas and default
formatting.</p>
<img alt="_images/tables12.png" src="_images/tables12.png" />
<p>For more information see
<a class="reference external" href="http://office.microsoft.com/en-us/excel-help/overview-of-excel-tables-HA010048546.aspx">An Overview of Excel Tables</a>
in the Microsoft Office documentation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Tables aren’t available in XlsxWriter when <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a>
<code class="docutils literal notranslate"><span class="pre">'constant_memory'</span></code> mode is enabled.</p>
</div>
<div class="section" id="add-table">
<h4>add_table()</h4>
<p>Tables are added to a worksheet using the <a class="reference internal" href="index.html#add_table" title="add_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_table()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="n">options</span><span class="p">})</span>
</pre></div>
</div>
<p>The data range can be specified in ‘A1’ or ‘Row/Column’ notation (see
<a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">)</span>
<span class="c1"># Same as:</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/tables1.png" src="_images/tables1.png" />
<p>The options parameter should be a dict containing the parameters that describe
the table options and data. The available options are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>data</td>
</tr>
<tr class="row-even"><td>autofilter</td>
</tr>
<tr class="row-odd"><td>header_row</td>
</tr>
<tr class="row-even"><td>banded_columns</td>
</tr>
<tr class="row-odd"><td>banded_rows</td>
</tr>
<tr class="row-even"><td>first_column</td>
</tr>
<tr class="row-odd"><td>last_column</td>
</tr>
<tr class="row-even"><td>style</td>
</tr>
<tr class="row-odd"><td>total_row</td>
</tr>
<tr class="row-even"><td>columns</td>
</tr>
<tr class="row-odd"><td>name</td>
</tr>
</tbody>
</table>
<p>These options are explained below. There are no required parameters and the
options parameter is itself optional if no options are specified (as shown
above).</p>
</div>
<div class="section" id="data">
<h4>data</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">data</span></code> parameter can be used to specify the data in the cells of the
table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Apples&#39;</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">6000</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Pears&#39;</span><span class="p">,</span>   <span class="mi">2000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Bananas&#39;</span><span class="p">,</span> <span class="mi">6000</span><span class="p">,</span> <span class="mi">6000</span><span class="p">,</span> <span class="mi">6500</span><span class="p">,</span> <span class="mi">6000</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Oranges&#39;</span><span class="p">,</span>  <span class="mi">500</span><span class="p">,</span>  <span class="mi">300</span><span class="p">,</span>  <span class="mi">200</span><span class="p">,</span>  <span class="mi">700</span><span class="p">],</span>

<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/tables2.png" src="_images/tables2.png" />
<p>Table data can also be written separately, as an array or individual cells:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># These statements are the same as the single statement above.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B7&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
</pre></div>
</div>
<p>Writing the cell data separately is occasionally required when you need to
control the <code class="docutils literal notranslate"><span class="pre">write_()</span></code> methods used to populate the cells or if you wish to
modify individual cell formatting.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">data</span></code> structure should be an list of lists holding row data as shown
above.</p>
</div>
<div class="section" id="header-row">
<h4>header_row</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">header_row</span></code> parameter can be used to turn on or off the header row in
the table. It is on by default:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Turn off the header row.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B4:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;header_row&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/tables4.png" src="_images/tables4.png" />
<p>The header row will contain default captions such as <code class="docutils literal notranslate"><span class="pre">Column</span> <span class="pre">1</span></code>,
<code class="docutils literal notranslate"><span class="pre">Column</span> <span class="pre">2</span></code>, etc. These captions can be overridden using the <code class="docutils literal notranslate"><span class="pre">columns</span></code>
parameter below.</p>
</div>
<div class="section" id="autofilter">
<h4>autofilter</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">autofilter</span></code> parameter can be used to turn on or off the autofilter in
the header row. It is on by default:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Turn off the default autofilter.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;autofilter&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/tables3.png" src="_images/tables3.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">autofilter</span></code> is only shown if the <code class="docutils literal notranslate"><span class="pre">header_row</span></code> is on. Filter conditions
within the table are not supported.</p>
</div>
<div class="section" id="banded-rows">
<h4>banded_rows</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">banded_rows</span></code> parameter can be used to create rows of alternating color
in the table. It is on by default:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Turn off banded rows.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;banded_rows&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/tables6.png" src="_images/tables6.png" />
</div>
<div class="section" id="banded-columns">
<h4>banded_columns</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">banded_columns</span></code> parameter can be used to used to create columns of
alternating color in the table. It is off by default:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Turn on banded columns.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;banded_columns&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>See the above image.</p>
</div>
<div class="section" id="first-column">
<h4>first_column</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">first_column</span></code> parameter can be used to highlight the first column of the
table. The type of highlighting will depend on the <code class="docutils literal notranslate"><span class="pre">style</span></code> of the table. It
may be bold text or a different color. It is off by default:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Turn on highlighting for the first column in the table.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;first_column&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/tables5.png" src="_images/tables5.png" />
</div>
<div class="section" id="last-column">
<h4>last_column</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">last_column</span></code> parameter can be used to highlight the last column of the
table. The type of highlighting will depend on the <code class="docutils literal notranslate"><span class="pre">style</span></code> of the table. It
may be bold text or a different color. It is off by default:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Turn on highlighting for the last column in the table.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;last_column&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>See the above image.</p>
</div>
<div class="section" id="style">
<h4>style</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">style</span></code> parameter can be used to set the style of the table. Standard
Excel table format names should be used (with matching capitalization):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
                              <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;Table Style Light 11&#39;</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/tables11.png" src="_images/tables11.png" />
<p>The default table style is ‘Table Style Medium 9’.</p>
<p>You can also turn the table style off by setting it to None:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span> <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/tables13.png" src="_images/tables13.png" />
</div>
<div class="section" id="name">
<h4>name</h4>
<p>By default tables are named <code class="docutils literal notranslate"><span class="pre">Table1</span></code>, <code class="docutils literal notranslate"><span class="pre">Table2</span></code>, etc. The <code class="docutils literal notranslate"><span class="pre">name</span></code>
parameter can be used to set the name of the table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;SalesData&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>If you override the table name you must ensure that it doesn’t clash with an
existing table name and that it follows Excel’s requirements for table names,
see the <a class="reference external" href="http://office.microsoft.com/en-001/excel-help/define-and-use-names-in-formulas-HA010147120.aspx">Microsoft Office documentation</a>.</p>
<p>If you need to know the name of the table, for example to use it in a formula,
you can get it as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">)</span>
<span class="n">table_name</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">name</span>
</pre></div>
</div>
</div>
<div class="section" id="total-row">
<h4>total_row</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">total_row</span></code> parameter can be used to turn on the total row in the last
row of a table. It is distinguished from the other rows by a different
formatting and also with dropdown <code class="docutils literal notranslate"><span class="pre">SUBTOTAL</span></code> functions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;total_row&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/tables9.png" src="_images/tables9.png" />
<p>The default total row doesn’t have any captions or functions. These must by
specified via the <code class="docutils literal notranslate"><span class="pre">columns</span></code> parameter below.</p>
</div>
<div class="section" id="columns">
<h4>columns</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">columns</span></code> parameter can be used to set properties for columns within the
table.</p>
<img alt="_images/tables7.png" src="_images/tables7.png" />
<p>The sub-properties that can be set are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>header</td>
</tr>
<tr class="row-even"><td>header_format</td>
</tr>
<tr class="row-odd"><td>formula</td>
</tr>
<tr class="row-even"><td>total_string</td>
</tr>
<tr class="row-odd"><td>total_function</td>
</tr>
<tr class="row-even"><td>total_value</td>
</tr>
<tr class="row-odd"><td>format</td>
</tr>
</tbody>
</table>
<p>The column data must be specified as a list of dicts. For example to override
the default ‘Column n’ style table headers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
                              <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Product&#39;</span><span class="p">},</span>
                                          <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 1&#39;</span><span class="p">},</span>
                                          <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 2&#39;</span><span class="p">},</span>
                                          <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 3&#39;</span><span class="p">},</span>
                                          <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 4&#39;</span><span class="p">},</span>
                                          <span class="p">]})</span>
</pre></div>
</div>
<p>See the resulting image above.</p>
<p>If you don’t wish to specify properties for a specific column you pass an empty
hash ref and the defaults will be applied:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">columns</span><span class="p">,</span> <span class="p">[</span>
    <span class="p">{</span><span class="n">header</span><span class="p">,</span> <span class="s1">&#39;Product&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="n">header</span><span class="p">,</span> <span class="s1">&#39;Quarter 1&#39;</span><span class="p">},</span>
    <span class="p">{},</span>                     <span class="c1"># Defaults to &#39;Column 3&#39;.</span>
    <span class="p">{</span><span class="n">header</span><span class="p">,</span> <span class="s1">&#39;Quarter 3&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="n">header</span><span class="p">,</span> <span class="s1">&#39;Quarter 4&#39;</span><span class="p">},</span>
<span class="p">]</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Column formulas can by applied using the column <code class="docutils literal notranslate"><span class="pre">formula</span></code> property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;=SUM(Table8[@[Quarter 1]:[Quarter 4]])&#39;</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:G7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
                              <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Product&#39;</span><span class="p">},</span>
                                          <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 1&#39;</span><span class="p">},</span>
                                          <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 2&#39;</span><span class="p">},</span>
                                          <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 3&#39;</span><span class="p">},</span>
                                          <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 4&#39;</span><span class="p">},</span>
                                          <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;formula&#39;</span><span class="p">:</span> <span class="n">formula</span><span class="p">},</span>
                                          <span class="p">]})</span>
</pre></div>
</div>
<img alt="_images/tables8.png" src="_images/tables8.png" />
<p>The Excel 2007 style <code class="docutils literal notranslate"><span class="pre">[#This</span> <span class="pre">Row]</span></code> and Excel 2010 style <code class="docutils literal notranslate"><span class="pre">&#64;</span></code> structural
references are supported within the formula. However, other Excel 2010
additions to structural references aren’t supported and formulas should
conform to Excel 2007 style formulas. See the Microsoft documentation on
<a class="reference external" href="http://office.microsoft.com/en-us/excel-help/using-structured-references-with-excel-tables-HA010155686.aspx">Using structured references with Excel tables</a>
for details.</p>
<p>As stated above the <code class="docutils literal notranslate"><span class="pre">total_row</span></code> table parameter turns on the “Total” row in
the table but it doesn’t populate it with any defaults. Total captions and
functions must be specified via the <code class="docutils literal notranslate"><span class="pre">columns</span></code> property and the
<code class="docutils literal notranslate"><span class="pre">total_string</span></code> and <code class="docutils literal notranslate"><span class="pre">total_function</span></code> sub properties:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
           <span class="s1">&#39;total_row&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
           <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Product&#39;</span><span class="p">,</span> <span class="s1">&#39;total_string&#39;</span><span class="p">:</span> <span class="s1">&#39;Totals&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 1&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 2&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 3&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 4&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;formula&#39;</span><span class="p">:</span> <span class="s1">&#39;=SUM(Table10[@[Quarter 1]:[Quarter 4]])&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span>
                        <span class="p">},</span>
                       <span class="p">]}</span>

<span class="c1"># Add a table to the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:G8&#39;</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
<p>The supported totals row <code class="docutils literal notranslate"><span class="pre">SUBTOTAL</span></code> functions are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>average</td>
</tr>
<tr class="row-even"><td>count_nums</td>
</tr>
<tr class="row-odd"><td>count</td>
</tr>
<tr class="row-even"><td>max</td>
</tr>
<tr class="row-odd"><td>min</td>
</tr>
<tr class="row-even"><td>std_dev</td>
</tr>
<tr class="row-odd"><td>sum</td>
</tr>
<tr class="row-even"><td>var</td>
</tr>
</tbody>
</table>
<p>User defined functions or formulas aren’t supported.</p>
<p>It is also possible to set a calculated value for the <code class="docutils literal notranslate"><span class="pre">total_function</span></code> using
the <code class="docutils literal notranslate"><span class="pre">total_value</span></code> sub property. This is only necessary when creating
workbooks for applications that cannot calculate the value of formulas
automatically. This is similar to setting the <code class="docutils literal notranslate"><span class="pre">value</span></code> optional property in
<a class="reference internal" href="index.html#write_formula" title="write_formula"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_formula()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
           <span class="s1">&#39;total_row&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
           <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;total_string&#39;</span><span class="p">:</span> <span class="s1">&#39;Totals&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;total_value&#39;</span><span class="p">:</span> <span class="mi">150</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;total_value&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;total_value&#39;</span><span class="p">:</span> <span class="mi">333</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="s1">&#39;total_value&#39;</span><span class="p">:</span> <span class="mi">124</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;formula&#39;</span><span class="p">:</span> <span class="s1">&#39;=SUM(Table10[@[Quarter 1]:[Quarter 4]])&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;total_value&#39;</span><span class="p">:</span> <span class="mi">807</span><span class="p">}]}</span>
</pre></div>
</div>
<p>Formatting can also be applied to columns, to the column data using <code class="docutils literal notranslate"><span class="pre">format</span></code> and to the header using <code class="docutils literal notranslate"><span class="pre">header_format</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">currency_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;$#,##0&#39;</span><span class="p">})</span>
<span class="n">wrap_format</span>     <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:D8&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
                              <span class="s1">&#39;total_row&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                              <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Product&#39;</span><span class="p">},</span>
                                          <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 1&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">currency_format</span><span class="p">},</span>
                                          <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 2&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;header_format&#39;</span><span class="p">:</span> <span class="n">wrap_format</span><span class="p">,</span>
                                           <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">currency_format</span><span class="p">}]})</span>
</pre></div>
</div>
<img alt="_images/tables12.png" src="_images/tables12.png" />
<p>Standard XlsxWriter <a class="reference internal" href="index.html#format"><span class="std std-ref">Format object</span></a> objects are used for this
formatting. However, they should be limited to numerical formats for the
columns and simple formatting like text wrap for the headers. Overriding other
table formatting may produce inconsistent results.</p>
</div>
<div class="section" id="example">
<h4>Example</h4>
<p>All of the images shown above are taken from <a class="reference internal" href="index.html#ex-tables"><span class="std std-ref">Example: Worksheet Tables</span></a>.</p>
</div>
</div>
<span id="document-working_with_textboxes"></span><div class="section" id="working-with-textboxes">
<span id="id1"></span><h3>Working with Textboxes</h3>
<p>This section explains how to work with some of the options and features of
textboxes in XlsxWriter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;textbox.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Formatted textbox&#39;</span>

<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
    <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>

    <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
             <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">},</span>
    <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;vertical&#39;</span><span class="p">:</span> <span class="s1">&#39;middle&#39;</span><span class="p">,</span>
              <span class="s1">&#39;horizontal&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span>
              <span class="p">},</span>
    <span class="s1">&#39;gradient&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;#DDEBCF&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;#9CB86E&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;#156B13&#39;</span><span class="p">]},</span>
<span class="p">}</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<img alt="_images/textbox02.png" src="_images/textbox02.png" />
<p>See also <a class="reference internal" href="index.html#ex-textbox"><span class="std std-ref">Example: Insert Textboxes into a Worksheet</span></a>.</p>
<div class="section" id="textbox-options">
<h4>Textbox options</h4>
<p>This Worksheet <a class="reference internal" href="index.html#insert_textbox" title="insert_textbox"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_textbox()</span></code></a> method is used to insert a textbox
into a worksheet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A simple textbox with some text&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/textbox31.png" src="_images/textbox31.png" />
<p>The text can contain newlines to wrap the text:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;Line 1</span><span class="se">\n</span><span class="s1">Line 2</span><span class="se">\n\n</span><span class="s1">More text&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/textbox32.png" src="_images/textbox32.png" />
<p>This <a class="reference internal" href="index.html#insert_textbox" title="insert_textbox"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_textbox()</span></code></a> takes an optional <code class="docutils literal notranslate"><span class="pre">dict</span></code> parameter that can be
used to control the size, positioning and format of the textbox:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;Some text&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">})</span>
</pre></div>
</div>
<p>The available options are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Size and position</span>
<span class="n">width</span>
<span class="n">height</span>
<span class="n">x_scale</span>
<span class="n">y_scale</span>
<span class="n">x_offset</span>
<span class="n">y_offset</span>
<span class="n">object_position</span>

<span class="c1"># Formatting</span>
<span class="n">line</span>
<span class="n">border</span>
<span class="n">fill</span>
<span class="n">gradient</span>
<span class="n">font</span>
<span class="n">align</span>
<span class="n">text_rotation</span>

<span class="c1"># Links</span>
<span class="n">textlink</span>
<span class="n">url</span>
<span class="n">tip</span>
</pre></div>
</div>
<p>These options are explained in the sections below. They are similar or
identical to position and formatting parameters used in charts.</p>
</div>
<div class="section" id="textbox-size-and-positioning">
<h4>Textbox size and positioning</h4>
<p>The <a class="reference internal" href="index.html#insert_textbox" title="insert_textbox"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_textbox()</span></code></a> options to control the size and positioning of a
textbox are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">width</span>
<span class="n">height</span>
<span class="n">x_scale</span>
<span class="n">y_scale</span>
<span class="n">x_offset</span>
<span class="n">y_offset</span>
<span class="n">object_position</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">width</span></code> and <code class="docutils literal notranslate"><span class="pre">height</span></code> are in pixels. The default textbox size is 192 x
120 pixels (or equivalent to 3 default columns x 6 default rows).</p>
<img alt="_images/textbox35.png" src="_images/textbox35.png" />
<p>The size of the textbox can be modified by setting the <code class="docutils literal notranslate"><span class="pre">width</span></code> and
<code class="docutils literal notranslate"><span class="pre">height</span></code> or by setting the <code class="docutils literal notranslate"><span class="pre">x_scale</span></code> and <code class="docutils literal notranslate"><span class="pre">y_scale</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;Size adjusted textbox&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">288</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">})</span>

<span class="c1"># or ...</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;Size adjusted textbox&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;x_scale&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span> <span class="s1">&#39;y_scale&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/textbox33.png" src="_images/textbox33.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">x_offset</span></code> and <code class="docutils literal notranslate"><span class="pre">y_offset</span></code> position the top left corner of the textbox in
the cell that it is inserted into.</p>
<img alt="_images/textbox34.png" src="_images/textbox34.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">object_position</span></code> parameter can be used to control the object
positioning of the image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s2">&quot;Don&#39;t move or size with cells&quot;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;object_position&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">object_position</span></code> has the following allowable values:</p>
<ol class="arabic simple">
<li>Move and size with cells (the default).</li>
<li>Move but don’t size with cells.</li>
<li>Don’t move or size with cells.</li>
</ol>
<p>See <a class="reference internal" href="index.html#object-position"><span class="std std-ref">Working with Object Positioning</span></a> for more detailed information about the positioning
and scaling of images within a worksheet.</p>
</div>
<div class="section" id="textbox-formatting">
<h4>Textbox Formatting</h4>
<p>The following formatting properties can be set for textbox objects:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">line</span>
<span class="n">border</span>
<span class="n">fill</span>
<span class="n">gradient</span>
<span class="n">font</span>
<span class="n">align</span>
<span class="n">text_rotation</span>
</pre></div>
</div>
<p>Textbox formatting properties are set using the options dict:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A textbox with a color text&#39;</span><span class="p">,</span>
                                <span class="p">{</span><span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">}})</span>
</pre></div>
</div>
<img alt="_images/textbox11.png" src="_images/textbox11.png" />
<p>In some cases the format properties can be nested:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;Some text in a textbox with formatting&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">},</span>
                          <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;vertical&#39;</span><span class="p">:</span> <span class="s1">&#39;middle&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;horizontal&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span>
                                    <span class="p">},</span>
                          <span class="s1">&#39;gradient&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">]}})</span>
</pre></div>
</div>
<img alt="_images/textbox12.png" src="_images/textbox12.png" />
</div>
<div class="section" id="textbox-formatting-line">
<span id="id2"></span><h4>Textbox formatting: Line</h4>
<p>The line format is used to specify properties of the border in a textbox. The
following properties can be set for <code class="docutils literal notranslate"><span class="pre">line</span></code> formats in a textbox:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">none</span>
<span class="n">color</span>
<span class="n">width</span>
<span class="n">dash_type</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">none</span></code> property is uses to turn the <code class="docutils literal notranslate"><span class="pre">line</span></code> off (it is always on by
default):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A textbox with no border line&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">color</span></code> property sets the color of the <code class="docutils literal notranslate"><span class="pre">line</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A textbox with a color border&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}})</span>
</pre></div>
</div>
<img alt="_images/textbox13.png" src="_images/textbox13.png" />
<p>The available colors are shown in the main XlsxWriter documentation. It is
also possible to set the color of a line with a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string
or a limited number of named colors, see <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A textbox with a color border&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#FF9900&#39;</span><span class="p">}})</span>
</pre></div>
</div>
<img alt="_images/textbox14.png" src="_images/textbox14.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">width</span></code> property sets the width of the <code class="docutils literal notranslate"><span class="pre">line</span></code>. It should be specified
in increments of 0.25 of a point as in Excel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A textbox with larger border&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">3.25</span><span class="p">}})</span>
</pre></div>
</div>
<img alt="_images/textbox15.png" src="_images/textbox15.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">dash_type</span></code> property sets the dash style of the line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A textbox a dash border&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;dash_type&#39;</span><span class="p">:</span> <span class="s1">&#39;dash_dot&#39;</span><span class="p">}})</span>
</pre></div>
</div>
<img alt="_images/textbox16.png" src="_images/textbox16.png" />
<p>The following <code class="docutils literal notranslate"><span class="pre">dash_type</span></code> values are available. They are shown in the order
that they appear in the Excel dialog:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">solid</span>
<span class="n">round_dot</span>
<span class="n">square_dot</span>
<span class="n">dash</span>
<span class="n">dash_dot</span>
<span class="n">long_dash</span>
<span class="n">long_dash_dot</span>
<span class="n">long_dash_dot_dot</span>
</pre></div>
</div>
<p>The default line style is <code class="docutils literal notranslate"><span class="pre">solid</span></code>.</p>
<p>More than one <code class="docutils literal notranslate"><span class="pre">line</span></code> property can be specified at a time:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A textbox with border formatting&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;line&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mf">1.25</span><span class="p">,</span>
                                   <span class="s1">&#39;dash_type&#39;</span><span class="p">:</span> <span class="s1">&#39;square_dot&#39;</span><span class="p">}})</span>
</pre></div>
</div>
<img alt="_images/textbox17.png" src="_images/textbox17.png" />
</div>
<div class="section" id="textbox-formatting-border">
<span id="id3"></span><h4>Textbox formatting: Border</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">border</span></code> property is a synonym for <code class="docutils literal notranslate"><span class="pre">line</span></code>.</p>
<p>Excel uses a common dialog for setting object formatting but depending on
context it may refer to a <em>line</em> or a <em>border</em>. For formatting these can be
used interchangeably.</p>
</div>
<div class="section" id="textbox-formatting-solid-fill">
<span id="textbox-formatting-fill"></span><h4>Textbox formatting: Solid Fill</h4>
<p>The solid fill format is used to specify a fill for a textbox object.</p>
<p>The following properties can be set for <code class="docutils literal notranslate"><span class="pre">fill</span></code> formats in a textbox:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">none</span>
<span class="n">color</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">none</span></code> property is used to turn the <code class="docutils literal notranslate"><span class="pre">fill</span></code> property off (to make the
textbox transparent):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A textbox with no fill&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}})</span>
</pre></div>
</div>
<img alt="_images/textbox21.png" src="_images/textbox21.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">color</span></code> property sets the color of the <code class="docutils literal notranslate"><span class="pre">fill</span></code> area:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A textbox with color fill&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#FF9900&#39;</span><span class="p">}})</span>
</pre></div>
</div>
<img alt="_images/textbox22.png" src="_images/textbox22.png" />
<p>The available colors are shown in the main XlsxWriter documentation. It is
also possible to set the color of a fill with a Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string
or a limited number of named colors, see <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A textbox with color fill&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}})</span>
</pre></div>
</div>
</div>
<div class="section" id="textbox-formatting-gradient-fill">
<span id="textbox-formatting-gradient"></span><h4>Textbox formatting: Gradient Fill</h4>
<p>The gradient fill format is used to specify a gradient fill for a textbox. The
following properties can be set for <code class="docutils literal notranslate"><span class="pre">gradient</span></code> fill formats in a textbox:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">colors</span><span class="p">:</span>    <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">colors</span>
<span class="n">positions</span><span class="p">:</span> <span class="n">an</span> <span class="n">optional</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">positions</span> <span class="k">for</span> <span class="n">the</span> <span class="n">colors</span>
<span class="nb">type</span><span class="p">:</span>      <span class="n">the</span> <span class="n">optional</span> <span class="nb">type</span> <span class="n">of</span> <span class="n">gradient</span> <span class="n">fill</span>
<span class="n">angle</span><span class="p">:</span>     <span class="n">the</span> <span class="n">optional</span> <span class="n">angle</span> <span class="n">of</span> <span class="n">the</span> <span class="n">linear</span> <span class="n">fill</span>
</pre></div>
</div>
<p>If gradient fill is used on a textbox object it overrides the solid fill
properties of the object.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">colors</span></code> property sets a list of colors that define the <code class="docutils literal notranslate"><span class="pre">gradient</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A textbox with gradient fill&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;gradient&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">]}})</span>
</pre></div>
</div>
<img alt="_images/textbox23.png" src="_images/textbox23.png" />
<p>Excel allows between 2 and 10 colors in a gradient but it is unlikely that
you will require more than 2 or 3.</p>
<p>As with solid fill it is also possible to set the colors of a gradient with a
Html style <code class="docutils literal notranslate"><span class="pre">#RRGGBB</span></code> string or a limited number of named colors, see
<a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A textbox with gradient fill&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;gradient&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;#DDEBCF&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;#9CB86E&#39;</span><span class="p">,</span>
                                                  <span class="s1">&#39;#156B13&#39;</span><span class="p">]}})</span>
</pre></div>
</div>
<img alt="_images/textbox24.png" src="_images/textbox24.png" />
<p>The <code class="docutils literal notranslate"><span class="pre">positions</span></code> defines an optional list of positions, between 0 and 100, of
where the colors in the gradient are located. Default values are provided for
<code class="docutils literal notranslate"><span class="pre">colors</span></code> lists of between 2 and 4 but they can be specified if required:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A textbox with gradient fill&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;gradient&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span>    <span class="p">[</span><span class="s1">&#39;#DDEBCF&#39;</span><span class="p">,</span> <span class="s1">&#39;#156B13&#39;</span><span class="p">],</span>
                                       <span class="s1">&#39;positions&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span>        <span class="mi">90</span><span class="p">]}})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">type</span></code> property can have one of the following values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">linear</span>        <span class="p">(</span><span class="n">the</span> <span class="n">default</span><span class="p">)</span>
<span class="n">radial</span>
<span class="n">rectangular</span>
<span class="n">path</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A textbox with gradient fill&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;gradient&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;#DDEBCF&#39;</span><span class="p">,</span> <span class="s1">&#39;#9CB86E&#39;</span><span class="p">,</span> <span class="s1">&#39;#156B13&#39;</span><span class="p">],</span>
                                       <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;radial&#39;</span><span class="p">}})</span>
</pre></div>
</div>
<img alt="_images/textbox25.png" src="_images/textbox25.png" />
<p>If <code class="docutils literal notranslate"><span class="pre">type</span></code> isn’t specified it defaults to <code class="docutils literal notranslate"><span class="pre">linear</span></code>.</p>
<p>For a <code class="docutils literal notranslate"><span class="pre">linear</span></code> fill the angle of the gradient can also be specified (the
default angle is 90 degrees):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;A textbox with angle gradient&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;gradient&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;#DDEBCF&#39;</span><span class="p">,</span> <span class="s1">&#39;#9CB86E&#39;</span><span class="p">,</span> <span class="s1">&#39;#156B13&#39;</span><span class="p">],</span>
                                       <span class="s1">&#39;angle&#39;</span><span class="p">:</span> <span class="mi">45</span><span class="p">}})</span>
</pre></div>
</div>
</div>
<div class="section" id="textbox-formatting-fonts">
<span id="textbox-fonts"></span><h4>Textbox formatting: Fonts</h4>
<p>The following font properties can be set for the entire textbox:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">name</span>
<span class="n">size</span>
<span class="n">bold</span>
<span class="n">italic</span>
<span class="n">underline</span>
<span class="n">color</span>
</pre></div>
</div>
<p>These properties correspond to the equivalent Worksheet cell Format object
properties. See the <a class="reference internal" href="index.html#format"><span class="std std-ref">The Format Class</span></a> section for more details about Format
properties and how to set them.</p>
<p>The font properties are:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">name</span></code>: Set the font name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;font&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Arial&#39;</span><span class="p">}}</span>
</pre></div>
</div>
<img alt="_images/textbox46.png" src="_images/textbox46.png" />
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">size</span></code>: Set the font size:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;font&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">}}</span>
</pre></div>
</div>
<img alt="_images/textbox47.png" src="_images/textbox47.png" />
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">bold</span></code>: Set the font bold property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;font&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}</span>
</pre></div>
</div>
<img alt="_images/textbox45.png" src="_images/textbox45.png" />
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">italic</span></code>: Set the font italic property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;font&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;italic&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}</span>
</pre></div>
</div>
<img alt="_images/textbox48.png" src="_images/textbox48.png" />
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">underline</span></code>: Set the font underline property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;font&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;underline&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}</span>
</pre></div>
</div>
<img alt="_images/textbox49.png" src="_images/textbox49.png" />
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">color</span></code>: Set the font color property. Can be a color index, a color name
or HTML style RGB color:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span> <span class="p">}}</span>
<span class="p">{</span><span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#92D050&#39;</span><span class="p">}}</span>
</pre></div>
</div>
</li>
</ul>
<p>Here is an example of Font formatting in a textbox:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;Some font formatting&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                   <span class="s1">&#39;italic&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                   <span class="s1">&#39;underline&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                   <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Arial&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">}})</span>
</pre></div>
</div>
<img alt="_images/textbox26.png" src="_images/textbox26.png" />
</div>
<div class="section" id="textbox-formatting-align">
<span id="textbox-align"></span><h4>Textbox formatting: Align</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">align</span></code> property is used to set the text alignment for the entire textbox:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;Alignment: middle - center&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;vertical&#39;</span><span class="p">:</span> <span class="s1">&#39;middle&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;horizontal&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">}})</span>
</pre></div>
</div>
<img alt="_images/textbox41.png" src="_images/textbox41.png" />
<p>The alignment properties that can be set in Excel for a textbox are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;vertical&#39;</span><span class="p">:</span> <span class="s1">&#39;top&#39;</span><span class="p">}}</span>      <span class="c1"># Default</span>
<span class="p">{</span><span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;vertical&#39;</span><span class="p">:</span> <span class="s1">&#39;middle&#39;</span><span class="p">}}</span>
<span class="p">{</span><span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;vertical&#39;</span><span class="p">:</span> <span class="s1">&#39;bottom&#39;</span><span class="p">}}</span>

<span class="p">{</span><span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;horizontal&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">}}</span>   <span class="c1"># Default</span>
<span class="p">{</span><span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;horizontal&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">}}</span>
</pre></div>
</div>
<p>Note, Excel doesn’t support right text alignment for the entire textbox. It
does support it for text within the textbox but that currently isn’t supported
by XlsxWriter, see the next section.</p>
<p>The default textbox alignment is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;Default alignment&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;vertical&#39;</span><span class="p">:</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;horizontal&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">}})</span>

<span class="c1"># Same as this:</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;Default alignment&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/textbox42.png" src="_images/textbox42.png" />
</div>
<div class="section" id="textbox-formatting-text-rotation">
<span id="textbox-formatting-rotation"></span><h4>Textbox formatting: Text Rotation</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">text_rotation</span></code> option can be used to set the text rotation for the
entire textbox:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;Text rotated up&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;text_rotation&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/textbox44.png" src="_images/textbox44.png" />
<p>Textboxes in Excel only support a limited number of rotation options. These
are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="mi">90</span><span class="p">:</span>     <span class="n">Rotate</span> <span class="n">text</span> <span class="n">up</span>
<span class="o">-</span><span class="mi">90</span><span class="p">:</span>     <span class="n">Rotate</span> <span class="n">text</span> <span class="n">down</span>
<span class="mi">270</span><span class="p">:</span>     <span class="n">Vertical</span> <span class="n">text</span> <span class="p">(</span><span class="n">stacked</span><span class="p">)</span>
<span class="mi">271</span><span class="p">:</span>     <span class="n">Vertical</span> <span class="n">text</span> <span class="p">(</span><span class="n">stacked</span><span class="p">)</span> <span class="o">-</span> <span class="k">for</span> <span class="n">East</span> <span class="n">Asian</span> <span class="n">fonts</span>
</pre></div>
</div>
</div>
<div class="section" id="textbox-textlink">
<span id="id4"></span><h4>Textbox Textlink</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">textlink</span></code> property is used to link/get the text for a textbox from a
cell in the worksheet. When you use this option the actual text in the textbox
can be left blank or set to <code class="docutils literal notranslate"><span class="pre">None</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;textlink&#39;</span><span class="p">:</span> <span class="s1">&#39;=$A$1&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The reference can also be to a cell in another worksheet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;textlink&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet2!A1&#39;</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/textbox43.png" src="_images/textbox43.png" />
</div>
<div class="section" id="textbox-hyperlink">
<span id="id5"></span><h4>Textbox Hyperlink</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">url</span></code> parameter can used to add a hyperlink/url to a textbox:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;This is some text&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/jmcnamara&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">tip</span></code> parameter adds an optional mouseover tooltip:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;This is some text&#39;</span><span class="p">,</span>
                         <span class="p">{</span><span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/jmcnamara&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;tip&#39;</span><span class="p">:</span> <span class="s1">&#39;GitHub&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="index.html#write_url" title="write_url"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_url()</span></code></a> for details on supported URIs.</p>
</div>
</div>
<span id="document-working_with_sparklines"></span><div class="section" id="working-with-sparklines">
<span id="sparklines"></span><h3>Working with Sparklines</h3>
<p>Sparklines are a feature of Excel 2010+ which allows you to add small charts to
worksheet cells. These are useful for showing visual trends in data in a
compact format.</p>
<img alt="_images/sparklines1.png" src="_images/sparklines1.png" />
<p>Sparklines were invented by Edward Tufte:
<a class="reference external" href="https://en.wikipedia.org/wiki/Sparklines">https://en.wikipedia.org/wiki/Sparklines</a></p>
<div class="section" id="the-add-sparkline-method">
<h4>The add_sparkline() method</h4>
<p>The <a class="reference internal" href="index.html#add_sparkline" title="add_sparkline"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_sparkline()</span></code></a> worksheet method is used to add sparklines to a cell
or a range of cells:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet1!A1:E1&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>Both row-column and A1 style notation are supported. See <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a>
for more details.</p>
<p>The parameters to <code class="docutils literal notranslate"><span class="pre">add_sparkline()</span></code> must be passed in a dictionary. The main
sparkline parameters are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>range (required)</td>
</tr>
<tr class="row-even"><td>type</td>
</tr>
<tr class="row-odd"><td>style</td>
</tr>
<tr class="row-even"><td>markers</td>
</tr>
<tr class="row-odd"><td>negative_points</td>
</tr>
<tr class="row-even"><td>axis</td>
</tr>
<tr class="row-odd"><td>reverse</td>
</tr>
</tbody>
</table>
<p>Other, less commonly used parameters are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>location</td>
</tr>
<tr class="row-even"><td>high_point</td>
</tr>
<tr class="row-odd"><td>low_point</td>
</tr>
<tr class="row-even"><td>first_point</td>
</tr>
<tr class="row-odd"><td>last_point</td>
</tr>
<tr class="row-even"><td>max</td>
</tr>
<tr class="row-odd"><td>min</td>
</tr>
<tr class="row-even"><td>empty_cells</td>
</tr>
<tr class="row-odd"><td>show_hidden</td>
</tr>
<tr class="row-even"><td>date_axis</td>
</tr>
<tr class="row-odd"><td>weight</td>
</tr>
<tr class="row-even"><td>series_color</td>
</tr>
<tr class="row-odd"><td>negative_color</td>
</tr>
<tr class="row-even"><td>markers_color</td>
</tr>
<tr class="row-odd"><td>first_color</td>
</tr>
<tr class="row-even"><td>last_color</td>
</tr>
<tr class="row-odd"><td>high_color</td>
</tr>
<tr class="row-even"><td>low_color</td>
</tr>
</tbody>
</table>
<img alt="_images/sparklines2.png" src="_images/sparklines2.png" />
<p>These parameters are explained in the sections below.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Sparklines are a feature of Excel 2010+ only. You can write them to an
XLSX file that can be read by Excel 2007 but they won’t be displayed.</p>
</div>
</div>
<div class="section" id="range">
<h4>range</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">range</span></code> specifier is the only non-optional parameter.</p>
<p>It specifies the cell data range that the sparkline will plot:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;A1:E1&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">range</span></code> should be a 2D array. (For 3D arrays of cells see “Grouped
Sparklines” below).</p>
<p>If <code class="docutils literal notranslate"><span class="pre">range</span></code> is not on the same worksheet you can specify its location using
the usual Excel notation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A1:E1&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>If the worksheet contains spaces or special characters you should quote the
worksheet name in the same way that Excel does:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s2">&quot;&#39;Monthly Data&#39;!A1:E1&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="type">
<h4>type</h4>
<p>Specifies the type of sparkline. There are 3 available sparkline types:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">line</span> <span class="p">(</span><span class="n">default</span><span class="p">)</span>
<span class="n">column</span>
<span class="n">win_loss</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;F2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;A2:E2&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="style">
<h4>style</h4>
<p>Excel provides 36 built-in Sparkline styles in 6 groups of 6. The <code class="docutils literal notranslate"><span class="pre">style</span></code>
parameter can be used to replicate these and should be a corresponding number
from 1 .. 36:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;F2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;A2:E2&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>
</pre></div>
</div>
<p>The style number starts in the top left of the style grid and runs left to
right. The default style is 1. It is possible to override color elements of
the sparklines using the <code class="docutils literal notranslate"><span class="pre">_color</span></code> parameters below.</p>
</div>
<div class="section" id="markers">
<h4>markers</h4>
<p>Turn on the markers for <code class="docutils literal notranslate"><span class="pre">line</span></code> style sparklines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A6&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A1:J1&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;markers&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>Markers aren’t shown in Excel for <code class="docutils literal notranslate"><span class="pre">column</span></code> and <code class="docutils literal notranslate"><span class="pre">win_loss</span></code> sparklines.</p>
</div>
<div class="section" id="negative-points">
<h4>negative_points</h4>
<p>Highlight negative values in a sparkline range. This is usually required with
<code class="docutils literal notranslate"><span class="pre">win_loss</span></code> sparklines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A9&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A1:J1&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;negative_points&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="axis">
<h4>axis</h4>
<p>Display a horizontal axis in the sparkline:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A10&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A1:J1&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="reverse">
<h4>reverse</h4>
<p>Plot the data from right-to-left instead of the default left-to-right:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A24&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A4:J4&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                                <span class="s1">&#39;reverse&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="weight">
<h4>weight</h4>
<p>Adjust the default line weight (thickness) for <code class="docutils literal notranslate"><span class="pre">line</span></code> style sparklines:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;F2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;A2:E2&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">})</span>
</pre></div>
</div>
<p>The weight value should be one of the following values allowed by Excel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.25</span><span class="p">,</span> <span class="mf">2.25</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">4.25</span><span class="p">,</span> <span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="section" id="high-point-low-point-first-point-last-point">
<h4>high_point, low_point, first_point, last_point</h4>
<p>Highlight points in a sparkline range:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A1:J1&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;high_point&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                               <span class="s1">&#39;low_point&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                               <span class="s1">&#39;first_point&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="max-min">
<h4>max, min</h4>
<p>Specify the maximum and minimum vertical axis values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;A1:E1&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
                               <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">})</span>
</pre></div>
</div>
<p>As a special case you can set the maximum and minimum to be for a group of
sparklines rather than one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="s1">&#39;group&#39;</span>
</pre></div>
</div>
<p>See “Grouped Sparklines” below.</p>
</div>
<div class="section" id="empty-cells">
<h4>empty_cells</h4>
<p>Define how empty cells are handled in a sparkline:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;A1:E1&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;empty_cells&#39;</span><span class="p">:</span> <span class="s1">&#39;zero&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The available options are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">gaps</span></code>: show empty cells as gaps (the default).</li>
<li><code class="docutils literal notranslate"><span class="pre">zero</span></code>: plot empty cells as 0.</li>
<li><code class="docutils literal notranslate"><span class="pre">connect</span></code>: Connect points with a line (“line” type sparklines only).</li>
</ul>
</div>
<div class="section" id="show-hidden">
<h4>show_hidden</h4>
<p>Plot data in hidden rows and columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;F3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;A3:E3&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;show_hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>Note, this option is off by default.</p>
</div>
<div class="section" id="date-axis">
<h4>date_axis</h4>
<p>Specify an alternative date axis for the sparkline. This is useful if the data
being plotted isn’t at fixed width intervals:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;F3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;A3:E3&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;date_axis&#39;</span><span class="p">:</span> <span class="s1">&#39;A4:E4&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The number of cells in the date range should correspond to the number of cells
in the data range.</p>
</div>
<div class="section" id="series-color">
<h4>series_color</h4>
<p>It is possible to override the color of a sparkline style using the following
parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">series_color</span>
<span class="n">negative_color</span>
<span class="n">markers_color</span>
<span class="n">first_color</span>
<span class="n">last_color</span>
<span class="n">high_color</span>
<span class="n">low_color</span>
</pre></div>
</div>
<p>The color should be specified as a HTML style <code class="docutils literal notranslate"><span class="pre">#rrggbb</span></code> hex value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A18&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A2:J2&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;series_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#E965E0&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="location">
<h4>location</h4>
<p>By default the sparkline location is specified by <code class="docutils literal notranslate"><span class="pre">row</span></code> and <code class="docutils literal notranslate"><span class="pre">col</span></code> in
<a class="reference internal" href="index.html#add_sparkline" title="add_sparkline"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_sparkline()</span></code></a>. However, for grouped sparklines it is necessary to
specify more than one cell location. The <code class="docutils literal notranslate"><span class="pre">location</span></code> parameter is used to
specify a list of cells. See “Grouped Sparklines” below.</p>
</div>
<div class="section" id="grouped-sparklines">
<h4>Grouped Sparklines</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">add_sparkline()</span></code> worksheet method can be used multiple times to write as
many sparklines as are required in a worksheet.</p>
<p>However, it is sometimes necessary to group contiguous sparklines so that
changes that are applied to one are applied to all. In Excel this is achieved
by selecting a 3D range of cells for the data <code class="docutils literal notranslate"><span class="pre">range</span></code> and a 2D range of
cells for the <code class="docutils literal notranslate"><span class="pre">location</span></code>.</p>
<p>In XlsxWriter, you can simulate this by passing an array refs of values to
<code class="docutils literal notranslate"><span class="pre">location</span></code> and <code class="docutils literal notranslate"><span class="pre">range</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A27&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A27&#39;</span><span class="p">,</span>   <span class="s1">&#39;A28&#39;</span><span class="p">,</span>   <span class="s1">&#39;A29&#39;</span><span class="p">],</span>
                                <span class="s1">&#39;range&#39;</span><span class="p">:</span>    <span class="p">[</span><span class="s1">&#39;A5:J5&#39;</span><span class="p">,</span> <span class="s1">&#39;A6:J6&#39;</span><span class="p">,</span> <span class="s1">&#39;A7:J7&#39;</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="section" id="sparkline-examples">
<h4>Sparkline examples</h4>
<p>See <a class="reference internal" href="index.html#ex-sparklines1"><span class="std std-ref">Example: Sparklines (Simple)</span></a> and <a class="reference internal" href="index.html#ex-sparklines2"><span class="std std-ref">Example: Sparklines (Advanced)</span></a>.</p>
</div>
</div>
<span id="document-working_with_cell_comments"></span><div class="section" id="working-with-cell-comments">
<span id="cell-comments"></span><h3>Working with Cell Comments</h3>
<p>Cell comments are a way of adding notation to cells in Excel. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;This is a comment&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/comments1.png" src="_images/comments1.png" />
<div class="section" id="setting-comment-properties">
<h4>Setting Comment Properties</h4>
<p>The properties of the cell comment can be modified by passing an optional
dictionary of key/value pairs to control the format of the comment. For
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_scale&#39;</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">,</span> <span class="s1">&#39;y_scale&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">})</span>
</pre></div>
</div>
<p>The following options are available:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">author</span>
<span class="n">visible</span>
<span class="n">x_scale</span>
<span class="n">width</span>
<span class="n">y_scale</span>
<span class="n">height</span>
<span class="n">color</span>
<span class="n">font_name</span>
<span class="n">font_size</span>
<span class="n">start_cell</span>
<span class="n">start_row</span>
<span class="n">start_col</span>
<span class="n">x_offset</span>
<span class="n">y_offset</span>
</pre></div>
</div>
<p>The options are explained in detail below:</p>
<ul>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">author</span></code>: This option is used to indicate who is the author of the cell
comment. Excel displays the author of the comment in the status bar at the
bottom of the worksheet. This is usually of interest in corporate
environments where several people might review and provide comments to a
workbook:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Atonement&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="s1">&#39;Ian McEwan&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The default author for all cell comments in a worksheet can be set using
the <a class="reference internal" href="index.html#set_comments_author" title="set_comments_author"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_comments_author()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_comments_author</span><span class="p">(</span><span class="s1">&#39;John Smith&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">visible</span></code>: This option is used to make a cell comment visible when the
worksheet is opened. The default behavior in Excel is that comments are
initially hidden. However, it is also possible in Excel to make individual
comments or all comments visible. In XlsxWriter individual comments can be
made visible as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;visible&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>It is possible to make all comments in a worksheet visible using the
<a class="reference internal" href="index.html#show_comments" title="show_comments"><code class="xref py py-func docutils literal notranslate"><span class="pre">show_comments()</span></code></a> worksheet method. Alternatively, if all of the cell
comments have been made visible you can hide individual comments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;visible&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">x_scale</span></code>: This option is used to set the width of the cell comment box
as a factor of the default width:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_scale&#39;</span><span class="p">:</span> <span class="mi">2</span>  <span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_scale&#39;</span><span class="p">:</span> <span class="mf">4.2</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">width</span></code>: This option is used to set the width of the cell comment box
explicitly in pixels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">y_scale</span></code>: This option is used to set the height of the cell comment box
as a factor of the default height:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;y_scale&#39;</span><span class="p">:</span> <span class="mi">2</span>  <span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;y_scale&#39;</span><span class="p">:</span> <span class="mf">4.2</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">height</span></code>: This option is used to set the height of the cell comment box
explicitly in pixels:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">color</span></code>: This option is used to set the background color of cell comment
box. You can use one of the named colors recognized by XlsxWriter or a Html
color. See <a class="reference internal" href="index.html#colors"><span class="std std-ref">Working with Colors</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span>  <span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#CCFFCC&#39;</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">font_name</span></code>: This option is used to set the font for the comment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;font_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Courier&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>The default font is ‘Tahoma’.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">font_size</span></code>: This option is used to set the font size for the comment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;font_size&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>
</pre></div>
</div>
<p>The  default font size is 8.</p>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">start_cell</span></code>: This option is used to set the cell in which the comment
will appear. By default Excel displays comments one cell to the right and
one cell above the cell to which the comment relates. However, you can
change this behavior if you wish. In the following example the comment
which would appear by default in cell <code class="docutils literal notranslate"><span class="pre">D2</span></code> is moved to <code class="docutils literal notranslate"><span class="pre">E2</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;start_cell&#39;</span><span class="p">:</span> <span class="s1">&#39;E2&#39;</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">start_row</span></code>: This option is used to set the row in which the comment will
appear. See the <code class="docutils literal notranslate"><span class="pre">start_cell</span></code> option above. The row is zero indexed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;start_row&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">start_col</span></code>: This option is used to set the column in which the comment
will appear. See the <code class="docutils literal notranslate"><span class="pre">start_cell</span></code> option above. The column is zero
indexed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;start_col&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">x_offset</span></code>: This option is used to change the x offset, in pixels, of a
comment within a cell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first"><code class="docutils literal notranslate"><span class="pre">y_offset</span></code>: This option is used to change the y offset, in pixels, of a
comment within a cell:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">})</span>
</pre></div>
</div>
</li>
</ul>
<p>You can apply as many of these options as you require. For a working example of
these options in use see <a class="reference internal" href="index.html#ex-comments2"><span class="std std-ref">Example: Adding Cell Comments to Worksheets (Advanced)</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Excel only displays offset cell comments when they are displayed as
<code class="docutils literal notranslate"><span class="pre">visible</span></code>. Excel does <strong>not</strong> display hidden cells as displaced
when you mouse over them. Please note this when using options that adjust
the position of the cell comment such as <code class="docutils literal notranslate"><span class="pre">start_cell</span></code>, <code class="docutils literal notranslate"><span class="pre">start_row</span></code>,
<code class="docutils literal notranslate"><span class="pre">start_col</span></code>, <code class="docutils literal notranslate"><span class="pre">x_offset</span></code> and <code class="docutils literal notranslate"><span class="pre">y_offset</span></code>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>Row height and comments</strong>. If you specify the height of a row that
contains a comment then XlsxWriter will adjust the height of the comment
to maintain the default or user specified dimensions. However, the height
of a row can also be adjusted automatically by Excel if the text wrap
property is set or large fonts are used in the cell. This means that
the height of the row is unknown to the module at run time and thus
the comment box is stretched with the row. Use the <code class="docutils literal notranslate"><span class="pre">set_row()</span></code> method
to specify the row height explicitly and avoid this problem. See example 8
of <a class="reference internal" href="index.html#ex-comments2"><span class="std std-ref">Example: Adding Cell Comments to Worksheets (Advanced)</span></a>.</p>
</div>
</div>
</div>
<span id="document-working_with_outlines"></span><div class="section" id="working-with-outlines-and-grouping">
<span id="outlines"></span><h3>Working with Outlines and Grouping</h3>
<p>Excel allows you to group rows or columns so that they can be hidden or
displayed with a single mouse click. This feature is referred to as outlines
and grouping.</p>
<p>Outlines can reduce complex data down to a few salient sub-totals or
summaries. For example the following is a worksheet with three outlines.</p>
<img alt="_images/outline1.png" src="_images/outline1.png" />
<p>Rows 2 to 11 are grouped at level 1 and rows 2 to 5 and 7 to 10 are grouped at
level 2. The lines at the left hand side are called “outline level” bars and
the level is shown by the small numeral above the outline.</p>
<p>Clicking the minus sign on each of the level 2 outlines will collapse and hide
the data as shown below.</p>
<img alt="_images/outline5.png" src="_images/outline5.png" />
<p>The minus sign changes to a plus sign to indicate that the data in the outline
is hidden. This shows the usefulness of outlines: with 2 mouse clicks we have
reduced the amount of visual data down to 2 sub-totals and a master total.</p>
<p>Finally, clicking on the minus sign on the level 1 outline will collapse the
remaining rows as follows:</p>
<img alt="_images/outline6.png" src="_images/outline6.png" />
<div class="section" id="outlines-and-grouping-in-xlsxwriter">
<h4>Outlines and Grouping in XlsxWriter</h4>
<p>Grouping in <code class="docutils literal notranslate"><span class="pre">XlsxWriter</span></code> is achieved by setting the outline level via the
<a class="reference internal" href="index.html#set_row" title="set_row"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_row()</span></code></a> and <a class="reference internal" href="index.html#set_column" title="set_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_column()</span></code></a> worksheet methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">first_col</span><span class="p">,</span> <span class="n">last_col</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
<p>Adjacent row or columns with the same outline level are grouped together into a
single outline.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">'options'</span></code> parameter is a dictionary with the following possible keys:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">'hidden'</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">'level'</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">'collapsed'</span></code></li>
</ul>
<p>Options can be set as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Or use defaults for other properties and set the options only.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>The following example sets an outline level of 1 for rows 1 to 4
(zero-indexed) and columns B to G. The parameters <code class="docutils literal notranslate"><span class="pre">height</span></code> and
<code class="docutils literal notranslate"><span class="pre">cell_format</span></code> are assigned default values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/outline3.png" src="_images/outline3.png" />
<p>Rows and columns can be collapsed by setting the <code class="docutils literal notranslate"><span class="pre">hidden</span></code> flag for the hidden
rows/columns and setting the <code class="docutils literal notranslate"><span class="pre">collapsed</span></code> flag for the row/column that has
the collapsed <code class="docutils literal notranslate"><span class="pre">'+'</span></code> symbol:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;collapsed&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;H:H&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;collapsed&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<img alt="_images/outline7.png" src="_images/outline7.png" />
<p>Excel allows up to 7 outline levels. Therefore the <code class="docutils literal notranslate"><span class="pre">level</span></code> parameter should
be in the range <code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">&lt;=</span> <span class="pre">level</span> <span class="pre">&lt;=</span> <span class="pre">7</span></code>.</p>
<img alt="_images/outline4.png" src="_images/outline4.png" />
<p>For a more complete examples see <a class="reference internal" href="index.html#ex-outline1"><span class="std std-ref">Example: Outline and Grouping</span></a> and <a class="reference internal" href="index.html#ex-outline2"><span class="std std-ref">Example: Collapsed Outline and Grouping</span></a>.</p>
<p>Some additional outline properties can be set via the <a class="reference internal" href="index.html#outline_settings" title="outline_settings"><code class="xref py py-func docutils literal notranslate"><span class="pre">outline_settings()</span></code></a>
worksheet method.</p>
</div>
</div>
<span id="document-working_with_memory"></span><div class="section" id="working-with-memory-and-performance">
<span id="memory-perf"></span><h3>Working with Memory and Performance</h3>
<p>By default XlsxWriter holds all cell data in memory. This is to allow future
features when formatting is applied separately from the data.</p>
<p>The effect of this is that XlsxWriter can consume a lot of memory and it is
possible to run out of memory when creating large files.</p>
<p>Fortunately, this memory usage can be reduced almost completely by using the
<a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> <code class="docutils literal notranslate"><span class="pre">'constant_memory'</span></code> property:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;constant_memory&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>The optimization works by flushing each row after a subsequent row is written.
In this way the largest amount of data held in memory for a worksheet is the
amount of data required to hold a single row of data.</p>
<p>Since each new row flushes the previous row, data must be written in sequential
row order when <code class="docutils literal notranslate"><span class="pre">'constant_memory'</span></code> mode is on:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ok. With &#39;constant_memory&#39; you must write data in row by column order.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">row_max</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_max</span><span class="p">):</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">some_data</span><span class="p">)</span>

<span class="c1"># Not ok. With &#39;constant_memory&#39; this will only write the first column of data.</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_max</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">row_max</span><span class="p">):</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">some_data</span><span class="p">)</span>
</pre></div>
</div>
<p>Another optimization that is used to reduce memory usage is that cell strings
aren’t stored in an Excel structure call “shared strings” and instead are
written “in-line”. This is a documented Excel feature that is supported by
most spreadsheet applications.</p>
<p>The trade-off when using <code class="docutils literal notranslate"><span class="pre">'constant_memory'</span></code> mode is that you won’t be able
to take advantage of any new features that manipulate cell data after it is
written. Currently the <a class="reference internal" href="index.html#add_table" title="add_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_table()</span></code></a> method doesn’t work in this mode
and <a class="reference internal" href="index.html#merge_range" title="merge_range"><code class="xref py py-func docutils literal notranslate"><span class="pre">merge_range()</span></code></a> and <a class="reference internal" href="index.html#set_row" title="set_row"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_row()</span></code></a> only work for the current row.</p>
<div class="section" id="performance-figures">
<h4>Performance Figures</h4>
<p>The performance figures below show execution time and memory usage for
worksheets of size <code class="docutils literal notranslate"><span class="pre">N</span></code> rows x 50 columns with a 50/50 mixture of strings and
numbers. The figures are taken from an arbitrary, mid-range, machine. Specific
figures will vary from machine to machine but the trends should be the same.</p>
<p>XlsxWriter in normal operation mode: the execution time and memory usage
increase more of less linearly with the number of rows:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="21%" />
<col width="24%" />
<col width="38%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Rows</th>
<th class="head">Columns</th>
<th class="head">Time (s)</th>
<th class="head">Memory (bytes)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>200</td>
<td>50</td>
<td>0.43</td>
<td>2346728</td>
</tr>
<tr class="row-odd"><td>400</td>
<td>50</td>
<td>0.84</td>
<td>4670904</td>
</tr>
<tr class="row-even"><td>800</td>
<td>50</td>
<td>1.68</td>
<td>8325928</td>
</tr>
<tr class="row-odd"><td>1600</td>
<td>50</td>
<td>3.39</td>
<td>17855192</td>
</tr>
<tr class="row-even"><td>3200</td>
<td>50</td>
<td>6.82</td>
<td>32279672</td>
</tr>
<tr class="row-odd"><td>6400</td>
<td>50</td>
<td>13.66</td>
<td>64862232</td>
</tr>
<tr class="row-even"><td>12800</td>
<td>50</td>
<td>27.60</td>
<td>128851880</td>
</tr>
</tbody>
</table>
<p>XlsxWriter in <code class="docutils literal notranslate"><span class="pre">constant_memory</span></code> mode: the execution time still increases
linearly with the number of rows but the memory usage remains small and
constant:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="21%" />
<col width="24%" />
<col width="38%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Rows</th>
<th class="head">Columns</th>
<th class="head">Time (s)</th>
<th class="head">Memory (bytes)</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>200</td>
<td>50</td>
<td>0.37</td>
<td>62208</td>
</tr>
<tr class="row-odd"><td>400</td>
<td>50</td>
<td>0.74</td>
<td>62208</td>
</tr>
<tr class="row-even"><td>800</td>
<td>50</td>
<td>1.46</td>
<td>62208</td>
</tr>
<tr class="row-odd"><td>1600</td>
<td>50</td>
<td>2.93</td>
<td>62208</td>
</tr>
<tr class="row-even"><td>3200</td>
<td>50</td>
<td>5.90</td>
<td>62208</td>
</tr>
<tr class="row-odd"><td>6400</td>
<td>50</td>
<td>11.84</td>
<td>62208</td>
</tr>
<tr class="row-even"><td>12800</td>
<td>50</td>
<td>23.63</td>
<td>62208</td>
</tr>
</tbody>
</table>
<p>In <code class="docutils literal notranslate"><span class="pre">constant_memory</span></code> mode the performance should be approximately the same
as normal mode.</p>
<p>These figures were generated using programs in the <code class="docutils literal notranslate"><span class="pre">dev/performance</span></code>
directory of the XlsxWriter repo.</p>
</div>
</div>
<span id="document-working_with_macros"></span><div class="section" id="working-with-vba-macros">
<span id="macros"></span><h3>Working with VBA Macros</h3>
<p>This section explains how to add a VBA file containing functions or macros to an XlsxWriter file.</p>
<img alt="_images/macros.png" src="_images/macros.png" />
<div class="section" id="the-excel-xlsm-file-format">
<h4>The Excel XLSM file format</h4>
<p>An Excel <code class="docutils literal notranslate"><span class="pre">xlsm</span></code> file is exactly the same as an <code class="docutils literal notranslate"><span class="pre">xlsx</span></code> file except that is
contains an additional <code class="docutils literal notranslate"><span class="pre">vbaProject.bin</span></code> file which contains functions and/or
macros. Excel uses a different extension to differentiate between the two file
formats since files containing macros are usually subject to additional
security checks.</p>
</div>
<div class="section" id="how-vba-macros-are-included-in-xlsxwriter">
<h4>How VBA macros are included in XlsxWriter</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">vbaProject.bin</span></code> file is a binary OLE COM container. This was the format
used in older <code class="docutils literal notranslate"><span class="pre">xls</span></code> versions of Excel prior to Excel 2007. Unlike all of the
other components of an xlsx/xlsm file the data isn’t stored in XML
format. Instead the functions and macros as stored as a pre-parsed binary
format. As such it wouldn’t be feasible to define macros and create a
<code class="docutils literal notranslate"><span class="pre">vbaProject.bin</span></code> file from scratch (at least not in the remaining lifespan
and interest levels of the author).</p>
<p>Instead a workaround is used to extract <code class="docutils literal notranslate"><span class="pre">vbaProject.bin</span></code> files from existing
xlsm files and then add these to XlsxWriter files.</p>
</div>
<div class="section" id="the-vba-extract-py-utility">
<h4>The vba_extract.py utility</h4>
<p>The <code class="docutils literal notranslate"><span class="pre">vba_extract.py</span></code> utility is used to extract the <code class="docutils literal notranslate"><span class="pre">vbaProject.bin</span></code> binary
from an Excel 2007+ xlsm file. The utility is included in the XlsxWriter
examples directory and is also installed as a standalone executable file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ vba_extract.py macro_file.xlsm
Extracted: vbaProject.bin
</pre></div>
</div>
</div>
<div class="section" id="adding-the-vba-macros-to-a-xlsxwriter-file">
<h4>Adding the VBA macros to a XlsxWriter file</h4>
<p>Once the <code class="docutils literal notranslate"><span class="pre">vbaProject.bin</span></code> file has been extracted it can be added to the
XlsxWriter workbook using the <a class="reference internal" href="index.html#add_vba_project" title="add_vba_project"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_vba_project()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span><span class="o">.</span><span class="n">add_vba_project</span><span class="p">(</span><span class="s1">&#39;./vbaProject.bin&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If the VBA file contains functions you can then refer to them in calculations
using <a class="reference internal" href="index.html#write_formula" title="write_formula"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_formula()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;=MyMortgageCalc(200000, 25)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Excel files that contain functions and macros should use an <code class="docutils literal notranslate"><span class="pre">xlsm</span></code> extension
or else Excel will complain and possibly not open the file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;macros.xlsm&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>It is also possible to assign a macro to a button that is inserted into a
worksheet using the <a class="reference internal" href="index.html#insert_button" title="insert_button"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_button()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="c1"># Note the file extension should be .xlsm.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;macros.xlsm&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="c1"># Add the VBA project binary.</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">add_vba_project</span><span class="p">(</span><span class="s1">&#39;./vbaProject.bin&#39;</span><span class="p">)</span>

<span class="c1"># Show text for the end user.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="s1">&#39;Press the button to say hello.&#39;</span><span class="p">)</span>

<span class="c1"># Add a button tied to a macro in the VBA project.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_button</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;macro&#39;</span><span class="p">:</span>   <span class="s1">&#39;say_hello&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;caption&#39;</span><span class="p">:</span> <span class="s1">&#39;Press Me&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;width&#39;</span><span class="p">:</span>   <span class="mi">80</span><span class="p">,</span>
                               <span class="s1">&#39;height&#39;</span><span class="p">:</span>  <span class="mi">30</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>It may be necessary to specify a more explicit macro name prefixed by the
workbook VBA name as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">insert_button</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;macro&#39;</span><span class="p">:</span> <span class="s1">&#39;ThisWorkbook.say_hello&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="index.html#ex-macros"><span class="std std-ref">Example: Adding a VBA macro to a Workbook</span></a> from the examples directory for a working example.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Button is the only VBA Control supported by Xlsxwriter. Due to the large
effort in implementation (1+ man months) it is unlikely that any other form
elements will be added in the future.</p>
</div>
</div>
<div class="section" id="setting-the-vba-codenames">
<h4>Setting the VBA codenames</h4>
<p>VBA macros generally refer to workbook and worksheet objects. If the VBA
codenames aren’t specified then XlsxWriter will use the Excel defaults of
<code class="docutils literal notranslate"><span class="pre">ThisWorkbook</span></code> and <code class="docutils literal notranslate"><span class="pre">Sheet1</span></code>, <code class="docutils literal notranslate"><span class="pre">Sheet2</span></code> etc.</p>
<p>If the macro uses other codenames you can set them using the workbook and
worksheet <code class="docutils literal notranslate"><span class="pre">set_vba_name()</span></code> methods as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note: set codename for workbook and any worksheets.</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">set_vba_name</span><span class="p">(</span><span class="s1">&#39;MyWorkbook&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_vba_name</span><span class="p">(</span><span class="s1">&#39;MySheet1&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_vba_name</span><span class="p">(</span><span class="s1">&#39;MySheet2&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can find the names that are used in the VBA editor or by unzipping the
<code class="docutils literal notranslate"><span class="pre">xlsm</span></code> file and grepping the files. The following shows how to do that using
<a class="reference external" href="http://xmlsoft.org/xmllint.html">libxml’s xmllint</a> to format the XML for
clarity:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ unzip myfile.xlsm -d myfile
$ xmllint --format `find myfile -name &quot;*.xml&quot; | xargs` | grep &quot;Pr.*codeName&quot;

  &lt;workbookPr codeName=&quot;MyWorkbook&quot; defaultThemeVersion=&quot;124226&quot;/&gt;
  &lt;sheetPr codeName=&quot;MySheet&quot;/&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This step is particularly important for macros created with non-English
versions of Excel.</p>
</div>
</div>
<div class="section" id="what-to-do-if-it-doesn-t-work">
<h4>What to do if it doesn’t work</h4>
<p>The XlsxWriter test suite contains several tests to ensure that this feature
works and there is a working example as shown above. However, there is no
guarantee that it will work in all cases. Some effort may be required and some
knowledge of VBA will certainly help. If things don’t work out here are some
things to try:</p>
<ol class="arabic">
<li><p class="first">Start with a simple macro file, ensure that it works and then add complexity.</p>
</li>
<li><p class="first">Check the code names that macros use to refer to the workbook and
worksheets (see the previous section above). In general VBA uses a code
name of <code class="docutils literal notranslate"><span class="pre">ThisWorkbook</span></code> to refer to the current workbook and the sheet
name (such as <code class="docutils literal notranslate"><span class="pre">Sheet1</span></code>) to refer to the worksheets. These are the
defaults used by XlsxWriter. If the macro uses other names, or the macro
was extracted from an non-English language version of Excel, then you can
specify these using the workbook and worksheet <a class="reference internal" href="index.html#set_vba_name" title="set_vba_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_vba_name()</span></code></a>
methods:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note: set codename for workbook and any worksheets.</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">set_vba_name</span><span class="p">(</span><span class="s1">&#39;MyWorkbook&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_vba_name</span><span class="p">(</span><span class="s1">&#39;MySheet1&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_vba_name</span><span class="p">(</span><span class="s1">&#39;MySheet2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p class="first">Try to extract the macros from an Excel 2007 file. The method should work
with macros from later versions (it was also tested with Excel 2010
macros). However there may be features in the macro files of more recent
version of Excel that aren’t backward compatible.</p>
</li>
</ol>
</div>
</div>
<span id="document-working_with_pandas"></span><div class="section" id="working-with-python-pandas-and-xlsxwriter">
<span id="ewx-pandas"></span><h3>Working with Python Pandas and XlsxWriter</h3>
<p>Python <a class="reference external" href="https://pandas.pydata.org/">Pandas</a> is a Python data analysis
library. It can read, filter and re-arrange small and large data sets and
output them in a range of formats including Excel.</p>
<p>Pandas writes Excel files using the <a class="reference external" href="https://pypi.org/project/xlwt/">Xlwt</a> module for xls files and the <a class="reference external" href="https://pypi.org/project/openpyxl/">Openpyxl</a> or XlsxWriter modules for xlsx
files.</p>
<div class="section" id="using-xlsxwriter-with-pandas">
<h4>Using XlsxWriter with Pandas</h4>
<p>To use XlsxWriter with Pandas you specify it as the Excel writer <em>engine</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Create a Pandas dataframe from the data.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">]})</span>

<span class="c1"># Create a Pandas Excel writer using XlsxWriter as the engine.</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;pandas_simple.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>

<span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>

<span class="c1"># Close the Pandas Excel writer and output the Excel file.</span>
<span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<p>The output from this would look like the following:</p>
<img alt="_images/pandas_simple.png" src="_images/pandas_simple.png" />
<p>See the full example at <a class="reference internal" href="index.html#ex-pandas-simple"><span class="std std-ref">Example: Pandas Excel example</span></a>.</p>
</div>
<div class="section" id="accessing-xlsxwriter-from-pandas">
<h4>Accessing XlsxWriter from Pandas</h4>
<p>In order to apply XlsxWriter features such as Charts, Conditional Formatting
and Column Formatting to the Pandas output we need to access the underlying
<a class="reference internal" href="index.html#workbook"><span class="std std-ref">workbook</span></a> and <a class="reference internal" href="index.html#worksheet"><span class="std std-ref">worksheet</span></a> objects. After
that we can treat them as normal XlsxWriter objects.</p>
<p>Continuing on from the above example we do that as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Create a Pandas dataframe from the data.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">]})</span>

<span class="c1"># Create a Pandas Excel writer using XlsxWriter as the engine.</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;pandas_simple.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>

<span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>

<span class="c1"># Get the xlsxwriter objects from the dataframe writer object.</span>
<span class="n">workbook</span>  <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>This is equivalent to the following code when using XlsxWriter on its own:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workbook</span>  <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;filename.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
</pre></div>
</div>
<p>The Workbook and Worksheet objects can then be used to access other XlsxWriter
features, see below.</p>
</div>
<div class="section" id="adding-charts-to-dataframe-output">
<h4>Adding Charts to Dataframe output</h4>
<p>Once we have the Workbook and Worksheet objects, as shown in the previous
section, we we can use them to apply other features such as adding a chart:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the xlsxwriter objects from the dataframe writer object.</span>
<span class="n">workbook</span>  <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">]</span>

<span class="c1"># Create a chart object.</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Configure the series of the chart from the dataframe data.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$2:$B$8&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>
</pre></div>
</div>
<p>The output would look like this:</p>
<img alt="_images/pandas_chart.png" src="_images/pandas_chart.png" />
<p>See the full example at <a class="reference internal" href="index.html#ex-pandas-chart"><span class="std std-ref">Example: Pandas Excel output with a chart</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The above example uses a fixed string <code class="docutils literal notranslate"><span class="pre">=Sheet1!$B$2:$B$8</span></code> for the data
range. It is also possible to use a <code class="docutils literal notranslate"><span class="pre">(row,</span> <span class="pre">col)</span></code> range which can be
varied based on the length of the dataframe. See for example
<a class="reference internal" href="index.html#ex-pandas-chart-line"><span class="std std-ref">Example: Pandas Excel output with a line chart</span></a> and <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a>.</p>
</div>
</div>
<div class="section" id="adding-conditional-formatting-to-dataframe-output">
<h4>Adding Conditional Formatting to Dataframe output</h4>
<p>Another option is to apply a conditional format like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply a conditional format to the cell range.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B2:B8&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;3_color_scale&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>Which would give:</p>
<img alt="_images/pandas_conditional.png" src="_images/pandas_conditional.png" />
<p>See the full example at <a class="reference internal" href="index.html#ex-pandas-conditional"><span class="std std-ref">Example: Pandas Excel output with conditional formatting</span></a>.</p>
</div>
<div class="section" id="formatting-of-the-dataframe-output">
<h4>Formatting of the Dataframe output</h4>
<p>XlsxWriter and Pandas provide very little support for formatting the output
data from a dataframe apart from default formatting such as the header and
index cells and any cells that contain dates or datetimes. In addition it
isn’t possible to format any cells that already have a default format applied.</p>
<p>If you require very controlled formatting of the dataframe output then you
would probably be better off using Xlsxwriter directly with raw data taken
from Pandas. However, some formatting options are available.</p>
<p>For example it is possible to set the default date and datetime formats via
the Pandas interface:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s2">&quot;pandas_datetime.xlsx&quot;</span><span class="p">,</span>
                        <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">,</span>
                        <span class="n">datetime_format</span><span class="o">=</span><span class="s1">&#39;mmm d yyyy hh:mm:ss&#39;</span><span class="p">,</span>
                        <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;mmmm dd yyyy&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Which would give:</p>
<img alt="_images/pandas_datetime.png" src="_images/pandas_datetime.png" />
<p>See the full example at <a class="reference internal" href="index.html#ex-pandas-datetime"><span class="std std-ref">Example: Pandas Excel output with datetimes</span></a>.</p>
<p>It is possible to format any other, non date/datetime column data using
<a class="reference internal" href="index.html#set_column" title="set_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_column()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add some cell formats.</span>
<span class="n">format1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;#,##0.00&#39;</span><span class="p">})</span>
<span class="n">format2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;0%&#39;</span><span class="p">})</span>

<span class="c1"># Set the column width and format.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:B&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="n">format1</span><span class="p">)</span>

<span class="c1"># Set the format but not the column width.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;C:C&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">format2</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/pandas_column_formats.png" src="_images/pandas_column_formats.png" />
<p>Note: This feature requires Pandas &gt;= 0.16.</p>
<p>See the full example at <a class="reference internal" href="index.html#ex-pandas-column-formats"><span class="std std-ref">Example: Pandas Excel output with column formatting</span></a>.</p>
</div>
<div class="section" id="formatting-of-the-dataframe-headers">
<h4>Formatting of the Dataframe headers</h4>
<p>Pandas writes the dataframe header with a default cell format. Since it is a
cell format it cannot be overridden using <a class="reference internal" href="index.html#set_row" title="set_row"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_row()</span></code></a>. If you wish to
use your own format for the headings then the best approach is to turn off the
automatic header from Pandas and write your own. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Turn off the default header and skip one row to allow us to insert a</span>
<span class="c1"># user defined header.</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">startrow</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Get the xlsxwriter workbook and worksheet objects.</span>
<span class="n">workbook</span>  <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">]</span>

<span class="c1"># Add a header format.</span>
<span class="n">header_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
    <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#D7E4BC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Write the column headers with the defined format.</span>
<span class="k">for</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">header_format</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/pandas_header_format.png" src="_images/pandas_header_format.png" />
<p>See the full example at <a class="reference internal" href="index.html#ex-pandas-header-format"><span class="std std-ref">Example: Pandas Excel output with user defined header format</span></a>.</p>
</div>
<div class="section" id="handling-multiple-pandas-dataframes">
<h4>Handling multiple Pandas Dataframes</h4>
<p>It is possible to write more than one dataframe to a worksheet or to several
worksheets. For example to write multiple dataframes to multiple worksheets:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Write each dataframe to a different worksheet.</span>
<span class="n">df1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet2&#39;</span><span class="p">)</span>
<span class="n">df3</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>See the full example at <a class="reference internal" href="index.html#ex-pandas-multiple"><span class="std std-ref">Example: Pandas Excel with multiple dataframes</span></a>.</p>
<p>It is also possible to position multiple dataframes within the same
worksheet:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Position the dataframes in the worksheet.</span>
<span class="n">df1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>  <span class="c1"># Default position, cell A1.</span>
<span class="n">df2</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">startcol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">df3</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">startrow</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="c1"># Write the dataframe without the header and index.</span>
<span class="n">df4</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span>
             <span class="n">startrow</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">startcol</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<img alt="_images/pandas_positioning.png" src="_images/pandas_positioning.png" />
<p>See the full example at <a class="reference internal" href="index.html#ex-pandas-positioning"><span class="std std-ref">Example: Pandas Excel dataframe positioning</span></a>.</p>
</div>
<div class="section" id="passing-xlsxwriter-constructor-options-to-pandas">
<h4>Passing XlsxWriter constructor options to Pandas</h4>
<p>XlsxWriter supports several <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> constructor options such as
<code class="docutils literal notranslate"><span class="pre">strings_to_urls()</span></code>. These can also be applied to the <code class="docutils literal notranslate"><span class="pre">Workbook</span></code> object
created by Pandas as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;pandas_example.xlsx&#39;</span><span class="p">,</span>
                        <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">,</span>
                        <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;strings_to_urls&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="section" id="saving-the-dataframe-output-to-a-string">
<h4>Saving the Dataframe output to a string</h4>
<p>It is also possible to write the Pandas XlsxWriter DataFrame output to a
byte array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">io</span>

<span class="c1"># Create a Pandas dataframe from the data.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">]})</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>

<span class="c1"># Use the BytesIO object as the filehandle.</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>

<span class="c1"># Write the data frame to the BytesIO object.</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>

<span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="n">xlsx_data</span> <span class="o">=</span> <span class="n">output</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>

<span class="c1"># Do something with the data...</span>
</pre></div>
</div>
<p>Note: This feature requires Pandas &gt;= 0.17.</p>
</div>
<div class="section" id="additional-pandas-and-excel-information">
<h4>Additional Pandas and Excel Information</h4>
<p>Here are some additional resources in relation to Pandas, Excel and XlsxWriter.</p>
<ul class="simple">
<li>The XlsxWriter Pandas examples later in the document: <a class="reference internal" href="index.html#pandas-examples"><span class="std std-ref">Pandas with XlsxWriter Examples</span></a>.</li>
<li>The Pandas documentation on the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.to_excel.html">pandas.DataFrame.to_excel() method</a>.</li>
<li>A more detailed tutorial on <a class="reference external" href="https://pandas-xlsxwriter-charts.readthedocs.io/">Using Pandas and XlsxWriter to create Excel
charts</a>.</li>
<li>The series of articles on the “Practical Business Python” website about
<a class="reference external" href="https://pbpython.com/tag/excel.html">Using Pandas and Excel</a>.</li>
</ul>
</div>
</div>
<span id="document-examples"></span><div class="section" id="examples">
<span id="main-examples"></span><h3>Examples</h3>
<p>The following are some of the examples included in the
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/tree/master/examples">examples</a>
directory of the XlsxWriter distribution.</p>
<div class="toctree-wrapper compound">
<span id="document-example_hello_world"></span><div class="section" id="example-hello-world">
<span id="ex-hello-world"></span><h4>Example: Hello World</h4>
<p>The simplest possible spreadsheet. This is a good place to start to see if
the XlsxWriter module is installed correctly.</p>
<img alt="_images/hello01.png" src="_images/hello01.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># A hello world spreadsheet using the XlsxWriter Python module.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;hello_world.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello world&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_demo"></span><div class="section" id="example-simple-feature-demonstration">
<span id="ex-demo"></span><h4>Example: Simple Feature Demonstration</h4>
<p>This program is an example of writing some of the features of the XlsxWriter
module.</p>
<img alt="_images/demo.png" src="_images/demo.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># A simple example of some of the features of the XlsxWriter Python module.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>


<span class="c1"># Create an new Excel file and add a worksheet.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;demo.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Widen the first column to make the text clearer.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Add a bold format to use to highlight cells.</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Write some simple text.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>

<span class="c1"># Text with formatting.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;World&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="c1"># Write some numbers, with row/column notation.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">123.456</span><span class="p">)</span>

<span class="c1"># Insert an image.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;logo.png&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Notes:</p>
<ul class="simple">
<li>This example includes the use of cell formatting via the <a class="reference internal" href="index.html#format"><span class="std std-ref">The Format Class</span></a>.</li>
<li>Strings and numbers can be written with the same worksheet <a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a>
method.</li>
<li>Data can be written to cells using Row-Column notation or ‘A1’ style
notation, see <a class="reference internal" href="index.html#cell-notation"><span class="std std-ref">Working with Cell Notation</span></a>.</li>
</ul>
</div>
<span id="document-example_check_close"></span><div class="section" id="example-catch-exception-on-closing">
<span id="ex-check-close"></span><h4>Example: Catch exception on closing</h4>
<p>A simple program demonstrating a check for exceptions when closing the file.</p>
<p>We try to <a class="reference internal" href="index.html#close" title="close"><code class="xref py py-func docutils literal notranslate"><span class="pre">close()</span></code></a> the file in a loop so that if there is an exception,
such as if the file is open or locked, we can ask the user to close the file,
after which we can try again to overwrite it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># A simple program demonstrating a check for exceptions when closing the file.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;check_close.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello world&#39;</span><span class="p">)</span>

<span class="c1"># Try to close() the file in a loop so that if there is an exception, such as</span>
<span class="c1"># if the file is open in Excel, we can ask the user to close the file, and</span>
<span class="c1"># try again to overwrite it.</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">except</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">FileCreateError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># For Python 3 use input() instead of raw_input().</span>
        <span class="n">decision</span> <span class="o">=</span> <span class="n">raw_input</span><span class="p">(</span><span class="s2">&quot;Exception caught in workbook.close(): </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Please close the file if it is open in Excel.</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;Try to write file again? [Y/n]: &quot;</span> <span class="o">%</span> <span class="n">e</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">decision</span> <span class="o">!=</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
            <span class="k">continue</span>

    <span class="k">break</span>
</pre></div>
</div>
</div>
<span id="document-example_datetimes"></span><div class="section" id="example-dates-and-times-in-excel">
<span id="ex-datetimes"></span><h4>Example: Dates and Times in Excel</h4>
<p>This program is an example of writing some of the features of the
XlsxWriter module. See the <a class="reference internal" href="index.html#working-with-dates-and-time"><span class="std std-ref">Working with Dates and Time</span></a> section for
more details on this example.</p>
<img alt="_images/working_with_dates_and_times02.png" src="_images/working_with_dates_and_times02.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># A simple program to write some dates and times to an Excel file</span>
<span class="c1"># using the XlsxWriter Python module.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="c1"># Create a workbook and add a worksheet.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;datetimes.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Expand the first columns so that the dates are visible.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:B&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="c1"># Write the column headers.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Formatted date&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;Format&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="c1"># Create a datetime object to use in the examples.</span>

<span class="n">date_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="s1">&#39;2013-01-23 12:30:05.123&#39;</span><span class="p">,</span>
                              <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S.</span><span class="si">%f</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Examples date and time formats. In the output file compare how changing</span>
<span class="c1"># the format codes change the appearance of the date.</span>
<span class="n">date_formats</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;dd/mm/yy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mm/dd/yy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;dd m yy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;d mm yy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;d mmm yy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;d mmmm yy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;d mmmm yyy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;d mmmm yyyy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;dd/mm/yy hh:mm&#39;</span><span class="p">,</span>
    <span class="s1">&#39;dd/mm/yy hh:mm:ss&#39;</span><span class="p">,</span>
    <span class="s1">&#39;dd/mm/yy hh:mm:ss.000&#39;</span><span class="p">,</span>
    <span class="s1">&#39;hh:mm&#39;</span><span class="p">,</span>
    <span class="s1">&#39;hh:mm:ss&#39;</span><span class="p">,</span>
    <span class="s1">&#39;hh:mm:ss.000&#39;</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Start from first row after headers.</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Write the same date and time using each of the above formats.</span>
<span class="k">for</span> <span class="n">date_format_str</span> <span class="ow">in</span> <span class="n">date_formats</span><span class="p">:</span>

    <span class="c1"># Create a format for the date or time.</span>
    <span class="n">date_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="n">date_format_str</span><span class="p">,</span>
                                      <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;left&#39;</span><span class="p">})</span>

    <span class="c1"># Write the same date using different formats.</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write_datetime</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">date_time</span><span class="p">,</span> <span class="n">date_format</span><span class="p">)</span>

    <span class="c1"># Also write the format string for comparison.</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">date_format_str</span><span class="p">)</span>

    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_hyperlink"></span><div class="section" id="example-adding-hyperlinks">
<span id="ex-hyperlink"></span><h4>Example: Adding hyperlinks</h4>
<p>This program is an example of writing hyperlinks to a worksheet. See the
<a class="reference internal" href="index.html#write_url" title="write_url"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_url()</span></code></a> method for more details.</p>
<img alt="_images/hyperlink.png" src="_images/hyperlink.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of how to use the XlsxWriter module to write hyperlinks</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="c1"># Create a new workbook and add a worksheet</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;hyperlink.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Hyperlinks&#39;</span><span class="p">)</span>

<span class="c1"># Format the first column</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="c1"># Add a sample alternative link format.</span>
<span class="n">red_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
    <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bold&#39;</span><span class="p">:</span>       <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;underline&#39;</span><span class="p">:</span>  <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;font_size&#39;</span><span class="p">:</span>  <span class="mi">12</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Write some hyperlinks</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;http://www.python.org/&#39;</span><span class="p">)</span>  <span class="c1"># Implicit format.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="s1">&#39;http://www.python.org/&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s1">&#39;Python Home&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="s1">&#39;http://www.python.org/&#39;</span><span class="p">,</span> <span class="n">tip</span><span class="o">=</span><span class="s1">&#39;Click here&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="s1">&#39;http://www.python.org/&#39;</span><span class="p">,</span> <span class="n">red_format</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_url</span><span class="p">(</span><span class="s1">&#39;A9&#39;</span><span class="p">,</span> <span class="s1">&#39;mailto:jmcnamara@cpan.org&#39;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="s1">&#39;Mail me&#39;</span><span class="p">)</span>

<span class="c1"># Write a URL that isn&#39;t a hyperlink</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="s1">&#39;A11&#39;</span><span class="p">,</span> <span class="s1">&#39;http://www.python.org/&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_array_formula"></span><div class="section" id="example-array-formulas">
<span id="ex-array-formula"></span><h4>Example: Array formulas</h4>
<p>This program is an example of writing array formulas with one or more return
values. See the <a class="reference internal" href="index.html#write_array_formula" title="write_array_formula"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_array_formula()</span></code></a> method for more details.</p>
<img alt="_images/array_formula.png" src="_images/array_formula.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of how to use Python and the XlsxWriter module to write</span>
<span class="c1"># simple array formulas.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="c1"># Create a new workbook and add a worksheet</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;array_formula.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Write some test data.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B7&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C5&#39;</span><span class="p">,</span> <span class="mi">20234</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="mi">21003</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C7&#39;</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>


<span class="c1"># Write an array formula that returns a single value</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;{=SUM(B1:C1*B2:C2)}&#39;</span><span class="p">)</span>

<span class="c1"># Same as above but more verbose.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_array_formula</span><span class="p">(</span><span class="s1">&#39;A2:A2&#39;</span><span class="p">,</span> <span class="s1">&#39;{=SUM(B1:C1*B2:C2)}&#39;</span><span class="p">)</span>

<span class="c1"># Write an array formula that returns a range of values</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_array_formula</span><span class="p">(</span><span class="s1">&#39;A5:A7&#39;</span><span class="p">,</span> <span class="s1">&#39;{=TREND(C5:C7,B5:B7)}&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_autofilter"></span><div class="section" id="example-applying-autofilters">
<span id="ex-autofilter"></span><h4>Example: Applying Autofilters</h4>
<p>This program is an example of using autofilters in a worksheet. See
<a class="reference internal" href="index.html#working-with-autofilters"><span class="std std-ref">Working with Autofilters</span></a> for more details.</p>
<img alt="_images/autofilter3.png" src="_images/autofilter3.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of how to create autofilters with XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># An autofilter is a way of adding drop down lists to the headers of a 2D</span>
<span class="c1"># range of worksheet data. This allows users to filter the data based on</span>
<span class="c1"># simple criteria so that some data is shown and some is hidden.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;autofilter.xlsx&#39;</span><span class="p">)</span>

<span class="c1"># Add a worksheet for each autofilter example.</span>
<span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet5</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet6</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Add a bold format for the headers.</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Open a text file with autofilter example data.</span>
<span class="n">textfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;autofilter_data.txt&#39;</span><span class="p">)</span>

<span class="c1"># Read the headers from the first line of the input file.</span>
<span class="n">headers</span> <span class="o">=</span> <span class="n">textfile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>


<span class="c1"># Read the text file and store the field data.</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">textfile</span><span class="p">:</span>
    <span class="c1"># Split the input data based on whitespace.</span>
    <span class="n">row_data</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

    <span class="c1"># Convert the number data from the text file.</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row_data</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">row_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row_data</span><span class="p">)</span>


<span class="c1"># Set up several sheets with the same data.</span>
<span class="k">for</span> <span class="n">worksheet</span> <span class="ow">in</span> <span class="p">(</span><span class="n">workbook</span><span class="o">.</span><span class="n">worksheets</span><span class="p">()):</span>
    <span class="c1"># Make the columns wider.</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:D&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
    <span class="c1"># Make the header row larger.</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
    <span class="c1"># Make the headers bold.</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 1. Autofilter without conditions.</span>
<span class="c1">#</span>

<span class="c1"># Set the autofilter.</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">autofilter</span><span class="p">(</span><span class="s1">&#39;A1:D51&#39;</span><span class="p">)</span>

<span class="n">row</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">worksheet1</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

    <span class="c1"># Move on to the next worksheet row.</span>
    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># Example 2. Autofilter with a filter condition in the first column.</span>
<span class="c1">#</span>

<span class="c1"># Autofilter range using Row-Column notation.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">autofilter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="c1"># Add filter criteria. The placeholder &quot;Region&quot; in the filter is</span>
<span class="c1"># ignored and can be any string that adds clarity to the expression.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">filter_column</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Region == East&#39;</span><span class="p">)</span>

<span class="c1"># Hide the rows that don&#39;t match the filter criteria.</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">region</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Check for rows that match the filter.</span>
    <span class="k">if</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;East&#39;</span><span class="p">:</span>
        <span class="c1"># Row matches the filter, no further action required.</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># We need to hide rows that don&#39;t match the filter.</span>
        <span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

    <span class="n">worksheet2</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

    <span class="c1"># Move on to the next worksheet row.</span>
    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># Example 3. Autofilter with a dual filter condition in one of the columns.</span>
<span class="c1">#</span>

<span class="c1"># Set the autofilter.</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">autofilter</span><span class="p">(</span><span class="s1">&#39;A1:D51&#39;</span><span class="p">)</span>

<span class="c1"># Add filter criteria.</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">filter_column</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;x == East or x == South&#39;</span><span class="p">)</span>

<span class="c1"># Hide the rows that don&#39;t match the filter criteria.</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">region</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Check for rows that match the filter.</span>
    <span class="k">if</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;East&#39;</span> <span class="ow">or</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;South&#39;</span><span class="p">:</span>
        <span class="c1"># Row matches the filter, no further action required.</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># We need to hide rows that don&#39;t match the filter.</span>
        <span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

    <span class="n">worksheet3</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

    <span class="c1"># Move on to the next worksheet row.</span>
    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># Example 4. Autofilter with filter conditions in two columns.</span>
<span class="c1">#</span>

<span class="c1"># Set the autofilter.</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">autofilter</span><span class="p">(</span><span class="s1">&#39;A1:D51&#39;</span><span class="p">)</span>

<span class="c1"># Add filter criteria.</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">filter_column</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;x == East&#39;</span><span class="p">)</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">filter_column</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;x &gt; 3000 and x &lt; 8000&#39;</span><span class="p">)</span>

<span class="c1"># Hide the rows that don&#39;t match the filter criteria.</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">region</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">volume</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">row_data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

    <span class="c1"># Check for rows that match the filter.</span>
    <span class="k">if</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;East&#39;</span> <span class="ow">and</span> <span class="n">volume</span> <span class="o">&gt;</span> <span class="mi">3000</span> <span class="ow">and</span> <span class="n">volume</span> <span class="o">&lt;</span> <span class="mi">8000</span><span class="p">:</span>
        <span class="c1"># Row matches the filter, no further action required.</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># We need to hide rows that don&#39;t match the filter.</span>
        <span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

    <span class="n">worksheet4</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

    <span class="c1"># Move on to the next worksheet row.</span>
    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># Example 5. Autofilter with filter for blanks.</span>
<span class="c1">#</span>
<span class="c1"># Create a blank cell in our test data.</span>

<span class="c1"># Set the autofilter.</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">autofilter</span><span class="p">(</span><span class="s1">&#39;A1:D51&#39;</span><span class="p">)</span>

<span class="c1"># Add filter criteria.</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">filter_column</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;x == Blanks&#39;</span><span class="p">)</span>

<span class="c1"># Simulate a blank cell in the data.</span>
<span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

<span class="c1"># Hide the rows that don&#39;t match the filter criteria.</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">region</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Check for rows that match the filter.</span>
    <span class="k">if</span> <span class="n">region</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="c1"># Row matches the filter, no further action required.</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># We need to hide rows that don&#39;t match the filter.</span>
        <span class="n">worksheet5</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

    <span class="n">worksheet5</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

    <span class="c1"># Move on to the next worksheet row.</span>
    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># Example 6. Autofilter with filter for non-blanks.</span>
<span class="c1">#</span>

<span class="c1"># Set the autofilter.</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">autofilter</span><span class="p">(</span><span class="s1">&#39;A1:D51&#39;</span><span class="p">)</span>

<span class="c1"># Add filter criteria.</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">filter_column</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;x == NonBlanks&#39;</span><span class="p">)</span>

<span class="c1"># Hide the rows that don&#39;t match the filter criteria.</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">region</span> <span class="o">=</span> <span class="n">row_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Check for rows that match the filter.</span>
    <span class="k">if</span> <span class="n">region</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="c1"># Row matches the filter, no further action required.</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># We need to hide rows that don&#39;t match the filter.</span>
        <span class="n">worksheet6</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

    <span class="n">worksheet6</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

    <span class="c1"># Move on to the next worksheet row.</span>
    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_data_validate"></span><div class="section" id="example-data-validation-and-drop-down-lists">
<span id="ex-data-valid"></span><h4>Example: Data Validation and Drop Down Lists</h4>
<p>Example of how to add data validation and drop down lists to an XlsxWriter
file. Data validation is a way of limiting user input to certain ranges
or to allow a selection from a drop down list.</p>
<img alt="_images/data_validate1.png" src="_images/data_validate1.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of how to add data validation and dropdown lists to an</span>
<span class="c1"># XlsxWriter file.</span>
<span class="c1">#</span>
<span class="c1"># Data validation is a feature of Excel which allows you to restrict</span>
<span class="c1"># the data that a user enters in a cell and to display help and</span>
<span class="c1"># warning messages. It also allows you to restrict input to values in</span>
<span class="c1"># a drop down list.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">date</span><span class="p">,</span> <span class="n">time</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;data_validate.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Add a format for the header cells.</span>
<span class="n">header_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#C6EFCE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
    <span class="s1">&#39;indent&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Set up layout of the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">68</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:B&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;D:D&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">36</span><span class="p">)</span>

<span class="c1"># Write the header cells and some data that will be used in the examples.</span>
<span class="n">heading1</span> <span class="o">=</span> <span class="s1">&#39;Some examples of data validation in XlsxWriter&#39;</span>
<span class="n">heading2</span> <span class="o">=</span> <span class="s1">&#39;Enter values in this column&#39;</span>
<span class="n">heading3</span> <span class="o">=</span> <span class="s1">&#39;Sample Data&#39;</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">heading1</span><span class="p">,</span> <span class="n">header_format</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">heading2</span><span class="p">,</span> <span class="n">header_format</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="n">heading3</span><span class="p">,</span> <span class="n">header_format</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;D3&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Integers&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;D4&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;List data&#39;</span><span class="p">,</span> <span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;D5&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Formula&#39;</span><span class="p">,</span> <span class="s1">&#39;=AND(F5=50,G5=60)&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>


<span class="c1"># Example 1. Limiting input to an integer in a fixed range.</span>
<span class="c1">#</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;Enter an integer between 1 and 10&#39;</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                 <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>


<span class="c1"># Example 2. Limiting input to an integer outside a fixed range.</span>
<span class="c1">#</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;Enter an integer that is not between 1 and 10 (using cell references)&#39;</span>


<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;not between&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="s1">&#39;=E3&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="s1">&#39;=F3&#39;</span><span class="p">})</span>


<span class="c1"># Example 3. Limiting input to an integer greater than a fixed value.</span>
<span class="c1">#</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;Enter an integer greater than 0&#39;</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>


<span class="c1"># Example 4. Limiting input to an integer less than a fixed value.</span>
<span class="c1">#</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;Enter an integer less than 10&#39;</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A9&#39;</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B9&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>


<span class="c1"># Example 5. Limiting input to a decimal in a fixed range.</span>
<span class="c1">#</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;Enter a decimal between 0.1 and 0.5&#39;</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A11&#39;</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B11&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;decimal&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
                                  <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>


<span class="c1"># Example 6. Limiting input to a value in a dropdown list.</span>
<span class="c1">#</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;Select a value from a drop down list&#39;</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A13&#39;</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B13&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;open&#39;</span><span class="p">,</span> <span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="s1">&#39;close&#39;</span><span class="p">]})</span>


<span class="c1"># Example 7. Limiting input to a value in a dropdown list.</span>
<span class="c1">#</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;Select a value from a drop down list (using a cell range)&#39;</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A15&#39;</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B15&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;=$E$4:$G$4&#39;</span><span class="p">})</span>


<span class="c1"># Example 8. Limiting input to a date in a fixed range.</span>
<span class="c1">#</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;Enter a date between 1/1/2013 and 12/12/2013&#39;</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A17&#39;</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B17&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                                  <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">)})</span>


<span class="c1"># Example 9. Limiting input to a time in a fixed range.</span>
<span class="c1">#</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;Enter a time between 6:00 and 12:00&#39;</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A19&#39;</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B19&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="n">time</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                                  <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="n">time</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">)})</span>


<span class="c1"># Example 10. Limiting input to a string greater than a fixed length.</span>
<span class="c1">#</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;Enter a string longer than 3 characters&#39;</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A21&#39;</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B21&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;length&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>


<span class="c1"># Example 11. Limiting input based on a formula.</span>
<span class="c1">#</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;Enter a value if the following is true &quot;=AND(F5=50,G5=60)&quot;&#39;</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A23&#39;</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B23&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;custom&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=AND(F5=50,G5=60)&#39;</span><span class="p">})</span>


<span class="c1"># Example 12. Displaying and modifying data validation messages.</span>
<span class="c1">#</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s1">&#39;Displays a message when you select the cell&#39;</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A25&#39;</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B25&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                  <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                                  <span class="s1">&#39;input_title&#39;</span><span class="p">:</span> <span class="s1">&#39;Enter an integer:&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;input_message&#39;</span><span class="p">:</span> <span class="s1">&#39;between 1 and 100&#39;</span><span class="p">})</span>


<span class="c1"># Example 13. Displaying and modifying data validation messages.</span>
<span class="c1">#</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;Display a custom error message when integer isn&#39;t between 1 and 100&quot;</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A27&#39;</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B27&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                  <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                                  <span class="s1">&#39;input_title&#39;</span><span class="p">:</span> <span class="s1">&#39;Enter an integer:&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;input_message&#39;</span><span class="p">:</span> <span class="s1">&#39;between 1 and 100&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;error_title&#39;</span><span class="p">:</span> <span class="s1">&#39;Input value is not valid!&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;error_message&#39;</span><span class="p">:</span>
                                  <span class="s1">&#39;It should be an integer between 1 and 100&#39;</span><span class="p">})</span>


<span class="c1"># Example 14. Displaying and modifying data validation messages.</span>
<span class="c1">#</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;Display a custom info message when integer isn&#39;t between 1 and 100&quot;</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A29&#39;</span><span class="p">,</span> <span class="n">txt</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">data_validation</span><span class="p">(</span><span class="s1">&#39;B29&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;validate&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                                  <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
                                  <span class="s1">&#39;input_title&#39;</span><span class="p">:</span> <span class="s1">&#39;Enter an integer:&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;input_message&#39;</span><span class="p">:</span> <span class="s1">&#39;between 1 and 100&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;error_title&#39;</span><span class="p">:</span> <span class="s1">&#39;Input value is not valid!&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;error_message&#39;</span><span class="p">:</span>
                                  <span class="s1">&#39;It should be an integer between 1 and 100&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;error_type&#39;</span><span class="p">:</span> <span class="s1">&#39;information&#39;</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_conditional_format"></span><div class="section" id="example-conditional-formatting">
<span id="ex-cond-format"></span><h4>Example: Conditional Formatting</h4>
<p>Example of how to add conditional formatting to an XlsxWriter file.
Conditional formatting allows you to apply a format to a cell or a
range of cells based on certain criteria.</p>
<img alt="_images/conditional_format1.png" src="_images/conditional_format1.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of how to add conditional formatting to an XlsxWriter file.</span>
<span class="c1">#</span>
<span class="c1"># Conditional formatting allows you to apply a format to a cell or a</span>
<span class="c1"># range of cells based on certain criteria.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;conditional_format.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet5</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet6</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet7</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet8</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet9</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Add a format. Light red fill with dark red text.</span>
<span class="n">format1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#FFC7CE&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#9C0006&#39;</span><span class="p">})</span>

<span class="c1"># Add a format. Green fill with dark green text.</span>
<span class="n">format2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#C6EFCE&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;font_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#006100&#39;</span><span class="p">})</span>

<span class="c1"># Some sample data to run the conditional formatting against.</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">34</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">86</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">59</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">28</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">14</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">27</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">47</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">88</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">36</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">88</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">48</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">52</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">36</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">55</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">70</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">21</span><span class="p">],</span>
<span class="p">]</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 1.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Cells with values &gt;= 50 are in light red. &#39;</span>
           <span class="s1">&#39;Values &lt; 50 are in light green.&#39;</span><span class="p">)</span>

<span class="c1"># Write the data.</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">worksheet1</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

<span class="c1"># Write a conditional format over a range.</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                                         <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>

<span class="c1"># Write another conditional format over the same range.</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                                         <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format2</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 2.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Values between 30 and 70 are in light red. &#39;</span>
           <span class="s1">&#39;Values outside that range are in light green.&#39;</span><span class="p">)</span>

<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">worksheet2</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

<span class="n">worksheet2</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;between&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
                                         <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span>
                                         <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>

<span class="n">worksheet2</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;not between&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;minimum&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
                                         <span class="s1">&#39;maximum&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span>
                                         <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format2</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 3.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Duplicate values are in light red. &#39;</span>
           <span class="s1">&#39;Unique values are in light green.&#39;</span><span class="p">)</span>

<span class="n">worksheet3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">worksheet3</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

<span class="n">worksheet3</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;duplicate&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>

<span class="n">worksheet3</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;unique&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format2</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 4.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Above average values are in light red. &#39;</span>
           <span class="s1">&#39;Below average values are in light green.&#39;</span><span class="p">)</span>

<span class="n">worksheet4</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">worksheet4</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

<span class="n">worksheet4</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;above&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>

<span class="n">worksheet4</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;average&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;below&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format2</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 5.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Top 10 values are in light red. &#39;</span>
           <span class="s1">&#39;Bottom 10 values are in light green.&#39;</span><span class="p">)</span>

<span class="n">worksheet5</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">worksheet5</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

<span class="n">worksheet5</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">})</span>

<span class="n">worksheet5</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format2</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 6.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Cells with values &gt;= 50 are in light red. &#39;</span>
           <span class="s1">&#39;Values &lt; 50 are in light green. Non-contiguous ranges.&#39;</span><span class="p">)</span>

<span class="c1"># Write the data.</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">worksheet6</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

<span class="c1"># Write a conditional format over a range.</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K6&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format1</span><span class="p">,</span>
                                        <span class="s1">&#39;multi_range&#39;</span><span class="p">:</span> <span class="s1">&#39;B3:K6 B9:K12&#39;</span><span class="p">})</span>

<span class="c1"># Write another conditional format over the same range.</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:K6&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;cell&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;criteria&#39;</span><span class="p">:</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">,</span>
                                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">format2</span><span class="p">,</span>
                                        <span class="s1">&#39;multi_range&#39;</span><span class="p">:</span> <span class="s1">&#39;B3:K6 B9:K12&#39;</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 7.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Examples of color scales with default and user colors.&#39;</span>

<span class="n">data</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>

<span class="n">worksheet7</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="n">worksheet7</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s2">&quot;2 Color Scale&quot;</span><span class="p">)</span>
<span class="n">worksheet7</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s2">&quot;2 Color Scale + user colors&quot;</span><span class="p">)</span>

<span class="n">worksheet7</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;G2&#39;</span><span class="p">,</span> <span class="s2">&quot;3 Color Scale&quot;</span><span class="p">)</span>
<span class="n">worksheet7</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;I2&#39;</span><span class="p">,</span> <span class="s2">&quot;3 Color Scale + user colors&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">worksheet7</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>
    <span class="n">worksheet7</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>
    <span class="n">worksheet7</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>
    <span class="n">worksheet7</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

<span class="n">worksheet7</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:B14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;2_color_scale&#39;</span><span class="p">})</span>

<span class="n">worksheet7</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;D3:D14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;2_color_scale&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;min_color&#39;</span><span class="p">:</span> <span class="s2">&quot;#FF0000&quot;</span><span class="p">,</span>
                                         <span class="s1">&#39;max_color&#39;</span><span class="p">:</span> <span class="s2">&quot;#00FF00&quot;</span><span class="p">})</span>

<span class="n">worksheet7</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;G3:G14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;3_color_scale&#39;</span><span class="p">})</span>

<span class="n">worksheet7</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;I3:I14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;3_color_scale&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;min_color&#39;</span><span class="p">:</span> <span class="s2">&quot;#C5D9F1&quot;</span><span class="p">,</span>
                                         <span class="s1">&#39;mid_color&#39;</span><span class="p">:</span> <span class="s2">&quot;#8DB4E3&quot;</span><span class="p">,</span>
                                         <span class="s1">&#39;max_color&#39;</span><span class="p">:</span> <span class="s2">&quot;#538ED5&quot;</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 8.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Examples of data bars.&#39;</span>

<span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s2">&quot;Default data bars&quot;</span><span class="p">)</span>
<span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s2">&quot;Bars only&quot;</span><span class="p">)</span>
<span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;F2&#39;</span><span class="p">,</span> <span class="s2">&quot;With user color&quot;</span><span class="p">)</span>
<span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;H2&#39;</span><span class="p">,</span> <span class="s2">&quot;Solid bars&quot;</span><span class="p">)</span>
<span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;J2&#39;</span><span class="p">,</span> <span class="s2">&quot;Right to left&quot;</span><span class="p">)</span>
<span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;L2&#39;</span><span class="p">,</span> <span class="s2">&quot;Excel 2010 style&quot;</span><span class="p">)</span>
<span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;N2&#39;</span><span class="p">,</span> <span class="s2">&quot;Negative same as positive&quot;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>
    <span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>
    <span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>
    <span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>
    <span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>
    <span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

<span class="n">worksheet8</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:B14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">})</span>

<span class="n">worksheet8</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;D3:D14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;bar_only&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet8</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;F3:F14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;bar_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#63C384&#39;</span><span class="p">})</span>

<span class="n">worksheet8</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;H3:H14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;bar_solid&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet8</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;J3:J14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;bar_direction&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">})</span>

<span class="n">worksheet8</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;L3:L14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;data_bar_2010&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet8</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;M3:N14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;data_bar&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;bar_negative_color_same&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                         <span class="s1">&#39;bar_negative_border_color_same&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 9.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Examples of conditional formats with icon sets.&#39;</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet9</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">worksheet9</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

<span class="n">worksheet9</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B3:D3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;icon_set&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;icon_style&#39;</span><span class="p">:</span> <span class="s1">&#39;3_traffic_lights&#39;</span><span class="p">})</span>

<span class="n">worksheet9</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B4:D4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;icon_set&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;icon_style&#39;</span><span class="p">:</span> <span class="s1">&#39;3_traffic_lights&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;reverse_icons&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet9</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B5:D5&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;icon_set&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;icon_style&#39;</span><span class="p">:</span> <span class="s1">&#39;3_traffic_lights&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;icons_only&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet9</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B6:D6&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;icon_set&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;icon_style&#39;</span><span class="p">:</span> <span class="s1">&#39;3_arrows&#39;</span><span class="p">})</span>

<span class="n">worksheet9</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B7:E8&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;icon_set&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;icon_style&#39;</span><span class="p">:</span> <span class="s1">&#39;4_arrows&#39;</span><span class="p">})</span>

<span class="n">worksheet9</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B8:F8&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;icon_set&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;icon_style&#39;</span><span class="p">:</span> <span class="s1">&#39;5_arrows&#39;</span><span class="p">})</span>

<span class="n">worksheet9</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B9:F9&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;icon_set&#39;</span><span class="p">,</span>
                                        <span class="s1">&#39;icon_style&#39;</span><span class="p">:</span> <span class="s1">&#39;5_ratings&#39;</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_defined_name"></span><div class="section" id="example-defined-names-named-ranges">
<span id="ex-defined-name"></span><h4>Example: Defined names/Named ranges</h4>
<p>Example of how to create defined names (named ranges) with XlsxWriter.</p>
<p>Defined names are used to define descriptive names to represent a value, a
single cell or a range of cells in a workbook or worksheet. See
<a class="reference internal" href="index.html#define_name" title="define_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">define_name()</span></code></a>.</p>
<img alt="_images/defined_name.png" src="_images/defined_name.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of how to create defined names with the XlsxWriter Python module.</span>
<span class="c1">#</span>
<span class="c1"># This method is used to define a user friendly name to represent a value,</span>
<span class="c1"># a single cell or a range of cells in a workbook.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>


<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;defined_name.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Define some global/workbook names.</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">define_name</span><span class="p">(</span><span class="s1">&#39;Exchange_rate&#39;</span><span class="p">,</span> <span class="s1">&#39;=0.96&#39;</span><span class="p">)</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">define_name</span><span class="p">(</span><span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;=Sheet1!$G$1:$H$10&#39;</span><span class="p">)</span>

<span class="c1"># Define a local/worksheet name. Over-rides the &quot;Sales&quot; name above.</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">define_name</span><span class="p">(</span><span class="s1">&#39;Sheet2!Sales&#39;</span><span class="p">,</span> <span class="s1">&#39;=Sheet2!$G$1:$G$10&#39;</span><span class="p">)</span>

<span class="c1"># Write some text in the file and one of the defined names in a formula.</span>
<span class="k">for</span> <span class="n">worksheet</span> <span class="ow">in</span> <span class="n">workbook</span><span class="o">.</span><span class="n">worksheets</span><span class="p">():</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;This worksheet contains some defined names.&#39;</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;See Formulas -&gt; Name Manager above.&#39;</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="s1">&#39;Example formula in cell B3 -&gt;&#39;</span><span class="p">)</span>

    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;=Exchange_rate&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_merge1"></span><div class="section" id="example-merging-cells">
<span id="ex-merge1"></span><h4>Example: Merging Cells</h4>
<p>This program is an example of merging cells in a worksheet. See the
<a class="reference internal" href="index.html#merge_range" title="merge_range"><code class="xref py py-func docutils literal notranslate"><span class="pre">merge_range()</span></code></a> method for more details.</p>
<img alt="_images/merge1.png" src="_images/merge1.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># A simple example of merging cells with the XlsxWriter Python module.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>


<span class="c1"># Create an new Excel file and add a worksheet.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;merge1.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Increase the cell size of the merged cells to highlight the formatting.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:D&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>


<span class="c1"># Create a format to use in the merged range.</span>
<span class="n">merge_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
    <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
    <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">})</span>


<span class="c1"># Merge 3 cells.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="s1">&#39;B4:D4&#39;</span><span class="p">,</span> <span class="s1">&#39;Merged Range&#39;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>

<span class="c1"># Merge 3 cells over two rows.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="s1">&#39;B7:D8&#39;</span><span class="p">,</span> <span class="s1">&#39;Merged Range&#39;</span><span class="p">,</span> <span class="n">merge_format</span><span class="p">)</span>


<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_rich_strings"></span><div class="section" id="example-writing-rich-strings-with-multiple-formats">
<span id="ex-rich-strings"></span><h4>Example: Writing “Rich” strings with multiple formats</h4>
<p>This program is an example of writing rich stings with multiple format to a
cell in a worksheet. See the <a class="reference internal" href="index.html#write_rich_string" title="write_rich_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_rich_string()</span></code></a> method for more details.</p>
<img alt="_images/rich_strings.png" src="_images/rich_strings.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of using Python and XlsxWriter to write some &quot;rich strings&quot;,</span>
<span class="c1"># i.e., strings with multiple formats.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;rich_strings.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="c1"># Set up some formats to use.</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">italic</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;italic&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">red</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">})</span>
<span class="n">blue</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">})</span>
<span class="n">center</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">})</span>
<span class="n">superscript</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;font_script&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Write some strings with multiple formats.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_rich_string</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;This is &#39;</span><span class="p">,</span>
                            <span class="n">bold</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span>
                            <span class="s1">&#39; and this is &#39;</span><span class="p">,</span>
                            <span class="n">italic</span><span class="p">,</span> <span class="s1">&#39;italic&#39;</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_rich_string</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;This is &#39;</span><span class="p">,</span>
                            <span class="n">red</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                            <span class="s1">&#39; and this is &#39;</span><span class="p">,</span>
                            <span class="n">blue</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_rich_string</span><span class="p">(</span><span class="s1">&#39;A5&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Some &#39;</span><span class="p">,</span>
                            <span class="n">bold</span><span class="p">,</span> <span class="s1">&#39;bold text&#39;</span><span class="p">,</span>
                            <span class="s1">&#39; centered&#39;</span><span class="p">,</span>
                            <span class="n">center</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_rich_string</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span>
                            <span class="n">italic</span><span class="p">,</span>
                            <span class="s1">&#39;j = k&#39;</span><span class="p">,</span>
                            <span class="n">superscript</span><span class="p">,</span> <span class="s1">&#39;(n-1)&#39;</span><span class="p">,</span>
                            <span class="n">center</span><span class="p">)</span>

<span class="c1"># If you have formats and segments in a list you can add them like this:</span>
<span class="n">segments</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;This is &#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="s1">&#39; and this is &#39;</span><span class="p">,</span> <span class="n">blue</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_rich_string</span><span class="p">(</span><span class="s1">&#39;A9&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">segments</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_merge_rich"></span><div class="section" id="example-merging-cells-with-a-rich-string">
<span id="ex-merge-rich"></span><h4>Example: Merging Cells with a Rich String</h4>
<p>This program is an example of merging cells that contain a rich string.</p>
<p>Using the standard XlsxWriter API we can only write simple types to merged
ranges so we first write a blank string to the merged range. We then overwrite
the first merged cell with a rich string.</p>
<p>Note that we must also pass the cell format used in the merged cells format at
the end</p>
<p>See the <a class="reference internal" href="index.html#merge_range" title="merge_range"><code class="xref py py-func docutils literal notranslate"><span class="pre">merge_range()</span></code></a> and <a class="reference internal" href="index.html#write_rich_string" title="write_rich_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_rich_string()</span></code></a> methods for more
details.</p>
<img alt="_images/merge_rich.png" src="_images/merge_rich.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An  example of merging cells which contain a rich string using the</span>
<span class="c1"># XlsxWriter Python module.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>


<span class="c1"># Create an new Excel file and add a worksheet.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;merge_rich_string.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Set up some formats to use.</span>
<span class="n">red</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">})</span>
<span class="n">blue</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">})</span>
<span class="n">cell_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
                                   <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># We can only write simple types to merged ranges so we write a blank string.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">merge_range</span><span class="p">(</span><span class="s1">&#39;B2:E5&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">cell_format</span><span class="p">)</span>

<span class="c1"># We then overwrite the first merged cell with a rich string. Note that we</span>
<span class="c1"># must also pass the cell format used in the merged cells format at the end.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_rich_string</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;This is &#39;</span><span class="p">,</span>
                            <span class="n">red</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                            <span class="s1">&#39; and this is &#39;</span><span class="p">,</span>
                            <span class="n">blue</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span>
                            <span class="n">cell_format</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_images"></span><div class="section" id="example-inserting-images-into-a-worksheet">
<span id="ex-insert-image"></span><h4>Example: Inserting images into a worksheet</h4>
<p>This program is an example of inserting images into a worksheet. See the
<a class="reference internal" href="index.html#insert_image" title="insert_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_image()</span></code></a> method for more details.</p>
<img alt="_images/images.png" src="_images/images.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of inserting images into a worksheet using the XlsxWriter</span>
<span class="c1"># Python module.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>


<span class="c1"># Create an new Excel file and add a worksheet.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;images.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Widen the first column to make the text clearer.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="c1"># Insert an image.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;Insert an image in a cell:&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;python.png&#39;</span><span class="p">)</span>

<span class="c1"># Insert an image offset in the cell.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A12&#39;</span><span class="p">,</span> <span class="s1">&#39;Insert an image with an offset:&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B12&#39;</span><span class="p">,</span> <span class="s1">&#39;python.png&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1"># Insert an image with scaling.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A23&#39;</span><span class="p">,</span> <span class="s1">&#39;Insert a scaled image:&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B23&#39;</span><span class="p">,</span> <span class="s1">&#39;python.png&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_scale&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;y_scale&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_images_bytesio"></span><div class="section" id="example-inserting-images-from-a-url-or-byte-stream-into-a-worksheet">
<span id="ex-images-bytesio"></span><h4>Example: Inserting images from a URL or byte stream into a worksheet</h4>
<p>This program is an example of inserting images from a Python
<a class="reference external" href="https://docs.python.org/3/library/io.html#io.BytesIO" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">io.BytesIO</span></code></a> byte stream into a worksheet.</p>
<p>The example byte streams are populated from a URL and from a local file.</p>
<p>See the <a class="reference internal" href="index.html#insert_image" title="insert_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_image()</span></code></a> method for more details.</p>
<img alt="_images/images_bytesio.png" src="_images/images_bytesio.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of inserting images from a Python BytesIO byte stream into a</span>
<span class="c1"># worksheet using the XlsxWriter module.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="c1"># Import the byte stream handler.</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="k">import</span> <span class="n">BytesIO</span>

<span class="c1"># Import urlopen() for either Python 2 or 3.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">urllib.request</span> <span class="k">import</span> <span class="n">urlopen</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">urllib2</span> <span class="k">import</span> <span class="n">urlopen</span>


<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="c1"># Create the workbook and add a worksheet.</span>
<span class="n">workbook</span>  <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;images_bytesio.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>


<span class="c1"># Read an image from a remote url.</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/jmcnamara/XlsxWriter/&#39;</span> <span class="o">+</span> \
      <span class="s1">&#39;master/examples/logo.png&#39;</span>

<span class="n">image_data</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>

<span class="c1"># Write the byte stream image to a cell. Note, the filename must be</span>
<span class="c1"># specified. In this case it will be read from url string.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;image_data&#39;</span><span class="p">:</span> <span class="n">image_data</span><span class="p">})</span>


<span class="c1"># Read a local image file into a a byte stream. Note, the insert_image()</span>
<span class="c1"># method can do this directly. This is for illustration purposes only.</span>
<span class="n">filename</span>   <span class="o">=</span> <span class="s1">&#39;python.png&#39;</span>

<span class="n">image_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span>
<span class="n">image_data</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">image_file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="n">image_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="c1"># Write the byte stream image to a cell. The filename must  be specified.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_image</span><span class="p">(</span><span class="s1">&#39;B8&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;image_data&#39;</span><span class="p">:</span> <span class="n">image_data</span><span class="p">})</span>


<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_right_to_left"></span><div class="section" id="example-left-to-right-worksheets-and-text">
<span id="ex-right-to-left"></span><h4>Example: Left to Right worksheets and text</h4>
<p>Example of how to use Python and the XlsxWriter module to change the default
worksheet and cell text direction from left-to-right to right-to-left as
required by some middle eastern versions of Excel.</p>
<p>Note, this a Python2 unicode version. Remove the <code class="docutils literal notranslate"><span class="pre">u''</span></code> to make this work
with Python3. See also the <a class="reference internal" href="index.html#ex-http-server3"><span class="std std-ref">unicode_python3.py</span></a>.</p>
<img alt="_images/right_to_left.png" src="_images/right_to_left.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1"># _*_ coding: utf-8</span>
<span class="c1">#</span>
<span class="c1"># Example of how to use Python and the XlsxWriter module to change the default</span>
<span class="c1"># worksheet and cell text direction from left-to-right to right-to-left as</span>
<span class="c1"># required by some middle eastern versions of Excel.</span>
<span class="c1">#</span>
<span class="c1"># Note, this a Python2 unicode version. Remove the u&#39;&#39; to make this work with</span>
<span class="c1"># Python3. See also the unicode_python3.py example.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;right_to_left.xlsx&#39;</span><span class="p">)</span>

<span class="c1"># Add two worksheets.</span>
<span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Add the cell formats.</span>
<span class="n">format_left_to_right</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;reading_order&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">format_right_to_left</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;reading_order&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>

<span class="c1"># Make the columns wider for clarity.</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>

<span class="c1"># Change the direction for worksheet2.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">right_to_left</span><span class="p">()</span>

<span class="c1"># Write some data to show the difference.</span>

<span class="c1"># Standard direction:         | A1 | B1 | C1 | ...</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;نص عربي / English text&#39;</span><span class="p">)</span>  <span class="c1"># Default direction.</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;نص عربي / English text&#39;</span><span class="p">,</span> <span class="n">format_left_to_right</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;نص عربي / English text&#39;</span><span class="p">,</span> <span class="n">format_right_to_left</span><span class="p">)</span>

<span class="c1"># Right to left direction:    ... | C1 | B1 | A1 |</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;نص عربي / English text&#39;</span><span class="p">)</span>  <span class="c1"># Default direction.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;نص عربي / English text&#39;</span><span class="p">,</span> <span class="n">format_left_to_right</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;نص عربي / English text&#39;</span><span class="p">,</span> <span class="n">format_right_to_left</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_django_simple"></span><div class="section" id="example-simple-django-class">
<span id="ex-django-simple"></span><h4>Example: Simple Django class</h4>
<p>A simple Django View class to write an Excel file using the XlsxWriter module.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># A simple Django view class to write an Excel file using the XlsxWriter</span>
<span class="c1"># module.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">from</span> <span class="nn">django.http</span> <span class="k">import</span> <span class="n">HttpResponse</span>
<span class="kn">from</span> <span class="nn">django.views.generic</span> <span class="k">import</span> <span class="n">View</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>


<span class="k">def</span> <span class="nf">get_simple_table_data</span><span class="p">():</span>
    <span class="c1"># Simulate a more complex table read.</span>
    <span class="k">return</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
            <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]</span>


<span class="k">class</span> <span class="nc">MyView</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>

        <span class="c1"># Create an in-memory output file for the new workbook.</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>

        <span class="c1"># Even though the final file will be in memory the module uses temp</span>
        <span class="c1"># files during assembly for efficiency. To avoid this on servers that</span>
        <span class="c1"># don&#39;t allow temp files, for example the Google APP Engine, set the</span>
        <span class="c1"># &#39;in_memory&#39; Workbook() constructor option as shown in the docs.</span>
        <span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

        <span class="c1"># Get some data to write to the spreadsheet.</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">get_simple_table_data</span><span class="p">()</span>

        <span class="c1"># Write some test data.</span>
        <span class="k">for</span> <span class="n">row_num</span><span class="p">,</span> <span class="n">columns</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">cell_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row_num</span><span class="p">,</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">cell_data</span><span class="p">)</span>

        <span class="c1"># Close the workbook before sending the data.</span>
        <span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># Rewind the buffer.</span>
        <span class="n">output</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Set up the Http response.</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;django_simple.xlsx&#39;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">HttpResponse</span><span class="p">(</span>
            <span class="n">output</span><span class="p">,</span>
            <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;</span>
        <span class="p">)</span>
        <span class="n">response</span><span class="p">[</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;attachment; filename=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">filename</span>

        <span class="k">return</span> <span class="n">response</span>
</pre></div>
</div>
</div>
<span id="document-example_http_server"></span><div class="section" id="example-simple-http-server-python-2">
<span id="ex-http-server"></span><h4>Example: Simple HTTP Server (Python 2)</h4>
<p>Example of using Python and XlsxWriter to create an Excel XLSX file in an in
memory string suitable for serving via SimpleHTTPServer or Django or with the
Google App Engine.</p>
<p>Even though the final file will be in memory, via the BytesIO object, the
module uses temp files during assembly for efficiency. To avoid this on
servers that don’t allow temp files, for example the Google APP Engine, set
the <code class="docutils literal notranslate"><span class="pre">in_memory</span></code> constructor option to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>For a Python 3 example see <a class="reference internal" href="index.html#ex-http-server3"><span class="std std-ref">Example: Simple HTTP Server (Python 3)</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of using Python and XlsxWriter to create an Excel XLSX file in an in</span>
<span class="c1"># memory string suitable for serving via SimpleHTTPServer or Django or with</span>
<span class="c1"># the Google App Engine.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="c1"># Note: This is a Python 2 example. For Python 3 see http_server_py3.py.</span>

<span class="kn">import</span> <span class="nn">SimpleHTTPServer</span>
<span class="kn">import</span> <span class="nn">SocketServer</span>
<span class="kn">import</span> <span class="nn">io</span>

<span class="kn">import</span> <span class="nn">xlsxwriter</span>


<span class="k">class</span> <span class="nc">Handler</span><span class="p">(</span><span class="n">SimpleHTTPServer</span><span class="o">.</span><span class="n">SimpleHTTPRequestHandler</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create an in-memory output file for the new workbook.</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>

        <span class="c1"># Even though the final file will be in memory the module uses temp</span>
        <span class="c1"># files during assembly for efficiency. To avoid this on servers that</span>
        <span class="c1"># don&#39;t allow temp files, for example the Google APP Engine, set the</span>
        <span class="c1"># &#39;in_memory&#39; constructor option to True:</span>
        <span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;in_memory&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
        <span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

        <span class="c1"># Write some test data.</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Hello, world!&#39;</span><span class="p">)</span>

        <span class="c1"># Close the workbook before streaming the data.</span>
        <span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># Rewind the buffer.</span>
        <span class="n">output</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Construct a server response.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_response</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_header</span><span class="p">(</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">,</span> <span class="s1">&#39;attachment; filename=test.xlsx&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_header</span><span class="p">(</span><span class="s1">&#39;Content-type&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_headers</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="k">return</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Server listening on port 8000...&#39;</span><span class="p">)</span>
<span class="n">httpd</span> <span class="o">=</span> <span class="n">SocketServer</span><span class="o">.</span><span class="n">TCPServer</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">8000</span><span class="p">),</span> <span class="n">Handler</span><span class="p">)</span>
<span class="n">httpd</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_http_server3"></span><div class="section" id="example-simple-http-server-python-3">
<span id="ex-http-server3"></span><h4>Example: Simple HTTP Server (Python 3)</h4>
<p>Example of using Python and XlsxWriter to create an Excel XLSX file in an in
memory string suitable for serving via SimpleHTTPRequestHandler or Django or with the
Google App Engine.</p>
<p>Even though the final file will be in memory, via the BytesIO object, the
XlsxWriter module uses temp files during assembly for efficiency. To avoid
this on servers that don’t allow temp files set the <code class="docutils literal notranslate"><span class="pre">in_memory</span></code> constructor
option to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<p>The Python 3 Runtime Environment in Google App Engine now supports a
<a class="reference external" href="https://cloud.google.com/appengine/docs/standard/python3/runtime#filesystem">filesystem with read/write access to /tmp</a>
which means that the <code class="docutils literal notranslate"><span class="pre">in_memory</span></code> option isn’t required. The <code class="docutils literal notranslate"><span class="pre">/tmp</span></code> dir
isn’t supported in the Python 2 Runtime Environment so that option is still
required there.</p>
<p>For a Python 2 example see <a class="reference internal" href="index.html#ex-http-server"><span class="std std-ref">Example: Simple HTTP Server (Python 2)</span></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of using Python and XlsxWriter to create an Excel XLSX file in an in</span>
<span class="c1"># memory string suitable for serving via SimpleHTTPRequestHandler or Django or</span>
<span class="c1"># with the Google App Engine.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="c1"># Note: This is a Python 3 example. For Python 2 see http_server_py2.py.</span>

<span class="kn">import</span> <span class="nn">http.server</span>
<span class="kn">import</span> <span class="nn">socketserver</span>
<span class="kn">import</span> <span class="nn">io</span>

<span class="kn">import</span> <span class="nn">xlsxwriter</span>


<span class="k">class</span> <span class="nc">Handler</span><span class="p">(</span><span class="n">http</span><span class="o">.</span><span class="n">server</span><span class="o">.</span><span class="n">SimpleHTTPRequestHandler</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">do_GET</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Create an in-memory output file for the new workbook.</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>

        <span class="c1"># Even though the final file will be in memory the module uses temp</span>
        <span class="c1"># files during assembly for efficiency. To avoid this on servers that</span>
        <span class="c1"># don&#39;t allow temp files set the &#39;in_memory&#39; constructor option to True.</span>
        <span class="c1">#</span>
        <span class="c1"># The Python 3 Runtime Environment in Google App Engine now supports a</span>
        <span class="c1"># filesystem with read/write access to /tmp which means that the</span>
        <span class="c1"># &#39;in_memory&#39; option isn&#39;t required. The /tmp dir isn&#39;t supported in</span>
        <span class="c1"># the Python 2 Runtime Environment so that option is still required</span>
        <span class="c1"># there. See:</span>
        <span class="c1">#</span>
        <span class="c1"># https://cloud.google.com/appengine/docs/standard/python3/runtime#filesystem</span>
        <span class="c1">#</span>
        <span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;in_memory&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
        <span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

        <span class="c1"># Write some test data.</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Hello, world!&#39;</span><span class="p">)</span>

        <span class="c1"># Close the workbook before streaming the data.</span>
        <span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="c1"># Rewind the buffer.</span>
        <span class="n">output</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1"># Construct a server response.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_response</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_header</span><span class="p">(</span><span class="s1">&#39;Content-Disposition&#39;</span><span class="p">,</span> <span class="s1">&#39;attachment; filename=test.xlsx&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send_header</span><span class="p">(</span><span class="s1">&#39;Content-type&#39;</span><span class="p">,</span>
                         <span class="s1">&#39;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_headers</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="k">return</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Server listening on port 8000...&#39;</span><span class="p">)</span>
<span class="n">httpd</span> <span class="o">=</span> <span class="n">socketserver</span><span class="o">.</span><span class="n">TCPServer</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">8000</span><span class="p">),</span> <span class="n">Handler</span><span class="p">)</span>
<span class="n">httpd</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_headers_footers"></span><div class="section" id="example-adding-headers-and-footers-to-worksheets">
<span id="ex-headers-footers"></span><h4>Example: Adding Headers and Footers to Worksheets</h4>
<p>This program is an example of adding headers and footers to worksheets.
See the <a class="reference internal" href="index.html#set_header" title="set_header"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_header()</span></code></a> and <a class="reference internal" href="index.html#set_footer" title="set_footer"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_footer()</span></code></a> methods for more details.</p>
<img alt="_images/header_image.png" src="_images/header_image.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">######################################################################</span>
<span class="c1">#</span>
<span class="c1"># This program shows several examples of how to set up headers and</span>
<span class="c1"># footers with XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># The control characters used in the header/footer strings are:</span>
<span class="c1">#</span>
<span class="c1">#     Control             Category            Description</span>
<span class="c1">#     =======             ========            ===========</span>
<span class="c1">#     &amp;L                  Justification       Left</span>
<span class="c1">#     &amp;C                                      Center</span>
<span class="c1">#     &amp;R                                      Right</span>
<span class="c1">#</span>
<span class="c1">#     &amp;P                  Information         Page number</span>
<span class="c1">#     &amp;N                                      Total number of pages</span>
<span class="c1">#     &amp;D                                      Date</span>
<span class="c1">#     &amp;T                                      Time</span>
<span class="c1">#     &amp;F                                      File name</span>
<span class="c1">#     &amp;A                                      Worksheet name</span>
<span class="c1">#</span>
<span class="c1">#     &amp;fontsize           Font                Font size</span>
<span class="c1">#     &amp;&quot;font,style&quot;                           Font name and style</span>
<span class="c1">#     &amp;U                                      Single underline</span>
<span class="c1">#     &amp;E                                      Double underline</span>
<span class="c1">#     &amp;S                                      Strikethrough</span>
<span class="c1">#     &amp;X                                      Superscript</span>
<span class="c1">#     &amp;Y                                      Subscript</span>
<span class="c1">#</span>
<span class="c1">#     &amp;[Picture]          Images              Image placeholder</span>
<span class="c1">#     &amp;G                                      Same as &amp;[Picture]</span>
<span class="c1">#</span>
<span class="c1">#     &amp;&amp;                  Miscellaneous       Literal ampersand &amp;</span>
<span class="c1">#</span>
<span class="c1"># See the main XlsxWriter documentation for more information.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;headers_footers.xlsx&#39;</span><span class="p">)</span>
<span class="n">preview</span> <span class="o">=</span> <span class="s1">&#39;Select Print Preview to see the header and footer&#39;</span>

<span class="c1">######################################################################</span>
<span class="c1">#</span>
<span class="c1"># A simple example to start</span>
<span class="c1">#</span>
<span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Simple&#39;</span><span class="p">)</span>
<span class="n">header1</span> <span class="o">=</span> <span class="s1">&#39;&amp;CHere is some centered text.&#39;</span>
<span class="n">footer1</span> <span class="o">=</span> <span class="s1">&#39;&amp;LHere is some left aligned text.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="n">header1</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_footer</span><span class="p">(</span><span class="n">footer1</span><span class="p">)</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">preview</span><span class="p">)</span>


<span class="c1">######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Insert a header image.</span>
<span class="c1">#</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Image&#39;</span><span class="p">)</span>
<span class="n">header2</span> <span class="o">=</span> <span class="s1">&#39;&amp;L&amp;G&#39;</span>

<span class="c1"># Adjust the page top margin to allow space for the header image.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_margins</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">1.3</span><span class="p">)</span>

<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="n">header2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;image_left&#39;</span><span class="p">:</span> <span class="s1">&#39;python-200x80.png&#39;</span><span class="p">})</span>

<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">preview</span><span class="p">)</span>


<span class="c1">######################################################################</span>
<span class="c1">#</span>
<span class="c1"># This is an example of some of the header/footer variables.</span>
<span class="c1">#</span>
<span class="n">worksheet3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Variables&#39;</span><span class="p">)</span>
<span class="n">header3</span> <span class="o">=</span> <span class="s1">&#39;&amp;LPage &amp;P of &amp;N&#39;</span> <span class="o">+</span> <span class="s1">&#39;&amp;CFilename: &amp;F&#39;</span> <span class="o">+</span> <span class="s1">&#39;&amp;RSheetname: &amp;A&#39;</span>
<span class="n">footer3</span> <span class="o">=</span> <span class="s1">&#39;&amp;LCurrent date: &amp;D&#39;</span> <span class="o">+</span> <span class="s1">&#39;&amp;RCurrent time: &amp;T&#39;</span>

<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="n">header3</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_footer</span><span class="p">(</span><span class="n">footer3</span><span class="p">)</span>

<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">preview</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A21&#39;</span><span class="p">,</span> <span class="s1">&#39;Next sheet&#39;</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_h_pagebreaks</span><span class="p">([</span><span class="mi">20</span><span class="p">])</span>

<span class="c1">######################################################################</span>
<span class="c1">#</span>
<span class="c1"># This example shows how to use more than one font</span>
<span class="c1">#</span>
<span class="n">worksheet4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Mixed fonts&#39;</span><span class="p">)</span>
<span class="n">header4</span> <span class="o">=</span> <span class="s1">&#39;&amp;C&amp;&quot;Courier New,Bold&quot;Hello &amp;&quot;Arial,Italic&quot;World&#39;</span>
<span class="n">footer4</span> <span class="o">=</span> <span class="s1">&#39;&amp;C&amp;&quot;Symbol&quot;e&amp;&quot;Arial&quot; = mc&amp;X2&#39;</span>

<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="n">header4</span><span class="p">)</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_footer</span><span class="p">(</span><span class="n">footer4</span><span class="p">)</span>

<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">preview</span><span class="p">)</span>

<span class="c1">######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of line wrapping</span>
<span class="c1">#</span>
<span class="n">worksheet5</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Word wrap&#39;</span><span class="p">)</span>
<span class="n">header5</span> <span class="o">=</span> <span class="s2">&quot;&amp;CHeading 1</span><span class="se">\n</span><span class="s2">Heading 2&quot;</span>

<span class="n">worksheet5</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="n">header5</span><span class="p">)</span>

<span class="n">worksheet5</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">preview</span><span class="p">)</span>

<span class="c1">######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of inserting a literal ampersand &amp;</span>
<span class="c1">#</span>
<span class="n">worksheet6</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Ampersand&#39;</span><span class="p">)</span>
<span class="n">header6</span> <span class="o">=</span> <span class="s1">&#39;&amp;CCuriouser &amp;&amp; Curiouser - Attorneys at Law&#39;</span>

<span class="n">worksheet6</span><span class="o">.</span><span class="n">set_header</span><span class="p">(</span><span class="n">header6</span><span class="p">)</span>

<span class="n">worksheet6</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">preview</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_panes"></span><div class="section" id="example-freeze-panes-and-split-panes">
<span id="ex-panes"></span><h4>Example: Freeze Panes and Split Panes</h4>
<p>An example of how to create panes in a worksheet, both “freeze” panes and
“split” panes. See the <a class="reference internal" href="index.html#freeze_panes" title="freeze_panes"><code class="xref py py-func docutils literal notranslate"><span class="pre">freeze_panes()</span></code></a> and <a class="reference internal" href="index.html#split_panes" title="split_panes"><code class="xref py py-func docutils literal notranslate"><span class="pre">split_panes()</span></code></a> methods
for more details.</p>
<img alt="_images/panes.png" src="_images/panes.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of using Python and the XlsxWriter module to create</span>
<span class="c1"># worksheet panes.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;panes.xlsx&#39;</span><span class="p">)</span>

<span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Panes 1&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Panes 2&#39;</span><span class="p">)</span>
<span class="n">worksheet3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Panes 3&#39;</span><span class="p">)</span>
<span class="n">worksheet4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Panes 4&#39;</span><span class="p">)</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Set up some formatting and text to highlight the panes.</span>
<span class="c1">#</span>
<span class="n">header_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                     <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;vcenter&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#D7E4BC&#39;</span><span class="p">,</span>
                                     <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="n">center_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">})</span>


<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 1. Freeze pane on the top row.</span>
<span class="c1">#</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">freeze_panes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Other sheet formatting.</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:I&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_selection</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">)</span>


<span class="c1"># Some text to demonstrate scrolling.</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
    <span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="s1">&#39;Scroll down&#39;</span><span class="p">,</span> <span class="n">header_format</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">):</span>
        <span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">center_format</span><span class="p">)</span>


<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 2. Freeze pane on the left column.</span>
<span class="c1">#</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">freeze_panes</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Other sheet formatting.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_selection</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">)</span>

<span class="c1"># Some text to demonstrate scrolling.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
    <span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Scroll right&#39;</span><span class="p">,</span> <span class="n">header_format</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">):</span>
        <span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">center_format</span><span class="p">)</span>


<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 3. Freeze pane on the top row and left column.</span>
<span class="c1">#</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">freeze_panes</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Other sheet formatting.</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:Z&#39;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_selection</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">header_format</span><span class="p">)</span>

<span class="c1"># Some text to demonstrate scrolling.</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">):</span>
    <span class="n">worksheet3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="s1">&#39;Scroll down&#39;</span><span class="p">,</span> <span class="n">header_format</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
    <span class="n">worksheet3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Scroll right&#39;</span><span class="p">,</span> <span class="n">header_format</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">):</span>
        <span class="n">worksheet3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">center_format</span><span class="p">)</span>


<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 4. Split pane on the top row and left column.</span>
<span class="c1">#</span>
<span class="c1"># The divisions must be specified in terms of row and column dimensions.</span>
<span class="c1"># The default row height is 15 and the default column width is 8.43</span>
<span class="c1">#</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">split_panes</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mf">8.43</span><span class="p">)</span>

<span class="c1"># Other sheet formatting.</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_selection</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">)</span>

<span class="c1"># Some text to demonstrate scrolling.</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">):</span>
    <span class="n">worksheet4</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="s1">&#39;Scroll&#39;</span><span class="p">,</span> <span class="n">center_format</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">):</span>
    <span class="n">worksheet4</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Scroll&#39;</span><span class="p">,</span> <span class="n">center_format</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">26</span><span class="p">):</span>
        <span class="n">worksheet4</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">center_format</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_tables"></span><div class="section" id="example-worksheet-tables">
<span id="ex-tables"></span><h4>Example: Worksheet Tables</h4>
<p>Example of how to add tables to an XlsxWriter worksheet.</p>
<p>Tables in Excel are used to group rows and columns of data into a single
structure that can be referenced in a formula or formatted collectively.</p>
<p>See also <a class="reference internal" href="index.html#tables"><span class="std std-ref">Working with Worksheet Tables</span></a>.</p>
<img alt="_images/tables12.png" src="_images/tables12.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of how to add tables to an XlsxWriter worksheet.</span>
<span class="c1">#</span>
<span class="c1"># Tables in Excel are used to group rows and columns of data into a single</span>
<span class="c1"># structure that can be referenced in a formula or formatted collectively.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;tables.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet5</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet6</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet7</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet8</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet9</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet10</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet11</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet12</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet13</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">currency_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;$#,##0&#39;</span><span class="p">})</span>

<span class="c1"># Some sample data for the table.</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Apples&#39;</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">6000</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Pears&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">5000</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Bananas&#39;</span><span class="p">,</span> <span class="mi">6000</span><span class="p">,</span> <span class="mi">6000</span><span class="p">,</span> <span class="mi">6500</span><span class="p">,</span> <span class="mi">6000</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Oranges&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">700</span><span class="p">],</span>

<span class="p">]</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 1.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Default table with no data.&#39;</span>

<span class="c1"># Set the columns widths.</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Write the caption.</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="c1"># Add a table to the worksheet.</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 2.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Default table with data.&#39;</span>

<span class="c1"># Set the columns widths.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Write the caption.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="c1"># Add a table to the worksheet.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 3.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Table without default autofilter.&#39;</span>

<span class="c1"># Set the columns widths.</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Write the caption.</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="c1"># Add a table to the worksheet.</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;autofilter&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>

<span class="c1"># Table data can also be written separately, as an array or individual cells.</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B7&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 4.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Table without default header row.&#39;</span>

<span class="c1"># Set the columns widths.</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Write the caption.</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="c1"># Add a table to the worksheet.</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B4:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;header_row&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>

<span class="c1"># Table data can also be written separately, as an array or individual cells.</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B7&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 5.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Default table with &quot;First Column&quot; and &quot;Last Column&quot; options.&#39;</span>

<span class="c1"># Set the columns widths.</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Write the caption.</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="c1"># Add a table to the worksheet.</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;first_column&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;last_column&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Table data can also be written separately, as an array or individual cells.</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B7&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 6.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Table with banded columns but without default banded rows.&#39;</span>

<span class="c1"># Set the columns widths.</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Write the caption.</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="c1"># Add a table to the worksheet.</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;banded_rows&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;banded_columns&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Table data can also be written separately, as an array or individual cells.</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;B7&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 7.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Table with user defined column headers&#39;</span>

<span class="c1"># Set the columns widths.</span>
<span class="n">worksheet7</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Write the caption.</span>
<span class="n">worksheet7</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="c1"># Add a table to the worksheet.</span>
<span class="n">worksheet7</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:F7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
                               <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Product&#39;</span><span class="p">},</span>
                                           <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 1&#39;</span><span class="p">},</span>
                                           <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 2&#39;</span><span class="p">},</span>
                                           <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 3&#39;</span><span class="p">},</span>
                                           <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 4&#39;</span><span class="p">},</span>
                                           <span class="p">]})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 8.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Table with user defined column headers&#39;</span>

<span class="c1"># Set the columns widths.</span>
<span class="n">worksheet8</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Write the caption.</span>
<span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="c1"># Formula to use in the table.</span>
<span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;=SUM(Table8[@[Quarter 1]:[Quarter 4]])&#39;</span>

<span class="c1"># Add a table to the worksheet.</span>
<span class="n">worksheet8</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:G7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
                               <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Product&#39;</span><span class="p">},</span>
                                           <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 1&#39;</span><span class="p">},</span>
                                           <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 2&#39;</span><span class="p">},</span>
                                           <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 3&#39;</span><span class="p">},</span>
                                           <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 4&#39;</span><span class="p">},</span>
                                           <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;formula&#39;</span><span class="p">:</span> <span class="n">formula</span><span class="p">},</span>
                                           <span class="p">]})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 9.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Table with totals row (but no caption or totals).&#39;</span>

<span class="c1"># Set the columns widths.</span>
<span class="n">worksheet9</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Write the caption.</span>
<span class="n">worksheet9</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="c1"># Formula to use in the table.</span>
<span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;=SUM(Table9[@[Quarter 1]:[Quarter 4]])&#39;</span>

<span class="c1"># Add a table to the worksheet.</span>
<span class="n">worksheet9</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:G8&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
                               <span class="s1">&#39;total_row&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                               <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Product&#39;</span><span class="p">},</span>
                                           <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 1&#39;</span><span class="p">},</span>
                                           <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 2&#39;</span><span class="p">},</span>
                                           <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 3&#39;</span><span class="p">},</span>
                                           <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 4&#39;</span><span class="p">},</span>
                                           <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;formula&#39;</span><span class="p">:</span> <span class="n">formula</span>
                                            <span class="p">},</span>
                                           <span class="p">]})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 10.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Table with totals row with user captions and functions.&#39;</span>

<span class="c1"># Set the columns widths.</span>
<span class="n">worksheet10</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Write the caption.</span>
<span class="n">worksheet10</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="c1"># Options to use in the table.</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
           <span class="s1">&#39;total_row&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
           <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Product&#39;</span><span class="p">,</span> <span class="s1">&#39;total_string&#39;</span><span class="p">:</span> <span class="s1">&#39;Totals&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 1&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 2&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 3&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 4&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;formula&#39;</span><span class="p">:</span> <span class="s1">&#39;=SUM(Table10[@[Quarter 1]:[Quarter 4]])&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span>
                        <span class="p">},</span>
                       <span class="p">]}</span>

<span class="c1"># Add a table to the worksheet.</span>
<span class="n">worksheet10</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:G8&#39;</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 11.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Table with alternative Excel style.&#39;</span>

<span class="c1"># Set the columns widths.</span>
<span class="n">worksheet11</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Write the caption.</span>
<span class="n">worksheet11</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="c1"># Options to use in the table.</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
           <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="s1">&#39;Table Style Light 11&#39;</span><span class="p">,</span>
           <span class="s1">&#39;total_row&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
           <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Product&#39;</span><span class="p">,</span> <span class="s1">&#39;total_string&#39;</span><span class="p">:</span> <span class="s1">&#39;Totals&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 1&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 2&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 3&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 4&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;formula&#39;</span><span class="p">:</span> <span class="s1">&#39;=SUM(Table11[@[Quarter 1]:[Quarter 4]])&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span>
                        <span class="p">},</span>
                       <span class="p">]}</span>


<span class="c1"># Add a table to the worksheet.</span>
<span class="n">worksheet11</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:G8&#39;</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 12.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Table with Excel style removed.&#39;</span>

<span class="c1"># Set the columns widths.</span>
<span class="n">worksheet12</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Write the caption.</span>
<span class="n">worksheet12</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="c1"># Options to use in the table.</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
           <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
           <span class="s1">&#39;total_row&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
           <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Product&#39;</span><span class="p">,</span> <span class="s1">&#39;total_string&#39;</span><span class="p">:</span> <span class="s1">&#39;Totals&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 1&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 2&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 3&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 4&#39;</span><span class="p">,</span> <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;formula&#39;</span><span class="p">:</span> <span class="s1">&#39;=SUM(Table12[@[Quarter 1]:[Quarter 4]])&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span>
                        <span class="p">},</span>
                       <span class="p">]}</span>


<span class="c1"># Add a table to the worksheet.</span>
<span class="n">worksheet12</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:G8&#39;</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 13.</span>
<span class="c1">#</span>
<span class="n">caption</span> <span class="o">=</span> <span class="s1">&#39;Table with column formats.&#39;</span>

<span class="c1"># Set the columns widths.</span>
<span class="n">worksheet13</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Write the caption.</span>
<span class="n">worksheet13</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">caption</span><span class="p">)</span>

<span class="c1"># Options to use in the table.</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
           <span class="s1">&#39;total_row&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
           <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Product&#39;</span><span class="p">,</span> <span class="s1">&#39;total_string&#39;</span><span class="p">:</span> <span class="s1">&#39;Totals&#39;</span><span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 1&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">currency_format</span><span class="p">,</span>
                        <span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 2&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">currency_format</span><span class="p">,</span>
                        <span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 3&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">currency_format</span><span class="p">,</span>
                        <span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Quarter 4&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">currency_format</span><span class="p">,</span>
                        <span class="p">},</span>
                       <span class="p">{</span><span class="s1">&#39;header&#39;</span><span class="p">:</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;formula&#39;</span><span class="p">:</span> <span class="s1">&#39;=SUM(Table13[@[Quarter 1]:[Quarter 4]])&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;total_function&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="n">currency_format</span><span class="p">,</span>
                        <span class="p">},</span>
                       <span class="p">]}</span>

<span class="c1"># Add a table to the worksheet.</span>
<span class="n">worksheet13</span><span class="o">.</span><span class="n">add_table</span><span class="p">(</span><span class="s1">&#39;B3:G8&#39;</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_user_types1"></span><div class="section" id="example-writing-user-defined-types-1">
<span id="ex-user-type1"></span><h4>Example: Writing User Defined Types (1)</h4>
<p>An example of adding support for user defined types to the XlsxWriter
<a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method using the <a class="reference internal" href="index.html#add_write_handler" title="add_write_handler"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_write_handler()</span></code></a> method.</p>
<p>This example takes UUID data and writes it as a string by adding a callback
handler to the <code class="docutils literal notranslate"><span class="pre">write()</span></code> method. A UUID data type would normally raise a
<code class="docutils literal notranslate"><span class="pre">TypeError</span></code> in XlsxWriter since it isn’t a type that is supported by Excel.</p>
<p>See the <a class="reference internal" href="index.html#writing-user-types"><span class="std std-ref">Writing user defined types</span></a> section for more details on how this
functionality works.</p>
<img alt="_images/user_types1.png" src="_images/user_types1.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of adding support for user defined types to the XlsxWriter write()</span>
<span class="c1"># method.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>
<span class="kn">import</span> <span class="nn">uuid</span>

<span class="c1"># Create a function that will behave like a worksheet write() method.</span>
<span class="c1">#</span>
<span class="c1"># This function takes a UUID and writes it as as string. It should take the</span>
<span class="c1"># parameters shown below and return the return value from the called worksheet</span>
<span class="c1"># write_*() method. In this case it changes the UUID to a string and calls</span>
<span class="c1"># write_string() to write it.</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">write_uuid</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">token</span><span class="p">),</span> <span class="nb">format</span><span class="p">)</span>

<span class="c1"># Set up the workbook as usual.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;user_types1.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Make the first column wider for clarity.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>

<span class="c1"># Add the write() handler/callback to the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_write_handler</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">UUID</span><span class="p">,</span> <span class="n">write_uuid</span><span class="p">)</span>

<span class="c1"># Create a UUID.</span>
<span class="n">my_uuid</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid3</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">NAMESPACE_DNS</span><span class="p">,</span> <span class="s1">&#39;python.org&#39;</span><span class="p">)</span>

<span class="c1"># Write the UUID. This would raise a TypeError without the handler.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">my_uuid</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_user_types2"></span><div class="section" id="example-writing-user-defined-types-2">
<span id="ex-user-type2"></span><h4>Example: Writing User Defined Types (2)</h4>
<p>An example of adding support for user defined types to the XlsxWriter
<a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method using the <a class="reference internal" href="index.html#add_write_handler" title="add_write_handler"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_write_handler()</span></code></a> method.</p>
<p>This example removes <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (Not a Number) values from numeric data and
writes a blank cell instead. Note, another way to handle this is with the
<code class="docutils literal notranslate"><span class="pre">nan_inf_to_errors</span></code> option in the <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> constructor.</p>
<p>See the <a class="reference internal" href="index.html#writing-user-types"><span class="std std-ref">Writing user defined types</span></a> section for more details on how this
functionality works.</p>
<img alt="_images/user_types2.png" src="_images/user_types2.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of adding support for user defined types to the XlsxWriter write()</span>
<span class="c1"># method.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="c1"># Create a function that will behave like a worksheet write() method.</span>
<span class="c1">#</span>
<span class="c1"># This function takes a float and if it is NaN then it writes a blank cell</span>
<span class="c1"># instead. It should take the parameters shown below and return the return</span>
<span class="c1"># value from the called worksheet write_*() method.</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">ignore_nan</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">write_blank</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Return control to the calling write() method for any other number.</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="c1"># Set up the workbook as usual.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;user_types2.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>


<span class="c1"># Add the write() handler/callback to the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_write_handler</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">ignore_nan</span><span class="p">)</span>

<span class="c1"># Create some data to write.</span>
<span class="n">my_data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;nan&#39;</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="c1"># Write the data. Note that write_row() calls write() so this will work as</span>
<span class="c1"># expected. Writing NaN values would raise a TypeError without the handler.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">my_data</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_user_types3"></span><div class="section" id="example-writing-user-defined-types-3">
<span id="ex-user-type3"></span><h4>Example: Writing User Defined types (3)</h4>
<p>An example of adding support for user defined types to the XlsxWriter
<a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method using the <a class="reference internal" href="index.html#add_write_handler" title="add_write_handler"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_write_handler()</span></code></a> method.</p>
<p>This, somewhat artificial, example shows how to use the <code class="docutils literal notranslate"><span class="pre">row</span></code> and <code class="docutils literal notranslate"><span class="pre">col</span></code>
parameters to control the logic of the callback function. It changes the
worksheet <code class="docutils literal notranslate"><span class="pre">write()</span></code> method so that it hides/replaces user passwords when
writing string values based on their position in the worksheet.</p>
<p>See the <a class="reference internal" href="index.html#writing-user-types"><span class="std std-ref">Writing user defined types</span></a> section for more details on how this
functionality works.</p>
<img alt="_images/user_types3.png" src="_images/user_types3.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of adding support for user defined types to the XlsxWriter write()</span>
<span class="c1"># method.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="c1"># Create a function that changes the worksheet write() method so that it</span>
<span class="c1"># hides/replaces user passwords when writing string data. The password data,</span>
<span class="c1"># based on the sample data structure, will be data in the second column, apart</span>
<span class="c1"># from the header row.</span>
<span class="k">def</span> <span class="nf">hide_password</span><span class="p">(</span><span class="n">worksheet</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">col</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">row</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="s1">&#39;****&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span>

<span class="c1"># Set up the workbook as usual.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;user_types3.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Make the headings in the first row bold.</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="c1"># Add the write() handler/callback to the worksheet. In Python 2 the type</span>
<span class="c1"># would be better as &#39;basestring&#39; if we also wanted to match the &#39;unicode&#39;</span>
<span class="c1"># type.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_write_handler</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">hide_password</span><span class="p">)</span>

<span class="c1"># Create some data to write.</span>
<span class="n">my_data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span>    <span class="s1">&#39;Password&#39;</span><span class="p">,</span>  <span class="s1">&#39;City&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Sara&#39;</span><span class="p">,</span>    <span class="s1">&#39;$5%^6&amp;&#39;</span><span class="p">,</span>    <span class="s1">&#39;Rome&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Michele&#39;</span><span class="p">,</span> <span class="s1">&#39;123abc&#39;</span><span class="p">,</span>    <span class="s1">&#39;Milano&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Maria&#39;</span><span class="p">,</span>   <span class="s1">&#39;juvexme&#39;</span><span class="p">,</span>   <span class="s1">&#39;Torino&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Paolo&#39;</span><span class="p">,</span>   <span class="s1">&#39;qwerty&#39;</span><span class="p">,</span>    <span class="s1">&#39;Fano&#39;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Write the data. Note that write_row() calls write() so this will work as</span>
<span class="c1"># expected.</span>
<span class="k">for</span> <span class="n">row_num</span><span class="p">,</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">my_data</span><span class="p">):</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row_num</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_sparklines1"></span><div class="section" id="example-sparklines-simple">
<span id="ex-sparklines1"></span><h4>Example: Sparklines (Simple)</h4>
<p>Example of how to add sparklines to a XlsxWriter worksheet.</p>
<p>Sparklines are small charts that fit in a single cell and are used to show
trends in data.</p>
<p>See the <a class="reference internal" href="index.html#sparklines"><span class="std std-ref">Working with Sparklines</span></a> method for more details.</p>
<img alt="_images/sparklines1.png" src="_images/sparklines1.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of how to add sparklines to a Python XlsxWriter file.</span>
<span class="c1">#</span>
<span class="c1"># Sparklines are small charts that fit in a single cell and are</span>
<span class="c1"># used to show trends in data.</span>
<span class="c1">#</span>
<span class="c1"># See sparklines2.py for examples of more complex sparkline formatting.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;sparklines1.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Some sample data to plot.</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
<span class="p">]</span>


<span class="c1"># Write the sample data to the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>


<span class="c1"># Add a line sparkline (the default) with markers.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;F1&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet1!A1:E1&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;markers&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>


<span class="c1"># Add a column sparkline with non-default style.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;F2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet1!A2:E2&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>


<span class="c1"># Add a win/loss sparkline with negative values highlighted.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;F3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet1!A3:E3&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;win_loss&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;negative_points&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_sparklines2"></span><div class="section" id="example-sparklines-advanced">
<span id="ex-sparklines2"></span><h4>Example: Sparklines (Advanced)</h4>
<p>This example shows the majority of options that can be applied to sparklines.</p>
<p>Sparklines are small charts that fit in a single cell and are used to show
trends in data.</p>
<p>See the <a class="reference internal" href="index.html#sparklines"><span class="std std-ref">Working with Sparklines</span></a> method for more details.</p>
<img alt="_images/sparklines2.png" src="_images/sparklines2.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of how to add sparklines to an XlsxWriter file with Python.</span>
<span class="c1">#</span>
<span class="c1"># Sparklines are small charts that fit in a single cell and are</span>
<span class="c1"># used to show trends in data. This example shows the majority of</span>
<span class="c1"># options that can be applied to sparklines.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;sparklines2.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Set the columns widths to make the output clearer.</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:B&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_zoom</span><span class="p">(</span><span class="mi">150</span><span class="p">)</span>

<span class="c1"># Headings.</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Sparkline&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A default &quot;line&quot; sparkline.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A1:J1&#39;</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A default &quot;column&quot; sparkline.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A2:J2&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A default &quot;win/loss&quot; sparkline.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A3:J3&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;win_loss&#39;</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">2</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Line with markers.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A6&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A1:J1&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;markers&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Line with high and low points.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A1:J1&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;high_point&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                <span class="s1">&#39;low_point&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Line with first and last point markers.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A8&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A1:J1&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;first_point&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                <span class="s1">&#39;last_point&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Line with negative point markers.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A9&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A1:J1&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;negative_points&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Line with axis.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A10&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A1:J1&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">2</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Column with default style (1).&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A12&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A2:J2&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Column with style 2.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A13&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A2:J2&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Column with style 3.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A14&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A2:J2&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Column with style 4.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A15&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A2:J2&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Column with style 5.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A16&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A2:J2&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Column with style 6.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A17&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A2:J2&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Column with a user defined color.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A18&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A2:J2&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;series_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#E965E0&#39;</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">2</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A win/loss sparkline.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A20&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A3:J3&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;win_loss&#39;</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A win/loss sparkline with negative points highlighted.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A21&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A3:J3&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;win_loss&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;negative_points&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">2</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A left to right column (the default).&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A23&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A4:J4&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A right to left column.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A24&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A4:J4&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
                                 <span class="s1">&#39;reverse&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Sparkline and text in one cell.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A25&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="s1">&#39;Sheet2!A4:J4&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;style&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Growth&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">2</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A grouped sparkline. Changes are applied to all three.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">add_sparkline</span><span class="p">(</span><span class="s1">&#39;A27&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;A27&#39;</span><span class="p">,</span> <span class="s1">&#39;A28&#39;</span><span class="p">,</span> <span class="s1">&#39;A29&#39;</span><span class="p">],</span>
                                 <span class="s1">&#39;range&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet2!A5:J5&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;Sheet2!A6:J6&#39;</span><span class="p">,</span>
                                           <span class="s1">&#39;Sheet2!A7:J7&#39;</span><span class="p">],</span>
                                 <span class="s1">&#39;markers&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a second worksheet with data to plot.</span>
<span class="c1">#</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:J&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>

    <span class="c1"># Simple line data.</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>

    <span class="c1"># Simple column data.</span>
    <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>

    <span class="c1"># Simple win/loss data.</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>

    <span class="c1"># Unbalanced histogram.</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>

    <span class="c1"># Data for the grouped sparkline example.</span>
    <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>

<span class="p">]</span>

<span class="c1"># Write the sample data to the worksheet.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A6&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_comments1"></span><div class="section" id="example-adding-cell-comments-to-worksheets-simple">
<span id="ex-comments1"></span><h4>Example: Adding Cell Comments to Worksheets (Simple)</h4>
<p>A simple example of adding cell comments to a worksheet. For more details see
<a class="reference internal" href="index.html#cell-comments"><span class="std std-ref">Working with Cell Comments</span></a>.</p>
<img alt="_images/comments1.png" src="_images/comments1.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of writing cell comments to a worksheet using Python and</span>
<span class="c1"># XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># For more advanced comment options see comments2.py.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;comments1.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;This is a comment&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_comments2"></span><div class="section" id="example-adding-cell-comments-to-worksheets-advanced">
<span id="ex-comments2"></span><h4>Example: Adding Cell Comments to Worksheets (Advanced)</h4>
<p>Another example of adding cell comments to a worksheet. This example
demonstrates most of the available comment formatting options. For more
details see <a class="reference internal" href="index.html#cell-comments"><span class="std std-ref">Working with Cell Comments</span></a>.</p>
<img alt="_images/comments2.png" src="_images/comments2.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of writing cell comments to a worksheet using Python and</span>
<span class="c1"># XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Each of the worksheets demonstrates different features of cell comments.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;comments.xlsx&#39;</span><span class="p">)</span>

<span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet5</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet6</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet7</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet8</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">text_wrap</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;top&#39;</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 1. Demonstrates a simple cell comments without formatting.</span>
<span class="c1">#</span>

<span class="c1"># Set up some formatting.</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;C:C&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># Simple ASCII string.</span>
<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;Hold the mouse over this cell to see the comment.&#39;</span>

<span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;This is a comment.&#39;</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 2. Demonstrates visible and hidden comments.</span>
<span class="c1">#</span>

<span class="c1"># Set up some formatting.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;C:C&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;This cell comment is visible.&#39;</span>
<span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;Hello.&#39;</span>

<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;visible&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s2">&quot;This cell comment isn&#39;t visible (the default).&quot;</span>

<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 3. Demonstrates visible and hidden comments set at the worksheet</span>
<span class="c1">#            level.</span>
<span class="c1">#</span>

<span class="c1"># Set up some formatting.</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;C:C&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># Make all comments on the worksheet visible.</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">show_comments</span><span class="p">()</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;This cell comment is visible, explicitly.&#39;</span>
<span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;Hello.&#39;</span>

<span class="n">worksheet3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;visible&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;This cell comment is also visible because of show_comments().&#39;</span>

<span class="n">worksheet3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;However, we can still override it locally.&#39;</span>

<span class="n">worksheet3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;visible&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 4. Demonstrates changes to the comment box dimensions.</span>
<span class="c1">#</span>

<span class="c1"># Set up some formatting.</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;C:C&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="n">worksheet4</span><span class="o">.</span><span class="n">show_comments</span><span class="p">()</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;This cell comment is default size.&#39;</span>
<span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;Hello.&#39;</span>

<span class="n">worksheet4</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;This cell comment is twice as wide.&#39;</span>

<span class="n">worksheet4</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_scale&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;This cell comment is twice as high.&#39;</span>

<span class="n">worksheet4</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;y_scale&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;This cell comment is scaled in both directions.&#39;</span>

<span class="n">worksheet4</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C16&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C16&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_scale&#39;</span><span class="p">:</span> <span class="mf">1.2</span><span class="p">,</span> <span class="s1">&#39;y_scale&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">})</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;This cell comment has width and height specified in pixels.&#39;</span>

<span class="n">worksheet4</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C19&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C19&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">50</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 5. Demonstrates changes to the cell comment position.</span>
<span class="c1">#</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;C:C&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="n">worksheet5</span><span class="o">.</span><span class="n">show_comments</span><span class="p">()</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;This cell comment is in the default position.&#39;</span>
<span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;Hello.&#39;</span>

<span class="n">worksheet5</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;This cell comment has been moved to another cell.&#39;</span>

<span class="n">worksheet5</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;start_cell&#39;</span><span class="p">:</span> <span class="s1">&#39;E4&#39;</span><span class="p">})</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;This cell comment has been moved to another cell.&#39;</span>

<span class="n">worksheet5</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;start_row&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;start_col&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;This cell comment has been shifted within its default cell.&#39;</span>

<span class="n">worksheet5</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C12&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C12&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 6. Demonstrates changes to the comment background color.</span>
<span class="c1">#</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;C:C&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="n">worksheet6</span><span class="o">.</span><span class="n">show_comments</span><span class="p">()</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;This cell comment has a different color.&#39;</span>
<span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;Hello.&#39;</span>

<span class="n">worksheet6</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">})</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;This cell comment has the default color.&#39;</span>

<span class="n">worksheet6</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="s1">&#39;This cell comment has a different color.&#39;</span>

<span class="n">worksheet6</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C9&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#CCFFCC&#39;</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 7. Demonstrates how to set the cell comment author.</span>
<span class="c1">#</span>
<span class="n">worksheet7</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;C:C&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">worksheet7</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">worksheet7</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="n">author</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">cell</span> <span class="o">=</span> <span class="s1">&#39;C3&#39;</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Move the mouse over this cell and you will see &#39;Cell commented &quot;</span>
             <span class="s2">&quot;by (blank)&#39; in the status bar at the bottom&quot;</span><span class="p">)</span>

<span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;Hello.&#39;</span>

<span class="n">worksheet7</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet7</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

<span class="n">author</span> <span class="o">=</span> <span class="s1">&#39;Python&#39;</span>
<span class="n">cell</span> <span class="o">=</span> <span class="s1">&#39;C6&#39;</span>
<span class="n">cell_text</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Move the mouse over this cell and you will see &#39;Cell commented &quot;</span>
             <span class="s2">&quot;by Python&#39; in the status bar at the bottom&quot;</span><span class="p">)</span>

<span class="n">worksheet7</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet7</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;author&#39;</span><span class="p">:</span> <span class="n">author</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 8. Demonstrates the need to explicitly set the row height.</span>
<span class="c1">#</span>

<span class="c1"># Set up some formatting.</span>
<span class="n">worksheet8</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;C:C&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">worksheet8</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>

<span class="n">worksheet8</span><span class="o">.</span><span class="n">show_comments</span><span class="p">()</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;The height of this row has been adjusted explicitly using &#39;</span>
             <span class="s1">&#39;set_row(). The size of the comment box is adjusted &#39;</span>
             <span class="s1">&#39;accordingly by XlsxWriter.&#39;</span><span class="p">)</span>

<span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;Hello.&#39;</span>

<span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet8</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

<span class="n">cell_text</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;The height of this row has been adjusted by Excel due to the &#39;</span>
             <span class="s1">&#39;text wrap property being set. Unfortunately this means that &#39;</span>
             <span class="s1">&#39;the height of the row is unknown to XlsxWriter at run time &#39;</span>
             <span class="s2">&quot;and thus the comment box is stretched as well.</span><span class="se">\n\n</span><span class="s2">&quot;</span>
             <span class="s1">&#39;Use set_row() to specify the row height explicitly to avoid &#39;</span>
             <span class="s1">&#39;this problem.&#39;</span><span class="p">)</span>

<span class="n">worksheet8</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="n">cell_text</span><span class="p">,</span> <span class="n">text_wrap</span><span class="p">)</span>
<span class="n">worksheet8</span><span class="o">.</span><span class="n">write_comment</span><span class="p">(</span><span class="s1">&#39;C6&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_textbox"></span><div class="section" id="example-insert-textboxes-into-a-worksheet">
<span id="ex-textbox"></span><h4>Example: Insert Textboxes into a Worksheet</h4>
<p>The following is an example of how to insert and format textboxes in a
worksheet, see <a class="reference internal" href="index.html#insert_textbox" title="insert_textbox"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_textbox()</span></code></a> and <a class="reference internal" href="index.html#working-with-textboxes"><span class="std std-ref">Working with Textboxes</span></a> for
more details.</p>
<img alt="_images/textbox01.png" src="_images/textbox01.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of inserting textboxes into an Excel worksheet using</span>
<span class="c1"># Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;textbox.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">col</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># The examples below show different textbox options and formatting. In each</span>
<span class="c1"># example the text describes the formatting.</span>


<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A simple textbox with some text&#39;</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A textbox with changed dimensions&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
    <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A textbox with an offset in the cell&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A textbox with scaling&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;x_scale&#39;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>
    <span class="s1">&#39;y_scale&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A textbox with some long text that wraps around onto several lines&#39;</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A textbox</span><span class="se">\n</span><span class="s1">with some</span><span class="se">\n</span><span class="s1">newlines</span><span class="se">\n\n</span><span class="s1">and paragraphs&#39;</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A textbox with a solid fill background&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A textbox with a no fill background&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A textbox with a gradient fill background&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;gradient&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;#DDEBCF&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;#9CB86E&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;#156B13&#39;</span><span class="p">]},</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A textbox with a user defined border line&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
               <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
               <span class="s1">&#39;dash_type&#39;</span><span class="p">:</span> <span class="s1">&#39;round_dot&#39;</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;A textbox with no border line&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Default alignment: top - left&#39;</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Alignment: top - center&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;horizontal&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Alignment: middle - center&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;vertical&#39;</span><span class="p">:</span> <span class="s1">&#39;middle&#39;</span><span class="p">,</span>
               <span class="s1">&#39;horizontal&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Font properties: bold&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Font properties: various&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Font properties: various&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
             <span class="s1">&#39;italic&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
             <span class="s1">&#39;underline&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
             <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Arial&#39;</span><span class="p">,</span>
             <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
             <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">}</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Some text in a textbox with formatting&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;white&#39;</span><span class="p">},</span>
    <span class="s1">&#39;align&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;vertical&#39;</span><span class="p">:</span> <span class="s1">&#39;middle&#39;</span><span class="p">,</span>
              <span class="s1">&#39;horizontal&#39;</span><span class="p">:</span> <span class="s1">&#39;center&#39;</span>
              <span class="p">},</span>
    <span class="s1">&#39;gradient&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]},</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;textlink&#39;</span><span class="p">:</span> <span class="s1">&#39;=$F$185&#39;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;F185&#39;</span><span class="p">,</span> <span class="s1">&#39;Text in a cell&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Text rotated up&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;text_rotation&#39;</span><span class="p">:</span> <span class="mi">90</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Text rotated down&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;text_rotation&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">90</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Text rotated vertically&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;text_rotation&#39;</span><span class="p">:</span> <span class="mi">270</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="c1"># Example</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Textbox with hyperlink&#39;</span>
<span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;url&#39;</span><span class="p">:</span> <span class="s1">&#39;https://github.com/jmcnamara&#39;</span><span class="p">,</span>
    <span class="s1">&#39;tip&#39;</span><span class="p">:</span> <span class="s1">&#39;GitHub&#39;</span>
<span class="p">}</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_textbox</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
<span class="n">row</span> <span class="o">+=</span> <span class="mi">10</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_outline1"></span><div class="section" id="example-outline-and-grouping">
<span id="ex-outline1"></span><h4>Example: Outline and Grouping</h4>
<p>Examples of how use XlsxWriter to generate Excel outlines and grouping. See
also <a class="reference internal" href="index.html#outlines"><span class="std std-ref">Working with Outlines and Grouping</span></a>.</p>
<img alt="_images/outline1.png" src="_images/outline1.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of how use Python and XlsxWriter to generate Excel outlines and</span>
<span class="c1"># grouping.</span>
<span class="c1">#</span>
<span class="c1"># Excel allows you to group rows or columns so that they can be hidden or</span>
<span class="c1"># displayed with a single mouse click. This feature is referred to as outlines.</span>
<span class="c1">#</span>
<span class="c1"># Outlines can reduce complex data down to a few salient sub-totals or</span>
<span class="c1"># summaries.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="c1"># Create a new workbook and add some worksheets</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;outline.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Outlined Rows&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Collapsed Rows&#39;</span><span class="p">)</span>
<span class="n">worksheet3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Outline Columns&#39;</span><span class="p">)</span>
<span class="n">worksheet4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Outline levels&#39;</span><span class="p">)</span>

<span class="c1"># Add a general format</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 1: A worksheet with outlined rows. It also includes SUBTOTAL()</span>
<span class="c1"># functions so that it looks like the type of automatic outlines that are</span>
<span class="c1"># generated when you use the Excel Data-&gt;SubTotals menu item.</span>
<span class="c1">#</span>
<span class="c1"># For outlines the important parameters are &#39;level&#39; and &#39;hidden&#39;. Rows with</span>
<span class="c1"># the same &#39;level&#39; are grouped together. The group will be collapsed if</span>
<span class="c1"># &#39;hidden&#39; is enabled. The parameters &#39;height&#39; and &#39;cell_format&#39; are assigned</span>
<span class="c1"># default values if they are None.</span>
<span class="c1">#</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Adjust the column width for clarity</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Add the data, labels and formulas</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Region&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;North&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="s1">&#39;North&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="s1">&#39;North&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="s1">&#39;North&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A6&#39;</span><span class="p">,</span> <span class="s1">&#39;North Total&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="mi">900</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUBTOTAL(9,B2:B5)&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A8&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A9&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A10&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A11&#39;</span><span class="p">,</span> <span class="s1">&#39;South Total&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B7&#39;</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B8&#39;</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B9&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B10&#39;</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B11&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUBTOTAL(9,B7:B10)&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A12&#39;</span><span class="p">,</span> <span class="s1">&#39;Grand Total&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B12&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUBTOTAL(9,B2:B10)&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 2: A worksheet with outlined rows. This is the same as the</span>
<span class="c1"># previous example except that the rows are collapsed.</span>
<span class="c1"># Note: We need to indicate the rows that contains the collapsed symbol &#39;+&#39;</span>
<span class="c1"># with the optional parameter, &#39;collapsed&#39;. The group will be then be</span>
<span class="c1"># collapsed if &#39;hidden&#39; is True.</span>
<span class="c1">#</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;collapsed&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Adjust the column width for clarity</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Add the data, labels and formulas</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Region&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;North&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="s1">&#39;North&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="s1">&#39;North&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="s1">&#39;North&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A6&#39;</span><span class="p">,</span> <span class="s1">&#39;North Total&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="mi">900</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUBTOTAL(9,B2:B5)&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A8&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A9&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A10&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A11&#39;</span><span class="p">,</span> <span class="s1">&#39;South Total&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B7&#39;</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B8&#39;</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B9&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B10&#39;</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B11&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUBTOTAL(9,B7:B10)&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A12&#39;</span><span class="p">,</span> <span class="s1">&#39;Grand Total&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B12&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUBTOTAL(9,B2:B10)&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 3: Create a worksheet with outlined columns.</span>
<span class="c1">#</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">,</span> <span class="s1">&#39;Total&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;North&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="s1">&#39;=SUM(B2:G2)&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;South&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;=SUM(B3:G3)&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;East&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;=SUM(B4:G4)&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;West&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;=SUM(B5:G5)&#39;</span><span class="p">]]</span>

<span class="c1"># Add bold format to the first row.</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="c1"># Set column formatting and the outline level.</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;H:H&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Write the data and a formula</span>
<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">data_row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">worksheet3</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data_row</span><span class="p">)</span>

<span class="n">worksheet3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;H6&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUM(H2:H5)&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 4: Show all possible outline levels.</span>
<span class="c1">#</span>
<span class="n">levels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Level 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Level 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Level 3&#39;</span><span class="p">,</span> <span class="s1">&#39;Level 4&#39;</span><span class="p">,</span> <span class="s1">&#39;Level 5&#39;</span><span class="p">,</span> <span class="s1">&#39;Level 6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Level 7&#39;</span><span class="p">,</span> <span class="s1">&#39;Level 6&#39;</span><span class="p">,</span> <span class="s1">&#39;Level 5&#39;</span><span class="p">,</span> <span class="s1">&#39;Level 4&#39;</span><span class="p">,</span> <span class="s1">&#39;Level 3&#39;</span><span class="p">,</span> <span class="s1">&#39;Level 2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Level 1&#39;</span><span class="p">]</span>

<span class="n">worksheet4</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">levels</span><span class="p">)</span>

<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_outline2"></span><div class="section" id="example-collapsed-outline-and-grouping">
<span id="ex-outline2"></span><h4>Example: Collapsed Outline and Grouping</h4>
<p>Examples of how use XlsxWriter to generate Excel outlines and
grouping. These examples focus mainly on collapsed outlines. See also
<a class="reference internal" href="index.html#outlines"><span class="std std-ref">Working with Outlines and Grouping</span></a>.</p>
<img alt="_images/outline2.png" src="_images/outline2.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of how to use Python and XlsxWriter to generate Excel outlines and</span>
<span class="c1"># grouping.</span>
<span class="c1">#</span>
<span class="c1"># These examples focus mainly on collapsed outlines. See also the</span>
<span class="c1"># outlines.py example program for more general examples.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="c1"># Create a new workbook and add some worksheets</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;outline_collapsed.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Outlined Rows&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Collapsed Rows 1&#39;</span><span class="p">)</span>
<span class="n">worksheet3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Collapsed Rows 2&#39;</span><span class="p">)</span>
<span class="n">worksheet4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Collapsed Rows 3&#39;</span><span class="p">)</span>
<span class="n">worksheet5</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Outline Columns&#39;</span><span class="p">)</span>
<span class="n">worksheet6</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Collapsed Columns&#39;</span><span class="p">)</span>

<span class="c1"># Add a general format</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>


<span class="c1"># This function will generate the same data and sub-totals on each worksheet.</span>
<span class="c1"># Used in the first 4 examples.</span>
<span class="c1">#</span>
<span class="k">def</span> <span class="nf">create_sub_totals</span><span class="p">(</span><span class="n">worksheet</span><span class="p">):</span>
    <span class="c1"># Adjust the column width for clarity.</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

    <span class="c1"># Add the data, labels and formulas.</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Region&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;North&#39;</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="s1">&#39;North&#39;</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="s1">&#39;North&#39;</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A5&#39;</span><span class="p">,</span> <span class="s1">&#39;North&#39;</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A6&#39;</span><span class="p">,</span> <span class="s1">&#39;North Total&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;Sales&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="mi">900</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="mi">1200</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUBTOTAL(9,B2:B5)&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A8&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A9&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A10&#39;</span><span class="p">,</span> <span class="s1">&#39;South&#39;</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A11&#39;</span><span class="p">,</span> <span class="s1">&#39;South Total&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B7&#39;</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B8&#39;</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B9&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B10&#39;</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B11&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUBTOTAL(9,B7:B10)&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A12&#39;</span><span class="p">,</span> <span class="s1">&#39;Grand Total&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B12&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUBTOTAL(9,B2:B10)&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 1: A worksheet with outlined rows. It also includes SUBTOTAL()</span>
<span class="c1"># functions so that it looks like the type of automatic outlines that are</span>
<span class="c1"># generated when you use the Excel Data-&gt;SubTotals menu item.</span>
<span class="c1">#</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Write the sub-total data that is common to the row examples.</span>
<span class="n">create_sub_totals</span><span class="p">(</span><span class="n">worksheet1</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 2: Create a worksheet with collapsed outlined rows.</span>
<span class="c1"># This is the same as the example 1  except that the all rows are collapsed.</span>
<span class="c1"># Note: We need to indicate the rows that contains the collapsed symbol &#39;+&#39;</span>
<span class="c1"># with the optional parameter, &#39;collapsed&#39;.</span>
<span class="c1">#</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;collapsed&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Write the sub-total data that is common to the row examples.</span>
<span class="n">create_sub_totals</span><span class="p">(</span><span class="n">worksheet2</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 3: Create a worksheet with collapsed outlined rows.</span>
<span class="c1"># Same as the example 1  except that the two sub-totals are collapsed.</span>
<span class="c1">#</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;collapsed&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;collapsed&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Write the sub-total data that is common to the row examples.</span>
<span class="n">create_sub_totals</span><span class="p">(</span><span class="n">worksheet3</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 4: Create a worksheet with outlined rows.</span>
<span class="c1"># Same as the example 1  except that the two sub-totals are collapsed.</span>
<span class="c1">#</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                   <span class="s1">&#39;collapsed&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                                    <span class="s1">&#39;collapsed&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">worksheet4</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;collapsed&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>


<span class="c1"># Write the sub-total data that is common to the row examples.</span>
<span class="n">create_sub_totals</span><span class="p">(</span><span class="n">worksheet4</span><span class="p">)</span>


<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 5: Create a worksheet with outlined columns.</span>
<span class="c1">#</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">,</span> <span class="s1">&#39;Total&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;North&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="s1">&#39;=SUM(B2:G2)&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;South&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;=SUM(B3:G3)&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;East&#39;</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;=SUM(B4:G4)&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;West&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;=SUM(B5:G5)&#39;</span><span class="p">]]</span>

<span class="c1"># Add bold format to the first row.</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="c1"># Set column formatting and the outline level.</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">worksheet5</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;H:H&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Write the data and a formula.</span>
<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">data_row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">worksheet5</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data_row</span><span class="p">)</span>

<span class="n">worksheet5</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;H6&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUM(H2:H5)&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example 6: Create a worksheet with collapsed outlined columns.</span>
<span class="c1"># This is the same as the previous example except with collapsed columns.</span>
<span class="c1">#</span>

<span class="c1"># Reuse the data from the previous example.</span>

<span class="c1"># Add bold format to the first row.</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="c1"># Set column formatting and the outline level.</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:G&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;level&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">worksheet6</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;H:H&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;collapsed&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Write the data and a formula.</span>
<span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">data_row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">worksheet6</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">data_row</span><span class="p">)</span>

<span class="n">worksheet6</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;H6&#39;</span><span class="p">,</span> <span class="s1">&#39;=SUM(H2:H5)&#39;</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_doc_properties"></span><div class="section" id="example-setting-document-properties">
<span id="ex-doc-properties"></span><h4>Example: Setting Document Properties</h4>
<p>This program is an example setting document properties. See the
<a class="reference internal" href="index.html#set_properties" title="set_properties"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_properties()</span></code></a> workbook method for more details.</p>
<img alt="_images/doc_properties.png" src="_images/doc_properties.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of adding document properties to a XlsxWriter file.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;doc_properties.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">set_properties</span><span class="p">({</span>
    <span class="s1">&#39;title&#39;</span><span class="p">:</span>    <span class="s1">&#39;This is an example spreadsheet&#39;</span><span class="p">,</span>
    <span class="s1">&#39;subject&#39;</span><span class="p">:</span>  <span class="s1">&#39;With document properties&#39;</span><span class="p">,</span>
    <span class="s1">&#39;author&#39;</span><span class="p">:</span>   <span class="s1">&#39;John McNamara&#39;</span><span class="p">,</span>
    <span class="s1">&#39;manager&#39;</span><span class="p">:</span>  <span class="s1">&#39;Dr. Heinz Doofenshmirtz&#39;</span><span class="p">,</span>
    <span class="s1">&#39;company&#39;</span><span class="p">:</span>  <span class="s1">&#39;of Wolves&#39;</span><span class="p">,</span>
    <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="s1">&#39;Example spreadsheets&#39;</span><span class="p">,</span>
    <span class="s1">&#39;keywords&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample, Example, Properties&#39;</span><span class="p">,</span>
    <span class="s1">&#39;comments&#39;</span><span class="p">:</span> <span class="s1">&#39;Created with Python and XlsxWriter&#39;</span><span class="p">,</span>
    <span class="s1">&#39;status&#39;</span><span class="p">:</span>   <span class="s1">&#39;Quo&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s2">&quot;Select &#39;Workbook Properties&#39; to see properties.&quot;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_unicode_python2"></span><div class="section" id="example-simple-unicode-with-python-2">
<span id="ex-unicode-python2"></span><h4>Example: Simple Unicode with Python 2</h4>
<p>To write Unicode text in UTF-8 to a xlsxwriter file in Python 2:</p>
<ol class="arabic simple">
<li>Encode the file as UTF-8.</li>
<li>Include a “coding” directive at the start of the file.</li>
<li>Use <code class="docutils literal notranslate"><span class="pre">u''</span></code> to indicate a Unicode string.</li>
</ol>
<img alt="_images/unicode_python2.png" src="_images/unicode_python2.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1"># _*_ coding: utf-8</span>
<span class="c1">#</span>
<span class="c1"># A simple Unicode spreadsheet in Python 2 using the XlsxWriter Python module.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="c1"># To write Unicode text in UTF-8 to a xlsxwriter file in Python 2:</span>
<span class="c1">#</span>
<span class="c1"># 1. Encode the file as UTF-8.</span>
<span class="c1"># 2. Include the &quot;coding&quot; directive at the start of the file.</span>
<span class="c1"># 3. Use u&#39;&#39; to indicate a Unicode string.</span>

<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;unicode_python2.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="sa">u</span><span class="s1">&#39;Это фраза на русском!&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_unicode_python3"></span><div class="section" id="example-simple-unicode-with-python-3">
<span id="ex-unicode-python3"></span><h4>Example: Simple Unicode with Python 3</h4>
<p>To write Unicode text in UTF-8 to a xlsxwriter file in Python 3:</p>
<ol class="arabic simple">
<li>Encode the file as UTF-8.</li>
</ol>
<img alt="_images/unicode_python3.png" src="_images/unicode_python3.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1">#</span>
<span class="c1"># A simple Unicode spreadsheet in Python 3 using the XlsxWriter Python module.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="c1"># To write Unicode text in UTF-8 to a xlsxwriter file in Python 3:</span>
<span class="c1">#</span>
<span class="c1"># 1. Encode the file as UTF-8.</span>
<span class="c1">#</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;unicode_python3.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;Это фраза на русском!&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_unicode_polish_utf8"></span><div class="section" id="example-unicode-polish-in-utf-8">
<span id="ex-unicode-polish-utf8"></span><h4>Example: Unicode - Polish in UTF-8</h4>
<p>This program is an example of reading in data from a UTF-8 encoded text file
and converting it to a worksheet.</p>
<p>The main trick is to ensure that the data read in is converted to UTF-8
within the Python program. The XlsxWriter module will then take care of
writing the encoding to the Excel file.</p>
<p>The encoding of the input data shouldn’t matter once it can be converted
to UTF-8 via the <a class="reference external" href="https://docs.python.org/3/library/codecs.html#module-codecs" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">codecs</span></code></a> module.</p>
<img alt="_images/unicode_polish_utf8.png" src="_images/unicode_polish_utf8.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># A simple example of converting some Unicode text to an Excel file using</span>
<span class="c1"># the XlsxWriter Python module.</span>
<span class="c1">#</span>
<span class="c1"># This example generates a spreadsheet with some Polish text from a file</span>
<span class="c1"># with UTF8 encoded text.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">codecs</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="c1"># Open the input file with the correct encoding.</span>
<span class="n">textfile</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;unicode_polish_utf8.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

<span class="c1"># Create an new Excel file and convert the text data.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;unicode_polish_utf8.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Widen the first column to make the text clearer.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># Start from the first cell.</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Read the text file and write it to the worksheet.</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">textfile</span><span class="p">:</span>
    <span class="c1"># Ignore the comments in the text file.</span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
        <span class="k">continue</span>

    <span class="c1"># Write any other lines to the worksheet.</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_unicode_shift_jis"></span><div class="section" id="example-unicode-shift-jis">
<span id="ex-unicode-shift-jis"></span><h4>Example: Unicode - Shift JIS</h4>
<p>This program is an example of reading in data from a Shift JIS encoded text
file and converting it to a worksheet.</p>
<p>The main trick is to ensure that the data read in is converted to UTF-8
within the Python program. The XlsxWriter module will then take care of
writing the encoding to the Excel file.</p>
<p>The encoding of the input data shouldn’t matter once it can be converted
to UTF-8 via the <a class="reference external" href="https://docs.python.org/3/library/codecs.html#module-codecs" title="(in Python v3.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">codecs</span></code></a> module.</p>
<img alt="_images/unicode_shift_jis.png" src="_images/unicode_shift_jis.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># A simple example of converting some Unicode text to an Excel file using</span>
<span class="c1"># the XlsxWriter Python module.</span>
<span class="c1">#</span>
<span class="c1"># This example generates a spreadsheet with some Japanese text from a file</span>
<span class="c1"># with Shift-JIS encoded text.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">codecs</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="c1"># Open the input file with the correct encoding.</span>
<span class="n">textfile</span> <span class="o">=</span> <span class="n">codecs</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;unicode_shift_jis.txt&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;shift_jis&#39;</span><span class="p">)</span>

<span class="c1"># Create an new Excel file and convert the text data.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;unicode_shift_jis.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Widen the first column to make the text clearer.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># Start from the first cell.</span>
<span class="n">row</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">col</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Read the text file and write it to the worksheet.</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">textfile</span><span class="p">:</span>
    <span class="c1"># Ignore the comments in the text file.</span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
        <span class="k">continue</span>

    <span class="c1"># Write any other lines to the worksheet.</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>
    <span class="n">row</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_tab_colors"></span><div class="section" id="example-setting-worksheet-tab-colors">
<span id="ex-tab-colors"></span><h4>Example: Setting Worksheet Tab Colors</h4>
<p>This program is an example of setting worksheet tab colors. See the
<a class="reference internal" href="index.html#set_tab_color" title="set_tab_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_tab_color()</span></code></a> method for more details.</p>
<img alt="_images/tab_colors.png" src="_images/tab_colors.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of how to set Excel worksheet tab colors using Python</span>
<span class="c1"># and the XlsxWriter module.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;tab_colors.xlsx&#39;</span><span class="p">)</span>

<span class="c1"># Set up some worksheets.</span>
<span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Set tab colors</span>
<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_tab_color</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_tab_color</span><span class="p">(</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_tab_color</span><span class="p">(</span><span class="s1">&#39;#FF9900&#39;</span><span class="p">)</span>  <span class="c1"># Orange</span>

<span class="c1"># worksheet4 will have the default color.</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_diagonal_border"></span><div class="section" id="example-diagonal-borders-in-cells">
<span id="ex-diagonal-border"></span><h4>Example: Diagonal borders in cells</h4>
<p>Example of how to set diagonal borders in a cell.</p>
<img alt="_images/diagonal_border.png" src="_images/diagonal_border.png" />
<p>See <a class="reference internal" href="index.html#set_diag_border" title="set_diag_border"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_diag_border()</span></code></a>, <a class="reference internal" href="index.html#set_diag_type" title="set_diag_type"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_diag_type()</span></code></a> and <a class="reference internal" href="index.html#set_diag_border" title="set_diag_border"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_diag_border()</span></code></a>
for details.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># A simple formatting example that demonstrates how to add diagonal cell</span>
<span class="c1"># borders with XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;diag_border.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">format1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;diag_type&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">format2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;diag_type&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="n">format3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;diag_type&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>

<span class="n">format4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
    <span class="s1">&#39;diag_type&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="s1">&#39;diag_border&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span>
    <span class="s1">&#39;diag_color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;Text&#39;</span><span class="p">,</span> <span class="n">format1</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B6&#39;</span><span class="p">,</span> <span class="s1">&#39;Text&#39;</span><span class="p">,</span> <span class="n">format2</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B9&#39;</span><span class="p">,</span> <span class="s1">&#39;Text&#39;</span><span class="p">,</span> <span class="n">format3</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B12&#39;</span><span class="p">,</span> <span class="s1">&#39;Text&#39;</span><span class="p">,</span> <span class="n">format4</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_protection"></span><div class="section" id="example-enabling-cell-protection-in-worksheets">
<span id="ex-protection"></span><h4>Example: Enabling Cell protection in Worksheets</h4>
<p>This program is an example cell locking and formula hiding in an Excel
worksheet using the <a class="reference internal" href="index.html#protect" title="protect"><code class="xref py py-func docutils literal notranslate"><span class="pre">protect()</span></code></a> worksheet method and the Format
<a class="reference internal" href="index.html#set_locked" title="set_locked"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_locked()</span></code></a> property.</p>
<p>Note, that Excel’s behavior is that all cells are locked once you set the
default protection. Therefore you need to explicitly unlock cells rather than
explicitly lock them.</p>
<img alt="_images/worksheet_protection.png" src="_images/worksheet_protection.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">########################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of cell locking and formula hiding in an Excel worksheet</span>
<span class="c1"># using Python and the XlsxWriter module.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;protection.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Create some cell formats with protection properties.</span>
<span class="n">unlocked</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;locked&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>
<span class="n">hidden</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Format the columns to make the text more visible.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>

<span class="c1"># Turn worksheet protection on.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">protect</span><span class="p">()</span>

<span class="c1"># Write a locked, unlocked and hidden cell.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Cell B1 is locked. It cannot be edited.&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;Cell B2 is unlocked. It can be edited.&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="s2">&quot;Cell B3 is hidden. The formula isn&#39;t visible.&quot;</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;=1+2&#39;</span><span class="p">)</span>  <span class="c1"># Locked by default.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;=1+2&#39;</span><span class="p">,</span> <span class="n">unlocked</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;=1+2&#39;</span><span class="p">,</span> <span class="n">hidden</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_hide_sheet"></span><div class="section" id="example-hiding-worksheets">
<span id="ex-hide-sheet"></span><h4>Example: Hiding Worksheets</h4>
<p>This program is an example of how to hide a worksheet using the
<a class="reference internal" href="index.html#hide" title="hide"><code class="xref py py-func docutils literal notranslate"><span class="pre">hide()</span></code></a> method.</p>
<img alt="_images/hide_sheet.png" src="_images/hide_sheet.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of how to hide a worksheet with XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;hide_sheet.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">worksheet3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="c1"># Hide Sheet2. It won&#39;t be visible until it is unhidden in Excel.</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>

<span class="n">worksheet1</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Sheet2 is hidden&#39;</span><span class="p">)</span>
<span class="n">worksheet2</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s2">&quot;Now it&#39;s my turn to find you!&quot;</span><span class="p">)</span>
<span class="n">worksheet3</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Sheet2 is hidden&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_hide_row_col"></span><div class="section" id="example-hiding-rows-and-columns">
<span id="ex-hide-row-col"></span><h4>Example: Hiding Rows and Columns</h4>
<p>This program is an example of how to hide rows and columns in XlsxWriter.</p>
<p>An individual row can be hidden using the <a class="reference internal" href="index.html#set_row" title="set_row"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_row()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>However, in order to hide a large number of rows, for example all the rows
after row 8, we need to use an Excel optimization to hide rows without setting
each one, (of approximately 1 million rows). To do this we use the
<a class="reference internal" href="index.html#set_default_row" title="set_default_row"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_default_row()</span></code></a> method.</p>
<p>Columns don’t require this optimization and can be hidden using
<a class="reference internal" href="index.html#set_column" title="set_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_column()</span></code></a>.</p>
<img alt="_images/hide_row_col.png" src="_images/hide_row_col.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of how to hide rows and columns in XlsxWriter. In order to</span>
<span class="c1"># hide rows without setting each one, (of approximately 1 million rows),</span>
<span class="c1"># Excel uses an optimizations to hide all rows that don&#39;t have data.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;hide_row_col.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Write some data.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;Some hidden columns.&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A8&#39;</span><span class="p">,</span> <span class="s1">&#39;Some hidden rows.&#39;</span><span class="p">)</span>

<span class="c1"># Hide all rows without data.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_default_row</span><span class="p">(</span><span class="n">hide_unused_rows</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Set the height of empty rows that we do want to display even if it is</span>
<span class="c1"># the default height.</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">set_row</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>

<span class="c1"># Columns can be hidden explicitly. This doesn&#39;t increase the file size..</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;G:XFD&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;hidden&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_inheritance1"></span><div class="section" id="example-example-of-subclassing-the-workbook-and-worksheet-classes">
<span id="ex-inheritance1"></span><h4>Example: Example of subclassing the Workbook and Worksheet classes</h4>
<p>Example of how to subclass the Workbook and Worksheet objects.</p>
<p>We also override the default <code class="docutils literal notranslate"><span class="pre">worksheet.write()</span></code> method to show how that is
done.</p>
<img alt="_images/inheritance1.png" src="_images/inheritance1.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of how to subclass the Workbook and Worksheet objects. We also</span>
<span class="c1"># override the default worksheet.write() method to show how that is done.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">xlsxwriter.workbook</span> <span class="k">import</span> <span class="n">Workbook</span>
<span class="kn">from</span> <span class="nn">xlsxwriter.worksheet</span> <span class="k">import</span> <span class="n">Worksheet</span>
<span class="kn">from</span> <span class="nn">xlsxwriter.worksheet</span> <span class="k">import</span> <span class="n">convert_cell_args</span>
<span class="kn">from</span> <span class="nn">xlsxwriter.compatibility</span> <span class="k">import</span> <span class="n">str_types</span>


<span class="k">class</span> <span class="nc">MyWorksheet</span><span class="p">(</span><span class="n">Worksheet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Subclass of the XlsxWriter Worksheet class to override the default</span>
<span class="sd">    write() method.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@convert_cell_args</span>
    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>

        <span class="n">data</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Reverse strings to demonstrate the overridden method.</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">str_types</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Call the parent version of write() as usual for other data.</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">MyWorksheet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MyWorkbook</span><span class="p">(</span><span class="n">Workbook</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Subclass of the XlsxWriter Workbook class to override the default</span>
<span class="sd">    Worksheet class with our custom class.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">add_worksheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Overwrite add_worksheet() to create a MyWorksheet object.</span>
        <span class="n">worksheet</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">MyWorkbook</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">MyWorksheet</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">worksheet</span>


<span class="c1"># Create a new MyWorkbook object.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">MyWorkbook</span><span class="p">(</span><span class="s1">&#39;inheritance1.xlsx&#39;</span><span class="p">)</span>

<span class="c1"># The code from now on will be the same as a normal &quot;Workbook&quot; program.</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Write some data to test the subclassing.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;World&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="mi">123</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A4&#39;</span><span class="p">,</span> <span class="mi">345</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_inheritance2"></span><div class="section" id="example-advanced-example-of-subclassing">
<span id="ex-inheritance2"></span><h4>Example: Advanced example of subclassing</h4>
<p>Example of how to subclass the Workbook and Worksheet objects. See also the
simpler <a class="reference internal" href="index.html#ex-inheritance1"><span class="std std-ref">inheritance1.py</span></a> example.</p>
<p>In this example we see an approach to implementing a simulated autofit in a
user application. This works by overriding the <code class="docutils literal notranslate"><span class="pre">write_string()</span></code> method to
track the maximum width string in each column and then set the column widths
when closing the workbook.</p>
<p>Some notes on this:</p>
<ul class="simple">
<li><strong>This isn’t a fully functional autofit example</strong> (as shown by the longer
strings in the screen shot). It is only a proof or concept or a framework to
try out solutions.</li>
<li>The hard part is coming up with an accurate (or mainly accurate)
<code class="docutils literal notranslate"><span class="pre">excel_string_width()</span></code> function. One possibility is to use the PIL
<a class="reference external" href="https://pillow.readthedocs.io/en/latest/reference/ImageFont.html">ImageFont()</a> method
and convert the pixel width back to a character width.</li>
<li>A more rigorous approach would have to consider font sizes, bold, italic,
etc.</li>
<li>The <code class="docutils literal notranslate"><span class="pre">set_column()</span></code> calls in <code class="docutils literal notranslate"><span class="pre">close()</span></code> will override any others set by the
user. They also don’t set any column formats.</li>
<li>It doesn’t work for horizontal merge ranges.</li>
<li>There are probably some other corner cases hiding here.</li>
</ul>
<img alt="_images/inheritance2.png" src="_images/inheritance2.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example of how to subclass the Workbook and Worksheet objects. See also the</span>
<span class="c1"># simpler inheritance1.py example.</span>
<span class="c1">#</span>
<span class="c1"># In this example we see an approach to implementing a simulated autofit in a</span>
<span class="c1"># user application. This works by overriding the write_string() method to</span>
<span class="c1"># track the maximum width string in each column and then set the column</span>
<span class="c1"># widths.</span>
<span class="c1">#</span>
<span class="c1"># Note: THIS ISN&#39;T A FULLY FUNCTIONAL AUTOFIT EXAMPLE. It is only a proof or</span>
<span class="c1"># concept or a framework to try out solutions.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">xlsxwriter.workbook</span> <span class="k">import</span> <span class="n">Workbook</span>
<span class="kn">from</span> <span class="nn">xlsxwriter.worksheet</span> <span class="k">import</span> <span class="n">Worksheet</span>
<span class="kn">from</span> <span class="nn">xlsxwriter.worksheet</span> <span class="k">import</span> <span class="n">convert_cell_args</span>


<span class="k">def</span> <span class="nf">excel_string_width</span><span class="p">(</span><span class="nb">str</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the length of the string in Excel character units. This is only</span>
<span class="sd">    an example and won&#39;t give accurate results. It will need to be replaced</span>
<span class="sd">    by something more rigorous.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">string_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">string_width</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">string_width</span> <span class="o">*</span> <span class="mf">1.1</span>


<span class="k">class</span> <span class="nc">MyWorksheet</span><span class="p">(</span><span class="n">Worksheet</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Subclass of the XlsxWriter Worksheet class to override the default</span>
<span class="sd">    write_string() method.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@convert_cell_args</span>
    <span class="k">def</span> <span class="nf">write_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">cell_format</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Overridden write_string() method to store the maximum string width</span>
        <span class="c1"># seen in each column.</span>

        <span class="c1"># Check that row and col are valid and store max and min values.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_dimensions</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>

        <span class="c1"># Set the min width for the cell. In some cases this might be the</span>
        <span class="c1"># default width of 8.43. In this case we use 0 and adjust for all</span>
        <span class="c1"># string widths.</span>
        <span class="n">min_width</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Check if it the string is the largest we have seen for this column.</span>
        <span class="n">string_width</span> <span class="o">=</span> <span class="n">excel_string_width</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">string_width</span> <span class="o">&gt;</span> <span class="n">min_width</span><span class="p">:</span>
            <span class="n">max_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_column_widths</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">min_width</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">string_width</span> <span class="o">&gt;</span> <span class="n">max_width</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">max_column_widths</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">string_width</span>

        <span class="c1"># Now call the parent version of write_string() as usual.</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">MyWorksheet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">write_string</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span>
                                                     <span class="n">cell_format</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MyWorkbook</span><span class="p">(</span><span class="n">Workbook</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Subclass of the XlsxWriter Workbook class to override the default</span>
<span class="sd">    Worksheet class with our custom class.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">add_worksheet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Overwrite add_worksheet() to create a MyWorksheet object.</span>
        <span class="c1"># Also add an Worksheet attribute to store the column widths.</span>
        <span class="n">worksheet</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">MyWorkbook</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">MyWorksheet</span><span class="p">)</span>
        <span class="n">worksheet</span><span class="o">.</span><span class="n">max_column_widths</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="n">worksheet</span>

    <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># We apply the stored column widths for each worksheet when we close</span>
        <span class="c1"># the workbook. This will override any other set_column() values that</span>
        <span class="c1"># may have been applied. This could be handled in the application code</span>
        <span class="c1"># below, instead.</span>
        <span class="k">for</span> <span class="n">worksheet</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">worksheets</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">column</span><span class="p">,</span> <span class="n">width</span> <span class="ow">in</span> <span class="n">worksheet</span><span class="o">.</span><span class="n">max_column_widths</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">MyWorkbook</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="c1"># Create a new MyWorkbook object.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">MyWorkbook</span><span class="p">(</span><span class="s1">&#39;inheritance2.xlsx&#39;</span><span class="p">)</span>

<span class="c1"># The code from now on will be the same as a normal &quot;Workbook&quot; program.</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Write some data to test column fitting.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;Foo&#39;</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;Fo&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="s1">&#39;Foo&#39;</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;C4&#39;</span><span class="p">,</span> <span class="s1">&#39;Food&#39;</span><span class="p">)</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;This is a longer string&#39;</span><span class="p">)</span>

<span class="c1"># Write a string in row-col notation.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Hello World&#39;</span><span class="p">)</span>

<span class="c1"># Write a number.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">123456</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_macros"></span><div class="section" id="example-adding-a-vba-macro-to-a-workbook">
<span id="ex-macros"></span><h4>Example: Adding a VBA macro to a Workbook</h4>
<p>This program is an example of how to add a button connected to a VBA macro to
a worksheet.</p>
<p>See <a class="reference internal" href="index.html#macros"><span class="std std-ref">Working with VBA Macros</span></a> for more details.</p>
<img alt="_images/macros.png" src="_images/macros.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of adding macros to an XlsxWriter file using a VBA project</span>
<span class="c1"># file extracted from an existing Excel xlsm file.</span>
<span class="c1">#</span>
<span class="c1"># The vba_extract.py utility supplied with XlsxWriter can be used to extract</span>
<span class="c1"># the vbaProject.bin file.</span>
<span class="c1">#</span>
<span class="c1"># An embedded macro is connected to a form button on the worksheet.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="c1"># Note the file extension should be .xlsm.</span>
<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;macros.xlsm&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

<span class="c1"># Add the VBA project binary.</span>
<span class="n">workbook</span><span class="o">.</span><span class="n">add_vba_project</span><span class="p">(</span><span class="s1">&#39;./vbaProject.bin&#39;</span><span class="p">)</span>

<span class="c1"># Show text for the end user.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="s1">&#39;Press the button to say hello.&#39;</span><span class="p">)</span>

<span class="c1"># Add a button tied to a macro in the VBA project.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_button</span><span class="p">(</span><span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;macro&#39;</span><span class="p">:</span> <span class="s1">&#39;say_hello&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;caption&#39;</span><span class="p">:</span> <span class="s1">&#39;Press Me&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span>
                               <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<span id="document-chart_examples"></span><div class="section" id="chart-examples">
<span id="id1"></span><h3>Chart Examples</h3>
<p>The following are some of the examples included in the
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/tree/master/examples">examples</a>
directory of the XlsxWriter distribution.</p>
<div class="toctree-wrapper compound">
<span id="document-example_chart_simple"></span><div class="section" id="example-chart-simple">
<span id="ex-chart-simple"></span><h4>Example: Chart (Simple)</h4>
<p>Example of a simple column chart with 3 data series:</p>
<a class="reference internal image-reference" href="_images/chart_simple.png"><img alt="_images/chart_simple.png" src="_images/chart_simple.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>See the <a class="reference internal" href="index.html#chart-class"><span class="std std-ref">The Chart Class</span></a> and <a class="reference internal" href="index.html#working-with-charts"><span class="std std-ref">Working with Charts</span></a> for more details.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of a simple Excel chart with Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Create a new Chart object.</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Write some data to add to plot on the chart.</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># Configure the charts. In simplest case we just add some data series.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$5&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$1:$B$5&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$1:$C$5&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;A7&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_area"></span><div class="section" id="example-area-chart">
<span id="ex-chart-area"></span><h4>Example: Area Chart</h4>
<p>Example of creating Excel Area charts.</p>
<p>Chart 1 in the following example is a default area chart:</p>
<a class="reference internal image-reference" href="_images/chart_area1.png"><img alt="_images/chart_area1.png" src="_images/chart_area1.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>Chart 2 is a stacked area chart:</p>
<a class="reference internal image-reference" href="_images/chart_area2.png"><img alt="_images/chart_area2.png" src="_images/chart_area2.png" style="width: 705.0px; height: 403.5px;" /></a>
<p>Chart 3 is a percentage stacked area chart:</p>
<a class="reference internal image-reference" href="_images/chart_area3.png"><img alt="_images/chart_area3.png" src="_images/chart_area3.png" style="width: 705.0px; height: 402.75px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating Excel Area charts with Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_area.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 2&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create an area chart.</span>
<span class="c1">#</span>
<span class="n">chart1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;area&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure a second series. Note use of alternative syntax to define ranges.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Results of sample analysis&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a stacked area chart sub-type.</span>
<span class="c1">#</span>
<span class="n">chart2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;stacked&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Stacked Chart&#39;</span><span class="p">})</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D18&#39;</span><span class="p">,</span> <span class="n">chart2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a percent stacked area chart sub-type.</span>
<span class="c1">#</span>
<span class="n">chart3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;percent_stacked&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Percent Stacked Chart&#39;</span><span class="p">})</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D34&#39;</span><span class="p">,</span> <span class="n">chart3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_bar"></span><div class="section" id="example-bar-chart">
<span id="ex-chart-bar"></span><h4>Example: Bar Chart</h4>
<p>Example of creating Excel Bar charts.</p>
<p>Chart 1 in the following example is a default bar chart:</p>
<a class="reference internal image-reference" href="_images/chart_bar1.png"><img alt="_images/chart_bar1.png" src="_images/chart_bar1.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>Chart 2 is a stacked bar chart:</p>
<a class="reference internal image-reference" href="_images/chart_bar2.png"><img alt="_images/chart_bar2.png" src="_images/chart_bar2.png" style="width: 705.0px; height: 403.5px;" /></a>
<p>Chart 3 is a percentage stacked bar chart:</p>
<a class="reference internal image-reference" href="_images/chart_bar3.png"><img alt="_images/chart_bar3.png" src="_images/chart_bar3.png" style="width: 705.0px; height: 402.75px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating Excel Bar charts with Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_bar.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 2&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a new bar chart.</span>
<span class="c1">#</span>
<span class="n">chart1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure a second series. Note use of alternative syntax to define ranges.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Results of sample analysis&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a stacked chart sub-type.</span>
<span class="c1">#</span>
<span class="n">chart2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;stacked&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Stacked Chart&#39;</span><span class="p">})</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D18&#39;</span><span class="p">,</span> <span class="n">chart2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a percentage stacked chart sub-type.</span>
<span class="c1">#</span>
<span class="n">chart3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;percent_stacked&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Percent Stacked Chart&#39;</span><span class="p">})</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D34&#39;</span><span class="p">,</span> <span class="n">chart3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_column"></span><div class="section" id="example-column-chart">
<span id="ex-chart-column"></span><h4>Example: Column Chart</h4>
<p>Example of creating Excel Column charts.</p>
<p>Chart 1 in the following example is a default column chart:</p>
<a class="reference internal image-reference" href="_images/chart_column1.png"><img alt="_images/chart_column1.png" src="_images/chart_column1.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>Chart 2 is a stacked column chart:</p>
<a class="reference internal image-reference" href="_images/chart_column2.png"><img alt="_images/chart_column2.png" src="_images/chart_column2.png" style="width: 705.0px; height: 403.5px;" /></a>
<p>Chart 3 is a percentage stacked column chart:</p>
<a class="reference internal image-reference" href="_images/chart_column3.png"><img alt="_images/chart_column3.png" src="_images/chart_column3.png" style="width: 705.0px; height: 402.75px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating Excel Column charts with Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_column.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 2&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a new column chart.</span>
<span class="c1">#</span>
<span class="n">chart1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure a second series. Note use of alternative syntax to define ranges.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Results of sample analysis&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a stacked chart sub-type.</span>
<span class="c1">#</span>
<span class="n">chart2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span> <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;stacked&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Stacked Chart&#39;</span><span class="p">})</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D18&#39;</span><span class="p">,</span> <span class="n">chart2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a percentage stacked chart sub-type.</span>
<span class="c1">#</span>
<span class="n">chart3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">,</span> <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;percent_stacked&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Percent Stacked Chart&#39;</span><span class="p">})</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D34&#39;</span><span class="p">,</span> <span class="n">chart3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_line"></span><div class="section" id="example-line-chart">
<span id="ex-chart-line"></span><h4>Example: Line Chart</h4>
<p>Example of creating an Excel line charts. The X axis of a line chart is a
category axis with fixed point spacing. For a line chart with arbitrary point
spacing see the Scatter chart type.</p>
<p>Chart 1 in the following example is a default line chart:</p>
<a class="reference internal image-reference" href="_images/chart_line1.png"><img alt="_images/chart_line1.png" src="_images/chart_line1.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>Chart 2 is a stacked line chart:</p>
<a class="reference internal image-reference" href="_images/chart_line2.png"><img alt="_images/chart_line2.png" src="_images/chart_line2.png" style="width: 704.25px; height: 403.5px;" /></a>
<p>Chart 3 is a percentage stacked line chart:</p>
<a class="reference internal image-reference" href="_images/chart_line3.png"><img alt="_images/chart_line3.png" src="_images/chart_line3.png" style="width: 704.25px; height: 402.75px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating Excel Line charts with Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_line.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 2&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1"># Create a new chart object. In this case an embedded chart.</span>
<span class="n">chart1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure a second series. Note use of alternative syntax to define ranges.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Results of sample analysis&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style. Colors with white outline and shadow.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a stacked line chart sub-type.</span>
<span class="c1">#</span>
<span class="n">chart2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;stacked&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Stacked Chart&#39;</span><span class="p">})</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D18&#39;</span><span class="p">,</span> <span class="n">chart2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a percent stacked line chart sub-type.</span>
<span class="c1">#</span>
<span class="n">chart3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;percent_stacked&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Percent Stacked Chart&#39;</span><span class="p">})</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D34&#39;</span><span class="p">,</span> <span class="n">chart3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_pie"></span><div class="section" id="example-pie-chart">
<span id="ex-chart-pie"></span><h4>Example: Pie Chart</h4>
<p>Example of creating Excel Pie charts. Chart 1 in the following example is:</p>
<a class="reference internal image-reference" href="_images/chart_pie1.png"><img alt="_images/chart_pie1.png" src="_images/chart_pie1.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>Chart 2 shows how to set segment colors.</p>
<p>It is possible to define chart colors for most types of XlsxWriter charts via
the <a class="reference internal" href="index.html#add_series" title="add_series"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_series()</span></code></a> method. However, Pie charts are a special case since
each segment is represented as a point and as such it is necessary to assign
formatting to each point in the series.</p>
<a class="reference internal image-reference" href="_images/chart_pie2.png"><img alt="_images/chart_pie2.png" src="_images/chart_pie2.png" style="width: 704.25px; height: 403.5px;" /></a>
<p>Chart 3 shows how to rotate the segments of the chart:</p>
<a class="reference internal image-reference" href="_images/chart_pie3.png"><img alt="_images/chart_pie3.png" src="_images/chart_pie3.png" style="width: 704.25px; height: 403.5px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating Excel Pie charts with Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># The demo also shows how to set segment colors. It is possible to</span>
<span class="c1"># define chart colors for most types of XlsxWriter charts</span>
<span class="c1"># via the add_series() method. However, Pie/Doughnut charts are a special</span>
<span class="c1"># case since each segment is represented as a point so it is necessary to</span>
<span class="c1"># assign formatting to each point in the series.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_pie.xlsx&#39;</span><span class="p">)</span>

<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">,</span> <span class="s1">&#39;Values&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Apple&#39;</span><span class="p">,</span> <span class="s1">&#39;Cherry&#39;</span><span class="p">,</span> <span class="s1">&#39;Pecan&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a new chart object.</span>
<span class="c1">#</span>
<span class="n">chart1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;pie&#39;</span><span class="p">})</span>

<span class="c1"># Configure the series. Note the use of the list syntax to define ranges:</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;Pie sales data&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">})</span>

<span class="c1"># Add a title.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Popular Pie Types&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style. Colors with white outline and shadow.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">chart1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a Pie chart with user defined segment colors.</span>
<span class="c1">#</span>

<span class="c1"># Create an example Pie chart like above.</span>
<span class="n">chart2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;pie&#39;</span><span class="p">})</span>

<span class="c1"># Configure the series and add user defined segment colors.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Pie sales data&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#5ABA10&#39;</span><span class="p">}},</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#FE110E&#39;</span><span class="p">}},</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#CA5C05&#39;</span><span class="p">}},</span>
    <span class="p">],</span>
<span class="p">})</span>

<span class="c1"># Add a title.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Pie Chart with user defined colors&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;C18&#39;</span><span class="p">,</span> <span class="n">chart2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a Pie chart with rotation of the segments.</span>
<span class="c1">#</span>

<span class="c1"># Create an example Pie chart like above.</span>
<span class="n">chart3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;pie&#39;</span><span class="p">})</span>

<span class="c1"># Configure the series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Pie sales data&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$4&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a title.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Pie Chart with segment rotation&#39;</span><span class="p">})</span>

<span class="c1"># Change the angle/rotation of the first segment.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;C34&#39;</span><span class="p">,</span> <span class="n">chart3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_doughnut"></span><div class="section" id="example-doughnut-chart">
<span id="ex-chart-doughnut"></span><h4>Example: Doughnut Chart</h4>
<p>Example of creating Excel Doughnut charts. Chart 1 in the following example is:</p>
<a class="reference internal image-reference" href="_images/chart_doughnut1.png"><img alt="_images/chart_doughnut1.png" src="_images/chart_doughnut1.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>Chart 4 shows how to set segment colors and other options.</p>
<p>It is possible to define chart colors for most types of XlsxWriter charts via
the <a class="reference internal" href="index.html#add_series" title="add_series"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_series()</span></code></a> method. However, Pie/Doughnut charts are a special
case since each segment is represented as a point and as such it is necessary
to assign formatting to each point in the series.</p>
<a class="reference internal image-reference" href="_images/chart_doughnut2.png"><img alt="_images/chart_doughnut2.png" src="_images/chart_doughnut2.png" style="width: 704.25px; height: 402.75px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating Excel Doughnut charts with Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># The demo also shows how to set segment colors. It is possible to</span>
<span class="c1"># define chart colors for most types of XlsxWriter charts</span>
<span class="c1"># via the add_series() method. However, Pie/Doughnut charts are a special</span>
<span class="c1"># case since each segment is represented as a point so it is necessary to</span>
<span class="c1"># assign formatting to each point in the series.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_doughnut.xlsx&#39;</span><span class="p">)</span>

<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">,</span> <span class="s1">&#39;Values&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Glazed&#39;</span><span class="p">,</span> <span class="s1">&#39;Chocolate&#39;</span><span class="p">,</span> <span class="s1">&#39;Cream&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a new chart object.</span>
<span class="c1">#</span>
<span class="n">chart1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;doughnut&#39;</span><span class="p">})</span>

<span class="c1"># Configure the series. Note the use of the list syntax to define ranges:</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;Doughnut sales data&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">})</span>

<span class="c1"># Add a title.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Popular Doughnut Types&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style. Colors with white outline and shadow.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">chart1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a Doughnut chart with user defined segment colors.</span>
<span class="c1">#</span>

<span class="c1"># Create an example Doughnut chart like above.</span>
<span class="n">chart2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;doughnut&#39;</span><span class="p">})</span>

<span class="c1"># Configure the series and add user defined segment colors.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Doughnut sales data&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#FA58D0&#39;</span><span class="p">}},</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#61210B&#39;</span><span class="p">}},</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#F5F6CE&#39;</span><span class="p">}},</span>
    <span class="p">],</span>
<span class="p">})</span>

<span class="c1"># Add a title.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Doughnut Chart with user defined colors&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;C18&#39;</span><span class="p">,</span> <span class="n">chart2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a Doughnut chart with rotation of the segments.</span>
<span class="c1">#</span>

<span class="c1"># Create an example Doughnut chart like above.</span>
<span class="n">chart3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;doughnut&#39;</span><span class="p">})</span>

<span class="c1"># Configure the series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Doughnut sales data&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$4&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a title.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Doughnut Chart with segment rotation&#39;</span><span class="p">})</span>

<span class="c1"># Change the angle/rotation of the first segment.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;C34&#39;</span><span class="p">,</span> <span class="n">chart3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>


<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a Doughnut chart with user defined hole size and other options.</span>
<span class="c1">#</span>

<span class="c1"># Create an example Doughnut chart like above.</span>
<span class="n">chart4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;doughnut&#39;</span><span class="p">})</span>

<span class="c1"># Configure the series.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Doughnut sales data&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#FA58D0&#39;</span><span class="p">}},</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#61210B&#39;</span><span class="p">}},</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#F5F6CE&#39;</span><span class="p">}},</span>
    <span class="p">],</span>
<span class="p">})</span>

<span class="c1"># Set a 3D style.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span>

<span class="c1"># Add a title.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Doughnut Chart with options applied&#39;</span><span class="p">})</span>

<span class="c1"># Change the angle/rotation of the first segment.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">28</span><span class="p">)</span>

<span class="c1"># Change the hole size.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">set_hole_size</span><span class="p">(</span><span class="mi">33</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;C50&#39;</span><span class="p">,</span> <span class="n">chart4</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>


<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_scatter"></span><div class="section" id="example-scatter-chart">
<span id="ex-chart-scatter"></span><h4>Example: Scatter Chart</h4>
<p>Example of creating Excel Scatter charts.</p>
<p>Chart 1 in the following example is a default scatter chart:</p>
<a class="reference internal image-reference" href="_images/chart_scatter1.png"><img alt="_images/chart_scatter1.png" src="_images/chart_scatter1.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>Chart 2 is a scatter chart with straight lines and markers:</p>
<a class="reference internal image-reference" href="_images/chart_scatter2.png"><img alt="_images/chart_scatter2.png" src="_images/chart_scatter2.png" style="width: 705.0px; height: 403.5px;" /></a>
<p>Chart 3 is a scatter chart with straight lines and no markers:</p>
<a class="reference internal image-reference" href="_images/chart_scatter3.png"><img alt="_images/chart_scatter3.png" src="_images/chart_scatter3.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>Chart 4 is a scatter chart with smooth lines and markers:</p>
<a class="reference internal image-reference" href="_images/chart_scatter4.png"><img alt="_images/chart_scatter4.png" src="_images/chart_scatter4.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>Chart 5 is a scatter chart with smooth lines and no markers:</p>
<a class="reference internal image-reference" href="_images/chart_scatter5.png"><img alt="_images/chart_scatter5.png" src="_images/chart_scatter5.png" style="width: 705.0px; height: 403.5px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating Excel Scatter charts with Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_scatter.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 2&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>


<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a new scatter chart.</span>
<span class="c1">#</span>
<span class="n">chart1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;scatter&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series. Note use of alternative syntax to define ranges.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Results of sample analysis&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a scatter chart sub-type with straight lines and markers.</span>
<span class="c1">#</span>
<span class="n">chart2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;scatter&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;straight_with_markers&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Straight line with markers&#39;</span><span class="p">})</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D18&#39;</span><span class="p">,</span> <span class="n">chart2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a scatter chart sub-type with straight lines and no markers.</span>
<span class="c1">#</span>
<span class="n">chart3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;scatter&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;straight&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Straight line&#39;</span><span class="p">})</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D34&#39;</span><span class="p">,</span> <span class="n">chart3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a scatter chart sub-type with smooth lines and markers.</span>
<span class="c1">#</span>
<span class="n">chart4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;scatter&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;smooth_with_markers&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Smooth line with markers&#39;</span><span class="p">})</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D50&#39;</span><span class="p">,</span> <span class="n">chart4</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a scatter chart sub-type with smooth lines and no markers.</span>
<span class="c1">#</span>
<span class="n">chart5</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;scatter&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;smooth&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart5</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series.</span>
<span class="n">chart5</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart5</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Smooth line&#39;</span><span class="p">})</span>
<span class="n">chart5</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart5</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart5</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D66&#39;</span><span class="p">,</span> <span class="n">chart5</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_radar"></span><div class="section" id="example-radar-chart">
<span id="ex-chart-radar"></span><h4>Example: Radar Chart</h4>
<p>Example of creating Excel Column charts.</p>
<p>Chart 1 in the following example is a default radar chart:</p>
<a class="reference internal image-reference" href="_images/chart_radar1.png"><img alt="_images/chart_radar1.png" src="_images/chart_radar1.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>Chart 2 in the following example is a radar chart with markers:</p>
<a class="reference internal image-reference" href="_images/chart_radar2.png"><img alt="_images/chart_radar2.png" src="_images/chart_radar2.png" style="width: 705.0px; height: 403.5px;" /></a>
<p>Chart 3 in the following example is a filled radar chart:</p>
<a class="reference internal image-reference" href="_images/chart_radar3.png"><img alt="_images/chart_radar3.png" src="_images/chart_radar3.png" style="width: 705.0px; height: 402.75px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating Excel Radar charts with Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_radar.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 2&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a new radar chart.</span>
<span class="c1">#</span>
<span class="n">chart1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;radar&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series. Note use of alternative syntax to define ranges.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Results of sample analysis&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a radar chart with markers chart sub-type.</span>
<span class="c1">#</span>
<span class="n">chart2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;radar&#39;</span><span class="p">,</span> <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;with_markers&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Radar Chart With Markers&#39;</span><span class="p">})</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D18&#39;</span><span class="p">,</span> <span class="n">chart2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a filled radar chart sub-type.</span>
<span class="c1">#</span>
<span class="n">chart3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;radar&#39;</span><span class="p">,</span> <span class="s1">&#39;subtype&#39;</span><span class="p">:</span> <span class="s1">&#39;filled&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Filled Radar Chart&#39;</span><span class="p">})</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">13</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D34&#39;</span><span class="p">,</span> <span class="n">chart3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_stock"></span><div class="section" id="example-stock-chart">
<span id="ex-chart-stock"></span><h4>Example: Stock Chart</h4>
<p>Example of creating and Excel HiLow-Close Stock chart.</p>
<p>Chart 1 in the following example is:</p>
<a class="reference internal image-reference" href="_images/chart_stock1.png"><img alt="_images/chart_stock1.png" src="_images/chart_stock1.png" style="width: 705.0px; height: 402.75px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating Excel Stock charts with Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_stock.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">date_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;dd/mm/yyyy&#39;</span><span class="p">})</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;stock&#39;</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Date&#39;</span><span class="p">,</span> <span class="s1">&#39;High&#39;</span><span class="p">,</span> <span class="s1">&#39;Low&#39;</span><span class="p">,</span> <span class="s1">&#39;Close&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;2007-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-01-02&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-01-03&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-01-04&#39;</span><span class="p">,</span> <span class="s1">&#39;2007-01-05&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">27.2</span><span class="p">,</span> <span class="mf">25.03</span><span class="p">,</span> <span class="mf">19.05</span><span class="p">,</span> <span class="mf">20.34</span><span class="p">,</span> <span class="mf">18.5</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">23.49</span><span class="p">,</span> <span class="mf">19.55</span><span class="p">,</span> <span class="mf">15.12</span><span class="p">,</span> <span class="mf">17.84</span><span class="p">,</span> <span class="mf">16.34</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">25.45</span><span class="p">,</span> <span class="mf">23.05</span><span class="p">,</span> <span class="mf">17.32</span><span class="p">,</span> <span class="mf">20.45</span><span class="p">,</span> <span class="mf">17.34</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">row</span><span class="p">],</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">date</span><span class="p">,</span> <span class="n">date_format</span><span class="p">)</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">row</span><span class="p">])</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">row</span><span class="p">])</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">row</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">row</span><span class="p">])</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:D&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>

<span class="c1"># Add a series for each of the High-Low-Close columns.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$2:$B$6&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$6&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$D$2:$D$6&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;High-Low-Close&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Date&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Share price&#39;</span><span class="p">})</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;E9&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_styles"></span><div class="section" id="example-styles-chart">
<span id="ex-chart-styles"></span><h4>Example: Styles Chart</h4>
<p>An example showing all 48 default chart styles available in Excel 2007 using
the chart <a class="reference internal" href="index.html#set_style" title="set_style"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_style()</span></code></a> method.</p>
<img alt="_images/chart_styles.png" src="_images/chart_styles.png" />
<p>Note, these styles are not the same as the styles available in Excel 2013.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example showing all 48 default chart styles available in Excel 2007</span>
<span class="c1"># using Python and XlsxWriter. Note, these styles are not the same as</span>
<span class="c1"># the styles available in Excel 2013.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_styles.xlsx&#39;</span><span class="p">)</span>

<span class="c1"># Show the styles for all of these chart types.</span>
<span class="n">chart_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;column&#39;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span> <span class="s1">&#39;pie&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">chart_type</span> <span class="ow">in</span> <span class="n">chart_types</span><span class="p">:</span>

    <span class="c1"># Add a worksheet for each chart type.</span>
    <span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="n">chart_type</span><span class="o">.</span><span class="n">title</span><span class="p">())</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">set_zoom</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">style_number</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># Create 48 charts, each with a different style.</span>
    <span class="k">for</span> <span class="n">row_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">15</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">col_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>

            <span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">chart_type</span><span class="p">})</span>
            <span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Data!$A$1:$A$6&#39;</span><span class="p">})</span>
            <span class="n">chart</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Style </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">style_number</span><span class="p">})</span>
            <span class="n">chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
            <span class="n">chart</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="n">style_number</span><span class="p">)</span>

            <span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="n">row_num</span><span class="p">,</span> <span class="n">col_num</span> <span class="p">,</span> <span class="n">chart</span><span class="p">)</span>
            <span class="n">style_number</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Create a worksheet with data for the charts.</span>
<span class="n">data_worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">(</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">]</span>
<span class="n">data_worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="n">data_worksheet</span><span class="o">.</span><span class="n">hide</span><span class="p">()</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_pattern"></span><div class="section" id="example-chart-with-pattern-fills">
<span id="ex-chart-pattern"></span><h4>Example: Chart with Pattern Fills</h4>
<p>Example of creating an Excel chart with pattern fills, in the columns.</p>
<a class="reference internal image-reference" href="_images/chart_pattern.png"><img alt="_images/chart_pattern.png" src="_images/chart_pattern.png" style="width: 704.25px; height: 402.75px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of an Excel chart with patterns using Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_pattern.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Shingle&#39;</span><span class="p">,</span> <span class="s1">&#39;Brick&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">105</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">90</span> <span class="p">],</span>
    <span class="p">[</span><span class="mi">50</span><span class="p">,</span>  <span class="mi">120</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">110</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Create a new Chart object.</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Configure the charts. Add two series with patterns. The gap is used to make</span>
<span class="c1"># the patterns more visible.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>   <span class="s1">&#39;=Sheet1!$A$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;pattern&#39;</span><span class="p">:</span>  <span class="s1">&#39;shingle&#39;</span><span class="p">,</span>
        <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#804000&#39;</span><span class="p">,</span>
        <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#c68c53&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#804000&#39;</span><span class="p">},</span>
    <span class="s1">&#39;gap&#39;</span><span class="p">:</span>     <span class="mi">70</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>   <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$2:$B$5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;pattern&#39;</span><span class="p">:</span>  <span class="s1">&#39;horizontal_brick&#39;</span><span class="p">,</span>
        <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#b30000&#39;</span><span class="p">,</span>
        <span class="s1">&#39;bg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#ff6666&#39;</span>
    <span class="p">},</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span>  <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;#b30000&#39;</span><span class="p">},</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Cladding types&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Region&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Number of houses&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_gradient"></span><div class="section" id="example-chart-with-gradient-fills">
<span id="ex-chart-gradient"></span><h4>Example: Chart with Gradient Fills</h4>
<p>Example of creating an Excel chart with gradient fills, in the columns and
in the plot area.</p>
<a class="reference internal image-reference" href="_images/chart_gradient.png"><img alt="_images/chart_gradient.png" src="_images/chart_gradient.png" style="width: 705.0px; height: 402.75px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating an Excel charts with gradient fills using</span>
<span class="c1"># Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_gradient.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 2&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>


<span class="c1"># Create a new column chart.</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series, including a gradient.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;gradient&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;#963735&#39;</span><span class="p">,</span> <span class="s1">&#39;#F1DCDB&#39;</span><span class="p">]}</span>
<span class="p">})</span>

<span class="c1"># Configure the second series, including a gradient.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;gradient&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;#E36C0A&#39;</span><span class="p">,</span> <span class="s1">&#39;#FCEADA&#39;</span><span class="p">]}</span>
<span class="p">})</span>

<span class="c1"># Set a gradient for the plotarea.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_plotarea</span><span class="p">({</span>
    <span class="s1">&#39;gradient&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;colors&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;#FFEFD1&#39;</span><span class="p">,</span> <span class="s1">&#39;#F0EBD5&#39;</span><span class="p">,</span> <span class="s1">&#39;#B69F66&#39;</span><span class="p">]}</span>
<span class="p">})</span>


<span class="c1"># Add some axis labels.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Turn off the chart legend.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;E2&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_secondary_axis"></span><div class="section" id="example-secondary-axis-chart">
<span id="ex-chart-secondary-axis"></span><h4>Example: Secondary Axis Chart</h4>
<p>Example of creating an Excel Line chart with a secondary axis. Note, the
primary and secondary chart type are the same. The next example shows a
secondary chart of a different type.</p>
<a class="reference internal image-reference" href="_images/chart_secondary_axis1.png"><img alt="_images/chart_secondary_axis1.png" src="_images/chart_secondary_axis1.png" style="width: 705.0px; height: 402.75px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating an Excel Line chart with a secondary axis</span>
<span class="c1"># using Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_secondary_axis.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Aliens&#39;</span><span class="p">,</span> <span class="s1">&#39;Humans&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>


<span class="c1"># Create a new chart object. In this case an embedded chart.</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>

<span class="c1"># Configure a series with a secondary axis</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>   <span class="s1">&#39;=Sheet1!$A$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;y2_axis&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>   <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;position&#39;</span><span class="p">:</span> <span class="s1">&#39;right&#39;</span><span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Survey results&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Days&#39;</span><span class="p">,</span> <span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Population&#39;</span><span class="p">,</span> <span class="s1">&#39;major_gridlines&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;visible&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_y2_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Laser wounds&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_combined"></span><div class="section" id="example-combined-chart">
<span id="ex-chart-combined"></span><h4>Example: Combined Chart</h4>
<p>Example of creating combined Excel charts with two chart types.</p>
<p>In the first example we create a combined column and line chart that share the
same X and Y axes.</p>
<a class="reference internal image-reference" href="_images/chart_combined1.png"><img alt="_images/chart_combined1.png" src="_images/chart_combined1.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>In the second example we create a similar combined column and line chart
except that the secondary chart has a secondary Y axis.</p>
<a class="reference internal image-reference" href="_images/chart_combined2.png"><img alt="_images/chart_combined2.png" src="_images/chart_combined2.png" style="width: 705.0px; height: 402.75px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of a Combined chart in XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">xlsxwriter.workbook</span> <span class="k">import</span> <span class="n">Workbook</span>

<span class="n">workbook</span>  <span class="o">=</span> <span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_combined.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Add a format for the headings.</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 2&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1">#</span>
<span class="c1"># In the first example we will create a combined column and line chart.</span>
<span class="c1"># They will share the same X and Y axes.</span>
<span class="c1">#</span>

<span class="c1"># Create a new column chart. This will use this as the primary chart.</span>
<span class="n">column_chart1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Configure the data series for the primary chart.</span>
<span class="n">column_chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Create a new column chart. This will use this as the secondary chart.</span>
<span class="n">line_chart1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>

<span class="c1"># Configure the data series for the secondary chart.</span>
<span class="n">line_chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Combine the charts.</span>
<span class="n">column_chart1</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">line_chart1</span><span class="p">)</span>

<span class="c1"># Add a chart title and some axis labels. Note, this is done via the</span>
<span class="c1"># primary chart.</span>
<span class="n">column_chart1</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Combined chart - same Y axis&#39;</span><span class="p">})</span>
<span class="n">column_chart1</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">column_chart1</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;E2&#39;</span><span class="p">,</span> <span class="n">column_chart1</span><span class="p">)</span>

<span class="c1">#</span>
<span class="c1"># In the second example we will create a similar combined column and line</span>
<span class="c1"># chart except that the secondary chart will have a secondary Y axis.</span>
<span class="c1">#</span>

<span class="c1"># Create a new column chart. This will use this as the primary chart.</span>
<span class="n">column_chart2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Configure the data series for the primary chart.</span>
<span class="n">column_chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Create a new column chart. This will use this as the secondary chart.</span>
<span class="n">line_chart2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>

<span class="c1"># Configure the data series for the secondary chart. We also set a</span>
<span class="c1"># secondary Y axis via (y2_axis). This is the only difference between</span>
<span class="c1"># this and the first example, apart from the axis label below.</span>
<span class="n">line_chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;y2_axis&#39;</span><span class="p">:</span>    <span class="kc">True</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Combine the charts.</span>
<span class="n">column_chart2</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">line_chart2</span><span class="p">)</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">column_chart2</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span>  <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Combine chart - secondary Y axis&#39;</span><span class="p">})</span>
<span class="n">column_chart2</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">column_chart2</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span> <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Note: the y2 properties are on the secondary chart.</span>
<span class="n">line_chart2</span><span class="o">.</span><span class="n">set_y2_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Target length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;E18&#39;</span><span class="p">,</span> <span class="n">column_chart2</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_pareto"></span><div class="section" id="example-pareto-chart">
<span id="ex-chart-pareto"></span><h4>Example: Pareto Chart</h4>
<p>Example of creating a Pareto chart with a secondary chart and axis.</p>
<a class="reference internal image-reference" href="_images/chart_pareto.png"><img alt="_images/chart_pareto.png" src="_images/chart_pareto.png" style="width: 704.25px; height: 402.75px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating of a Pareto chart with Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_pareto.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Formats used in the workbook.</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
<span class="n">percent_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;0.0%&#39;</span><span class="p">})</span>

<span class="c1"># Widen the columns for visibility.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:C&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Reason&#39;</span><span class="p">,</span> <span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Percentage&#39;</span><span class="p">]</span>

<span class="n">reasons</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Traffic&#39;</span><span class="p">,</span> <span class="s1">&#39;Child care&#39;</span><span class="p">,</span> <span class="s1">&#39;Public Transport&#39;</span><span class="p">,</span> <span class="s1">&#39;Weather&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Overslept&#39;</span><span class="p">,</span> <span class="s1">&#39;Emergency&#39;</span><span class="p">,</span>
<span class="p">]</span>

<span class="n">numbers</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">60</span><span class="p">,</span>   <span class="mi">40</span><span class="p">,</span>    <span class="mi">20</span><span class="p">,</span>  <span class="mi">15</span><span class="p">,</span>  <span class="mi">10</span><span class="p">,</span>    <span class="mi">5</span><span class="p">]</span>
<span class="n">percents</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.44</span><span class="p">,</span> <span class="mf">0.667</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.967</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">reasons</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">numbers</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">percents</span><span class="p">,</span> <span class="n">percent_format</span><span class="p">)</span>


<span class="c1"># Create a new column chart. This will be the primary chart.</span>
<span class="n">column_chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Add a series.</span>
<span class="n">column_chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">column_chart</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Reasons for lateness&#39;</span><span class="p">})</span>

<span class="c1"># Turn off the chart legend.</span>
<span class="n">column_chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;position&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">})</span>

<span class="c1"># Set the title and scale of the Y axes. Note, the secondary axis is set from</span>
<span class="c1"># the primary chart.</span>
<span class="n">column_chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Respondents (number)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">120</span>
<span class="p">})</span>
<span class="n">column_chart</span><span class="o">.</span><span class="n">set_y2_axis</span><span class="p">({</span><span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Create a new line chart. This will be the secondary chart.</span>
<span class="n">line_chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>

<span class="c1"># Add a series, on the secondary axis.</span>
<span class="n">line_chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;marker&#39;</span><span class="p">:</span>     <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;automatic&#39;</span><span class="p">},</span>
    <span class="s1">&#39;y2_axis&#39;</span><span class="p">:</span>    <span class="mi">1</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Combine the charts.</span>
<span class="n">column_chart</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">line_chart</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;F2&#39;</span><span class="p">,</span> <span class="n">column_chart</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_gauge"></span><div class="section" id="example-gauge-chart">
<span id="ex-chart-gauge"></span><h4>Example: Gauge Chart</h4>
<p>A Gauge Chart isn’t a native chart type in Excel. It is constructed by
combining a doughnut chart and a pie chart and by using some non-filled
elements. This example follows the following online example of how to create a
Gauge Chart in Excel: <a class="reference external" href="https://www.excel-easy.com/examples/gauge-chart.html">https://www.excel-easy.com/examples/gauge-chart.html</a></p>
<img alt="_images/chart_gauge.png" src="_images/chart_gauge.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating a Gauge Chart in Excel with Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># A Gauge Chart isn&#39;t a native chart type in Excel. It is constructed by</span>
<span class="c1"># combining a doughnut chart and a pie chart and by using some non-filled</span>
<span class="c1"># elements. This example follows the following online example of how to create</span>
<span class="c1"># a Gauge Chart in Excel: https://www.excel-easy.com/examples/gauge-chart.html</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_gauge.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">chart_doughnut</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;doughnut&#39;</span><span class="p">})</span>
<span class="n">chart_pie</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;pie&#39;</span><span class="p">})</span>

<span class="c1"># Add some data for the Doughnut and Pie charts. This is set up so the</span>
<span class="c1"># gauge goes from 0-100. It is initially set at 75%.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;H2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Donut&#39;</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;I2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Pie&#39;</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;=200-I4-I3&#39;</span><span class="p">])</span>

<span class="c1"># Configure the doughnut chart as the background for the gauge.</span>
<span class="n">chart_doughnut</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$H$2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$H$3:$H$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">}},</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">}},</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}},</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}],</span>
<span class="p">})</span>

<span class="c1"># Rotate chart so the gauge parts are above the horizontal.</span>
<span class="n">chart_doughnut</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">270</span><span class="p">)</span>

<span class="c1"># Turn off the chart legend.</span>
<span class="n">chart_doughnut</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Turn off the chart fill and border.</span>
<span class="n">chart_doughnut</span><span class="o">.</span><span class="n">set_chartarea</span><span class="p">({</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">})</span>

<span class="c1"># Configure the pie chart as the needle for the gauge.</span>
<span class="n">chart_pie</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$I$2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$I$3:$I$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;points&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}},</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">}},</span>
        <span class="p">{</span><span class="s1">&#39;fill&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}}],</span>
<span class="p">})</span>

<span class="c1"># Rotate the pie chart/needle to align with the doughnut/gauge.</span>
<span class="n">chart_pie</span><span class="o">.</span><span class="n">set_rotation</span><span class="p">(</span><span class="mi">270</span><span class="p">)</span>

<span class="c1"># Combine the pie and doughnut charts.</span>
<span class="n">chart_doughnut</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">chart_pie</span><span class="p">)</span>

<span class="c1"># Insert the chart into the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">chart_doughnut</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_clustered"></span><div class="section" id="example-clustered-chart">
<span id="ex-chart-clustered"></span><h4>Example: Clustered Chart</h4>
<p>Example of creating a clustered Excel chart where there are two levels of
category on the X axis.</p>
<a class="reference internal image-reference" href="_images/chart_clustered.png"><img alt="_images/chart_clustered.png" src="_images/chart_clustered.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>The categories in clustered charts are 2D ranges, instead of the more normal
1D ranges. The series are shown as formula strings for clarity but you can also
use the a list syntax.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># A demo of a clustered category chart in XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">from</span> <span class="nn">xlsxwriter.workbook</span> <span class="k">import</span> <span class="n">Workbook</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_clustered.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Types&#39;</span><span class="p">,</span> <span class="s1">&#39;Sub Type&#39;</span><span class="p">,</span> <span class="s1">&#39;Value 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Value 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Value 3&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;Type 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Sub Type A&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span>      <span class="mi">8000</span><span class="p">,</span>      <span class="mi">6000</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span>       <span class="s1">&#39;Sub Type B&#39;</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span>      <span class="mi">3000</span><span class="p">,</span>      <span class="mi">4000</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span>       <span class="s1">&#39;Sub Type C&#39;</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span>       <span class="mi">1000</span><span class="p">,</span>      <span class="mi">2000</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Type 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Sub Type D&#39;</span><span class="p">,</span> <span class="mi">6000</span><span class="p">,</span>      <span class="mi">6000</span><span class="p">,</span>      <span class="mi">6500</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span>       <span class="s1">&#39;Sub Type E&#39;</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span>       <span class="mi">300</span><span class="p">,</span>        <span class="mi">200</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>

<span class="k">for</span> <span class="n">row_num</span><span class="p">,</span> <span class="n">row_data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="n">row_num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">row_data</span><span class="p">)</span>

<span class="c1"># Create a new chart object. In this case an embedded chart.</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Configure the series. Note, that the categories are 2D ranges (from column A</span>
<span class="c1"># to column B). This creates the clusters. The series are shown as formula</span>
<span class="c1"># strings for clarity but you can also use the list syntax. See the docs.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$B$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$6&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$B$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$D$2:$D$6&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$B$6&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$E$2:$E$6&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Set the Excel chart style.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">37</span><span class="p">)</span>

<span class="c1"># Turn off the legend.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;position&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;G3&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_date_axis"></span><div class="section" id="example-date-axis-chart">
<span id="ex-chart-date-axis"></span><h4>Example: Date Axis Chart</h4>
<p>Date Category Axes are a special case of Category axes in Excel which give them
some of the properties of Values axes.</p>
<p>For example, Excel doesn’t normally allow minimum and maximum values to be set
for category axes. However, date axes are an exception.</p>
<a class="reference internal image-reference" href="_images/chart_date_axis.png"><img alt="_images/chart_date_axis.png" src="_images/chart_date_axis.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>In XlsxWriter Date Category Axes are set using the <code class="docutils literal notranslate"><span class="pre">date_axis</span></code> option in
<a class="reference internal" href="index.html#set_x_axis" title="set_x_axis"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_x_axis()</span></code></a> or <a class="reference internal" href="index.html#set_y_axis" title="set_y_axis"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_y_axis()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;date_axis&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
</pre></div>
</div>
<p>If used, the <code class="docutils literal notranslate"><span class="pre">min</span></code> and <code class="docutils literal notranslate"><span class="pre">max</span></code> values should be set as Excel times or dates.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating an Excel charts with a date axis using</span>
<span class="c1"># Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">date</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_date_axis.xlsx&#39;</span><span class="p">)</span>

<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>
<span class="n">date_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;dd/mm/yyyy&#39;</span><span class="p">})</span>

<span class="c1"># Widen the first column to display the dates.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;A:A&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Some data to be plotted in the worksheet.</span>
<span class="n">dates</span> <span class="o">=</span> <span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
         <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
         <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
         <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
         <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
         <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>
         <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
         <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
         <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
         <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)]</span>

<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">]</span>

<span class="c1"># Write the date to the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">dates</span><span class="p">,</span> <span class="n">date_format</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>

<span class="c1"># Add a series to the chart.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$1:$A$10&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$1:$B$10&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure the X axis as a Date axis and set the max and min limits.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span>
    <span class="s1">&#39;date_axis&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span>
<span class="p">})</span>

<span class="c1"># Turn off the legend.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_data_table"></span><div class="section" id="example-charts-with-data-tables">
<span id="ex-chart-data-table"></span><h4>Example: Charts with Data Tables</h4>
<p>Example of creating charts with data tables.</p>
<p>Chart 1 in the following example is a column chart with default data table:</p>
<a class="reference internal image-reference" href="_images/chart_data_table1.png"><img alt="_images/chart_data_table1.png" src="_images/chart_data_table1.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>Chart 2 is a column chart with default data table with legend keys:</p>
<a class="reference internal image-reference" href="_images/chart_data_table2.png"><img alt="_images/chart_data_table2.png" src="_images/chart_data_table2.png" style="width: 705.0px; height: 403.5px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating Excel Column charts with data tables using</span>
<span class="c1"># Python and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_data_table.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 2&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>


<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a column chart with a data table.</span>
<span class="c1">#</span>
<span class="n">chart1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series. Note use of alternative syntax to define ranges.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chart with Data Table&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set a default data table on the X-Axis.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_table</span><span class="p">()</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Create a column chart with a data table and legend keys.</span>
<span class="c1">#</span>
<span class="n">chart2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure second series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$C$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Data Table with legend keys&#39;</span><span class="p">})</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set a data table on the X-Axis with the legend keys shown.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_table</span><span class="p">({</span><span class="s1">&#39;show_keys&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Hide the chart legend since the keys are shown on the data table.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;position&#39;</span><span class="p">:</span> <span class="s1">&#39;none&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D18&#39;</span><span class="p">,</span> <span class="n">chart2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_data_tools"></span><div class="section" id="example-charts-with-data-tools">
<span id="ex-chart-data-tools"></span><h4>Example: Charts with Data Tools</h4>
<p>A demo of an various Excel chart data tools that are available via an
XlsxWriter chart. These include, Trendlines, Data Labels, Error Bars, Drop
Lines, High-Low Lines and Up-Down Bars.</p>
<p>Chart 1 in the following example is a chart with trendlines:</p>
<a class="reference internal image-reference" href="_images/chart_data_tools1.png"><img alt="_images/chart_data_tools1.png" src="_images/chart_data_tools1.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>Chart 2 is a chart with data labels and markers:</p>
<a class="reference internal image-reference" href="_images/chart_data_tools2.png"><img alt="_images/chart_data_tools2.png" src="_images/chart_data_tools2.png" style="width: 705.0px; height: 403.5px;" /></a>
<p>Chart 3 is a chart with error bars:</p>
<a class="reference internal image-reference" href="_images/chart_data_tools3.png"><img alt="_images/chart_data_tools3.png" src="_images/chart_data_tools3.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>Chart 4 is a chart with up-down bars:</p>
<a class="reference internal image-reference" href="_images/chart_data_tools4.png"><img alt="_images/chart_data_tools4.png" src="_images/chart_data_tools4.png" style="width: 705.0px; height: 402.75px;" /></a>
<p>Chart 5 is a chart with hi-low lines:</p>
<a class="reference internal image-reference" href="_images/chart_data_tools5.png"><img alt="_images/chart_data_tools5.png" src="_images/chart_data_tools5.png" style="width: 705.0px; height: 403.5px;" /></a>
<p>Chart 6 is a chart with drop lines:</p>
<a class="reference internal image-reference" href="_images/chart_data_tools6.png"><img alt="_images/chart_data_tools6.png" src="_images/chart_data_tools6.png" style="width: 705.0px; height: 402.75px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># A demo of an various Excel chart data tools that are available via</span>
<span class="c1"># an XlsxWriter chart.</span>
<span class="c1">#</span>
<span class="c1"># These include, Trendlines, Data Labels, Error Bars, Drop Lines,</span>
<span class="c1"># High-Low Lines and Up-Down Bars.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_data_tools.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Data 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Data 2&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>


<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Trendline example.</span>
<span class="c1">#</span>
<span class="c1"># Create a Line chart.</span>
<span class="n">chart1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series with a polynomial trendline.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;trendline&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;polynomial&#39;</span><span class="p">,</span>
        <span class="s1">&#39;order&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">})</span>

<span class="c1"># Configure the second series with a moving average trendline.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;trendline&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">},</span>
<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chart with Trendlines&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Data Labels and Markers example.</span>
<span class="c1">#</span>
<span class="c1"># Create a Line chart.</span>
<span class="n">chart2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span>
    <span class="s1">&#39;marker&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;automatic&#39;</span><span class="p">},</span>
<span class="p">})</span>

<span class="c1"># Configure the second series.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chart with Data Labels and Markers&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D18&#39;</span><span class="p">,</span> <span class="n">chart2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Error Bars example.</span>
<span class="c1">#</span>
<span class="c1"># Create a Line chart.</span>
<span class="n">chart3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;y_error_bars&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;standard_error&#39;</span><span class="p">},</span>
<span class="p">})</span>

<span class="c1"># Configure the second series.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chart with Error Bars&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D34&#39;</span><span class="p">,</span> <span class="n">chart3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Up-Down Bars example.</span>
<span class="c1">#</span>
<span class="c1"># Create a Line chart.</span>
<span class="n">chart4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>

<span class="c1"># Add the Up-Down Bars.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">set_up_down_bars</span><span class="p">()</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure the second series.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chart with Up-Down Bars&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D50&#39;</span><span class="p">,</span> <span class="n">chart4</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># High-Low Lines example.</span>
<span class="c1">#</span>
<span class="c1"># Create a Line chart.</span>
<span class="n">chart5</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>

<span class="c1"># Add the High-Low lines.</span>
<span class="n">chart5</span><span class="o">.</span><span class="n">set_high_low_lines</span><span class="p">()</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart5</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure the second series.</span>
<span class="n">chart5</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">chart5</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chart with High-Low Lines&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D66&#39;</span><span class="p">,</span> <span class="n">chart5</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Drop Lines example.</span>
<span class="c1">#</span>
<span class="c1"># Create a Line chart.</span>
<span class="n">chart6</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>

<span class="c1"># Add Drop Lines.</span>
<span class="n">chart6</span><span class="o">.</span><span class="n">set_drop_lines</span><span class="p">()</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart6</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure the second series.</span>
<span class="n">chart6</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$C$2:$C$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">chart6</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chart with Drop Lines&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D82&#39;</span><span class="p">,</span> <span class="n">chart6</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chart_data_labels"></span><div class="section" id="example-charts-with-data-labels">
<span id="ex-chart-data-labels"></span><h4>Example: Charts with Data Labels</h4>
<p>A demo of some of the Excel chart data labels options that are available via
an XlsxWriter chart. These include custom labels with user text or text taken
from cells in the worksheet. See also <a class="reference internal" href="index.html#chart-series-option-data-labels"><span class="std std-ref">Chart series option: Data Labels</span></a>
and <a class="reference internal" href="index.html#chart-series-option-custom-data-labels"><span class="std std-ref">Chart series option: Custom Data Labels</span></a>.</p>
<p>Chart 1 in the following example is a chart with standard data labels:</p>
<a class="reference internal image-reference" href="_images/chart_data_labels11.png"><img alt="_images/chart_data_labels11.png" src="_images/chart_data_labels11.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>Chart 2 is a chart with Category and Value data labels:</p>
<a class="reference internal image-reference" href="_images/chart_data_labels12.png"><img alt="_images/chart_data_labels12.png" src="_images/chart_data_labels12.png" style="width: 704.25px; height: 403.5px;" /></a>
<p>Chart 3 is a chart with data labels with a user defined font:</p>
<a class="reference internal image-reference" href="_images/chart_data_labels13.png"><img alt="_images/chart_data_labels13.png" src="_images/chart_data_labels13.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>Chart 4 is a chart with standard data labels and formatting:</p>
<a class="reference internal image-reference" href="_images/chart_data_labels22.png"><img alt="_images/chart_data_labels22.png" src="_images/chart_data_labels22.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>Chart 5 is a chart with custom string data labels:</p>
<a class="reference internal image-reference" href="_images/chart_data_labels14.png"><img alt="_images/chart_data_labels14.png" src="_images/chart_data_labels14.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>Chart 6 is a chart with custom data labels referenced from worksheet cells:</p>
<a class="reference internal image-reference" href="_images/chart_data_labels15.png"><img alt="_images/chart_data_labels15.png" src="_images/chart_data_labels15.png" style="width: 704.25px; height: 403.5px;" /></a>
<p>Chart 7 is a chart with a mix of custom and default labels. The <code class="docutils literal notranslate"><span class="pre">None</span></code> items
will get the default value. We also set a font for the custom items as an
extra example:</p>
<a class="reference internal image-reference" href="_images/chart_data_labels16.png"><img alt="_images/chart_data_labels16.png" src="_images/chart_data_labels16.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>Chart 8 is a chart with some deleted custom labels and defaults (set with
<code class="docutils literal notranslate"><span class="pre">None</span></code> values). This allows us to highlight certain values such as the
minimum and maximum:</p>
<a class="reference internal image-reference" href="_images/chart_data_labels17.png"><img alt="_images/chart_data_labels17.png" src="_images/chart_data_labels17.png" style="width: 704.25px; height: 402.75px;" /></a>
<p>Chart 9 is a chart with custom string data labels and formatting:</p>
<a class="reference internal image-reference" href="_images/chart_data_labels23.png"><img alt="_images/chart_data_labels23.png" src="_images/chart_data_labels23.png" style="width: 704.25px; height: 402.75px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># A demo of an various Excel chart data label features that are available</span>
<span class="c1"># via an XlsxWriter chart.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chart_data_labels.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Data&#39;</span><span class="p">,</span> <span class="s1">&#39;Text&#39;</span><span class="p">]</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example with standard data labels.</span>
<span class="c1">#</span>

<span class="c1"># Create a Column chart.</span>
<span class="n">chart1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Configure the data series and add the data labels.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chart with standard data labels&#39;</span><span class="p">})</span>

<span class="c1"># Turn off the chart legend.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart1</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example with value and category data labels.</span>
<span class="c1">#</span>

<span class="c1"># Create a Column chart.</span>
<span class="n">chart2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Configure the data series and add the data labels.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;category&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Category and Value data labels&#39;</span><span class="p">})</span>

<span class="c1"># Turn off the chart legend.</span>
<span class="n">chart2</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D18&#39;</span><span class="p">,</span> <span class="n">chart2</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example with standard data labels with different font.</span>
<span class="c1">#</span>

<span class="c1"># Create a Column chart.</span>
<span class="n">chart3</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Configure the data series and add the data labels.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                             <span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;rotation&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">30</span><span class="p">}},</span>
<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Data labels with user defined font&#39;</span><span class="p">})</span>

<span class="c1"># Turn off the chart legend.</span>
<span class="n">chart3</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D34&#39;</span><span class="p">,</span> <span class="n">chart3</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example with standard data labels and formatting.</span>
<span class="c1">#</span>

<span class="c1"># Create a Column chart.</span>
<span class="n">chart4</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Configure the data series and add the data labels.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">}},</span>
<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Data labels with formatting&#39;</span><span class="p">})</span>

<span class="c1"># Turn off the chart legend.</span>
<span class="n">chart4</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D50&#39;</span><span class="p">,</span> <span class="n">chart4</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example with custom string data labels.</span>
<span class="c1">#</span>

<span class="c1"># Create a Column chart.</span>
<span class="n">chart5</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Some custom labels.</span>
<span class="n">custom_labels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Amy&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Bea&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Eva&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Fay&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Liv&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Una&#39;</span><span class="p">},</span>
<span class="p">]</span>

<span class="c1"># Configure the data series and add the data labels.</span>
<span class="n">chart5</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span> <span class="n">custom_labels</span><span class="p">},</span>
<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">chart5</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chart with custom string data labels&#39;</span><span class="p">})</span>

<span class="c1"># Turn off the chart legend.</span>
<span class="n">chart5</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D66&#39;</span><span class="p">,</span> <span class="n">chart5</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example with custom data labels from cells.</span>
<span class="c1">#</span>

<span class="c1"># Create a Column chart.</span>
<span class="n">chart6</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Some custom labels.</span>
<span class="n">custom_labels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$2&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$3&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$4&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$5&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$6&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$7&#39;</span><span class="p">},</span>
<span class="p">]</span>

<span class="c1"># Configure the data series and add the data labels.</span>
<span class="n">chart6</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span> <span class="n">custom_labels</span><span class="p">},</span>
<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">chart6</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chart with custom data labels from cells&#39;</span><span class="p">})</span>

<span class="c1"># Turn off the chart legend.</span>
<span class="n">chart6</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D82&#39;</span><span class="p">,</span> <span class="n">chart6</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example with custom and default data labels.</span>
<span class="c1">#</span>

<span class="c1"># Create a Column chart.</span>
<span class="n">chart7</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># The following is used to get a mix of default and custom labels. The &#39;None&#39;</span>
<span class="c1"># items will get the default value. We also set a font for the custom items</span>
<span class="c1"># as an extra example.</span>
<span class="n">custom_labels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$2&#39;</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}},</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$4&#39;</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$C$5&#39;</span><span class="p">,</span> <span class="s1">&#39;font&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}},</span>
<span class="p">]</span>

<span class="c1"># Configure the data series and add the data labels.</span>
<span class="n">chart7</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span> <span class="n">custom_labels</span><span class="p">},</span>
<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">chart7</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Mixed custom and default data labels&#39;</span><span class="p">})</span>

<span class="c1"># Turn off the chart legend.</span>
<span class="n">chart7</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D98&#39;</span><span class="p">,</span> <span class="n">chart7</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>


<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example with deleted custom data labels.</span>
<span class="c1">#</span>

<span class="c1"># Create a Column chart.</span>
<span class="n">chart8</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Some deleted custom labels and defaults (set with None values). This allows</span>
<span class="c1"># us to highlight certain values such as the minimum and maximum.</span>
<span class="n">custom_labels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;delete&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;delete&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;delete&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;delete&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">},</span>
<span class="p">]</span>

<span class="c1"># Configure the data series and add the data labels.</span>
<span class="n">chart8</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span> <span class="n">custom_labels</span><span class="p">},</span>
<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">chart8</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chart with deleted data labels&#39;</span><span class="p">})</span>

<span class="c1"># Turn off the chart legend.</span>
<span class="n">chart8</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D114&#39;</span><span class="p">,</span> <span class="n">chart8</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># Example with custom string data labels and formatting.</span>
<span class="c1">#</span>

<span class="c1"># Create a Column chart.</span>
<span class="n">chart9</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Some custom labels.</span>
<span class="n">custom_labels</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Amy&#39;</span><span class="p">,</span> <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;blue&#39;</span><span class="p">}},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Bea&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Eva&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Fay&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Liv&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;Una&#39;</span><span class="p">,</span> <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;green&#39;</span><span class="p">}},</span>
<span class="p">]</span>

<span class="c1"># Configure the data series and add the data labels.</span>
<span class="n">chart9</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;data_labels&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
                    <span class="s1">&#39;custom&#39;</span><span class="p">:</span> <span class="n">custom_labels</span><span class="p">,</span>
                    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">},</span>
                    <span class="s1">&#39;fill&#39;</span><span class="p">:</span>   <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span> <span class="s1">&#39;yellow&#39;</span><span class="p">}},</span>

<span class="p">})</span>

<span class="c1"># Add a chart title.</span>
<span class="n">chart9</span><span class="o">.</span><span class="n">set_title</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Chart with custom labels and formatting&#39;</span><span class="p">})</span>

<span class="c1"># Turn off the chart legend.</span>
<span class="n">chart9</span><span class="o">.</span><span class="n">set_legend</span><span class="p">({</span><span class="s1">&#39;none&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet (with an offset).</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D130&#39;</span><span class="p">,</span> <span class="n">chart9</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;x_offset&#39;</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;y_offset&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">})</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_chartsheet"></span><div class="section" id="example-chartsheet">
<span id="ex-chartsheet"></span><h4>Example: Chartsheet</h4>
<p>Example of creating an Excel Bar chart on a <a class="reference internal" href="index.html#chartsheet"><span class="std std-ref">chartsheet</span></a>.</p>
<img alt="_images/chartsheet.png" src="_images/chartsheet.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#######################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of creating an Excel chart in a chartsheet with Python</span>
<span class="c1"># and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>
<span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;chartsheet.xlsx&#39;</span><span class="p">)</span>

<span class="c1"># Add a worksheet to hold the data.</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="c1"># Add a chartsheet. A worksheet that only holds a chart.</span>
<span class="n">chartsheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chartsheet</span><span class="p">()</span>

<span class="c1"># Add a format for the headings.</span>
<span class="n">bold</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Add the worksheet data that the charts will refer to.</span>
<span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Batch 2&#39;</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">30</span><span class="p">],</span>
<span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write_row</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="n">headings</span><span class="p">,</span> <span class="n">bold</span><span class="p">)</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">write_column</span><span class="p">(</span><span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>


<span class="c1"># Create a new bar chart.</span>
<span class="n">chart1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">})</span>

<span class="c1"># Configure the first series.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="s1">&#39;=Sheet1!$B$1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$A$2:$A$7&#39;</span><span class="p">,</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="s1">&#39;=Sheet1!$B$2:$B$7&#39;</span><span class="p">,</span>
<span class="p">})</span>

<span class="c1"># Configure a second series. Note use of alternative syntax to define ranges.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<span class="p">})</span>

<span class="c1"># Add a chart title and some axis labels.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_title</span> <span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Results of sample analysis&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Test number&#39;</span><span class="p">})</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Sample length (mm)&#39;</span><span class="p">})</span>

<span class="c1"># Set an Excel chart style.</span>
<span class="n">chart1</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>

<span class="c1"># Add the chart to the chartsheet.</span>
<span class="n">chartsheet</span><span class="o">.</span><span class="n">set_chart</span><span class="p">(</span><span class="n">chart1</span><span class="p">)</span>

<span class="c1"># Display the chartsheet as the active sheet when the workbook is opened.</span>
<span class="n">chartsheet</span><span class="o">.</span><span class="n">activate</span><span class="p">();</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<span id="document-pandas_examples"></span><div class="section" id="pandas-with-xlsxwriter-examples">
<span id="pandas-examples"></span><h3>Pandas with XlsxWriter Examples</h3>
<p>The following are some of the examples included in the
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/tree/master/examples">examples</a>
directory of the XlsxWriter distribution.</p>
<p>They show how to use XlsxWriter with <a class="reference external" href="https://pandas.pydata.org/">Pandas</a>.</p>
<div class="toctree-wrapper compound">
<span id="document-example_pandas_simple"></span><div class="section" id="example-pandas-excel-example">
<span id="ex-pandas-simple"></span><h4>Example: Pandas Excel example</h4>
<p>A simple example of converting a Pandas dataframe to an Excel file using
Pandas and XlsxWriter. See <a class="reference internal" href="index.html#ewx-pandas"><span class="std std-ref">Working with Python Pandas and XlsxWriter</span></a> for more details.</p>
<img alt="_images/pandas_simple.png" src="_images/pandas_simple.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># A simple example of converting a Pandas dataframe to an xlsx file using</span>
<span class="c1"># Pandas and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<span class="c1"># Create a Pandas dataframe from some data.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">]})</span>

<span class="c1"># Create a Pandas Excel writer using XlsxWriter as the engine.</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;pandas_simple.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>

<span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>

<span class="c1"># Close the Pandas Excel writer and output the Excel file.</span>
<span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_pandas_multiple"></span><div class="section" id="example-pandas-excel-with-multiple-dataframes">
<span id="ex-pandas-multiple"></span><h4>Example: Pandas Excel with multiple dataframes</h4>
<p>An example of writing multiple dataframes to worksheets using Pandas and
XlsxWriter.</p>
<img alt="_images/pandas_multiple.png" src="_images/pandas_multiple.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of writing multiple dataframes to worksheets using Pandas and</span>
<span class="c1"># XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<span class="c1"># Create some Pandas dataframes from some data.</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">]})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">]})</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">]})</span>

<span class="c1"># Create a Pandas Excel writer using XlsxWriter as the engine.</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;pandas_multiple.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>

<span class="c1"># Write each dataframe to a different worksheet.</span>
<span class="n">df1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>
<span class="n">df2</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet2&#39;</span><span class="p">)</span>
<span class="n">df3</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet3&#39;</span><span class="p">)</span>

<span class="c1"># Close the Pandas Excel writer and output the Excel file.</span>
<span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_pandas_positioning"></span><div class="section" id="example-pandas-excel-dataframe-positioning">
<span id="ex-pandas-positioning"></span><h4>Example: Pandas Excel dataframe positioning</h4>
<p>An example of positioning dataframes in a worksheet using Pandas and
XlsxWriter. It also demonstrates how to write a dataframe without the header
and index.</p>
<img alt="_images/pandas_positioning.png" src="_images/pandas_positioning.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of positioning dataframes in a worksheet using Pandas and</span>
<span class="c1"># XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<span class="c1"># Create some Pandas dataframes from some data.</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">]})</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">]})</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">]})</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">]})</span>

<span class="c1"># Create a Pandas Excel writer using XlsxWriter as the engine.</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;pandas_positioning.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>

<span class="c1"># Position the dataframes in the worksheet.</span>
<span class="n">df1</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>  <span class="c1"># Default position, cell A1.</span>
<span class="n">df2</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">startcol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">df3</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">startrow</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="c1"># It is also possible to write the dataframe without the header and index.</span>
<span class="n">df4</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span>
             <span class="n">startrow</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">startcol</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Close the Pandas Excel writer and output the Excel file.</span>
<span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_pandas_chart"></span><div class="section" id="example-pandas-excel-output-with-a-chart">
<span id="ex-pandas-chart"></span><h4>Example: Pandas Excel output with a chart</h4>
<p>A simple example of converting a Pandas dataframe to an Excel file with a
chart using Pandas and XlsxWriter.</p>
<img alt="_images/pandas_chart.png" src="_images/pandas_chart.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of converting a Pandas dataframe to an xlsx file with a chart</span>
<span class="c1"># using Pandas and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<span class="c1"># Create a Pandas dataframe from some data.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">]})</span>

<span class="c1"># Create a Pandas Excel writer using XlsxWriter as the engine.</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;pandas_chart.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>

<span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>

<span class="c1"># Get the xlsxwriter workbook and worksheet objects.</span>
<span class="n">workbook</span>  <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">]</span>

<span class="c1"># Create a chart object.</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Configure the series of the chart from the dataframe data.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span><span class="s1">&#39;values&#39;</span><span class="p">:</span> <span class="s1">&#39;=Sheet1!$B$2:$B$8&#39;</span><span class="p">})</span>

<span class="c1"># Insert the chart into the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>

<span class="c1"># Close the Pandas Excel writer and output the Excel file.</span>
<span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_pandas_conditional"></span><div class="section" id="example-pandas-excel-output-with-conditional-formatting">
<span id="ex-pandas-conditional"></span><h4>Example: Pandas Excel output with conditional formatting</h4>
<p>An example of converting a Pandas dataframe to an Excel file with a
conditional formatting using Pandas and XlsxWriter.</p>
<img alt="_images/pandas_conditional.png" src="_images/pandas_conditional.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of converting a Pandas dataframe to an xlsx file with a</span>
<span class="c1"># conditional formatting using Pandas and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<span class="c1"># Create a Pandas dataframe from some data.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Data&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">45</span><span class="p">]})</span>

<span class="c1"># Create a Pandas Excel writer using XlsxWriter as the engine.</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;pandas_conditional.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>

<span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>

<span class="c1"># Get the xlsxwriter workbook and worksheet objects.</span>
<span class="n">workbook</span>  <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">]</span>

<span class="c1"># Apply a conditional format to the cell range.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">conditional_format</span><span class="p">(</span><span class="s1">&#39;B2:B8&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;3_color_scale&#39;</span><span class="p">})</span>

<span class="c1"># Close the Pandas Excel writer and output the Excel file.</span>
<span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_pandas_datetime"></span><div class="section" id="example-pandas-excel-output-with-datetimes">
<span id="ex-pandas-datetime"></span><h4>Example: Pandas Excel output with datetimes</h4>
<p>An example of converting a Pandas dataframe with datetimes to an Excel file
with a default datetime and date format using Pandas and XlsxWriter.</p>
<img alt="_images/pandas_datetime.png" src="_images/pandas_datetime.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of converting a Pandas dataframe with datetimes to an xlsx file</span>
<span class="c1"># with a default datetime and date format using Pandas and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">date</span>

<span class="c1"># Create a Pandas dataframe from some datetime data.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Date and time&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">55</span><span class="p">),</span>
                                     <span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>  <span class="mi">20</span><span class="p">,</span> <span class="mi">33</span><span class="p">),</span>
                                     <span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">10</span>    <span class="p">),</span>
                                     <span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">35</span><span class="p">),</span>
                                     <span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">)],</span>
                   <span class="s1">&#39;Dates only&#39;</span><span class="p">:</span>    <span class="p">[</span><span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                                     <span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                                     <span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                                     <span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                                     <span class="n">date</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)],</span>
                   <span class="p">})</span>

<span class="c1"># Create a Pandas Excel writer using XlsxWriter as the engine.</span>
<span class="c1"># Also set the default datetime and date formats.</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s2">&quot;pandas_datetime.xlsx&quot;</span><span class="p">,</span>
                        <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">,</span>
                        <span class="n">datetime_format</span><span class="o">=</span><span class="s1">&#39;mmm d yyyy hh:mm:ss&#39;</span><span class="p">,</span>
                        <span class="n">date_format</span><span class="o">=</span><span class="s1">&#39;mmmm dd yyyy&#39;</span><span class="p">)</span>

<span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>

<span class="c1"># Get the xlsxwriter workbook and worksheet objects in order to set the column</span>
<span class="c1"># widths, to make the dates clearer.</span>
<span class="n">workbook</span>  <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">]</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:C&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>

<span class="c1"># Close the Pandas Excel writer and output the Excel file.</span>
<span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_pandas_column_formats"></span><div class="section" id="example-pandas-excel-output-with-column-formatting">
<span id="ex-pandas-column-formats"></span><h4>Example: Pandas Excel output with column formatting</h4>
<p>An example of converting a Pandas dataframe to an Excel file with column
formats using Pandas and XlsxWriter.</p>
<p>It isn’t possible to format any cells that already have a format such as
the index or headers or any cells that contain dates or datetimes.</p>
<p>Note: This feature requires Pandas &gt;= 0.16.</p>
<img alt="_images/pandas_column_formats.png" src="_images/pandas_column_formats.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of converting a Pandas dataframe to an xlsx file</span>
<span class="c1"># with column formats using Pandas and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Create a Pandas dataframe from some data.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Numbers&#39;</span><span class="p">:</span>    <span class="p">[</span><span class="mi">1010</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">3030</span><span class="p">,</span> <span class="mi">2020</span><span class="p">,</span> <span class="mi">1515</span><span class="p">,</span> <span class="mi">3030</span><span class="p">,</span> <span class="mi">4545</span><span class="p">],</span>
                   <span class="s1">&#39;Percentage&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">.</span><span class="mi">1</span><span class="p">,</span>   <span class="o">.</span><span class="mi">2</span><span class="p">,</span>   <span class="o">.</span><span class="mi">33</span><span class="p">,</span>  <span class="o">.</span><span class="mi">25</span><span class="p">,</span>  <span class="o">.</span><span class="mi">5</span><span class="p">,</span>   <span class="o">.</span><span class="mi">75</span><span class="p">,</span>  <span class="o">.</span><span class="mi">45</span> <span class="p">],</span>
<span class="p">})</span>

<span class="c1"># Create a Pandas Excel writer using XlsxWriter as the engine.</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s2">&quot;pandas_column_formats.xlsx&quot;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>

<span class="c1"># Convert the dataframe to an XlsxWriter Excel object.</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">)</span>

<span class="c1"># Get the xlsxwriter workbook and worksheet objects.</span>
<span class="n">workbook</span>  <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">]</span>

<span class="c1"># Add some cell formats.</span>
<span class="n">format1</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;#,##0.00&#39;</span><span class="p">})</span>
<span class="n">format2</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span><span class="s1">&#39;num_format&#39;</span><span class="p">:</span> <span class="s1">&#39;0%&#39;</span><span class="p">})</span>

<span class="c1"># Note: It isn&#39;t possible to format any cells that already have a format such</span>
<span class="c1"># as the index or headers or any cells that contain dates or datetimes.</span>

<span class="c1"># Set the column width and format.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;B:B&#39;</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="n">format1</span><span class="p">)</span>

<span class="c1"># Set the format but not the column width.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">set_column</span><span class="p">(</span><span class="s1">&#39;C:C&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">format2</span><span class="p">)</span>

<span class="c1"># Close the Pandas Excel writer and output the Excel file.</span>
<span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_pandas_header_format"></span><div class="section" id="example-pandas-excel-output-with-user-defined-header-format">
<span id="ex-pandas-header-format"></span><h4>Example: Pandas Excel output with user defined header format</h4>
<p>An example of converting a Pandas dataframe to an Excel file with a user
defined header format using Pandas and XlsxWriter.</p>
<img alt="_images/pandas_header_format.png" src="_images/pandas_header_format.png" />
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of converting a Pandas dataframe to an xlsx file</span>
<span class="c1"># with a user defined header format.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Create a Pandas dataframe from some data.</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">60</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Heading&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
                   <span class="s1">&#39;Longer heading that should be wrapped&#39;</span> <span class="p">:</span> <span class="n">data</span><span class="p">})</span>

<span class="c1"># Create a Pandas Excel writer using XlsxWriter as the engine.</span>
<span class="n">writer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s2">&quot;pandas_header_format.xlsx&quot;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>

<span class="c1"># Convert the dataframe to an XlsxWriter Excel object. Note that we turn off</span>
<span class="c1"># the default header and skip one row to allow us to insert a user defined</span>
<span class="c1"># header.</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="n">startrow</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Get the xlsxwriter workbook and worksheet objects.</span>
<span class="n">workbook</span>  <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">]</span>

<span class="c1"># Add a header format.</span>
<span class="n">header_format</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_format</span><span class="p">({</span>
    <span class="s1">&#39;bold&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;text_wrap&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;valign&#39;</span><span class="p">:</span> <span class="s1">&#39;top&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fg_color&#39;</span><span class="p">:</span> <span class="s1">&#39;#D7E4BC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;border&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="c1"># Write the column headers with the defined format.</span>
<span class="k">for</span> <span class="n">col_num</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
    <span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">col_num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">header_format</span><span class="p">)</span>

<span class="c1"># Close the Pandas Excel writer and output the Excel file.</span>
<span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_pandas_chart_line"></span><div class="section" id="example-pandas-excel-output-with-a-line-chart">
<span id="ex-pandas-chart-line"></span><h4>Example: Pandas Excel output with a line chart</h4>
<p>A simple example of converting a Pandas dataframe to an Excel file with a
line chart using Pandas and XlsxWriter.</p>
<a class="reference internal image-reference" href="_images/pandas_chart_line.png"><img alt="_images/pandas_chart_line.png" src="_images/pandas_chart_line.png" style="width: 619.5px; height: 317.25px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of converting a Pandas dataframe to an xlsx file with a line</span>
<span class="c1"># chart using Pandas and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># Create some sample data to plot.</span>
<span class="n">max_row</span>     <span class="o">=</span> <span class="mi">21</span>
<span class="n">categories</span>  <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Node 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Node 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Node 3&#39;</span><span class="p">,</span> <span class="s1">&#39;Node 4&#39;</span><span class="p">]</span>
<span class="n">index_1</span>     <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_row</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">multi_iter1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="n">index_1</span><span class="p">}</span>

<span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">categories</span><span class="p">:</span>
    <span class="n">multi_iter1</span><span class="p">[</span><span class="n">category</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">index_1</span><span class="p">]</span>

<span class="c1"># Create a Pandas dataframe from the data.</span>
<span class="n">index_2</span> <span class="o">=</span> <span class="n">multi_iter1</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="n">df</span>      <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">multi_iter1</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index_2</span><span class="p">)</span>
<span class="n">df</span>      <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>

<span class="c1"># Create a Pandas Excel writer using XlsxWriter as the engine.</span>
<span class="n">sheet_name</span> <span class="o">=</span> <span class="s1">&#39;Sheet1&#39;</span>
<span class="n">writer</span>     <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;pandas_chart_line.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">)</span>

<span class="c1"># Access the XlsxWriter workbook and worksheet objects from the dataframe.</span>
<span class="n">workbook</span>  <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">sheet_name</span><span class="p">]</span>

<span class="c1"># Create a chart object.</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;line&#39;</span><span class="p">})</span>

<span class="c1"># Configure the series of the chart from the dataframe data.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">categories</span><span class="p">)):</span>
    <span class="n">col</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="p">],</span>
        <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>   <span class="n">max_row</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">max_row</span><span class="p">,</span> <span class="n">col</span><span class="p">],</span>
    <span class="p">})</span>

<span class="c1"># Configure the chart axes.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Index&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Value&#39;</span><span class="p">,</span> <span class="s1">&#39;major_gridlines&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;visible&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}})</span>

<span class="c1"># Insert the chart into the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;G2&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>

<span class="c1"># Close the Pandas Excel writer and output the Excel file.</span>
<span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
<span id="document-example_pandas_chart_columns"></span><div class="section" id="example-pandas-excel-output-with-a-column-chart">
<span id="ex-pandas-chart-columns"></span><h4>Example: Pandas Excel output with a column chart</h4>
<p>An example of converting a Pandas dataframe to an Excel file with a column
chart using Pandas and XlsxWriter.</p>
<a class="reference internal image-reference" href="_images/pandas_chart_columns.png"><img alt="_images/pandas_chart_columns.png" src="_images/pandas_chart_columns.png" style="width: 618.75px; height: 317.25px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">##############################################################################</span>
<span class="c1">#</span>
<span class="c1"># An example of converting a Pandas dataframe to an xlsx file with a grouped</span>
<span class="c1"># column chart using Pandas and XlsxWriter.</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2013-2020, John McNamara, jmcnamara@cpan.org</span>
<span class="c1">#</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Some sample data to plot.</span>
<span class="n">farm_1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Apples&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Berries&#39;</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span> <span class="s1">&#39;Squash&#39;</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="s1">&#39;Melons&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">,</span> <span class="s1">&#39;Corn&#39;</span><span class="p">:</span> <span class="mi">18</span><span class="p">}</span>
<span class="n">farm_2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Apples&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;Berries&#39;</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span> <span class="s1">&#39;Squash&#39;</span><span class="p">:</span> <span class="mi">17</span><span class="p">,</span> <span class="s1">&#39;Melons&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;Corn&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">}</span>
<span class="n">farm_3</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Apples&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>  <span class="s1">&#39;Berries&#39;</span><span class="p">:</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;Squash&#39;</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;Melons&#39;</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;Corn&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">}</span>
<span class="n">farm_4</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Apples&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;Berries&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;Squash&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;Melons&#39;</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span>  <span class="s1">&#39;Corn&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">}</span>

<span class="n">data</span>  <span class="o">=</span> <span class="p">[</span><span class="n">farm_1</span><span class="p">,</span> <span class="n">farm_2</span><span class="p">,</span> <span class="n">farm_3</span><span class="p">,</span> <span class="n">farm_4</span><span class="p">]</span>
<span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Farm 1&#39;</span><span class="p">,</span> <span class="s1">&#39;Farm 2&#39;</span><span class="p">,</span> <span class="s1">&#39;Farm 3&#39;</span><span class="p">,</span> <span class="s1">&#39;Farm 4&#39;</span><span class="p">]</span>

<span class="c1"># Create a Pandas dataframe from the data.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>

<span class="c1"># Create a Pandas Excel writer using XlsxWriter as the engine.</span>
<span class="n">sheet_name</span> <span class="o">=</span> <span class="s1">&#39;Sheet1&#39;</span>
<span class="n">writer</span>     <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="s1">&#39;pandas_chart_columns.xlsx&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;xlsxwriter&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">)</span>

<span class="c1"># Access the XlsxWriter workbook and worksheet objects from the dataframe.</span>
<span class="n">workbook</span>  <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">book</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">writer</span><span class="o">.</span><span class="n">sheets</span><span class="p">[</span><span class="n">sheet_name</span><span class="p">]</span>

<span class="c1"># Create a chart object.</span>
<span class="n">chart</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_chart</span><span class="p">({</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;column&#39;</span><span class="p">})</span>

<span class="c1"># Some alternative colors for the chart.</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#E41A1C&#39;</span><span class="p">,</span> <span class="s1">&#39;#377EB8&#39;</span><span class="p">,</span> <span class="s1">&#39;#4DAF4A&#39;</span><span class="p">,</span> <span class="s1">&#39;#984EA3&#39;</span><span class="p">,</span> <span class="s1">&#39;#FF7F00&#39;</span><span class="p">]</span>

<span class="c1"># Configure the series of the chart from the dataframe data.</span>
<span class="k">for</span> <span class="n">col_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">farm_1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">chart</span><span class="o">.</span><span class="n">add_series</span><span class="p">({</span>
        <span class="s1">&#39;name&#39;</span><span class="p">:</span>       <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">col_num</span><span class="p">],</span>
        <span class="s1">&#39;categories&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="s1">&#39;values&#39;</span><span class="p">:</span>     <span class="p">[</span><span class="s1">&#39;Sheet1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">col_num</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">col_num</span><span class="p">],</span>
        <span class="s1">&#39;fill&#39;</span><span class="p">:</span>       <span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span>  <span class="n">colors</span><span class="p">[</span><span class="n">col_num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]},</span>
        <span class="s1">&#39;overlap&#39;</span><span class="p">:</span>    <span class="o">-</span><span class="mi">10</span><span class="p">,</span>
    <span class="p">})</span>

<span class="c1"># Configure the chart axes.</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_x_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Total Produce&#39;</span><span class="p">})</span>
<span class="n">chart</span><span class="o">.</span><span class="n">set_y_axis</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Farms&#39;</span><span class="p">,</span> <span class="s1">&#39;major_gridlines&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;visible&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}})</span>

<span class="c1"># Insert the chart into the worksheet.</span>
<span class="n">worksheet</span><span class="o">.</span><span class="n">insert_chart</span><span class="p">(</span><span class="s1">&#39;H2&#39;</span><span class="p">,</span> <span class="n">chart</span><span class="p">)</span>

<span class="c1"># Close the Pandas Excel writer and output the Excel file.</span>
<span class="n">writer</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<span id="document-alternatives"></span><div class="section" id="alternative-modules-for-handling-excel-files">
<span id="alternatives"></span><h3>Alternative modules for handling Excel files</h3>
<p>The following are some Python alternatives to XlsxWriter.</p>
<div class="section" id="openpyxl">
<h4>OpenPyXL</h4>
<p>From the <a class="reference external" href="https://openpyxl.readthedocs.io/en/stable/">openpyxl</a> documentation:</p>
<blockquote>
<div>openpyxl is a Python library to read/write Excel 2010 xlsx/xlsm/xltx/xltm
files.</div></blockquote>
</div>
<div class="section" id="xlwings">
<h4>Xlwings</h4>
<p>From the <a class="reference external" href="https://www.xlwings.org/">xlwings</a> webpage:</p>
<blockquote>
<div>Leverage Python’s scientific stack for interactive data analysis using
Jupyter Notebooks, NumPy, Pandas, scikit-learn etc. As such, xlwings is a
free alternative to tools like Power BI or Tableau (Windows &amp; Mac).</div></blockquote>
</div>
<div class="section" id="xlwt">
<h4>XLWT</h4>
<p>From the <a class="reference external" href="https://xlwt.readthedocs.io/en/latest/">xlwt</a> documentation:</p>
<blockquote>
<div>xlwt is a library for writing data and formatting information to older
Excel files (ie: .xls)</div></blockquote>
</div>
<div class="section" id="xlrd">
<h4>XLRD</h4>
<p>From the <a class="reference external" href="https://xlrd.readthedocs.io/en/latest/">xlrd</a> documentation:</p>
<blockquote>
<div>xlrd is a library for reading data and formatting information from Excel
files, whether they are .xls or .xlsx files.</div></blockquote>
</div>
</div>
<span id="document-third_party"></span><div class="section" id="libraries-that-use-or-enhance-xlsxwriter">
<span id="third-party"></span><h3>Libraries that use or enhance XlsxWriter</h3>
<p>The following are some libraries or applications that wrap or extend
XlsxWriter.</p>
<div class="section" id="pandas">
<h4>Pandas</h4>
<p>Python <a class="reference external" href="https://pandas.pydata.org/">Pandas</a> is a Python data analysis
library. It can read, filter and re-arrange small and large data sets and
output them in a range of formats including Excel.</p>
<p>XlsxWriter is available as an Excel output engine in Pandas. See also See
<a class="reference internal" href="index.html#ewx-pandas"><span class="std std-ref">Working with Python Pandas and XlsxWriter</span></a>.</p>
</div>
<div class="section" id="xlsxpandasformatter">
<h4>XlsxPandasFormatter</h4>
<p><a class="reference external" href="https://github.com/webermarcolivier/xlsxpandasformatter">XlsxPandasFormatter</a> is a helper class
that wraps the worksheet, workbook and dataframe objects written by Pandas
<code class="docutils literal notranslate"><span class="pre">to_excel()</span></code> method using the <code class="docutils literal notranslate"><span class="pre">xlsxwriter</span></code> engine to allow consistent
formatting of cells.</p>
</div>
</div>
<span id="document-bugs"></span><div class="section" id="known-issues-and-bugs">
<span id="bugs"></span><h3>Known Issues and Bugs</h3>
<p>This section lists known issues and bugs and gives some information on how to
submit bug reports.</p>
<div class="section" id="content-is-unreadable-open-and-repair">
<h4>“Content is Unreadable. Open and Repair”</h4>
<p>You may occasionally see an Excel warning when opening an XlsxWriter file
like:</p>
<blockquote>
<div>Excel could not open file.xlsx because some content is unreadable. Do you
want to open and repair this workbook.</div></blockquote>
<p>This ominous sounding message is Excel’s default warning for any validation
error in the XML used for the components of the XLSX file.</p>
<p>The error message and the actual file aren’t helpful in debugging issues like
this. If you do encounter this warning you should open an issue on GitHub with
a program to replicate it (see <a class="reference internal" href="#reporting-bugs"><span class="std std-ref">Reporting Bugs</span></a>).</p>
</div>
<div class="section" id="exception-caught-in-workbook-destructor-explicit-close-may-be-required">
<h4>“Exception caught in workbook destructor. Explicit close() may be required”</h4>
<p>The following exception, or similar, can occur if the <a class="reference internal" href="index.html#close" title="close"><code class="xref py py-func docutils literal notranslate"><span class="pre">close()</span></code></a> method
isn’t used at the end of the program:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">Exception</span> <span class="ne">Exception</span><span class="p">:</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Exception caught in workbook destructor.</span>
<span class="n">Explicit</span> <span class="n">close</span><span class="p">()</span> <span class="n">may</span> <span class="n">be</span> <span class="n">required</span> <span class="k">for</span> <span class="n">workbook</span><span class="o">.</span><span class="s1">&#39;,)</span>
<span class="ow">in</span> <span class="o">&lt;</span><span class="n">bound</span> <span class="n">method</span> <span class="n">Workbook</span><span class="o">.</span><span class="fm">__del__</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">xlsxwriter</span><span class="o">.</span><span class="n">workbook</span><span class="o">.</span><span class="n">Workbookobject</span>
<span class="n">at</span> <span class="mh">0x103297d50</span><span class="o">&gt;&gt;</span>
</pre></div>
</div>
<p>Note, it is possible that this exception will also be raised as part of
another exception that occurs during workbook destruction. In either case
ensure that there is an explicit <code class="docutils literal notranslate"><span class="pre">workbook.close()</span></code> in the program.</p>
</div>
<div class="section" id="formulas-displayed-as-name-until-edited">
<h4>Formulas displayed as <code class="docutils literal notranslate"><span class="pre">#NAME?</span></code> until edited</h4>
<p>There are a few reasons why a formula written by XlsxWriter would generate a
<code class="docutils literal notranslate"><span class="pre">#NAME?</span></code> error in Excel:</p>
<ul class="simple">
<li>Invalid formula syntax.</li>
<li>Non-English function names.</li>
<li>Semi-colon separators instead of commas.</li>
<li>Use of Excel 2010 and later functions without a prefix.</li>
</ul>
<p>See <a class="reference internal" href="index.html#working-with-formulas"><span class="std std-ref">Working with Formulas</span></a> and <a class="reference internal" href="index.html#formula-errors"><span class="std std-ref">Dealing with formula errors</span></a> for a more details
and a explanation of how to debug the issue.</p>
</div>
<div class="section" id="formula-results-displaying-as-zero-in-non-excel-applications">
<h4>Formula results displaying as zero in non-Excel applications</h4>
<p>Due to wide range of possible formulas and interdependencies between them
XlsxWriter doesn’t, and realistically cannot, calculate the result of a
formula when it is written to an XLSX file. Instead, it stores the value 0 as
the formula result. It then sets a global flag in the XLSX file to say that
all formulas and functions should be recalculated when the file is opened.</p>
<p>This is the method recommended in the Excel documentation and in general it
works fine with spreadsheet applications. However, applications that don’t
have a facility to calculate formulas, such as Excel Viewer, or several mobile
applications, will only display the 0 results.</p>
<p>See <a class="reference internal" href="index.html#formula-result"><span class="std std-ref">Formula Results</span></a> for more details and a workaround.</p>
</div>
<div class="section" id="images-not-displayed-correctly-in-excel-2001-for-mac-and-non-excel-applications">
<h4>Images not displayed correctly in Excel 2001 for Mac and non-Excel applications</h4>
<p>Images inserted into worksheets via <a class="reference internal" href="index.html#insert_image" title="insert_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_image()</span></code></a> may not display
correctly in Excel 2011 for Mac and non-Excel applications such as OpenOffice
and LibreOffice. Specifically the images may looked stretched or squashed.</p>
<p>This is not specifically an XlsxWriter issue. It also occurs with files created
in Excel 2007 and Excel 2010.</p>
</div>
<div class="section" id="charts-series-created-from-worksheet-tables-cannot-have-user-defined-names">
<h4>Charts series created from Worksheet Tables cannot have user defined names</h4>
<p>In Excel, charts created from <a class="reference internal" href="index.html#tables"><span class="std std-ref">Worksheet Tables</span></a> have a
limitation where the data series name, if specified, must refer to a cell
within the table.</p>
<p>To workaround this Excel limitation you can specify a user defined name in the
table and refer to that from the chart. See <a class="reference internal" href="index.html#charts-from-tables"><span class="std std-ref">Charts from Worksheet Tables</span></a>.</p>
</div>
</div>
<div class="section" id="reporting-bugs">
<span id="id1"></span><h3>Reporting Bugs</h3>
<p>Here are some tips on reporting bugs in XlsxWriter.</p>
<div class="section" id="upgrade-to-the-latest-version-of-the-module">
<h4>Upgrade to the latest version of the module</h4>
<p>The bug you are reporting may already be fixed in the latest version of the
module. You can check which version of XlsxWriter that you are using as
follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import xlsxwriter; print(xlsxwriter.__version__)&#39;</span>
</pre></div>
</div>
<p>Check the <a class="reference internal" href="index.html#changes"><span class="std std-ref">Changes in XlsxWriter</span></a> section to see what has changed in the latest versions.</p>
</div>
<div class="section" id="read-the-documentation">
<h4>Read the documentation</h4>
<p>Read or search the XlsxWriter documentation to see if the issue you are
encountering is already explained.</p>
</div>
<div class="section" id="look-at-the-example-programs">
<h4>Look at the example programs</h4>
<p>There are many <a class="reference internal" href="index.html#main-examples"><span class="std std-ref">Examples</span></a> in the distribution. Try to identify an
example program that corresponds to your query and adapt it to use as a bug
report.</p>
</div>
<div class="section" id="use-the-official-xlsxwriter-issue-tracker-on-github">
<h4>Use the official XlsxWriter Issue tracker on GitHub</h4>
<p>The official XlsxWriter
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues">Issue tracker is on GitHub</a>.</p>
</div>
<div class="section" id="pointers-for-submitting-a-bug-report">
<h4>Pointers for submitting a bug report</h4>
<ol class="arabic simple">
<li>Describe the problem as clearly and as concisely as possible.</li>
<li>Include a sample program. This is probably the most important step. It is
generally easier to describe a problem in code than in written prose.</li>
<li>The sample program should be as small as possible to demonstrate the
problem. Don’t copy and paste large non-relevant sections of your program.</li>
</ol>
<p>A sample bug report is shown below. This format helps to analyze and respond to
the bug report more quickly.</p>
<blockquote>
<div><p><strong>Issue with SOMETHING</strong></p>
<p>I am using XlsxWriter to do SOMETHING but it appears to do SOMETHING ELSE.</p>
<p>I am using Python version X.Y.Z and XlsxWriter x.y.z.</p>
<p>Here is some code that demonstrates the problem:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xlsxwriter</span>

<span class="n">workbook</span> <span class="o">=</span> <span class="n">xlsxwriter</span><span class="o">.</span><span class="n">Workbook</span><span class="p">(</span><span class="s1">&#39;hello.xlsx&#39;</span><span class="p">)</span>
<span class="n">worksheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="n">add_worksheet</span><span class="p">()</span>

<span class="n">worksheet</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;Hello world&#39;</span><span class="p">)</span>

<span class="n">workbook</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
<p>See also how <a class="reference external" href="https://stackoverflow.com/help/minimal-reproducible-example">How to create a Minimal, Complete, and Verifiable example</a> from
StackOverflow.</p>
</div>
</div>
<span id="document-faq"></span><div class="section" id="frequently-asked-questions">
<span id="faq"></span><h3>Frequently Asked Questions</h3>
<p>The section outlines some answers to frequently asked questions.</p>
<div class="section" id="q-can-xlsxwriter-use-an-existing-excel-file-as-a-template">
<h4>Q. Can XlsxWriter use an existing Excel file as a template?</h4>
<p>No.</p>
<p>XlsxWriter is designed only as a file <em>writer</em>. It cannot read or modify an
existing Excel file.</p>
</div>
<div class="section" id="q-why-do-my-formulas-show-a-zero-result-in-some-non-excel-applications">
<h4>Q. Why do my formulas show a zero result in some, non-Excel applications?</h4>
<p>Due to wide range of possible formulas and interdependencies between them
XlsxWriter doesn’t, and realistically cannot, calculate the result of a
formula when it is written to an XLSX file. Instead, it stores the value 0 as
the formula result. It then sets a global flag in the XLSX file to say that
all formulas and functions should be recalculated when the file is opened.</p>
<p>This is the method recommended in the Excel documentation and in general it
works fine with spreadsheet applications. However, applications that don’t
have a facility to calculate formulas, such as Excel Viewer, or several mobile
applications, will only display the 0 results.</p>
<p>If required, it is also possible to specify the calculated result of the
formula using the optional <code class="docutils literal notranslate"><span class="pre">value</span></code> parameter in <a class="reference internal" href="index.html#write_formula" title="write_formula"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_formula()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;=2+2&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="index.html#formula-result"><span class="std std-ref">Formula Results</span></a>.</p>
<p>Note: <strong>LibreOffice</strong> doesn’t recalculate Excel formulas that reference other
cells by default, in which case you will get the default XlsxWriter value
of 0. You can work around this by setting the “LibreOffice Preferences -&gt;
LibreOffice Calc -&gt; Formula -&gt; Recalculation on File Load” option to “Always
recalculate” (see the LibreOffice <a class="reference external" href="https://help.libreoffice.org/6.4/en-US/text/scalc/01/06080000.html">documentation</a>). Or,
you can set a blank result in the formula, which will also force
recalculation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">worksheet</span><span class="o">.</span><span class="n">write_formula</span><span class="p">(</span><span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;=Sheet1!$A$1&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="q-can-i-apply-a-format-to-a-range-of-cells-in-one-go">
<h4>Q. Can I apply a format to a range of cells in one go?</h4>
<p>Currently no. However, it is a planned features to allow cell formats and data
to be written separately.</p>
</div>
<div class="section" id="q-is-feature-x-supported-or-will-it-be-supported">
<h4>Q. Is feature X supported or will it be supported?</h4>
<p>All supported features are documented. Future features are on the <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/653">Roadmap</a>.</p>
</div>
<div class="section" id="q-is-there-an-autofit-option-for-columns">
<h4>Q. Is there an “AutoFit” option for columns?</h4>
<p>Unfortunately, there is no way to specify “AutoFit” for a column in the Excel
file format. This feature is only available at runtime from within Excel. It
is possible to simulate “AutoFit” in your application by tracking the maximum
width of the data in the column as your write it and then adjusting the column
width at the end.</p>
</div>
<div class="section" id="q-can-i-password-protect-an-xlsxwriter-xlsx-file">
<h4>Q. Can I password protect an XlsxWriter xlsx file</h4>
<p>Although it is possible to password protect a worksheet using the Worksheet
<a class="reference internal" href="index.html#protect" title="protect"><code class="xref py py-func docutils literal notranslate"><span class="pre">protect()</span></code></a> method it isn’t possible to password protect the entire
workbook/file using XlsxWriter.</p>
<p>The reason for this is that a protected/encrypted xlsx file is in a different
format from an ordinary xlsx file. This would require a lot of additional work,
and testing, and isn’t something that is on the XlsxWriter roadmap.</p>
<p>However, it is possible to password protect an XlsxWriter generated file using
a third party open source tool called <a class="reference external" href="https://github.com/herumi/msoffice">msoffice-crypt</a>. This works for macOS, Linux and Windows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">msoffice</span><span class="o">-</span><span class="n">crypt</span><span class="o">.</span><span class="n">exe</span> <span class="o">-</span><span class="n">e</span> <span class="o">-</span><span class="n">p</span> <span class="n">password</span> <span class="n">clear</span><span class="o">.</span><span class="n">xlsx</span> <span class="n">encrypted</span><span class="o">.</span><span class="n">xlsx</span>
</pre></div>
</div>
</div>
<div class="section" id="q-do-people-actually-ask-these-questions-frequently-or-at-all">
<h4>Q. Do people actually ask these questions frequently, or at all?</h4>
<p>Apart from this question, yes.</p>
</div>
</div>
<span id="document-changes"></span><div class="section" id="changes-in-xlsxwriter">
<span id="changes"></span><h3>Changes in XlsxWriter</h3>
<p>This section shows changes and bug fixes in the XlsxWriter module.</p>
<p><strong>Deprecation Notice</strong>: Python 2.7 reached the end of its life on January 1st,
2020 and is no longer being supported in the community. XlsxWriter support for
Python 2.7 will end after the first release in 2021 (probably in January
2021). No new features or fixes for Python 2.7 will be added to XlsxWriter
after that date/release.</p>
<div class="section" id="release-1-3-2-august-6-2020">
<h4>Release 1.3.2 - August 6 2020</h4>
<ul class="simple">
<li>Added Border, Fill, Pattern and Gradient formatting to chart data labels and
chart custom data labels. See <a class="reference internal" href="index.html#chart-series-option-data-labels"><span class="std std-ref">Chart series option: Data Labels</span></a> and
<a class="reference internal" href="index.html#chart-series-option-custom-data-labels"><span class="std std-ref">Chart series option: Custom Data Labels</span></a>.</li>
</ul>
</div>
<div class="section" id="release-1-3-1-august-3-2020">
<h4>Release 1.3.1 - August 3 2020</h4>
<ul class="simple">
<li>Fix for issue where array formulas weren’t included in the output file for
certain ranges/conditions.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/735">#735</a>.</li>
</ul>
</div>
<div class="section" id="release-1-3-0-july-30-2020">
<h4>Release 1.3.0 - July 30 2020</h4>
<ul class="simple">
<li>Added support for chart <a class="reference internal" href="index.html#chart-series-option-custom-data-labels"><span class="std std-ref">custom data labels</span></a>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/343">#343</a>.</li>
</ul>
</div>
<div class="section" id="release-1-2-9-may-29-2020">
<h4>Release 1.2.9 - May 29 2020</h4>
<ul class="simple">
<li>Added support for <code class="docutils literal notranslate"><span class="pre">stacked</span></code> and <code class="docutils literal notranslate"><span class="pre">percent_stacked</span></code> Line charts.</li>
</ul>
</div>
<div class="section" id="release-1-2-8-february-22-2020">
<h4>Release 1.2.8 - February 22 2020</h4>
<ul class="simple">
<li>Fix for issue where duplicate images with hyperlinks weren’t handled
correctly.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/686">#686</a>.</li>
<li>Removed <code class="docutils literal notranslate"><span class="pre">ReservedWorksheetName</span></code> exception which was used with the reserved
worksheet name “History” since this name is allowed in some Excel variants.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/688">#688</a>.</li>
<li>Fix for worksheet objects (charts, images and textboxes) that are inserted
with an offset that starts in a hidden cell.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/676">#676</a>.</li>
<li>Fix to allow handling of NoneType in <a class="reference internal" href="index.html#add_write_handler" title="add_write_handler"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_write_handler()</span></code></a>.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/677">#677</a>.</li>
</ul>
</div>
<div class="section" id="release-1-2-7-december-23-2019">
<h4>Release 1.2.7 - December 23 2019</h4>
<ul class="simple">
<li>Fix for duplicate images being copied to an XlsxWriter file. Excel uses an
optimization where it only stores one copy of a repeated/duplicate image in
a workbook. XlsxWriter didn’t do this which meant that the file size would
increase when then was a large number of repeated images. This release fixes
that issue and replicates Excel’s behavior.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/615">#615</a>.</li>
<li>Added documentation on <a class="reference internal" href="index.html#num-format-categories"><span class="std std-ref">Number Format Categories</span></a> and
<a class="reference internal" href="index.html#num-format-locale"><span class="std std-ref">Number Formats in different locales</span></a>.</li>
<li>Added note to <a class="reference internal" href="index.html#protect" title="protect"><code class="xref py py-func docutils literal notranslate"><span class="pre">protect()</span></code></a> about how it is possible to encrypt an
XlsxWriter file using a third party, cross platform, open source tool called
<a class="reference external" href="https://github.com/herumi/msoffice">msoffice-crypt</a>.</li>
</ul>
</div>
<div class="section" id="release-1-2-6-november-15-2019">
<h4>Release 1.2.6 - November 15 2019</h4>
<ul class="simple">
<li>Added option to remove style from worksheet tables.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/670">#670</a>.</li>
</ul>
</div>
<div class="section" id="release-1-2-5-november-10-2019">
<h4>Release 1.2.5 - November 10 2019</h4>
<ul class="simple">
<li>Added option to add hyperlinks to textboxes. See <a class="reference internal" href="index.html#textbox-hyperlink"><span class="std std-ref">Textbox Hyperlink</span></a>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/419">#419</a>.</li>
</ul>
</div>
<div class="section" id="release-1-2-4-november-9-2019">
<h4>Release 1.2.4 - November 9 2019</h4>
<ul class="simple">
<li>Added option to link textbox text from a cell. See <a class="reference internal" href="index.html#textbox-textlink"><span class="std std-ref">Textbox Textlink</span></a>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/516">#516</a>.</li>
<li>Added option to rotate text in a textbox. See
<a class="reference internal" href="index.html#textbox-formatting-rotation"><span class="std std-ref">Textbox formatting: Text Rotation</span></a>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/638">#638</a>.</li>
</ul>
</div>
<div class="section" id="release-1-2-3-november-7-2019">
<h4>Release 1.2.3 - November 7 2019</h4>
<ul class="simple">
<li>Increased allowable worksheet url length from 255 to 2079 characters, as
supported in more recent versions of Excel. A lower or user defined limit
can be set via the <code class="docutils literal notranslate"><span class="pre">max_url_length</span></code> property in the <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a>
constructor.</li>
<li>Fixed several issues with hyperlinks in worksheet images.</li>
</ul>
</div>
<div class="section" id="release-1-2-2-october-16-2019">
<h4>Release 1.2.2 - October 16 2019</h4>
<ul class="simple">
<li>Fixed Python 3.8.0 warnings.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/660">#660</a>.</li>
</ul>
</div>
<div class="section" id="release-1-2-1-september-14-2019">
<h4>Release 1.2.1 - September 14 2019</h4>
<ul class="simple">
<li>Added the <a class="reference internal" href="index.html#add_write_handler" title="add_write_handler"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_write_handler()</span></code></a> method to allow user defined types to be
handled by the <a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> method. See <a class="reference internal" href="index.html#writing-user-types"><span class="std std-ref">Writing user defined types</span></a> for more
information.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/631">#631</a>.</li>
<li>Add support for East Asian vertical fonts in charts.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/648">#648</a>.</li>
</ul>
</div>
<div class="section" id="release-1-2-0-august-26-2019">
<h4>Release 1.2.0 - August 26 2019</h4>
<ul class="simple">
<li>Refactored exception handling around the workbook file <a class="reference internal" href="index.html#close" title="close"><code class="xref py py-func docutils literal notranslate"><span class="pre">close()</span></code></a>
method to allow exceptions to be caught and handled. See
<a class="reference internal" href="index.html#ex-check-close"><span class="std std-ref">Example: Catch exception on closing</span></a>. Also refactored the code to clean up temp files in
the event of an exception.
Issues <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/471">#471</a>
and <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/647">#647</a>.</li>
<li>Added the option to allow chart fonts to be rotated to 270 degrees
to give a stacked orientation. See <a class="reference internal" href="index.html#chart-fonts"><span class="std std-ref">Chart Fonts</span></a>.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/648">#648</a>.</li>
</ul>
</div>
<div class="section" id="release-1-1-9-august-19-2019">
<h4>Release 1.1.9 - August 19 2019</h4>
<ul class="simple">
<li>Another fix for issues where zipfile.py raises “ZIP does not support
timestamps before 1980” exception.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/651">#651</a>.</li>
</ul>
</div>
<div class="section" id="release-1-1-8-may-5-2019">
<h4>Release 1.1.8 - May 5 2019</h4>
<ul class="simple">
<li>Added ability to combine Doughnut and Pie charts.</li>
<li>Added gauge chart example which is a combination of a Doughnut and a Pie
chart. See <a class="reference internal" href="index.html#ex-chart-gauge"><span class="std std-ref">Example: Gauge Chart</span></a>.</li>
</ul>
</div>
<div class="section" id="release-1-1-7-april-20-2019">
<h4>Release 1.1.7 - April 20 2019</h4>
<ul class="simple">
<li>Added docs on <a class="reference internal" href="index.html#object-position"><span class="std std-ref">Working with Object Positioning</span></a>.</li>
<li>Added fix for sizing of cell comment boxes when they cross columns/rows that
have size changes that occur after the comment is written.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/403">#403</a> and
issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/312">#312</a>.</li>
<li>Added fix for the sizing of worksheet objects (images, charts, textboxes)
when the underlying cell sizes have changed and the “object_position”
parameter has been set to 1 “Move and size with cells”. An additional mode 4
has been added to simulate inserting the object in hidden rows.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/618">#618</a>.</li>
<li>Added object positioning for charts and textboxes, it was already supported
for images. Note, the parameter is now called <code class="docutils literal notranslate"><span class="pre">object_position</span></code>. The
previous parameter name <code class="docutils literal notranslate"><span class="pre">positioning</span></code> is deprecated but still supported
for images.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/568">#568</a>.</li>
</ul>
</div>
<div class="section" id="release-1-1-6-april-7-2019">
<h4>Release 1.1.6 - April 7 2019</h4>
<ul class="simple">
<li>Fixed issue where images that started in hidden rows/columns weren’t placed
correctly in the worksheet.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/613">#613</a>.</li>
<li>Fixed the mime-type reported by system <code class="docutils literal notranslate"><span class="pre">file(1)</span></code>. The mime-type reported
by “file –mime-type”/magic was incorrect for XlsxWriter files since it
expected the <code class="docutils literal notranslate"><span class="pre">[Content_types]</span></code> to be the first file in the zip container.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/614">#614</a>.</li>
</ul>
</div>
<div class="section" id="release-1-1-5-february-22-2019">
<h4>Release 1.1.5 - February 22 2019</h4>
<ul class="simple">
<li>This version removes support for end of life Pythons 2.5, 2.6, 3.1, 3.2 and
3.3. For older, unsupported versions of Python use version 1.1.4 of
XlsxWriter.</li>
</ul>
</div>
<div class="section" id="release-1-1-4-february-10-2019">
<h4>Release 1.1.4 - February 10 2019</h4>
<ul class="simple">
<li>Fix for issues where zipfile.py raises “ZIP does not support timestamps
before 1980” exception.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/535">#535</a>.</li>
</ul>
</div>
<div class="section" id="release-1-1-3-february-9-2019">
<h4>Release 1.1.3 - February 9 2019</h4>
<ul class="simple">
<li>Fix handling of <code class="docutils literal notranslate"><span class="pre">'num_format':</span> <span class="pre">'0'</span></code> in duplicate formats.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/584">#584</a>.</li>
</ul>
</div>
<div class="section" id="release-1-1-2-october-20-2018">
<h4>Release 1.1.2 - October 20 2018</h4>
<ul class="simple">
<li>Fix for issue where <code class="docutils literal notranslate"><span class="pre">in_memory</span></code> files weren’t compressed.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/573">#573</a>.</li>
<li>Fix <code class="docutils literal notranslate"><span class="pre">write()</span></code> so that it handles array formulas as documented.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/418">#418</a>.</li>
<li>Fix for issue with special characters in worksheet table functions.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/442">#442</a>.</li>
<li>Added warnings for input issues in <a class="reference internal" href="index.html#write_rich_string" title="write_rich_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_rich_string()</span></code></a> such as blank
strings, double formats or insufficient parameters.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/425">#425</a>.</li>
</ul>
</div>
<div class="section" id="release-1-1-1-september-22-2018">
<h4>Release 1.1.1 - September 22 2018</h4>
<ul class="simple">
<li>Added comment font name and size options.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/201">#201</a>.</li>
<li>Fix for issue when using text boxes in the same workbook as a chartsheet.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/420">#420</a>.</li>
</ul>
</div>
<div class="section" id="release-1-1-0-september-2-2018">
<h4>Release 1.1.0 - September 2 2018</h4>
<ul class="simple">
<li>Added functionality to align chart category axis labels. See the
<code class="docutils literal notranslate"><span class="pre">label_align</span></code> property of the <a class="reference internal" href="index.html#set_x_axis" title="set_x_axis"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_x_axis()</span></code></a> method.</li>
<li>Added worksheet <a class="reference internal" href="index.html#hide_row_col_headers" title="hide_row_col_headers"><code class="xref py py-func docutils literal notranslate"><span class="pre">hide_row_col_headers()</span></code></a> method to turn off worksheet
row and column headings.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/480">#480</a>.</li>
<li>Added the <a class="reference internal" href="index.html#set_tab_ratio" title="set_tab_ratio"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_tab_ratio()</span></code></a> method to set the ratio between the
worksheet tabs and the horizontal slider.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/481">#481</a>.</li>
<li>Fixed issue with icon conditional formats when the values were zero.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/565">#565</a>.</li>
</ul>
</div>
<div class="section" id="release-1-0-9-august-27-2018">
<h4>Release 1.0.9 - August 27 2018</h4>
<ul class="simple">
<li>Fix for issue with formulas quoted as strings in conditional formats,
introduced in version 1.0.7.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/564">#564</a>.</li>
</ul>
</div>
<div class="section" id="release-1-0-8-august-27-2018">
<h4>Release 1.0.8 - August 27 2018</h4>
<ul class="simple">
<li>Added named exceptions to XlsxWriter. See <a class="reference internal" href="index.html#exceptions"><span class="std std-ref">The Exceptions Class</span></a>.</li>
<li>Removed the implicit <a class="reference internal" href="index.html#close" title="close"><code class="xref py py-func docutils literal notranslate"><span class="pre">close()</span></code></a> in the destructor since it wasn’t
guaranteed to work correctly and raised a confusing exception when any other
exception was triggered. <strong>Note that this is a backward incompatible
change.</strong> The <code class="docutils literal notranslate"><span class="pre">with</span></code> context manager is a better way to close
automatically, see <a class="reference internal" href="index.html#close" title="close"><code class="xref py py-func docutils literal notranslate"><span class="pre">close()</span></code></a>.</li>
<li>Added border, fill, pattern and gradient formatting options to
<a class="reference internal" href="index.html#set_legend" title="set_legend"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_legend()</span></code></a>.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/545">#545</a>.</li>
<li>Added <code class="docutils literal notranslate"><span class="pre">top_right</span></code> position to <a class="reference internal" href="index.html#set_legend" title="set_legend"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_legend()</span></code></a>.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/537">#537</a>.</li>
</ul>
</div>
<div class="section" id="release-1-0-7-august-16-2018">
<h4>Release 1.0.7 - August 16 2018</h4>
<ul class="simple">
<li>Fix for unicode type error in Python 3.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/554">#554</a>.</li>
</ul>
</div>
<div class="section" id="release-1-0-6-august-15-2018">
<h4>Release 1.0.6 - August 15 2018</h4>
<ul class="simple">
<li>Added some performance improvements.
PR <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/pull/551">#551</a>.</li>
</ul>
</div>
<div class="section" id="release-1-0-5-may-19-2018">
<h4>Release 1.0.5 - May 19 2018</h4>
<ul class="simple">
<li>Added example of how to subclass the Workbook and Worksheet objects. See
<a class="reference internal" href="index.html#ex-inheritance1"><span class="std std-ref">Example: Example of subclassing the Workbook and Worksheet classes</span></a> and <a class="reference internal" href="index.html#ex-inheritance2"><span class="std std-ref">Example: Advanced example of subclassing</span></a>.</li>
<li>Added support for WMF and EMF image formats to the Worksheet
<code class="xref py py-func docutils literal notranslate"><span class="pre">add_image()</span></code> method.</li>
</ul>
</div>
<div class="section" id="release-1-0-4-april-14-2018">
<h4>Release 1.0.4 - April 14 2018</h4>
<ul class="simple">
<li>Set the xlsx internal file member datetimes to 1980-01-01 00:00:00 like
Excel so that apps can produce a consistent binary file once the workbook
<a class="reference internal" href="index.html#set_properties" title="set_properties"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_properties()</span></code></a> <code class="docutils literal notranslate"><span class="pre">created</span></code> date is set.
Pull request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/pull/495">#495</a>.</li>
<li>Fix for jpeg images that reported unknown height/width due to unusual SOF markers.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/506">#506</a>.</li>
<li>Added support for blanks in list autofilter.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/505">#505</a>.</li>
</ul>
</div>
<div class="section" id="release-1-0-3-april-10-2018">
<h4>Release 1.0.3 - April 10 2018</h4>
<ul class="simple">
<li>Added Excel 2010 data bar features such as solid fills and control over the
display of negative values. See <a class="reference internal" href="index.html#working-with-conditional-formats"><span class="std std-ref">Working with Conditional Formatting</span></a> and
<a class="reference internal" href="index.html#ex-cond-format"><span class="std std-ref">Example: Conditional Formatting</span></a>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/502">#502</a>.</li>
<li>Fixed <a class="reference internal" href="index.html#set_column" title="set_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_column()</span></code></a> parameter names to match docs and other methods.
Note, this is a backward incompatible change.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/504">#504</a>.</li>
<li>Fixed missing plotarea formatting in pie/doughnut charts.</li>
</ul>
</div>
<div class="section" id="release-1-0-2-october-14-2017">
<h4>Release 1.0.2 - October 14 2017</h4>
<ul class="simple">
<li>Fix for cases where the hyperlink style added in the previous release didn’t
work.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/455">#455</a>.</li>
</ul>
</div>
<div class="section" id="release-1-0-1-october-14-2017">
<h4>Release 1.0.1 - October 14 2017</h4>
<ul class="simple">
<li>Changed default <a class="reference internal" href="index.html#write_url" title="write_url"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_url()</span></code></a> format to the Excel hyperlink style so that
it changes when the theme is changed and also so that it indicates that the
link has been clicked.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/455">#455</a>.</li>
</ul>
</div>
<div class="section" id="release-1-0-0-september-16-2017">
<h4>Release 1.0.0 - September 16 2017</h4>
<ul class="simple">
<li>Added icon sets to conditional formatting. See
<a class="reference internal" href="index.html#working-with-conditional-formats"><span class="std std-ref">Working with Conditional Formatting</span></a> and <a class="reference internal" href="index.html#ex-cond-format"><span class="std std-ref">Example: Conditional Formatting</span></a>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/387">#387</a>.</li>
</ul>
</div>
<div class="section" id="release-0-9-9-september-5-2017">
<h4>Release 0.9.9 - September 5 2017</h4>
<ul class="simple">
<li>Added <code class="docutils literal notranslate"><span class="pre">stop_if_true</span></code> parameter to conditional formatting.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/386">#386</a>.</li>
</ul>
</div>
<div class="section" id="release-0-9-8-july-1-2017">
<h4>Release 0.9.8 - July 1 2017</h4>
<ul class="simple">
<li>Fixed issue where spurious deprecation warning was raised in <code class="docutils literal notranslate"><span class="pre">-Werror</span></code> mode.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/451">#451</a>.</li>
</ul>
</div>
<div class="section" id="release-0-9-7-june-25-2017">
<h4>Release 0.9.7 - June 25 2017</h4>
<ul class="simple">
<li>Minor bug and doc fixes.</li>
</ul>
</div>
<div class="section" id="release-0-9-6-dec-26-2016">
<h4>Release 0.9.6 - Dec 26 2016</h4>
<ul class="simple">
<li>Fix for table with data but without a header.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/405">#405</a>.</li>
<li>Add a warning when the number of series in a chart exceeds Excel’s limit
of 255.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/399">#399</a>.</li>
</ul>
</div>
<div class="section" id="release-0-9-5-dec-24-2016">
<h4>Release 0.9.5 - Dec 24 2016</h4>
<ul class="simple">
<li>Fix for missing <cite>remove_timezone</cite> option in Chart class.
PR from Thomas Arnhold
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/pull/404">#404</a>.</li>
</ul>
</div>
<div class="section" id="release-0-9-4-dec-2-2016">
<h4>Release 0.9.4 - Dec 2 2016</h4>
<ul class="simple">
<li>Added user definable removal of timezones in datetimes. See the
<a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> constructor option <code class="docutils literal notranslate"><span class="pre">remove_timezone</span></code> and <a class="reference internal" href="index.html#timezone-handling"><span class="std std-ref">Timezone
Handling in XlsxWriter</span></a>.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/257">#257</a>.</li>
<li>Fix duplicate header warning in <a class="reference internal" href="index.html#add_table" title="add_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_table()</span></code></a> when there is only one
user defined header.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/380">#380</a>.</li>
<li>Fix for <cite>center_across</cite> property in <a class="reference internal" href="index.html#add_format" title="add_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_format()</span></code></a>.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/381">#381</a>.</li>
</ul>
</div>
<div class="section" id="release-0-9-3-july-8-2016">
<h4>Release 0.9.3 - July 8 2016</h4>
<ul class="simple">
<li>Added check to <a class="reference internal" href="index.html#add_table" title="add_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_table()</span></code></a> to prevent duplicate header names which
leads to a corrupt Excel file.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/362">#362</a>.</li>
</ul>
</div>
<div class="section" id="release-0-9-2-june-13-2016">
<h4>Release 0.9.2 - June 13 2016</h4>
<ul class="simple">
<li>Added workbook <a class="reference internal" href="index.html#set_size" title="set_size"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_size()</span></code></a> method to set the workbook window size.</li>
</ul>
</div>
<div class="section" id="release-0-9-1-june-8-2016">
<h4>Release 0.9.1 - June 8 2016</h4>
<ul class="simple">
<li>Added font support to chart <a class="reference internal" href="index.html#set_table" title="set_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_table()</span></code></a>.</li>
<li>Documented used of font rotation in chart <a class="reference internal" href="index.html#chart-series-option-data-labels"><span class="std std-ref">data labels</span></a>.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/337">#337</a>.</li>
</ul>
</div>
<div class="section" id="release-0-9-0-june-7-2016">
<h4>Release 0.9.0 - June 7 2016</h4>
<ul class="simple">
<li>Added <a class="reference internal" href="index.html#chart-series-option-trendline"><span class="std std-ref">trendline properties</span></a>:
<code class="docutils literal notranslate"><span class="pre">intercept</span></code>, <code class="docutils literal notranslate"><span class="pre">display_equation</span></code> and <code class="docutils literal notranslate"><span class="pre">display_r_squared</span></code>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/357">#357</a>.</li>
</ul>
</div>
<div class="section" id="release-0-8-9-june-1-2016">
<h4>Release 0.8.9 - June 1 2016</h4>
<ul class="simple">
<li>Fix for <a class="reference internal" href="index.html#insert_image" title="insert_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_image()</span></code></a> issue when handling images with zero dpi.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/356">#356</a>.</li>
</ul>
</div>
<div class="section" id="release-0-8-8-may-31-2016">
<h4>Release 0.8.8 - May 31 2016</h4>
<ul class="simple">
<li>Added workbook <a class="reference internal" href="index.html#set_custom_property" title="set_custom_property"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_custom_property()</span></code></a> method to set custom document
properties.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/355">#355</a>.</li>
</ul>
</div>
<div class="section" id="release-0-8-7-may-13-2016">
<h4>Release 0.8.7 - May 13 2016</h4>
<ul class="simple">
<li>Fix for issue when inserting read-only images on Windows.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/352">#352</a>.</li>
<li>Added <a class="reference internal" href="index.html#get_worksheet_by_name" title="get_worksheet_by_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_worksheet_by_name()</span></code></a> method to allow the retrieval of a
worksheet from a workbook via its name.</li>
<li>Fixed issue where internal file creation and modification dates were in the
local timezone instead of UTC.</li>
</ul>
</div>
<div class="section" id="release-0-8-6-april-27-2016">
<h4>Release 0.8.6 - April 27 2016</h4>
<ul class="simple">
<li>Fix for <code class="docutils literal notranslate"><span class="pre">external:</span></code> urls where the target/anchor contains spaces.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/350">#350</a>.</li>
</ul>
</div>
<div class="section" id="release-0-8-5-april-17-2016">
<h4>Release 0.8.5 - April 17 2016</h4>
<ul class="simple">
<li>Added additional documentation on <a class="reference internal" href="index.html#ewx-pandas"><span class="std std-ref">Working with Python Pandas and XlsxWriter</span></a> and
<a class="reference internal" href="index.html#pandas-examples"><span class="std std-ref">Pandas with XlsxWriter Examples</span></a>.</li>
<li>Added fix for <a class="reference internal" href="index.html#set_center_across" title="set_center_across"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_center_across()</span></code></a> format method.</li>
</ul>
</div>
<div class="section" id="release-0-8-4-january-16-2016">
<h4>Release 0.8.4 - January 16 2016</h4>
<ul class="simple">
<li>Fix for <a class="reference internal" href="index.html#write_url" title="write_url"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_url()</span></code></a> exception when the URL contains two <code class="docutils literal notranslate"><span class="pre">#</span></code>
location/anchors. Note, URLs like this aren’t strictly valid and cannot be
entered manually in Excel.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/330">#330</a>.</li>
</ul>
</div>
<div class="section" id="release-0-8-3-january-14-2016">
<h4>Release 0.8.3 - January 14 2016</h4>
<ul class="simple">
<li>Added options to configure chart axis tick placement. See <a class="reference internal" href="index.html#set_x_axis" title="set_x_axis"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_x_axis()</span></code></a>.</li>
</ul>
</div>
<div class="section" id="release-0-8-2-january-13-2016">
<h4>Release 0.8.2 - January 13 2016</h4>
<ul class="simple">
<li>Added transparency option to solid fill colors in chart areas
(<a class="reference internal" href="index.html#chart-formatting-fill"><span class="std std-ref">Chart formatting: Solid Fill</span></a>).
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/298">#298</a>.</li>
</ul>
</div>
<div class="section" id="release-0-8-1-january-12-2016">
<h4>Release 0.8.1 - January 12 2016</h4>
<ul class="simple">
<li>Added option to set chart tick interval.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/251">#251</a>.</li>
</ul>
</div>
<div class="section" id="release-0-8-0-january-10-2016">
<h4>Release 0.8.0 - January 10 2016</h4>
<ul class="simple">
<li>Added additional documentation on <a class="reference internal" href="index.html#working-with-formulas"><span class="std std-ref">Working with Formulas</span></a>.</li>
</ul>
</div>
<div class="section" id="release-0-7-9-january-9-2016">
<h4>Release 0.7.9 - January 9 2016</h4>
<ul class="simple">
<li>Added chart pattern fills, see <a class="reference internal" href="index.html#chart-formatting-pattern"><span class="std std-ref">Chart formatting: Pattern Fill</span></a> and
<a class="reference internal" href="index.html#ex-chart-pattern"><span class="std std-ref">Example: Chart with Pattern Fills</span></a>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/268">#268</a>.</li>
</ul>
</div>
<div class="section" id="release-0-7-8-january-6-2016">
<h4>Release 0.7.8 - January 6 2016</h4>
<ul class="simple">
<li>Add checks for valid and non-duplicate worksheet table names.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/319">#319</a>.</li>
</ul>
</div>
<div class="section" id="release-0-7-7-october-19-2015">
<h4>Release 0.7.7 - October 19 2015</h4>
<ul class="simple">
<li>Added support for table header formatting and a fix for wrapped lines in the
header.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/287">#287</a>.</li>
</ul>
</div>
<div class="section" id="release-0-7-6-october-7-2015">
<h4>Release 0.7.6 - October 7 2015</h4>
<ul class="simple">
<li>Fix for images with negative offsets.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/273">#273</a>.</li>
</ul>
</div>
<div class="section" id="release-0-7-5-october-4-2015">
<h4>Release 0.7.5 - October 4 2015</h4>
<ul class="simple">
<li>Allow hyperlinks longer than 255 characters when the link and anchor are
each less than or equal to 255 characters.</li>
<li>Added <code class="docutils literal notranslate"><span class="pre">hyperlink_base</span></code> document property.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/306">#306</a>.</li>
</ul>
</div>
<div class="section" id="release-0-7-4-september-29-2015">
<h4>Release 0.7.4 - September 29 2015</h4>
<ul class="simple">
<li>Added option to allow data validation input messages with the ‘any’ validate
parameter.</li>
<li>Fixed url encoding of links to external files and directories.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/278">#278</a>.</li>
</ul>
</div>
<div class="section" id="release-0-7-3-may-7-2015">
<h4>Release 0.7.3 - May 7 2015</h4>
<ul class="simple">
<li>Added documentation on <a class="reference internal" href="index.html#ewx-pandas"><span class="std std-ref">Working with Python Pandas and XlsxWriter</span></a> and <a class="reference internal" href="index.html#pandas-examples"><span class="std std-ref">Pandas with XlsxWriter Examples</span></a>.</li>
<li>Added support for <code class="docutils literal notranslate"><span class="pre">with</span></code> context manager.
Pull request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/pull/239">#239</a>.</li>
</ul>
</div>
<div class="section" id="release-0-7-2-march-29-2015">
<h4>Release 0.7.2 - March 29 2015</h4>
<ul class="simple">
<li>Added support for textboxes in worksheets. See <a class="reference internal" href="index.html#insert_textbox" title="insert_textbox"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_textbox()</span></code></a> and
<a class="reference internal" href="index.html#working-with-textboxes"><span class="std std-ref">Working with Textboxes</span></a> for more details.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/107">#107</a>.</li>
</ul>
</div>
<div class="section" id="release-0-7-1-march-23-2015">
<h4>Release 0.7.1 - March 23 2015</h4>
<ul class="simple">
<li>Added gradient fills to chart objects such as the plot area of columns. See
<a class="reference internal" href="index.html#chart-formatting-gradient"><span class="std std-ref">Chart formatting: Gradient Fill</span></a> and <a class="reference internal" href="index.html#ex-chart-gradient"><span class="std std-ref">Example: Chart with Gradient Fills</span></a>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/228">#228</a>.</li>
</ul>
</div>
<div class="section" id="release-0-7-0-march-21-2015">
<h4>Release 0.7.0 - March 21 2015</h4>
<ul class="simple">
<li>Added support for display units in chart axes. See <a class="reference internal" href="index.html#set_x_axis" title="set_x_axis"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_x_axis()</span></code></a>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/185">#185</a>.</li>
<li>Added <code class="docutils literal notranslate"><span class="pre">nan_inf_to_errors</span></code> <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> constructor option to allow
mapping of Python <cite>nan/inf</cite> value to Excel error formulas in <code class="docutils literal notranslate"><span class="pre">write()</span></code> and
<code class="docutils literal notranslate"><span class="pre">write_number()</span></code>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/150">#150</a>.</li>
</ul>
</div>
<div class="section" id="release-0-6-9-march-19-2015">
<h4>Release 0.6.9 - March 19 2015</h4>
<ul class="simple">
<li>Added support for clustered category charts. See <a class="reference internal" href="index.html#ex-chart-clustered"><span class="std std-ref">Example: Clustered Chart</span></a>
for details.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/180">#180</a>.</li>
<li>Refactored the <a class="reference internal" href="index.html#format"><span class="std std-ref">The Format Class</span></a> and formatting documentation.</li>
</ul>
</div>
<div class="section" id="release-0-6-8-march-17-2015">
<h4>Release 0.6.8 - March 17 2015</h4>
<ul class="simple">
<li>Added option to combine two different chart types. See the
<a class="reference internal" href="index.html#chart-combined-charts"><span class="std std-ref">Combined Charts</span></a> section and <a class="reference internal" href="index.html#ex-chart-combined"><span class="std std-ref">Example: Combined Chart</span></a> and
<a class="reference internal" href="index.html#ex-chart-pareto"><span class="std std-ref">Example: Pareto Chart</span></a> for more details.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/72">#72</a>.</li>
</ul>
</div>
<div class="section" id="release-0-6-7-march-1-2015">
<h4>Release 0.6.7 - March 1 2015</h4>
<ul class="simple">
<li>Added option to add function value in worksheet <a class="reference internal" href="index.html#add_table" title="add_table"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_table()</span></code></a>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/216">#216</a>.</li>
<li>Fix for A1 row/col numbers below lower bound.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/212">#212</a>.</li>
</ul>
</div>
<div class="section" id="release-0-6-6-january-16-2015">
<h4>Release 0.6.6 - January 16 2015</h4>
<ul class="simple">
<li>Fix for incorrect shebang line in <cite>vba_extract.py</cite> packaged in wheel.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/211">#211</a>.</li>
<li>Added docs and example for diagonal cell border.
See <a class="reference internal" href="index.html#ex-diagonal-border"><span class="std std-ref">Example: Diagonal borders in cells</span></a>.</li>
</ul>
</div>
<div class="section" id="release-0-6-5-december-31-2014">
<h4>Release 0.6.5 - December 31 2014</h4>
<ul class="simple">
<li>Added worksheet quoting for chart names in lists.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/205">#205</a>.</li>
<li>Added docs on how to find and set VBA codenames.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/202">#202</a>.</li>
<li>Fix Python3 issue with unused charts.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/200">#200</a>.</li>
<li>Enabled warning for missing category is scatter chart.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/197">#197</a>.</li>
<li>Fix for upper chart style limit. Increased the chart style limit from
42 to the correct 48.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/192">#192</a>.</li>
<li>Raise warning if a chart is inserted more than once.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/184">#184</a>.</li>
</ul>
</div>
<div class="section" id="release-0-6-4-november-15-2014">
<h4>Release 0.6.4 - November 15 2014</h4>
<ul class="simple">
<li>Fix for issue where fonts applied to data labels raised exception.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/179">#179</a>.</li>
<li>Added option to allow explicit text axis types for charts, similar to date
axes.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/178">#178</a>.</li>
<li>Fix for issue where the bar/column chart gap and overlap weren’t
applied to the secondary axis.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/177">#177</a>.</li>
</ul>
</div>
<div class="section" id="release-0-6-3-november-6-2014">
<h4>Release 0.6.3 - November 6 2014</h4>
<ul class="simple">
<li>Added support for adding VBA macros to workbooks. See <a class="reference internal" href="index.html#macros"><span class="std std-ref">Working with VBA Macros</span></a>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/126">#126</a>.</li>
</ul>
</div>
<div class="section" id="release-0-6-2-november-1-2014">
<h4>Release 0.6.2 - November 1 2014</h4>
<ul class="simple">
<li>Added chart axis line and fill properties.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/88">#88</a>.</li>
</ul>
</div>
<div class="section" id="release-0-6-1-october-29-2014">
<h4>Release 0.6.1 - October 29 2014</h4>
<ul class="simple">
<li>Added chart specific handling of data label positions since not all positions
are available for all chart types.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/170">#170</a>.</li>
<li>Added number formatting
(issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/130">#130</a>),
font handling, separator and legend key for data labels.
See <a class="reference internal" href="index.html#chart-series-option-data-labels"><span class="std std-ref">Chart series option: Data Labels</span></a></li>
<li>Fix for non-quoted worksheet names containing spaces and non-alphanumeric
characters.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/167">#167</a>.</li>
</ul>
</div>
<div class="section" id="release-0-6-0-october-15-2014">
<h4>Release 0.6.0 - October 15 2014</h4>
<ul class="simple">
<li>Added option to add images to headers and footers. See
<a class="reference internal" href="index.html#ex-headers-footers"><span class="std std-ref">Example: Adding Headers and Footers to Worksheets</span></a>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/133">#133</a>.</li>
<li>Fixed issue where non 96dpi images weren’t scaled properly in Excel.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/164">#164</a>.</li>
<li>Added option to not scale header/footer with page. See <a class="reference internal" href="index.html#set_header" title="set_header"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_header()</span></code></a>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/134">#134</a>.</li>
</ul>
</div>
<div class="section" id="release-0-5-9-october-11-2014">
<h4>Release 0.5.9 - October 11 2014</h4>
<ul class="simple">
<li>Removed <code class="docutils literal notranslate"><span class="pre">egg_base</span></code> requirement from <code class="docutils literal notranslate"><span class="pre">setup.cfg</span></code> which was preventing
installation on Windows.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/162">#162</a>.</li>
<li>Fix for issue where X axis title formula was overwritten by the Y axis
title.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/161">#161</a>.</li>
</ul>
</div>
<div class="section" id="release-0-5-8-september-28-2014">
<h4>Release 0.5.8 - September 28 2014</h4>
<ul class="simple">
<li>Added support for Doughnut charts.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/157">#157</a>.</li>
<li>Added support for wheel packages.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/156">#156</a>.</li>
<li>Made the exception handling in <code class="docutils literal notranslate"><span class="pre">write()</span></code> clearer for unsupported types so
that it raises a more accurate TypeError instead of a ValueError.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/153">#153</a>.</li>
</ul>
</div>
<div class="section" id="release-0-5-7-august-13-2014">
<h4>Release 0.5.7 - August 13 2014</h4>
<ul class="simple">
<li>Added support for <a class="reference internal" href="index.html#insert_image" title="insert_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_image()</span></code></a> images from byte streams to allow
images from URLs and other sources.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/118">#118</a>.</li>
<li>Added <a class="reference internal" href="index.html#write_datetime" title="write_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_datetime()</span></code></a> support for datetime.timedelta.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/128">#128</a>.</li>
</ul>
</div>
<div class="section" id="release-0-5-6-july-22-2014">
<h4>Release 0.5.6 - July 22 2014</h4>
<ul class="simple">
<li>Fix for spurious exception message when <a class="reference internal" href="index.html#close" title="close"><code class="xref py py-func docutils literal notranslate"><span class="pre">close()</span></code></a> isn’t used.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/131">#131</a>.</li>
<li>Fix for formula string values that look like numbers.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/122">#122</a>.</li>
<li>Clarify <a class="reference internal" href="index.html#print_area" title="print_area"><code class="xref py py-func docutils literal notranslate"><span class="pre">print_area()</span></code></a> documentation for complete row/column ranges.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/139">#139</a>.</li>
<li>Fix for unicode strings in data validation lists.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/135">#135</a>.</li>
</ul>
</div>
<div class="section" id="release-0-5-5-may-6-2014">
<h4>Release 0.5.5 - May 6 2014</h4>
<ul class="simple">
<li>Fix for incorrect chart offsets in <a class="reference internal" href="index.html#insert_chart" title="insert_chart"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_chart()</span></code></a> and
<a class="reference internal" href="index.html#set_size" title="set_size"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_size()</span></code></a>.</li>
</ul>
</div>
<div class="section" id="release-0-5-4-may-4-2014">
<h4>Release 0.5.4 - May 4 2014</h4>
<ul class="simple">
<li>Added image positioning option to <a class="reference internal" href="index.html#insert_image" title="insert_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_image()</span></code></a> to control how
images are moved in relation to surrounding cells.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/117">#117</a>.</li>
<li>Fix for chart <code class="docutils literal notranslate"><span class="pre">error_bar</span></code> exceptions.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/115">#115</a>.</li>
<li>Added clearer reporting of nested exceptions in <code class="docutils literal notranslate"><span class="pre">write()</span></code> methods.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/pull/108">#108</a>.</li>
<li>Added support for <code class="docutils literal notranslate"><span class="pre">inside_base</span></code> data label position in charts.</li>
</ul>
</div>
<div class="section" id="release-0-5-3-february-20-2014">
<h4>Release 0.5.3 - February 20 2014</h4>
<ul class="simple">
<li>Added checks and warnings for data validation limits.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/89">#89</a>.</li>
<li>Added option to add hyperlinks to images. Thanks to Paul Tax.</li>
<li>Added Python 3 Http server example. Thanks to Krystian Rosinski.</li>
<li>Added <a class="reference internal" href="index.html#set_calc_mode" title="set_calc_mode"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_calc_mode()</span></code></a> method to control automatic calculation of
formulas when worksheet is opened. Thanks to Chris Tompkinson.</li>
<li>Added <a class="reference internal" href="index.html#use_zip64" title="use_zip64"><code class="xref py py-func docutils literal notranslate"><span class="pre">use_zip64()</span></code></a> method to allow ZIP64 extensions when writing
very large files.</li>
<li>Fix to handle ‘0’ and other number like strings as number formats.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/103">#103</a>.</li>
<li>Fix for missing images in <code class="docutils literal notranslate"><span class="pre">in_memory</span></code> mode.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/102">#102</a>.</li>
</ul>
</div>
<div class="section" id="release-0-5-2-december-31-2013">
<h4>Release 0.5.2 - December 31 2013</h4>
<ul class="simple">
<li>Added date axis handling to charts. See <a class="reference internal" href="index.html#ex-chart-date-axis"><span class="std std-ref">Example: Date Axis Chart</span></a>.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/73">#73</a>.</li>
<li>Added support for non-contiguous chart ranges.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/44">#44</a>.</li>
<li>Fix for low byte and control characters in strings.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/86">#86</a>.</li>
<li>Fix for chart titles with exclamation mark.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/83">#83</a>.</li>
<li>Fix to remove duplicate <a class="reference internal" href="index.html#set_column" title="set_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_column()</span></code></a> entries.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/82">#82</a>.</li>
</ul>
</div>
<div class="section" id="release-0-5-1-december-2-2013">
<h4>Release 0.5.1 - December 2 2013</h4>
<ul class="simple">
<li>Added interval unit option for category axes.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/69">#69</a>.</li>
<li>Fix for axis name font rotation.</li>
<li>Fix for several minor issues with Pie chart legends.</li>
</ul>
</div>
<div class="section" id="release-0-5-0-november-17-2013">
<h4>Release 0.5.0 - November 17 2013</h4>
<ul class="simple">
<li>Added <a class="reference internal" href="index.html#chartsheet"><span class="std std-ref">Chartsheets</span></a> to allow single worksheet charts.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/10">#10</a>.</li>
</ul>
</div>
<div class="section" id="release-0-4-9-november-17-2013">
<h4>Release 0.4.9 - November 17 2013</h4>
<ul class="simple">
<li>Added <a class="reference internal" href="index.html#chart-layout"><span class="std std-ref">chart object positioning and sizing</span></a> to allow
positioning of plotarea, legend, title and axis names.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/66">#66</a>.</li>
<li>Added <a class="reference internal" href="index.html#set_title" title="set_title"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_title()</span></code></a> <code class="docutils literal notranslate"><span class="pre">none</span></code> option to turn off automatic titles.</li>
<li>Improved <a class="reference internal" href="index.html#define_name" title="define_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">define_name()</span></code></a> name validation.</li>
<li>Fix to prevent modification of user parameters in
<a class="reference internal" href="index.html#conditional_format" title="conditional_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">conditional_format()</span></code></a>.</li>
</ul>
</div>
<div class="section" id="release-0-4-8-november-13-2013">
<h4>Release 0.4.8 - November 13 2013</h4>
<ul class="simple">
<li>Added <code class="docutils literal notranslate"><span class="pre">in_memory</span></code> <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> constructor option to allow XlsxWriter
to work on Google App Engine.
Feature request <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/28">#28</a>.</li>
</ul>
</div>
<div class="section" id="release-0-4-7-november-9-2013">
<h4>Release 0.4.7 - November 9 2013</h4>
<ul class="simple">
<li>Added fix for markers on non-marker scatter charts.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/62">#62</a>.</li>
<li>Added custom error bar option. Thanks to input from Alex Birmingham.</li>
<li>Changed Html docs to Bootstrap theme.</li>
<li>Added <a class="reference internal" href="index.html#ex-merge-rich"><span class="std std-ref">Example: Merging Cells with a Rich String</span></a>.</li>
</ul>
</div>
<div class="section" id="release-0-4-6-october-23-2013">
<h4>Release 0.4.6 - October 23 2013</h4>
<ul class="simple">
<li>Added font formatting to chart legends.</li>
</ul>
</div>
<div class="section" id="release-0-4-5-october-21-2013">
<h4>Release 0.4.5 - October 21 2013</h4>
<ul class="simple">
<li>Added <code class="docutils literal notranslate"><span class="pre">position_axis</span></code> chart axis option.</li>
<li>Added optional list handling for chart names.</li>
</ul>
</div>
<div class="section" id="release-0-4-4-october-16-2013">
<h4>Release 0.4.4 - October 16 2013</h4>
<ul class="simple">
<li>Documented use of <a class="reference internal" href="index.html#cell-utility"><span class="std std-ref">cell utility</span></a> functions.</li>
<li>Fix for tables added in non-sequential order. Closes
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/51">#51</a> reported by
calfzhou.</li>
</ul>
</div>
<div class="section" id="release-0-4-3-september-12-2013">
<h4>Release 0.4.3 - September 12 2013</h4>
<ul class="simple">
<li>Fix for comments overlying columns with non-default width.
Issue <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/45">#45</a>.</li>
</ul>
</div>
<div class="section" id="release-0-4-2-august-30-2013">
<h4>Release 0.4.2 - August 30 2013</h4>
<ul class="simple">
<li>Added a default blue underline hyperlink format for <a class="reference internal" href="index.html#write_url" title="write_url"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_url()</span></code></a>.</li>
<li>Added <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> constructor options <code class="docutils literal notranslate"><span class="pre">strings_to_formulas</span></code> and
<code class="docutils literal notranslate"><span class="pre">strings_to_urls</span></code> to override default conversion of strings in write().</li>
</ul>
</div>
<div class="section" id="release-0-4-1-august-28-2013">
<h4>Release 0.4.1 - August 28 2013</h4>
<ul class="simple">
<li>Fix for charts and images that cross rows and columns that are hidden or
formatted but which don’t have size changes. Issue
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/42">#42</a> reported by
Kristian Stobbe.</li>
</ul>
</div>
<div class="section" id="release-0-4-0-august-26-2013">
<h4>Release 0.4.0 - August 26 2013</h4>
<ul class="simple">
<li>Added more generic support for JPEG files. Issue
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/40">#40</a> reported by Simon
Breuss.</li>
<li>Fix for harmless Python 3 installation warning. Issue
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/41">#41</a> reported by James
Reeves.</li>
</ul>
</div>
<div class="section" id="release-0-3-9-august-24-2013">
<h4>Release 0.3.9 - August 24 2013</h4>
<ul class="simple">
<li>Added fix for minor issue with <a class="reference internal" href="index.html#insert_image" title="insert_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_image()</span></code></a> for images that extend
over several cells.</li>
<li>Added fix to ensure formula calculation on load regardless of Excel version.</li>
</ul>
</div>
<div class="section" id="release-0-3-8-august-23-2013">
<h4>Release 0.3.8 - August 23 2013</h4>
<ul class="simple">
<li>Added handling for Decimal(), Fraction() and other float types to the
<a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> function.</li>
<li>Added Python 2.5 and Jython support. Thanks to Jonas Diemer for the patch.</li>
</ul>
</div>
<div class="section" id="release-0-3-7-august-16-2013">
<h4>Release 0.3.7 - August 16 2013</h4>
<ul class="simple">
<li>Added <a class="reference internal" href="index.html#write_boolean" title="write_boolean"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_boolean()</span></code></a> function to write Excel boolean values. Feature request
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/37">#37</a>. Also added
explicit handling of Python bool values to the <a class="reference internal" href="index.html#write" title="write"><code class="xref py py-func docutils literal notranslate"><span class="pre">write()</span></code></a> function.</li>
<li>Changed <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> constructor option
<code class="docutils literal notranslate"><span class="pre">strings_to_numbers</span></code> default option to False so that there is no implicit
conversion of numbers in strings to numbers. The previous behavior can be
obtained by setting the constructor option to True.
<strong>Note</strong> This is a backward incompatibility.</li>
</ul>
</div>
<div class="section" id="release-0-3-6-july-26-2013">
<h4>Release 0.3.6 - July 26 2013</h4>
<ul class="simple">
<li>Simplified import based on a suggestion from John Yeung. Feature request
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/26">#26</a>.</li>
<li>Fix for NAN/INF converted to invalid numbers in write(). Issue
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/30">#30</a>.</li>
<li>Added <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> constructor option <code class="docutils literal notranslate"><span class="pre">strings_to_numbers</span></code> to
override default conversion of number strings to numbers in write().</li>
<li>Added <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> constructor option <code class="docutils literal notranslate"><span class="pre">default_date_format</span></code> to
allow a default date format string to be set. Feature request
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/5">#5</a>.</li>
</ul>
</div>
<div class="section" id="release-0-3-5-june-28-2013">
<h4>Release 0.3.5 - June 28 2013</h4>
<ul class="simple">
<li>Reverted back to using codecs for file encoding (versions &lt;= 0.3.1) to avoid
numerous UTF-8 issues in Python2/3.</li>
</ul>
</div>
<div class="section" id="release-0-3-4-june-27-2013">
<h4>Release 0.3.4 - June 27 2013</h4>
<ul class="simple">
<li>Added Chart line smoothing option. Thanks to Dieter Vandenbussche.</li>
<li>Added Http Server example (<a class="reference internal" href="index.html#ex-http-server"><span class="std std-ref">Example: Simple HTTP Server (Python 2)</span></a>). Thanks to
Alexander Afanasiev.</li>
<li>Fixed inaccurate column width calculation. Closes
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/27">#27</a>. Thanks to
John Yeung.</li>
<li>Added chart axis font rotation.</li>
</ul>
</div>
<div class="section" id="release-0-3-3-june-10-2013">
<h4>Release 0.3.3 - June 10 2013</h4>
<ul class="simple">
<li>Minor packaging fixes
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/14">#14</a> and
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/19">#19</a>.</li>
<li>Fixed explicit UTF-8 file encoding for Python 3.
PR from Alexandr Shadchin,
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/pull/15">#15</a>.</li>
<li>Fixed invalid string formatting resulted in misleading stack trace.
PR from Andrei Korostelev,
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/pull/21">#21</a>.</li>
</ul>
</div>
<div class="section" id="release-0-3-2-may-1-2013">
<h4>Release 0.3.2 - May 1 2013</h4>
<ul class="simple">
<li>Speed optimizations. The module is now 10-15% faster on average.</li>
</ul>
</div>
<div class="section" id="release-0-3-1-april-27-2013">
<h4>Release 0.3.1 - April 27 2013</h4>
<ul class="simple">
<li>Added chart support. See the <a class="reference internal" href="index.html#chart-class"><span class="std std-ref">The Chart Class</span></a>, <a class="reference internal" href="index.html#working-with-charts"><span class="std std-ref">Working with Charts</span></a>
and <a class="reference internal" href="index.html#chart-examples"><span class="std std-ref">Chart Examples</span></a>.</li>
</ul>
</div>
<div class="section" id="release-0-3-0-april-7-2013">
<h4>Release 0.3.0 - April 7 2013</h4>
<ul class="simple">
<li>Added worksheet sparklines. See <a class="reference internal" href="index.html#sparklines"><span class="std std-ref">Working with Sparklines</span></a>, <a class="reference internal" href="index.html#ex-sparklines1"><span class="std std-ref">Example: Sparklines (Simple)</span></a> and
<a class="reference internal" href="index.html#ex-sparklines2"><span class="std std-ref">Example: Sparklines (Advanced)</span></a></li>
</ul>
</div>
<div class="section" id="release-0-2-9-april-7-2013">
<h4>Release 0.2.9 - April 7 2013</h4>
<ul>
<li><p class="first">Added worksheet tables. See <a class="reference internal" href="index.html#tables"><span class="std std-ref">Working with Worksheet Tables</span></a> and <a class="reference internal" href="index.html#ex-tables"><span class="std std-ref">Example: Worksheet Tables</span></a>.</p>
</li>
<li><p class="first">Tested with the new Python stable releases 2.7.4 and 3.3.1. All tests now
pass in the following versions:</p>
<blockquote>
<div><ul class="simple">
<li>Python 2.6</li>
<li>Python 2.7.2</li>
<li>Python 2.7.3</li>
<li>Python 2.7.4</li>
<li>Python 3.1</li>
<li>Python 3.2</li>
<li>Python 3.3.0</li>
<li>Python 3.3.1</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">There are now over 700 unit tests including more than 170 tests that
compare against the output of Excel.</p>
</li>
</ul>
</div>
<div class="section" id="release-0-2-8-april-4-2013">
<h4>Release 0.2.8 - April 4 2013</h4>
<ul class="simple">
<li>Added worksheet outlines and grouping. See <a class="reference internal" href="index.html#outlines"><span class="std std-ref">Working with Outlines and Grouping</span></a>.</li>
</ul>
</div>
<div class="section" id="release-0-2-7-april-3-2013">
<h4>Release 0.2.7 - April 3 2013</h4>
<ul class="simple">
<li>Added <a class="reference internal" href="index.html#set_default_row" title="set_default_row"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_default_row()</span></code></a> method. See <a class="reference internal" href="index.html#ex-hide-row-col"><span class="std std-ref">Example: Hiding Rows and Columns</span></a>.</li>
<li>Added hide_row_col.py, hide_sheet.py and text_indent.py examples.</li>
</ul>
</div>
<div class="section" id="release-0-2-6-april-1-2013">
<h4>Release 0.2.6 - April 1 2013</h4>
<ul class="simple">
<li>Added <a class="reference internal" href="index.html#freeze_panes" title="freeze_panes"><code class="xref py py-func docutils literal notranslate"><span class="pre">freeze_panes()</span></code></a> and <a class="reference internal" href="index.html#split_panes" title="split_panes"><code class="xref py py-func docutils literal notranslate"><span class="pre">split_panes()</span></code></a> methods.
See <a class="reference internal" href="index.html#ex-panes"><span class="std std-ref">Example: Freeze Panes and Split Panes</span></a> .</li>
<li>Added <a class="reference internal" href="index.html#set_selection" title="set_selection"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_selection()</span></code></a> method to select worksheet cell or range of
cells.</li>
</ul>
</div>
<div class="section" id="release-0-2-5-april-1-2013">
<h4>Release 0.2.5 - April 1 2013</h4>
<ul class="simple">
<li>Added additional <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> parameters <code class="docutils literal notranslate"><span class="pre">'tmpdir'</span></code> and
<code class="docutils literal notranslate"><span class="pre">'date_1904'</span></code>.</li>
</ul>
</div>
<div class="section" id="release-0-2-4-march-31-2013">
<h4>Release 0.2.4 - March 31 2013</h4>
<ul class="simple">
<li>Added <a class="reference internal" href="index.html#Workbook" title="Workbook"><code class="xref py py-func docutils literal notranslate"><span class="pre">Workbook()</span></code></a> <code class="docutils literal notranslate"><span class="pre">'constant_memory'</span></code> constructor property to
minimize memory usage when writing large files. See <a class="reference internal" href="index.html#memory-perf"><span class="std std-ref">Working with Memory and Performance</span></a>
for more details.</li>
<li>Fixed bug with handling of UTF-8 strings in worksheet names (and probably
some other places as well). Reported by Josh English.</li>
<li>Fixed bug where temporary directory used to create xlsx files wasn’t
cleaned up after program close.</li>
</ul>
</div>
<div class="section" id="release-0-2-3-march-27-2013">
<h4>Release 0.2.3 - March 27 2013</h4>
<ul class="simple">
<li>Fixed bug that was killing performance for medium sized files. The module
is now 10x faster than previous versions. Reported by John Yeung.</li>
</ul>
</div>
<div class="section" id="release-0-2-2-march-27-2013">
<h4>Release 0.2.2 - March 27 2013</h4>
<ul class="simple">
<li>Added worksheet data validation options. See the <a class="reference internal" href="index.html#data_validation" title="data_validation"><code class="xref py py-func docutils literal notranslate"><span class="pre">data_validation()</span></code></a>
method, <a class="reference internal" href="index.html#working-with-data-validation"><span class="std std-ref">Working with Data Validation</span></a> and <a class="reference internal" href="index.html#ex-data-valid"><span class="std std-ref">Example: Data Validation and Drop Down Lists</span></a>.</li>
<li>There are now over 600 unit tests including more than 130 tests that
compare against the output of Excel.</li>
</ul>
</div>
<div class="section" id="release-0-2-1-march-25-2013">
<h4>Release 0.2.1 - March 25 2013</h4>
<ul class="simple">
<li>Added support for datetime.datetime, datetime.date and datetime.time
to the <a class="reference internal" href="index.html#write_datetime" title="write_datetime"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_datetime()</span></code></a> method. GitHub issue
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues/3">#3</a>.
Thanks to Eduardo (eazb) and Josh English for the prompt.</li>
</ul>
</div>
<div class="section" id="release-0-2-0-march-24-2013">
<h4>Release 0.2.0 - March 24 2013</h4>
<ul class="simple">
<li>Added conditional formatting. See the <a class="reference internal" href="index.html#conditional_format" title="conditional_format"><code class="xref py py-func docutils literal notranslate"><span class="pre">conditional_format()</span></code></a> method,
<a class="reference internal" href="index.html#working-with-conditional-formats"><span class="std std-ref">Working with Conditional Formatting</span></a> and <a class="reference internal" href="index.html#ex-cond-format"><span class="std std-ref">Example: Conditional Formatting</span></a>.</li>
</ul>
</div>
<div class="section" id="release-0-1-9-march-19-2013">
<h4>Release 0.1.9 - March 19 2013</h4>
<ul>
<li><p class="first">Added Python 2.6 support. All tests now pass in the following versions:</p>
<blockquote>
<div><ul class="simple">
<li>Python 2.6</li>
<li>Python 2.7.2</li>
<li>Python 2.7.3</li>
<li>Python 3.1</li>
<li>Python 3.2</li>
<li>Python 3.3.0</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="release-0-1-8-march-18-2013">
<h4>Release 0.1.8 - March 18 2013</h4>
<ul class="simple">
<li>Fixed Python 3 support.</li>
</ul>
</div>
<div class="section" id="release-0-1-7-march-18-2013">
<h4>Release 0.1.7 - March 18 2013</h4>
<ul class="simple">
<li>Added the option to write cell comments to a worksheet. See
<a class="reference internal" href="index.html#write_comment" title="write_comment"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_comment()</span></code></a> and <a class="reference internal" href="index.html#cell-comments"><span class="std std-ref">Working with Cell Comments</span></a>.</li>
</ul>
</div>
<div class="section" id="release-0-1-6-march-17-2013">
<h4>Release 0.1.6 - March 17 2013</h4>
<ul class="simple">
<li>Added <a class="reference internal" href="index.html#insert_image" title="insert_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">insert_image()</span></code></a> worksheet method to support inserting PNG and
JPEG images into a worksheet. See also the example program
<a class="reference internal" href="index.html#ex-insert-image"><span class="std std-ref">Example: Inserting images into a worksheet</span></a>.</li>
<li>There are now over 500 unit tests including more than 100 tests that
compare against the output of Excel.</li>
</ul>
</div>
<div class="section" id="release-0-1-5-march-10-2013">
<h4>Release 0.1.5 - March 10 2013</h4>
<ul class="simple">
<li>Added the <a class="reference internal" href="index.html#write_rich_string" title="write_rich_string"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_rich_string()</span></code></a> worksheet method to allow writing of
text with multiple formats to a cell. Also added example program:
<a class="reference internal" href="index.html#ex-rich-strings"><span class="std std-ref">Example: Writing “Rich” strings with multiple formats</span></a>.</li>
<li>Added the <a class="reference internal" href="index.html#hide" title="hide"><code class="xref py py-func docutils literal notranslate"><span class="pre">hide()</span></code></a> worksheet method to hide worksheets.</li>
<li>Added the <a class="reference internal" href="index.html#set_first_sheet" title="set_first_sheet"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_first_sheet()</span></code></a> worksheet method.</li>
</ul>
</div>
<div class="section" id="release-0-1-4-march-8-2013">
<h4>Release 0.1.4 - March 8 2013</h4>
<ul class="simple">
<li>Added the <a class="reference internal" href="index.html#protect" title="protect"><code class="xref py py-func docutils literal notranslate"><span class="pre">protect()</span></code></a> worksheet method to allow protection of cells
from editing. Also added example program: <a class="reference internal" href="index.html#ex-protection"><span class="std std-ref">Example: Enabling Cell protection in Worksheets</span></a>.</li>
</ul>
</div>
<div class="section" id="release-0-1-3-march-7-2013">
<h4>Release 0.1.3 - March 7 2013</h4>
<ul>
<li><p class="first">Added worksheet methods:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="index.html#set_zoom" title="set_zoom"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_zoom()</span></code></a> for setting worksheet zoom levels.</li>
<li><a class="reference internal" href="index.html#right_to_left" title="right_to_left"><code class="xref py py-func docutils literal notranslate"><span class="pre">right_to_left()</span></code></a> for middle eastern versions of Excel.</li>
<li><a class="reference internal" href="index.html#hide_zero" title="hide_zero"><code class="xref py py-func docutils literal notranslate"><span class="pre">hide_zero()</span></code></a> for hiding zero values in cells.</li>
<li><a class="reference internal" href="index.html#set_tab_color" title="set_tab_color"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_tab_color()</span></code></a> for setting the worksheet tab color.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="release-0-1-2-march-6-2013">
<h4>Release 0.1.2 - March 6 2013</h4>
<ul class="simple">
<li>Added autofilters. See <a class="reference internal" href="index.html#working-with-autofilters"><span class="std std-ref">Working with Autofilters</span></a> for more details.</li>
<li>Added the <a class="reference internal" href="index.html#write_row" title="write_row"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_row()</span></code></a> and <a class="reference internal" href="index.html#write_column" title="write_column"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_column()</span></code></a> worksheet methods.</li>
</ul>
</div>
<div class="section" id="release-0-1-1-march-3-2013">
<h4>Release 0.1.1 - March 3 2013</h4>
<ul class="simple">
<li>Added the <a class="reference internal" href="index.html#write_url" title="write_url"><code class="xref py py-func docutils literal notranslate"><span class="pre">write_url()</span></code></a> worksheet method for writing hyperlinks to
a worksheet.</li>
</ul>
</div>
<div class="section" id="release-0-1-0-february-28-2013">
<h4>Release 0.1.0 - February 28 2013</h4>
<ul>
<li><p class="first">Added the <a class="reference internal" href="index.html#set_properties" title="set_properties"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_properties()</span></code></a> workbook method for setting document
properties.</p>
</li>
<li><p class="first">Added several new examples programs with documentation. The examples now
include:</p>
<blockquote>
<div><ul class="simple">
<li>array_formula.py</li>
<li>cell_indentation.py</li>
<li>datetimes.py</li>
<li>defined_name.py</li>
<li>demo.py</li>
<li>doc_properties.py</li>
<li>headers_footers.py</li>
<li>hello_world.py</li>
<li>merge1.py</li>
<li>tutorial1.py</li>
<li>tutorial2.py</li>
<li>tutorial3.py</li>
<li>unicode_polish_utf8.py</li>
<li>unicode_shift_jis.py</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="release-0-0-9-february-27-2013">
<h4>Release 0.0.9 - February 27 2013</h4>
<ul class="simple">
<li>Added the <a class="reference internal" href="index.html#define_name" title="define_name"><code class="xref py py-func docutils literal notranslate"><span class="pre">define_name()</span></code></a> method to create defined names and ranges
in a workbook or worksheet.</li>
<li>Added the <a class="reference internal" href="index.html#worksheets" title="worksheets"><code class="xref py py-func docutils literal notranslate"><span class="pre">worksheets()</span></code></a> method as an accessor for the worksheets in a
workbook.</li>
</ul>
</div>
<div class="section" id="release-0-0-8-february-26-2013">
<h4>Release 0.0.8 - February 26 2013</h4>
<ul class="simple">
<li>Added the <a class="reference internal" href="index.html#merge_range" title="merge_range"><code class="xref py py-func docutils literal notranslate"><span class="pre">merge_range()</span></code></a> method to merge worksheet cells.</li>
</ul>
</div>
<div class="section" id="release-0-0-7-february-25-2013">
<h4>Release 0.0.7 - February 25 2013</h4>
<ul>
<li><p class="first">Added final page setup methods to complete the page setup section.</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="index.html#print_area" title="print_area"><code class="xref py py-func docutils literal notranslate"><span class="pre">print_area()</span></code></a></li>
<li><a class="reference internal" href="index.html#fit_to_pages" title="fit_to_pages"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_to_pages()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_start_page" title="set_start_page"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_start_page()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_print_scale" title="set_print_scale"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_print_scale()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_h_pagebreaks" title="set_h_pagebreaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_h_pagebreaks()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_v_pagebreaks" title="set_v_pagebreaks"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_v_pagebreaks()</span></code></a></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="release-0-0-6-february-22-2013">
<h4>Release 0.0.6 - February 22 2013</h4>
<ul>
<li><p class="first">Added page setup method.</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="index.html#print_row_col_headers" title="print_row_col_headers"><code class="xref py py-func docutils literal notranslate"><span class="pre">print_row_col_headers()</span></code></a></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="release-0-0-5-february-21-2013">
<h4>Release 0.0.5 - February 21 2013</h4>
<ul>
<li><p class="first">Added page setup methods.</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="index.html#repeat_rows" title="repeat_rows"><code class="xref py py-func docutils literal notranslate"><span class="pre">repeat_rows()</span></code></a></li>
<li><a class="reference internal" href="index.html#repeat_columns" title="repeat_columns"><code class="xref py py-func docutils literal notranslate"><span class="pre">repeat_columns()</span></code></a></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="release-0-0-4-february-20-2013">
<h4>Release 0.0.4 - February 20 2013</h4>
<ul>
<li><p class="first">Added Python 3 support with help from John Evans. Tested with:</p>
<blockquote>
<div><ul class="simple">
<li>Python-2.7.2</li>
<li>Python-2.7.3</li>
<li>Python-3.2</li>
<li>Python-3.3.0</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Added page setup methods.</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="index.html#center_horizontally" title="center_horizontally"><code class="xref py py-func docutils literal notranslate"><span class="pre">center_horizontally()</span></code></a></li>
<li><a class="reference internal" href="index.html#center_vertically" title="center_vertically"><code class="xref py py-func docutils literal notranslate"><span class="pre">center_vertically()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_header" title="set_header"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_header()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_footer" title="set_footer"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_footer()</span></code></a></li>
<li><a class="reference internal" href="index.html#hide_gridlines" title="hide_gridlines"><code class="xref py py-func docutils literal notranslate"><span class="pre">hide_gridlines()</span></code></a></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="release-0-0-3-february-19-2013">
<h4>Release 0.0.3 - February 19 2013</h4>
<ul>
<li><p class="first">Added page setup method.</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="index.html#set_margins" title="set_margins"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_margins()</span></code></a></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="release-0-0-2-february-18-2013">
<h4>Release 0.0.2 - February 18 2013</h4>
<ul>
<li><p class="first">Added page setup methods.</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="index.html#set_landscape" title="set_landscape"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_landscape()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_portrait" title="set_portrait"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_portrait()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_page_view" title="set_page_view"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_page_view()</span></code></a></li>
<li><a class="reference internal" href="index.html#set_paper" title="set_paper"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_paper()</span></code></a></li>
<li><a class="reference internal" href="index.html#print_across" title="print_across"><code class="xref py py-func docutils literal notranslate"><span class="pre">print_across()</span></code></a></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="release-0-0-1-february-17-2013">
<h4>Release 0.0.1 - February 17 2013</h4>
<ul class="simple">
<li>First public release.</li>
</ul>
</div>
</div>
<span id="document-author"></span><div class="section" id="author">
<span id="id1"></span><h3>Author</h3>
<p>XlsxWriter was written by John McNamara.</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/jmcnamara">GitHub</a></li>
<li><a class="reference external" href="https://twitter.com/jmcnamara13">Twitter &#64;jmcnamara13</a></li>
</ul>
<div class="section" id="asking-questions">
<h4>Asking questions</h4>
<p>If you have questions about XlsxWriter here are some ways to deal with them:</p>
<ul>
<li><p class="first"><strong>Bug Reports</strong>:</p>
<p>See the <a class="reference internal" href="index.html#reporting-bugs"><span class="std std-ref">Reporting Bugs</span></a> section of the docs.</p>
</li>
<li><p class="first"><strong>Feature Requests</strong>:</p>
<p>Open a Feature Request issue on
<a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/issues">Github issues</a>.</p>
</li>
<li><p class="first"><strong>Pull Requests</strong>:</p>
<p>See the <a class="reference external" href="https://github.com/jmcnamara/XlsxWriter/blob/master/CONTRIBUTING.md">Contributing Guide</a>.
Note, all Pull Requests must start with an Issue Tracker.</p>
</li>
<li><p class="first"><strong>General Questions</strong>:</p>
<p>General questions about how to use the module should be asked on
<a class="reference external" href="https://stackoverflow.com/search?tab=newest&amp;q=xlsxwriter">StackOverflow</a>.
Add the <code class="docutils literal notranslate"><span class="pre">xlsxwriter</span></code> tag to the question.</p>
<p>Questions on StackOverflow have the advantage of (usually) getting several
answers and it also leaves a searchable question for someone else.</p>
</li>
<li><p class="first"><strong>Email</strong>:</p>
<p>If none of the above apply you can contact me at <a class="reference external" href="mailto:jmcnamara&#37;&#52;&#48;cpan&#46;org">jmcnamara<span>&#64;</span>cpan<span>&#46;</span>org</a>.</p>
</li>
</ul>
</div>
<div class="section" id="sponsorship-and-donations">
<h4>Sponsorship and Donations</h4>
<p>I write and maintain a series of open source libraries for creating Excel
files. The most commonly used are XlsxWriter in Python, Libxlsxwriter in C and
Excel::Writer::XLSX and Spreadsheet::WriteExcel in Perl.</p>
<p>My aim is to write well documented and well tested code that does what the
user needs and doesn’t get in their way.  You can help make this continue, or
show your appreciation for work to date, by becoming a
<a class="reference external" href="https://github.com/sponsors/jmcnamara">GitHub Sponsor</a>.</p>
<p>Or make a one-off donation via
<a class="reference external" href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=RRZCPSL65X858">PayPal</a>.</p>
<center>
<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="RRZCPSL65X858">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>
</center></div>
</div>
<span id="document-license"></span><div class="section" id="license">
<span id="id1"></span><h3>License</h3>
<p>XlsxWriter is released under a BSD license.</p>
<p>Copyright (c) 2013-2020, John McNamara &lt;<a class="reference external" href="mailto:jmcnamara&#37;&#52;&#48;cpan&#46;org">jmcnamara<span>&#64;</span>cpan<span>&#46;</span>org</a>&gt;
All rights reserved.</p>
<p>Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:</p>
<ol class="arabic simple">
<li>Redistributions of source code must retain the above copyright notice, this
list of conditions and the following disclaimer.</li>
<li>Redistributions in binary form must reproduce the above copyright notice,
this list of conditions and the following disclaimer in the documentation
and/or other materials provided with the distribution.</li>
</ol>
<p>THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS IS” AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</p>
<p>The views and conclusions contained in the software and documentation are those
of the authors and should not be interpreted as representing official policies,
either expressed or implied, of the FreeBSD Project.</p>
</div>
</div>
</div>
</div>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2013-2020, John McNamara.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.8.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>